var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertyNames,r=Object.getOwnPropertySymbols,s=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,l=Reflect.get,c=(t,n,i)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[n]=i,u=(e,t)=>{for(var n in t||(t={}))o.call(t,n)&&c(e,n,t[n]);if(r)for(var n of r(t))a.call(t,n)&&c(e,n,t[n]);return e},h=(e,i)=>t(e,n(i)),d=(e,t)=>{var n={};for(var i in e)o.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&r)for(var i of r(e))t.indexOf(i)<0&&a.call(e,i)&&(n[i]=e[i]);return n},f=(e,t,n)=>l(s(e),n,t),p=(e,t,n)=>new Promise((i,r)=>{var s=e=>{try{a(n.next(e))}catch(t){r(t)}},o=e=>{try{a(n.throw(e))}catch(t){r(t)}},a=e=>e.done?i(e.value):Promise.resolve(e.value).then(s,o);a((n=n.apply(e,t)).next())});import{a as m,b as g,j as v,f as y,T as b,A as x,g as w,I as S,M as C,i as T,B as E,k,S as D,F as I,l as _,m as j,N as P,L as M,D as A,n as R,o as O,p as N,q as L,P as V,r as F,s as U,u as z,v as W,w as B,x as q,y as H,z as $,C as X,E as K,K as G,G as Y,H as Q,J,W as Z,O as ee,Q as te,R as ne,_ as ie,U as re,V as se,X as oe,Y as ae,Z as le,$ as ce,a0 as ue,a1 as he,a2 as de,a3 as fe,a4 as pe,a5 as me,a6 as ge,a7 as ve,a8 as ye,a9 as be,aa as xe,ab as we,ac as Se,ad as Ce,ae as Te,af as Ee,ag as ke,ah as De,ai as Ie,aj as _e,ak as je,al as Pe,am as Me,an as Ae,ao as Re,ap as Oe,aq as Ne,ar as Le,as as Ve,at as Fe,au as Ue,av as ze,aw as We,ax as Be,ay as qe,az as He,aA as $e,aB as Xe,aC as Ke,aD as Ge,aE as Ye,aF as Qe,aG as Je,aH as Ze,aI as et,aJ as tt,aK as nt,aL as it,aM as rt,aN as st,aO as ot,aP as at,aQ as lt,aR as ct,aS as ut,aT as ht,aU as dt,aV as ft,aW as pt,aX as mt,aY as gt,aZ as vt,a_ as yt,a$ as bt,b0 as xt,b1 as wt,b2 as St,b3 as Ct,b4 as Tt,b5 as Et,b6 as kt,b7 as Dt,b8 as It,b9 as _t,ba as jt}from"./mui-gL6vxxMU.js";import{d as Pt,c as Mt,b as At,r as Rt,g as Ot}from"./vendor-Dgl78f6S.js";import{u as Nt,a as Lt,B as Vt,R as Ft,b as Ut}from"./router-oEaKxWsV.js";import{V as zt,b as Wt,a as Bt,c as qt,d as Ht,e as $t,l as Xt,p as Kt,f as Gt,g as Yt,i as Qt,h as Jt,j as Zt,k as en,m as tn,n as nn,o as rn,q as sn,r as on,s as an,t as ln,u as cn,v as un,w as hn,x as dn,y as fn,z as pn,A as mn,B as gn,C as vn,D as yn,E as bn,F as xn,G as wn,H as Sn,I as Cn,J as Tn,K as En,L as kn,M as Dn,N as In,O as _n,P as jn,Q as Pn,R as Mn,S as An,T as Rn,U as On,W as Nn,X as Ln,Y as Vn,Z as Fn,_ as Un,$ as zn,a0 as Wn,a1 as Bn,a2 as qn,a3 as Hn,a4 as $n,a5 as Xn,a6 as Kn,a7 as Gn}from"./utils-BYgCwDxS.js";import{m as Yn,A as Qn,D as Jn,C as Zn,P as ei}from"./animation-BYFpfXX6.js";import{m as ti,y as ni,D as ii,a as ri,b as si,d as oi,c as ai,e as li,f as ci,W as ui,C as hi,g as di,S as fi,V as pi,h as mi,N as gi,i as vi,r as yi,j as bi,k as xi,B as wi,l as Si,n as Ci,o as Ti,p as Ei,w as ki,q as Di,s as Ii,t as _i,u as ji,v as Pi,x as Mi,R as Ai,P as Ri,z as Oi,A as Ni,E as Li,F as Vi,_ as Fi,G as Ui,H as zi,I as Wi,J as Bi,K as qi,L as Hi,M as $i,O as Xi,Q as Ki,T as Gi,U as Yi,X as Qi,Y as Ji,Z as Zi,$ as er,a0 as tr,a1 as nr,a2 as ir,a3 as rr,a4 as sr,a5 as or,a6 as ar,a7 as lr,a8 as cr,a9 as ur,aa as hr,ab as dr,ac as fr,ad as pr,ae as mr,af as gr,ag as vr,ah as yr,ai as br,aj as xr,ak as wr,al as Sr,am as Cr,an as Tr,ao as Er,ap as kr,aq as Dr,ar as Ir,as as _r,at as jr,au as Pr,av as Mr,aw as Ar,ax as Rr,ay as Or,az as Nr,aA as Lr,aB as Vr,aC as Fr,aD as Ur,aE as zr,aF as Wr,aG as Br,aH as qr,aI as Hr,aJ as $r}from"./calendar-Dfug1utP.js";var Xr,Kr,Gr=(Xr={"assets/main-HnwQL0ao.js"(e){!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var t={},n=Pt;t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot;var i=function(){function e(){this.listeners=[]}var t=e.prototype;return t.subscribe=function(e){var t=this,n=e||function(){};return this.listeners.push(n),this.onSubscribe(),function(){t.listeners=t.listeners.filter(function(e){return e!==n}),t.onUnsubscribe()}},t.hasListeners=function(){return this.listeners.length>0},t.onSubscribe=function(){},t.onUnsubscribe=function(){},e}(),r="undefined"==typeof window;function s(){}function o(e){return Array.isArray(e)?e:[e]}function a(e,t,n){return ts(e)?"function"==typeof t?m({},n,{queryKey:e,queryFn:t}):m({},t,{queryKey:e}):e}function l(e,t,n){return ts(e)?[m({},t,{queryKey:e}),n]:[e||{},t]}function c(e,t){var n=e.active,i=e.exact,r=e.fetching,s=e.inactive,o=e.predicate,a=e.queryKey,l=e.stale;if(ts(a))if(i){if(t.queryHash!==Kr(a,t.options))return!1}else if(!Yr(t.queryKey,a))return!1;var c=function(e,t){return!0===e&&!0===t||null==e&&null==t?"all":!1===e&&!1===t?"none":(null!=e?e:!t)?"active":"inactive"}(n,s);if("none"===c)return!1;if("all"!==c){var u=t.isActive();if("active"===c&&!u)return!1;if("inactive"===c&&u)return!1}return!("boolean"==typeof l&&t.isStale()!==l||"boolean"==typeof r&&t.isFetching()!==r||o&&!o(t))}function Xr(e,t){var n=e.exact,i=e.fetching,r=e.predicate,s=e.mutationKey;if(ts(s)){if(!t.options.mutationKey)return!1;if(n){if(Gr(t.options.mutationKey)!==Gr(s))return!1}else if(!Yr(t.options.mutationKey,s))return!1}return!("boolean"==typeof i&&"loading"===t.state.status!==i||r&&!r(t))}function Kr(e,t){return((null==t?void 0:t.queryKeyHashFn)||Gr)(e)}function Gr(e){var t,n=o(e);return t=n,JSON.stringify(t,function(e,t){return Zr(t)?Object.keys(t).sort().reduce(function(e,n){return e[n]=t[n],e},{}):t})}function Yr(e,t){return Qr(o(e),o(t))}function Qr(e,t){return e===t||typeof e==typeof t&&!(!e||!t||"object"!=typeof e||"object"!=typeof t)&&!Object.keys(t).some(function(n){return!Qr(e[n],t[n])})}function Jr(e,t){if(e===t)return e;var n=Array.isArray(e)&&Array.isArray(t);if(n||Zr(e)&&Zr(t)){for(var i=n?e.length:Object.keys(e).length,r=n?t:Object.keys(t),s=r.length,o=n?[]:{},a=0,l=0;l<s;l++){var c=n?l:r[l];o[c]=Jr(e[c],t[c]),o[c]===e[c]&&a++}return i===s&&a===i?e:o}return t}function Zr(e){if(!es(e))return!1;var t=e.constructor;if(void 0===t)return!0;var n=t.prototype;return!!es(n)&&!!n.hasOwnProperty("isPrototypeOf")}function es(e){return"[object Object]"===Object.prototype.toString.call(e)}function ts(e){return"string"==typeof e||Array.isArray(e)}function ns(e){Promise.resolve().then(e).catch(function(e){return setTimeout(function(){throw e})})}function is(){if("function"==typeof AbortController)return new AbortController}var rs=new(function(e){function t(){var t;return(t=e.call(this)||this).setup=function(e){var t;if(!r&&(null==(t=window)?void 0:t.addEventListener)){var n=function(){return e()};return window.addEventListener("visibilitychange",n,!1),window.addEventListener("focus",n,!1),function(){window.removeEventListener("visibilitychange",n),window.removeEventListener("focus",n)}}},t}g(t,e);var n=t.prototype;return n.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},n.onUnsubscribe=function(){var e;this.hasListeners()||(null==(e=this.cleanup)||e.call(this),this.cleanup=void 0)},n.setEventListener=function(e){var t,n=this;this.setup=e,null==(t=this.cleanup)||t.call(this),this.cleanup=e(function(e){"boolean"==typeof e?n.setFocused(e):n.onFocus()})},n.setFocused=function(e){this.focused=e,e&&this.onFocus()},n.onFocus=function(){this.listeners.forEach(function(e){e()})},n.isFocused=function(){return"boolean"==typeof this.focused?this.focused:"undefined"==typeof document||[void 0,"visible","prerender"].includes(document.visibilityState)},t}(i)),ss=new(function(e){function t(){var t;return(t=e.call(this)||this).setup=function(e){var t;if(!r&&(null==(t=window)?void 0:t.addEventListener)){var n=function(){return e()};return window.addEventListener("online",n,!1),window.addEventListener("offline",n,!1),function(){window.removeEventListener("online",n),window.removeEventListener("offline",n)}}},t}g(t,e);var n=t.prototype;return n.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},n.onUnsubscribe=function(){var e;this.hasListeners()||(null==(e=this.cleanup)||e.call(this),this.cleanup=void 0)},n.setEventListener=function(e){var t,n=this;this.setup=e,null==(t=this.cleanup)||t.call(this),this.cleanup=e(function(e){"boolean"==typeof e?n.setOnline(e):n.onOnline()})},n.setOnline=function(e){this.online=e,e&&this.onOnline()},n.onOnline=function(){this.listeners.forEach(function(e){e()})},n.isOnline=function(){return"boolean"==typeof this.online?this.online:"undefined"==typeof navigator||void 0===navigator.onLine||navigator.onLine},t}(i));function os(e){return Math.min(1e3*Math.pow(2,e),3e4)}function as(e){return"function"==typeof(null==e?void 0:e.cancel)}var ls=function(e){this.revert=null==e?void 0:e.revert,this.silent=null==e?void 0:e.silent};function cs(e){return e instanceof ls}var us=function(e){var t,n,i,r,s=this,o=!1;this.abort=e.abort,this.cancel=function(e){return null==t?void 0:t(e)},this.cancelRetry=function(){o=!0},this.continueRetry=function(){o=!1},this.continue=function(){return null==n?void 0:n()},this.failureCount=0,this.isPaused=!1,this.isResolved=!1,this.isTransportCancelable=!1,this.promise=new Promise(function(e,t){i=e,r=t});var a=function(t){s.isResolved||(s.isResolved=!0,null==e.onSuccess||e.onSuccess(t),null==n||n(),i(t))},l=function(t){s.isResolved||(s.isResolved=!0,null==e.onError||e.onError(t),null==n||n(),r(t))};!function i(){if(!s.isResolved){var r;try{r=e.fn()}catch(c){r=Promise.reject(c)}t=function(e){if(!s.isResolved&&(l(new ls(e)),null==s.abort||s.abort(),as(r)))try{r.cancel()}catch(t){}},s.isTransportCancelable=as(r),Promise.resolve(r).then(a).catch(function(t){var r,a;if(!s.isResolved){var c,u=null!=(r=e.retry)?r:3,h=null!=(a=e.retryDelay)?a:os,d="function"==typeof h?h(s.failureCount,t):h,f=!0===u||"number"==typeof u&&s.failureCount<u||"function"==typeof u&&u(s.failureCount,t);!o&&f?(s.failureCount++,null==e.onFail||e.onFail(s.failureCount,t),(c=d,new Promise(function(e){setTimeout(e,c)})).then(function(){if(!rs.isFocused()||!ss.isOnline())return new Promise(function(t){n=t,s.isPaused=!0,null==e.onPause||e.onPause()}).then(function(){n=void 0,s.isPaused=!1,null==e.onContinue||e.onContinue()})}).then(function(){o?l(t):i()})):l(t)}})}}()},hs=function(){function e(){this.queue=[],this.transactions=0,this.notifyFn=function(e){e()},this.batchNotifyFn=function(e){e()}}var t=e.prototype;return t.batch=function(e){var t;this.transactions++;try{t=e()}finally{this.transactions--,this.transactions||this.flush()}return t},t.schedule=function(e){var t=this;this.transactions?this.queue.push(e):ns(function(){t.notifyFn(e)})},t.batchCalls=function(e){var t=this;return function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];t.schedule(function(){e.apply(void 0,i)})}},t.flush=function(){var e=this,t=this.queue;this.queue=[],t.length&&ns(function(){e.batchNotifyFn(function(){t.forEach(function(t){e.notifyFn(t)})})})},t.setNotifyFunction=function(e){this.notifyFn=e},t.setBatchNotifyFunction=function(e){this.batchNotifyFn=e},e}(),ds=new hs,fs=console;function ps(){return fs}var ms=function(){function e(e){this.abortSignalConsumed=!1,this.hadObservers=!1,this.defaultOptions=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.cache=e.cache,this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.initialState=e.state||this.getDefaultState(this.options),this.state=this.initialState,this.meta=e.meta,this.scheduleGc()}var t=e.prototype;return t.setOptions=function(e){var t;this.options=m({},this.defaultOptions,e),this.meta=null==e?void 0:e.meta,this.cacheTime=Math.max(this.cacheTime||0,null!=(t=this.options.cacheTime)?t:3e5)},t.setDefaultOptions=function(e){this.defaultOptions=e},t.scheduleGc=function(){var e,t=this;this.clearGcTimeout(),"number"==typeof(e=this.cacheTime)&&e>=0&&e!==1/0&&(this.gcTimeout=setTimeout(function(){t.optionalRemove()},this.cacheTime))},t.clearGcTimeout=function(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)},t.optionalRemove=function(){this.observers.length||(this.state.isFetching?this.hadObservers&&this.scheduleGc():this.cache.remove(this))},t.setData=function(e,t){var n,i,r=this.state.data,s=function(e,t){return"function"==typeof e?e(t):e}(e,r);return(null==(n=(i=this.options).isDataEqual)?void 0:n.call(i,r,s))?s=r:!1!==this.options.structuralSharing&&(s=Jr(r,s)),this.dispatch({data:s,type:"success",dataUpdatedAt:null==t?void 0:t.updatedAt}),s},t.setState=function(e,t){this.dispatch({type:"setState",state:e,setStateOptions:t})},t.cancel=function(e){var t,n=this.promise;return null==(t=this.retryer)||t.cancel(e),n?n.then(s).catch(s):Promise.resolve()},t.destroy=function(){this.clearGcTimeout(),this.cancel({silent:!0})},t.reset=function(){this.destroy(),this.setState(this.initialState)},t.isActive=function(){return this.observers.some(function(e){return!1!==e.options.enabled})},t.isFetching=function(){return this.state.isFetching},t.isStale=function(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(function(e){return e.getCurrentResult().isStale})},t.isStaleByTime=function(e){return void 0===e&&(e=0),this.state.isInvalidated||!this.state.dataUpdatedAt||!function(e,t){return Math.max(e+(t||0)-Date.now(),0)}(this.state.dataUpdatedAt,e)},t.onFocus=function(){var e,t=this.observers.find(function(e){return e.shouldFetchOnWindowFocus()});t&&t.refetch(),null==(e=this.retryer)||e.continue()},t.onOnline=function(){var e,t=this.observers.find(function(e){return e.shouldFetchOnReconnect()});t&&t.refetch(),null==(e=this.retryer)||e.continue()},t.addObserver=function(e){-1===this.observers.indexOf(e)&&(this.observers.push(e),this.hadObservers=!0,this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:e}))},t.removeObserver=function(e){-1!==this.observers.indexOf(e)&&(this.observers=this.observers.filter(function(t){return t!==e}),this.observers.length||(this.retryer&&(this.retryer.isTransportCancelable||this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.cacheTime?this.scheduleGc():this.cache.remove(this)),this.cache.notify({type:"observerRemoved",query:this,observer:e}))},t.getObserversCount=function(){return this.observers.length},t.invalidate=function(){this.state.isInvalidated||this.dispatch({type:"invalidate"})},t.fetch=function(e,t){var n,i,r,s=this;if(this.state.isFetching)if(this.state.dataUpdatedAt&&(null==t?void 0:t.cancelRefetch))this.cancel({silent:!0});else if(this.promise){var a;return null==(a=this.retryer)||a.continueRetry(),this.promise}if(e&&this.setOptions(e),!this.options.queryFn){var l=this.observers.find(function(e){return e.options.queryFn});l&&this.setOptions(l.options)}var c=o(this.queryKey),u=is(),h={queryKey:c,pageParam:void 0,meta:this.meta};Object.defineProperty(h,"signal",{enumerable:!0,get:function(){if(u)return s.abortSignalConsumed=!0,u.signal}});var d,f,p={fetchOptions:t,options:this.options,queryKey:c,state:this.state,fetchFn:function(){return s.options.queryFn?(s.abortSignalConsumed=!1,s.options.queryFn(h)):Promise.reject("Missing queryFn")},meta:this.meta};return(null==(n=this.options.behavior)?void 0:n.onFetch)&&(null==(d=this.options.behavior)||d.onFetch(p)),this.revertState=this.state,this.state.isFetching&&this.state.fetchMeta===(null==(i=p.fetchOptions)?void 0:i.meta)||this.dispatch({type:"fetch",meta:null==(f=p.fetchOptions)?void 0:f.meta}),this.retryer=new us({fn:p.fetchFn,abort:null==u||null==(r=u.abort)?void 0:r.bind(u),onSuccess:function(e){s.setData(e),null==s.cache.config.onSuccess||s.cache.config.onSuccess(e,s),0===s.cacheTime&&s.optionalRemove()},onError:function(e){cs(e)&&e.silent||s.dispatch({type:"error",error:e}),cs(e)||(null==s.cache.config.onError||s.cache.config.onError(e,s),ps().error(e)),0===s.cacheTime&&s.optionalRemove()},onFail:function(){s.dispatch({type:"failed"})},onPause:function(){s.dispatch({type:"pause"})},onContinue:function(){s.dispatch({type:"continue"})},retry:p.options.retry,retryDelay:p.options.retryDelay}),this.promise=this.retryer.promise,this.promise},t.dispatch=function(e){var t=this;this.state=this.reducer(this.state,e),ds.batch(function(){t.observers.forEach(function(t){t.onQueryUpdate(e)}),t.cache.notify({query:t,type:"queryUpdated",action:e})})},t.getDefaultState=function(e){var t="function"==typeof e.initialData?e.initialData():e.initialData,n=void 0!==e.initialData?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0,i=void 0!==t;return{data:t,dataUpdateCount:0,dataUpdatedAt:i?null!=n?n:Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchMeta:null,isFetching:!1,isInvalidated:!1,isPaused:!1,status:i?"success":"idle"}},t.reducer=function(e,t){var n,i;switch(t.type){case"failed":return m({},e,{fetchFailureCount:e.fetchFailureCount+1});case"pause":return m({},e,{isPaused:!0});case"continue":return m({},e,{isPaused:!1});case"fetch":return m({},e,{fetchFailureCount:0,fetchMeta:null!=(n=t.meta)?n:null,isFetching:!0,isPaused:!1},!e.dataUpdatedAt&&{error:null,status:"loading"});case"success":return m({},e,{data:t.data,dataUpdateCount:e.dataUpdateCount+1,dataUpdatedAt:null!=(i=t.dataUpdatedAt)?i:Date.now(),error:null,fetchFailureCount:0,isFetching:!1,isInvalidated:!1,isPaused:!1,status:"success"});case"error":var r=t.error;return cs(r)&&r.revert&&this.revertState?m({},this.revertState):m({},e,{error:r,errorUpdateCount:e.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:e.fetchFailureCount+1,isFetching:!1,isPaused:!1,status:"error"});case"invalidate":return m({},e,{isInvalidated:!0});case"setState":return m({},e,t.state);default:return e}},e}(),gs=function(e){function t(t){var n;return(n=e.call(this)||this).config=t||{},n.queries=[],n.queriesMap={},n}g(t,e);var n=t.prototype;return n.build=function(e,t,n){var i,r=t.queryKey,s=null!=(i=t.queryHash)?i:Kr(r,t),o=this.get(s);return o||(o=new ms({cache:this,queryKey:r,queryHash:s,options:e.defaultQueryOptions(t),state:n,defaultOptions:e.getQueryDefaults(r),meta:t.meta}),this.add(o)),o},n.add=function(e){this.queriesMap[e.queryHash]||(this.queriesMap[e.queryHash]=e,this.queries.push(e),this.notify({type:"queryAdded",query:e}))},n.remove=function(e){var t=this.queriesMap[e.queryHash];t&&(e.destroy(),this.queries=this.queries.filter(function(t){return t!==e}),t===e&&delete this.queriesMap[e.queryHash],this.notify({type:"queryRemoved",query:e}))},n.clear=function(){var e=this;ds.batch(function(){e.queries.forEach(function(t){e.remove(t)})})},n.get=function(e){return this.queriesMap[e]},n.getAll=function(){return this.queries},n.find=function(e,t){var n=l(e,t)[0];return void 0===n.exact&&(n.exact=!0),this.queries.find(function(e){return c(n,e)})},n.findAll=function(e,t){var n=l(e,t)[0];return Object.keys(n).length>0?this.queries.filter(function(e){return c(n,e)}):this.queries},n.notify=function(e){var t=this;ds.batch(function(){t.listeners.forEach(function(t){t(e)})})},n.onFocus=function(){var e=this;ds.batch(function(){e.queries.forEach(function(e){e.onFocus()})})},n.onOnline=function(){var e=this;ds.batch(function(){e.queries.forEach(function(e){e.onOnline()})})},t}(i),vs=function(){function e(e){this.options=m({},e.defaultOptions,e.options),this.mutationId=e.mutationId,this.mutationCache=e.mutationCache,this.observers=[],this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,isPaused:!1,status:"idle",variables:void 0},this.meta=e.meta}var t=e.prototype;return t.setState=function(e){this.dispatch({type:"setState",state:e})},t.addObserver=function(e){-1===this.observers.indexOf(e)&&this.observers.push(e)},t.removeObserver=function(e){this.observers=this.observers.filter(function(t){return t!==e})},t.cancel=function(){return this.retryer?(this.retryer.cancel(),this.retryer.promise.then(s).catch(s)):Promise.resolve()},t.continue=function(){return this.retryer?(this.retryer.continue(),this.retryer.promise):this.execute()},t.execute=function(){var e,t=this,n="loading"===this.state.status,i=Promise.resolve();return n||(this.dispatch({type:"loading",variables:this.options.variables}),i=i.then(function(){null==t.mutationCache.config.onMutate||t.mutationCache.config.onMutate(t.state.variables,t)}).then(function(){return null==t.options.onMutate?void 0:t.options.onMutate(t.state.variables)}).then(function(e){e!==t.state.context&&t.dispatch({type:"loading",context:e,variables:t.state.variables})})),i.then(function(){return t.executeMutation()}).then(function(n){e=n,null==t.mutationCache.config.onSuccess||t.mutationCache.config.onSuccess(e,t.state.variables,t.state.context,t)}).then(function(){return null==t.options.onSuccess?void 0:t.options.onSuccess(e,t.state.variables,t.state.context)}).then(function(){return null==t.options.onSettled?void 0:t.options.onSettled(e,null,t.state.variables,t.state.context)}).then(function(){return t.dispatch({type:"success",data:e}),e}).catch(function(e){return null==t.mutationCache.config.onError||t.mutationCache.config.onError(e,t.state.variables,t.state.context,t),ps().error(e),Promise.resolve().then(function(){return null==t.options.onError?void 0:t.options.onError(e,t.state.variables,t.state.context)}).then(function(){return null==t.options.onSettled?void 0:t.options.onSettled(void 0,e,t.state.variables,t.state.context)}).then(function(){throw t.dispatch({type:"error",error:e}),e})})},t.executeMutation=function(){var e,t=this;return this.retryer=new us({fn:function(){return t.options.mutationFn?t.options.mutationFn(t.state.variables):Promise.reject("No mutationFn found")},onFail:function(){t.dispatch({type:"failed"})},onPause:function(){t.dispatch({type:"pause"})},onContinue:function(){t.dispatch({type:"continue"})},retry:null!=(e=this.options.retry)?e:0,retryDelay:this.options.retryDelay}),this.retryer.promise},t.dispatch=function(e){var t=this;this.state=function(e,t){switch(t.type){case"failed":return m({},e,{failureCount:e.failureCount+1});case"pause":return m({},e,{isPaused:!0});case"continue":return m({},e,{isPaused:!1});case"loading":return m({},e,{context:t.context,data:void 0,error:null,isPaused:!1,status:"loading",variables:t.variables});case"success":return m({},e,{data:t.data,error:null,status:"success",isPaused:!1});case"error":return m({},e,{data:void 0,error:t.error,failureCount:e.failureCount+1,isPaused:!1,status:"error"});case"setState":return m({},e,t.state);default:return e}}(this.state,e),ds.batch(function(){t.observers.forEach(function(t){t.onMutationUpdate(e)}),t.mutationCache.notify(t)})},e}(),ys=function(e){function t(t){var n;return(n=e.call(this)||this).config=t||{},n.mutations=[],n.mutationId=0,n}g(t,e);var n=t.prototype;return n.build=function(e,t,n){var i=new vs({mutationCache:this,mutationId:++this.mutationId,options:e.defaultMutationOptions(t),state:n,defaultOptions:t.mutationKey?e.getMutationDefaults(t.mutationKey):void 0,meta:t.meta});return this.add(i),i},n.add=function(e){this.mutations.push(e),this.notify(e)},n.remove=function(e){this.mutations=this.mutations.filter(function(t){return t!==e}),e.cancel(),this.notify(e)},n.clear=function(){var e=this;ds.batch(function(){e.mutations.forEach(function(t){e.remove(t)})})},n.getAll=function(){return this.mutations},n.find=function(e){return void 0===e.exact&&(e.exact=!0),this.mutations.find(function(t){return Xr(e,t)})},n.findAll=function(e){return this.mutations.filter(function(t){return Xr(e,t)})},n.notify=function(e){var t=this;ds.batch(function(){t.listeners.forEach(function(t){t(e)})})},n.onFocus=function(){this.resumePausedMutations()},n.onOnline=function(){this.resumePausedMutations()},n.resumePausedMutations=function(){var e=this.mutations.filter(function(e){return e.state.isPaused});return ds.batch(function(){return e.reduce(function(e,t){return e.then(function(){return t.continue().catch(s)})},Promise.resolve())})},t}(i);function bs(e,t){return null==e.getNextPageParam?void 0:e.getNextPageParam(t[t.length-1],t)}var xs=function(){function e(e){void 0===e&&(e={}),this.queryCache=e.queryCache||new gs,this.mutationCache=e.mutationCache||new ys,this.defaultOptions=e.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[]}var t=e.prototype;return t.mount=function(){var e=this;this.unsubscribeFocus=rs.subscribe(function(){rs.isFocused()&&ss.isOnline()&&(e.mutationCache.onFocus(),e.queryCache.onFocus())}),this.unsubscribeOnline=ss.subscribe(function(){rs.isFocused()&&ss.isOnline()&&(e.mutationCache.onOnline(),e.queryCache.onOnline())})},t.unmount=function(){var e,t;null==(e=this.unsubscribeFocus)||e.call(this),null==(t=this.unsubscribeOnline)||t.call(this)},t.isFetching=function(e,t){var n=l(e,t)[0];return n.fetching=!0,this.queryCache.findAll(n).length},t.isMutating=function(e){return this.mutationCache.findAll(m({},e,{fetching:!0})).length},t.getQueryData=function(e,t){var n;return null==(n=this.queryCache.find(e,t))?void 0:n.state.data},t.getQueriesData=function(e){return this.getQueryCache().findAll(e).map(function(e){return[e.queryKey,e.state.data]})},t.setQueryData=function(e,t,n){var i=a(e),r=this.defaultQueryOptions(i);return this.queryCache.build(this,r).setData(t,n)},t.setQueriesData=function(e,t,n){var i=this;return ds.batch(function(){return i.getQueryCache().findAll(e).map(function(e){var r=e.queryKey;return[r,i.setQueryData(r,t,n)]})})},t.getQueryState=function(e,t){var n;return null==(n=this.queryCache.find(e,t))?void 0:n.state},t.removeQueries=function(e,t){var n=l(e,t)[0],i=this.queryCache;ds.batch(function(){i.findAll(n).forEach(function(e){i.remove(e)})})},t.resetQueries=function(e,t,n){var i=this,r=l(e,t,n),s=r[0],o=r[1],a=this.queryCache,c=m({},s,{active:!0});return ds.batch(function(){return a.findAll(s).forEach(function(e){e.reset()}),i.refetchQueries(c,o)})},t.cancelQueries=function(e,t,n){var i=this,r=l(e,t,n),o=r[0],a=r[1],c=void 0===a?{}:a;void 0===c.revert&&(c.revert=!0);var u=ds.batch(function(){return i.queryCache.findAll(o).map(function(e){return e.cancel(c)})});return Promise.all(u).then(s).catch(s)},t.invalidateQueries=function(e,t,n){var i,r,s,o=this,a=l(e,t,n),c=a[0],u=a[1],h=m({},c,{active:null==(i=null!=(r=c.refetchActive)?r:c.active)||i,inactive:null!=(s=c.refetchInactive)&&s});return ds.batch(function(){return o.queryCache.findAll(c).forEach(function(e){e.invalidate()}),o.refetchQueries(h,u)})},t.refetchQueries=function(e,t,n){var i=this,r=l(e,t,n),o=r[0],a=r[1],c=ds.batch(function(){return i.queryCache.findAll(o).map(function(e){return e.fetch(void 0,m({},a,{meta:{refetchPage:null==o?void 0:o.refetchPage}}))})}),u=Promise.all(c).then(s);return(null==a?void 0:a.throwOnError)||(u=u.catch(s)),u},t.fetchQuery=function(e,t,n){var i=a(e,t,n),r=this.defaultQueryOptions(i);void 0===r.retry&&(r.retry=!1);var s=this.queryCache.build(this,r);return s.isStaleByTime(r.staleTime)?s.fetch(r):Promise.resolve(s.state.data)},t.prefetchQuery=function(e,t,n){return this.fetchQuery(e,t,n).then(s).catch(s)},t.fetchInfiniteQuery=function(e,t,n){var i=a(e,t,n);return i.behavior={onFetch:function(e){e.fetchFn=function(){var t,n,i,r,s,o,a,l,c,u=null==(t=e.fetchOptions)||null==(n=t.meta)?void 0:n.refetchPage,h=null==(i=e.fetchOptions)||null==(r=i.meta)?void 0:r.fetchMore,d=null==h?void 0:h.pageParam,f="forward"===(null==h?void 0:h.direction),p="backward"===(null==h?void 0:h.direction),m=(null==(s=e.state.data)?void 0:s.pages)||[],g=(null==(o=e.state.data)?void 0:o.pageParams)||[],v=is(),y=null==v?void 0:v.signal,b=g,x=!1,w=e.options.queryFn||function(){return Promise.reject("Missing queryFn")},S=function(e,t,n,i){return b=i?[t].concat(b):[].concat(b,[t]),i?[n].concat(e):[].concat(e,[n])},C=function(t,n,i,r){if(x)return Promise.reject("Cancelled");if(void 0===i&&!n&&t.length)return Promise.resolve(t);var s={queryKey:e.queryKey,signal:y,pageParam:i,meta:e.meta},o=w(s),a=Promise.resolve(o).then(function(e){return S(t,i,e,r)});return as(o)&&(a.cancel=o.cancel),a};if(m.length)if(f){var T=void 0!==d,E=T?d:bs(e.options,m);a=C(m,T,E)}else if(p){var k=void 0!==d,D=k?d:(l=e.options,c=m,null==l.getPreviousPageParam?void 0:l.getPreviousPageParam(c[0],c));a=C(m,k,D,!0)}else!function(){b=[];var t=void 0===e.options.getNextPageParam,n=!u||!m[0]||u(m[0],0,m);a=n?C([],t,g[0]):Promise.resolve(S([],g[0],m[0]));for(var i=function(n){a=a.then(function(i){if(!u||!m[n]||u(m[n],n,m)){var r=t?g[n]:bs(e.options,i);return C(i,t,r)}return Promise.resolve(S(i,g[n],m[n]))})},r=1;r<m.length;r++)i(r)}();else a=C([]);var I=a.then(function(e){return{pages:e,pageParams:b}});return I.cancel=function(){x=!0,null==v||v.abort(),as(a)&&a.cancel()},I}}},this.fetchQuery(i)},t.prefetchInfiniteQuery=function(e,t,n){return this.fetchInfiniteQuery(e,t,n).then(s).catch(s)},t.cancelMutations=function(){var e=this,t=ds.batch(function(){return e.mutationCache.getAll().map(function(e){return e.cancel()})});return Promise.all(t).then(s).catch(s)},t.resumePausedMutations=function(){return this.getMutationCache().resumePausedMutations()},t.executeMutation=function(e){return this.mutationCache.build(this,e).execute()},t.getQueryCache=function(){return this.queryCache},t.getMutationCache=function(){return this.mutationCache},t.getDefaultOptions=function(){return this.defaultOptions},t.setDefaultOptions=function(e){this.defaultOptions=e},t.setQueryDefaults=function(e,t){var n=this.queryDefaults.find(function(t){return Gr(e)===Gr(t.queryKey)});n?n.defaultOptions=t:this.queryDefaults.push({queryKey:e,defaultOptions:t})},t.getQueryDefaults=function(e){var t;return e?null==(t=this.queryDefaults.find(function(t){return Yr(e,t.queryKey)}))?void 0:t.defaultOptions:void 0},t.setMutationDefaults=function(e,t){var n=this.mutationDefaults.find(function(t){return Gr(e)===Gr(t.mutationKey)});n?n.defaultOptions=t:this.mutationDefaults.push({mutationKey:e,defaultOptions:t})},t.getMutationDefaults=function(e){var t;return e?null==(t=this.mutationDefaults.find(function(t){return Yr(e,t.mutationKey)}))?void 0:t.defaultOptions:void 0},t.defaultQueryOptions=function(e){if(null==e?void 0:e._defaulted)return e;var t=m({},this.defaultOptions.queries,this.getQueryDefaults(null==e?void 0:e.queryKey),e,{_defaulted:!0});return!t.queryHash&&t.queryKey&&(t.queryHash=Kr(t.queryKey,t)),t},t.defaultQueryObserverOptions=function(e){return this.defaultQueryOptions(e)},t.defaultMutationOptions=function(e){return(null==e?void 0:e._defaulted)?e:m({},this.defaultOptions.mutations,this.getMutationDefaults(null==e?void 0:e.mutationKey),e,{_defaulted:!0})},t.clear=function(){this.queryCache.clear(),this.mutationCache.clear()},e}(),ws=Mt.unstable_batchedUpdates;ds.setBatchNotifyFunction(ws);var Ss=console;fs=Ss;var Cs=At.createContext(void 0),Ts=At.createContext(!1),Es=function(e){var t=e.client,n=e.contextSharing,i=void 0!==n&&n,r=e.children;At.useEffect(function(){return t.mount(),function(){t.unmount()}},[t]);var s=function(e){return e&&"undefined"!=typeof window?(window.ReactQueryClientContext||(window.ReactQueryClientContext=Cs),window.ReactQueryClientContext):Cs}(i);return At.createElement(Ts.Provider,{value:i},At.createElement(s.Provider,{value:t},r))};const ks=Rt.createContext(void 0),Ds=()=>{const e=Rt.useContext(ks);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},Is=({children:t})=>{const[n,i]=Rt.useState(null),[r,s]=Rt.useState(!0);Rt.useEffect(()=>{const e=localStorage.getItem("taskAppUser");if(e)try{const t=JSON.parse(e);i(t)}catch(t){console.error("ユーザー情報の復元に失敗しました:",t),localStorage.removeItem("taskAppUser")}s(!1)},[]);const o={user:n,login:(t,n)=>p(e,null,function*(){s(!0);try{if("demo@example.com"!==t||"password"!==n)throw new Error("メールアドレスまたはパスワードが正しくありません");{const e={id:"1",name:"デモユーザー",email:t};i(e),localStorage.setItem("taskAppUser",JSON.stringify(e))}}catch(e){throw e}finally{s(!1)}}),logout:()=>{i(null),localStorage.removeItem("taskAppUser")},register:(t,n,r)=>p(e,null,function*(){s(!0);try{const e={id:Date.now().toString(),name:t,email:n};i(e),localStorage.setItem("taskAppUser",JSON.stringify(e))}catch(e){throw e}finally{s(!1)}}),isLoading:r};return v.jsx(ks.Provider,{value:o,children:t})},_s=y({palette:{mode:"light",primary:{main:"#6366f1",light:"#818cf8",dark:"#4f46e5",contrastText:"#ffffff"},secondary:{main:"#ec4899",light:"#f472b6",dark:"#db2777",contrastText:"#ffffff"},background:{default:"#f1f5f9",paper:"#ffffff"},text:{primary:"#0f172a",secondary:"#64748b",disabled:"#94a3b8"},divider:"#e2e8f0",success:{main:"#10b981",light:"#34d399",dark:"#059669"},warning:{main:"#f59e0b",light:"#fbbf24",dark:"#d97706"},error:{main:"#ef4444",light:"#f87171",dark:"#dc2626"},info:{main:"#3b82f6",light:"#60a5fa",dark:"#2563eb"}},typography:{fontFamily:'"Inter", "Roboto", "Helvetica", "Arial", sans-serif',h1:{fontWeight:700,fontSize:"2.5rem",lineHeight:1.2},h2:{fontWeight:600,fontSize:"2rem",lineHeight:1.3},h3:{fontWeight:600,fontSize:"1.75rem",lineHeight:1.3},h4:{fontWeight:600,fontSize:"1.5rem",lineHeight:1.4},h5:{fontWeight:600,fontSize:"1.25rem",lineHeight:1.4},h6:{fontWeight:600,fontSize:"1rem",lineHeight:1.4},body1:{fontSize:"1rem",lineHeight:1.5,fontWeight:400},body2:{fontSize:"0.875rem",lineHeight:1.5,fontWeight:400},button:{fontWeight:500,textTransform:"none"},caption:{fontSize:"0.75rem",fontWeight:400}},shape:{borderRadius:12},spacing:8,components:{MuiButton:{styleOverrides:{root:{borderRadius:12,padding:"10px 20px",fontWeight:600,textTransform:"none",boxShadow:"none","&:hover":{boxShadow:"0 4px 12px rgba(99, 102, 241, 0.15)"}},contained:{"&:hover":{boxShadow:"0 6px 16px rgba(99, 102, 241, 0.25)"}},outlined:{borderWidth:"2px","&:hover":{borderWidth:"2px"}}}},MuiCard:{styleOverrides:{root:{borderRadius:16,boxShadow:"0 1px 3px rgba(0, 0, 0, 0.05), 0 1px 2px rgba(0, 0, 0, 0.03)",border:"1px solid #f1f5f9","&:hover":{boxShadow:"0 8px 25px rgba(0, 0, 0, 0.08), 0 4px 10px rgba(0, 0, 0, 0.04)"}}}},MuiPaper:{styleOverrides:{root:{borderRadius:16,boxShadow:"0 1px 3px rgba(0, 0, 0, 0.05), 0 1px 2px rgba(0, 0, 0, 0.03)"},elevation1:{boxShadow:"0 1px 3px rgba(0, 0, 0, 0.05), 0 1px 2px rgba(0, 0, 0, 0.03)"},elevation2:{boxShadow:"0 4px 12px rgba(0, 0, 0, 0.08), 0 2px 6px rgba(0, 0, 0, 0.04)"}}},MuiTextField:{styleOverrides:{root:{"& .MuiOutlinedInput-root":{borderRadius:12,"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#6366f1"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#6366f1",borderWidth:"2px"}}}}},MuiChip:{styleOverrides:{root:{borderRadius:20,fontWeight:600,fontSize:"0.75rem"},filled:{"&.MuiChip-colorPrimary":{backgroundColor:"#6366f1",color:"#ffffff"},"&.MuiChip-colorSecondary":{backgroundColor:"#ec4899",color:"#ffffff"}}}},MuiAppBar:{styleOverrides:{root:{backgroundColor:"#ffffff",color:"#0f172a",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.05)",borderBottom:"1px solid #f1f5f9"}}},MuiDrawer:{styleOverrides:{paper:{backgroundColor:"#ffffff",borderRight:"1px solid #f1f5f9",boxShadow:"2px 0 8px rgba(0, 0, 0, 0.05)"}}},MuiListItem:{styleOverrides:{root:{borderRadius:12,marginBottom:4,"&:hover":{backgroundColor:"#f8fafc"}}}},MuiListItemButton:{styleOverrides:{root:{borderRadius:12,"&:hover":{backgroundColor:"#f8fafc"},"&.Mui-selected":{backgroundColor:"#eef2ff","&:hover":{backgroundColor:"#eef2ff"}}}}},MuiDialog:{styleOverrides:{paper:{borderRadius:20,boxShadow:"0 25px 50px rgba(0, 0, 0, 0.1)"}}},MuiMenu:{styleOverrides:{paper:{borderRadius:16,boxShadow:"0 10px 30px rgba(0, 0, 0, 0.08)",border:"1px solid #f1f5f9"}}},MuiTooltip:{styleOverrides:{tooltip:{backgroundColor:"#0f172a",color:"#ffffff",borderRadius:12,fontSize:"0.75rem",padding:"8px 12px"}}},MuiBadge:{styleOverrides:{badge:{borderRadius:12,fontSize:"0.75rem",fontWeight:600}}},MuiAvatar:{styleOverrides:{root:{fontWeight:600}}},MuiLinearProgress:{styleOverrides:{root:{borderRadius:6,backgroundColor:"#f1f5f9"},bar:{borderRadius:6}}},MuiTable:{styleOverrides:{root:{"& .MuiTableCell-root":{borderBottom:"1px solid #f1f5f9"}}}},MuiTableHead:{styleOverrides:{root:{"& .MuiTableCell-root":{fontWeight:600,backgroundColor:"#f8fafc"}}}}}}),js=y({palette:{mode:"dark",primary:{main:"#a855f7",light:"#c084fc",dark:"#9333ea",contrastText:"#ffffff"},secondary:{main:"#f472b6",light:"#f9a8d4",dark:"#ec4899",contrastText:"#ffffff"},background:{default:"#0f172a",paper:"#1e293b"},text:{primary:"#f8fafc",secondary:"#cbd5e1",disabled:"#64748b"},divider:"#334155",success:{main:"#10b981",light:"#34d399",dark:"#059669"},warning:{main:"#f59e0b",light:"#fbbf24",dark:"#d97706"},error:{main:"#ef4444",light:"#f87171",dark:"#dc2626"},info:{main:"#3b82f6",light:"#60a5fa",dark:"#2563eb"}},typography:{fontFamily:'"Inter", "Roboto", "Helvetica", "Arial", sans-serif',h1:{fontWeight:700,fontSize:"2.5rem",lineHeight:1.2},h2:{fontWeight:600,fontSize:"2rem",lineHeight:1.3},h3:{fontWeight:600,fontSize:"1.75rem",lineHeight:1.3},h4:{fontWeight:600,fontSize:"1.5rem",lineHeight:1.4},h5:{fontWeight:600,fontSize:"1.25rem",lineHeight:1.4},h6:{fontWeight:600,fontSize:"1rem",lineHeight:1.4},body1:{fontSize:"1rem",lineHeight:1.5,fontWeight:400},body2:{fontSize:"0.875rem",lineHeight:1.5,fontWeight:400},button:{fontWeight:500,textTransform:"none"},caption:{fontSize:"0.75rem",fontWeight:400}},shape:{borderRadius:12},spacing:8,components:{MuiButton:{styleOverrides:{root:{borderRadius:12,padding:"10px 20px",fontWeight:600,textTransform:"none",boxShadow:"none","&:hover":{boxShadow:"0 4px 12px rgba(168, 85, 247, 0.3)"}},contained:{"&:hover":{boxShadow:"0 6px 16px rgba(168, 85, 247, 0.4)"}},outlined:{borderWidth:"2px","&:hover":{borderWidth:"2px"}}}},MuiCard:{styleOverrides:{root:{borderRadius:16,boxShadow:"0 1px 3px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2)",border:"1px solid #334155","&:hover":{boxShadow:"0 8px 25px rgba(0, 0, 0, 0.4), 0 4px 10px rgba(0, 0, 0, 0.3)"}}}},MuiPaper:{styleOverrides:{root:{borderRadius:16,boxShadow:"0 1px 3px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2)"},elevation1:{boxShadow:"0 1px 3px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2)"},elevation2:{boxShadow:"0 4px 12px rgba(0, 0, 0, 0.4), 0 2px 6px rgba(0, 0, 0, 0.3)"}}},MuiTextField:{styleOverrides:{root:{"& .MuiOutlinedInput-root":{borderRadius:12,"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#a855f7"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#a855f7",borderWidth:"2px"}}}}},MuiChip:{styleOverrides:{root:{borderRadius:20,fontWeight:600,fontSize:"0.75rem"},filled:{"&.MuiChip-colorPrimary":{backgroundColor:"#a855f7",color:"#ffffff"},"&.MuiChip-colorSecondary":{backgroundColor:"#f472b6",color:"#ffffff"}}}},MuiAppBar:{styleOverrides:{root:{backgroundColor:"#1e293b",color:"#f8fafc",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.3)",borderBottom:"1px solid #334155"}}},MuiDrawer:{styleOverrides:{paper:{backgroundColor:"#1e293b",borderRight:"1px solid #334155",boxShadow:"2px 0 8px rgba(0, 0, 0, 0.4)"}}},MuiListItem:{styleOverrides:{root:{borderRadius:12,marginBottom:4,"&:hover":{backgroundColor:"#334155"}}}},MuiListItemButton:{styleOverrides:{root:{borderRadius:12,"&:hover":{backgroundColor:"#334155"},"&.Mui-selected":{backgroundColor:"#581c87","&:hover":{backgroundColor:"#581c87"}}}}},MuiDialog:{styleOverrides:{paper:{borderRadius:20,boxShadow:"0 25px 50px rgba(0, 0, 0, 0.5)"}}},MuiMenu:{styleOverrides:{paper:{borderRadius:16,boxShadow:"0 10px 30px rgba(0, 0, 0, 0.4)",border:"1px solid #334155"}}},MuiTooltip:{styleOverrides:{tooltip:{backgroundColor:"#ffffff",color:"#0f172a",borderRadius:12,fontSize:"0.75rem",padding:"8px 12px"}}},MuiBadge:{styleOverrides:{badge:{borderRadius:12,fontSize:"0.75rem",fontWeight:600}}},MuiAvatar:{styleOverrides:{root:{fontWeight:600}}},MuiLinearProgress:{styleOverrides:{root:{borderRadius:6,backgroundColor:"#334155"},bar:{borderRadius:6}}},MuiTable:{styleOverrides:{root:{"& .MuiTableCell-root":{borderBottom:"1px solid #334155"}}}},MuiTableHead:{styleOverrides:{root:{"& .MuiTableCell-root":{fontWeight:600,backgroundColor:"#334155"}}}}}}),Ps=Rt.createContext(void 0),Ms=()=>{const e=Rt.useContext(Ps);if(void 0===e)throw new Error("useTheme must be used within a ThemeProvider");return e},As=({children:e})=>{const[t,n]=Rt.useState(()=>{const e=localStorage.getItem("darkMode");return!!e&&JSON.parse(e)});Rt.useEffect(()=>{localStorage.setItem("darkMode",JSON.stringify(t))},[t]);const i=t?js:_s;return v.jsx(Ps.Provider,{value:{isDarkMode:t,toggleTheme:()=>{n(!t)}},children:v.jsx(b,{theme:i,children:e})})};var Rs={};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Os=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&i+1<e.length&&56320==(64512&e.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},Ns={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<e.length;r+=3){const t=e[r],s=r+1<e.length,o=s?e[r+1]:0,a=r+2<e.length,l=a?e[r+2]:0,c=t>>2,u=(3&t)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),i.push(n[c],n[u],n[h],n[d])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Os(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=e[n++];t[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(s>>10)),t[i++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<e.length;){const t=n[e.charAt(r++)],s=r<e.length?n[e.charAt(r)]:0;++r;const o=r<e.length?n[e.charAt(r)]:64;++r;const a=r<e.length?n[e.charAt(r)]:64;if(++r,null==t||null==s||null==o||null==a)throw new Ls;const l=t<<2|s>>4;if(i.push(l),64!==o){const e=s<<4&240|o>>2;if(i.push(e),64!==a){const e=o<<6&192|a;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Ls extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Vs=function(e){return function(e){const t=Os(e);return Ns.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Fs=function(e){try{return Ns.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},Us=()=>
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */().__FIREBASE_DEFAULTS__,zs=()=>{try{return Us()||(()=>{if("undefined"==typeof process)return;const e=Rs.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&Fs(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},Ws=e=>{var t,n;return null===(n=null===(t=zs())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},Bs=e=>{const t=Ws(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),i]:[t.substring(0,n),i]},qs=()=>{var e;return null===(e=zs())||void 0===e?void 0:e.config},Hs=e=>{var t;return null===(t=zs())||void 0===t?void 0:t[`_${e}`]};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class $s{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Xs(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Vs(JSON.stringify({alg:"none",type:"JWT"})),Vs(JSON.stringify(s)),""].join(".")}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ks(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Gs(){return!function(){var e;const t=null===(e=zs())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(n){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}class Ys extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Ys.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qs.prototype.create)}}class Qs{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,r=this.errors[e],s=r?function(e,t){return e.replace(Js,(e,n)=>{const i=t[n];return null!=i?String(i):`<${n}?>`})}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new Ys(i,o,n)}}const Js=/\{\$([^}]+)}/g;function Zs(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const n=e[r],s=t[r];if(eo(n)&&eo(s)){if(!Zs(n,s))return!1}else if(n!==s)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function eo(e){return null!==e&&"object"==typeof e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function to(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}class no{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=io),void 0===i.error&&(i.error=io),void 0===i.complete&&(i.complete=io);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}}),this.observers.push(i),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!=typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function io(){}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ro(e){return e&&e._delegate?e._delegate:e}class so{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const oo="[DEFAULT]";
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ao{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new $s;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),i=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(i)return null;throw r}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e))try{this.getOrInitializeService({instanceIdentifier:oo})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:i});n.resolve(e)}catch(t){}}}}clearInstance(e=oo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return p(this,null,function*(){const e=Array.from(this.instances.values());yield Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])})}isComponentSet(){return null!=this.component}isInitialized(e=oo){return this.instances.has(e)}getOptions(e=oo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[r,s]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(r)&&s.resolve(i);return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(i){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===oo?void 0:i),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(r){}var i;return n||null}normalizeInstanceIdentifier(e=oo){return this.component?this.component.multipleInstances?e:oo:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class lo{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ao(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var co,uo;(uo=co||(co={}))[uo.DEBUG=0]="DEBUG",uo[uo.VERBOSE=1]="VERBOSE",uo[uo.INFO=2]="INFO",uo[uo.WARN=3]="WARN",uo[uo.ERROR=4]="ERROR",uo[uo.SILENT=5]="SILENT";const ho={debug:co.DEBUG,verbose:co.VERBOSE,info:co.INFO,warn:co.WARN,error:co.ERROR,silent:co.SILENT},fo=co.INFO,po={[co.DEBUG]:"log",[co.VERBOSE]:"log",[co.INFO]:"info",[co.WARN]:"warn",[co.ERROR]:"error"},mo=(e,t,...n)=>{if(t<e.logLevel)return;const i=(new Date).toISOString(),r=po[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[r](`[${i}]  ${e.name}:`,...n)};class go{constructor(e){this.name=e,this._logLevel=fo,this._logHandler=mo,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in co))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?ho[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,co.DEBUG,...e),this._logHandler(this,co.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,co.VERBOSE,...e),this._logHandler(this,co.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,co.INFO,...e),this._logHandler(this,co.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,co.WARN,...e),this._logHandler(this,co.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,co.ERROR,...e),this._logHandler(this,co.ERROR,...e)}}let vo,yo;const bo=new WeakMap,xo=new WeakMap,wo=new WeakMap,So=new WeakMap,Co=new WeakMap;let To={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return xo.get(e);if("objectStoreNames"===t)return e.objectStoreNames||wo.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Do(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Eo(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(yo||(yo=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Io(this),t),Do(bo.get(this))}:function(...t){return Do(e.apply(Io(this),t))}:function(t,...n){const i=e.call(Io(this),t,...n);return wo.set(i,t.sort?t.sort():[t]),Do(i)}}function ko(e){return"function"==typeof e?Eo(e):(e instanceof IDBTransaction&&function(e){if(xo.has(e))return;const t=new Promise((t,n)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",s),e.removeEventListener("abort",s)},r=()=>{t(),i()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",s),e.addEventListener("abort",s)});xo.set(e,t)}(e),t=e,(vo||(vo=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,To):e);var t}function Do(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",s)},r=()=>{t(Do(e.result)),i()},s=()=>{n(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&bo.set(t,e)}).catch(()=>{}),Co.set(t,e),t}(e);if(So.has(e))return So.get(e);const t=ko(e);return t!==e&&(So.set(e,t),Co.set(t,e)),t}const Io=e=>Co.get(e),_o=["get","getKey","getAll","getAllKeys","count"],jo=["put","add","delete","clear"],Po=new Map;function Mo(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Po.get(t))return Po.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=jo.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!_o.includes(n))return;const s=function(e,...t){return p(this,null,function*(){const s=this.transaction(e,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(t.shift())),(yield Promise.all([o[n](...t),r&&s.done]))[0]})};return Po.set(t,s),s}var Ao;To=h(u({},Ao=To),{get:(e,t,n)=>Mo(e,t)||Ao.get(e,t,n),has:(e,t)=>!!Mo(e,t)||Ao.has(e,t)});
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Ro{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const Oo="@firebase/app",No="0.10.13",Lo=new go("@firebase/app"),Vo="@firebase/app-compat",Fo="@firebase/analytics-compat",Uo="@firebase/analytics",zo="@firebase/app-check-compat",Wo="@firebase/app-check",Bo="@firebase/auth",qo="@firebase/auth-compat",Ho="@firebase/database",$o="@firebase/data-connect",Xo="@firebase/database-compat",Ko="@firebase/functions",Go="@firebase/functions-compat",Yo="@firebase/installations",Qo="@firebase/installations-compat",Jo="@firebase/messaging",Zo="@firebase/messaging-compat",ea="@firebase/performance",ta="@firebase/performance-compat",na="@firebase/remote-config",ia="@firebase/remote-config-compat",ra="@firebase/storage",sa="@firebase/storage-compat",oa="@firebase/firestore",aa="@firebase/vertexai-preview",la="@firebase/firestore-compat",ca="firebase",ua="[DEFAULT]",ha={[Oo]:"fire-core",[Vo]:"fire-core-compat",[Uo]:"fire-analytics",[Fo]:"fire-analytics-compat",[Wo]:"fire-app-check",[zo]:"fire-app-check-compat",[Bo]:"fire-auth",[qo]:"fire-auth-compat",[Ho]:"fire-rtdb",[$o]:"fire-data-connect",[Xo]:"fire-rtdb-compat",[Ko]:"fire-fn",[Go]:"fire-fn-compat",[Yo]:"fire-iid",[Qo]:"fire-iid-compat",[Jo]:"fire-fcm",[Zo]:"fire-fcm-compat",[ea]:"fire-perf",[ta]:"fire-perf-compat",[na]:"fire-rc",[ia]:"fire-rc-compat",[ra]:"fire-gcs",[sa]:"fire-gcs-compat",[oa]:"fire-fst",[la]:"fire-fst-compat",[aa]:"fire-vertex","fire-js":"fire-js",[ca]:"fire-js-all"},da=new Map,fa=new Map,pa=new Map;function ma(e,t){try{e.container.addComponent(t)}catch(n){Lo.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function ga(e){const t=e.name;if(pa.has(t))return Lo.debug(`There were multiple attempts to register component ${t}.`),!1;pa.set(t,e);for(const n of da.values())ma(n,e);for(const n of fa.values())ma(n,e);return!0}function va(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function ya(e){return void 0!==e.settings}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const ba=new Qs("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class xa{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new so("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ba.create("app-deleted",{appName:this._name})}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const wa="10.14.1";function Sa(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const i=Object.assign({name:ua,automaticDataCollectionEnabled:!1},t),r=i.name;if("string"!=typeof r||!r)throw ba.create("bad-app-name",{appName:String(r)});if(n||(n=qs()),!n)throw ba.create("no-options");const s=da.get(r);if(s){if(Zs(n,s.options)&&Zs(i,s.config))return s;throw ba.create("duplicate-app",{appName:r})}const o=new lo(r);for(const l of pa.values())o.addComponent(l);const a=new xa(n,i,o);return da.set(r,a),a}function Ca(e=ua){const t=da.get(e);if(!t&&e===ua&&qs())return Sa();if(!t)throw ba.create("no-app",{appName:e});return t}function Ta(e,t,n){var i;let r=null!==(i=ha[e])&&void 0!==i?i:e;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${r}" with version "${t}":`];return s&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Lo.warn(e.join(" "))}ga(new so(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Ea="firebase-heartbeat-store";let ka=null;function Da(){return ka||(ka=function(e,t,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(e,t),a=Do(o);return i&&o.addEventListener("upgradeneeded",e=>{i(Do(o.result),e.oldVersion,e.newVersion,Do(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),r&&e.addEventListener("versionchange",e=>r(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Ea)}catch(n){console.warn(n)}}}).catch(e=>{throw ba.create("idb-open",{originalErrorMessage:e.message})})),ka}function Ia(e,t){return p(this,null,function*(){try{const n=(yield Da()).transaction(Ea,"readwrite"),i=n.objectStore(Ea);yield i.put(t,_a(e)),yield n.done}catch(n){if(n instanceof Ys)Lo.warn(n.message);else{const e=ba.create("idb-set",{originalErrorMessage:null==n?void 0:n.message});Lo.warn(e.message)}}})}function _a(e){return`${e.name}!${e.options.appId}`}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ja{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Ma(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}triggerHeartbeat(){return p(this,null,function*(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Pa();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(e=>e.date===i))return;return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache)}catch(n){Lo.warn(n)}})}getHeartbeatsHeader(){return p(this,null,function*(){var e;try{if(null===this._heartbeatsCache&&(yield this._heartbeatsCachePromise),null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Pa(),{heartbeatsToSend:n,unsentEntries:i}=function(e,t=1024){const n=[];let i=e.slice();for(const r of e){const e=n.find(e=>e.agent===r.agent);if(e){if(e.dates.push(r.date),Aa(n)>t){e.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Aa(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=Vs(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return Lo.warn(t),""}})}}function Pa(){return(new Date).toISOString().substring(0,10)}class Ma{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return p(this,null,function*(){return!!function(){try{return"object"==typeof indexedDB}catch(e){return!1}}()&&new Promise((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)})}read(){return p(this,null,function*(){if(yield this._canUseIndexedDBPromise){const e=yield function(e){return p(this,null,function*(){try{const t=(yield Da()).transaction(Ea),n=yield t.objectStore(Ea).get(_a(e));return yield t.done,n}catch(t){if(t instanceof Ys)Lo.warn(t.message);else{const e=ba.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});Lo.warn(e.message)}}})}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}})}overwrite(e){return p(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){const n=yield this.read();return Ia(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})}add(e){return p(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){const n=yield this.read();return Ia(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}})}}function Aa(e){return Vs(JSON.stringify({version:2,heartbeats:e})).length}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ra;function Oa(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function Na(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}Ra="",ga(new so("platform-logger",e=>new Ro(e),"PRIVATE")),ga(new so("heartbeat",e=>new ja(e),"PRIVATE")),Ta(Oo,No,Ra),Ta(Oo,No,"esm2017"),Ta("fire-js",""),
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
Ta("firebase","10.14.1","app"),"function"==typeof SuppressedError&&SuppressedError;const La=Na,Va=new Qs("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Fa=new go("@firebase/auth");function Ua(e,...t){Fa.logLevel<=co.ERROR&&Fa.error(`Auth (${wa}): ${e}`,...t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function za(e,...t){throw Ha(e,...t)}function Wa(e,...t){return Ha(e,...t)}function Ba(e,t,n){const i=Object.assign(Object.assign({},La()),{[t]:n});return new Qs("auth","Firebase",i).create(t,{appName:e.name})}function qa(e){return Ba(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ha(e,...t){if("string"!=typeof e){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return Va.create(e,...t)}function $a(e,t,...n){if(!e)throw Ha(t,...n)}function Xa(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Ua(t),new Error(t)}function Ka(e,t){e||Xa(t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ga(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Ya(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Qa(){return"undefined"==typeof navigator||!navigator||!("onLine"in navigator)||"boolean"!=typeof navigator.onLine||"http:"!==Ya()&&"https:"!==Ya()&&!function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()&&!("connection"in navigator)||navigator.onLine}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Ja{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ka(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ks())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return Qa()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Za(e,t){Ka(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class el{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void Xa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void Xa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void Xa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const tl={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},nl=new Ja(3e4,6e4);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function il(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function rl(e,t,n,i){return p(this,arguments,function*(e,t,n,i,r={}){return sl(e,r,()=>p(this,null,function*(){let r={},s={};i&&("GET"===t?s=i:r={body:JSON.stringify(i)});const o=to(Object.assign({key:e.config.apiKey},s)).slice(1),a=yield e._getAdditionalHeaders();a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:a},r);return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),el.fetch()(ol(e,e.config.apiHost,n,o),l)}))})}function sl(e,t,n){return p(this,null,function*(){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},tl),t);try{const t=new al(e),r=yield Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=yield r.json();if("needConfirmation"in s)throw ll(e,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const t=r.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw ll(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw ll(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw ll(e,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw Ba(e,a,o);za(e,a)}}catch(r){if(r instanceof Ys)throw r;za(e,"network-request-failed",{message:String(r)})}})}function ol(e,t,n,i){const r=`${t}${n}?${i}`;return e.config.emulator?Za(e.config,r):`${e.config.apiScheme}://${r}`}class al{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(Wa(this.auth,"network-request-failed")),nl.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ll(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Wa(e,t,i);return r.customData._tokenResponse=n,r}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function cl(e,t){return p(this,null,function*(){return rl(e,"POST","/v1/accounts:lookup",t)})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ul(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function hl(e){return 1e3*Number(e)}function dl(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return Ua("JWT malformed, contained fewer than 3 sections"),null;try{const e=Fs(n);return e?JSON.parse(e):(Ua("Failed to decode base64 JWT payload"),null)}catch(r){return Ua("Caught error parsing JWT payload as JSON",null==r?void 0:r.toString()),null}}function fl(e){const t=dl(e);return $a(t,"internal-error"),$a(void 0!==t.exp,"internal-error"),$a(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function pl(e,t,n=!1){return p(this,null,function*(){if(n)return t;try{return yield t}catch(i){throw i instanceof Ys&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(i)&&e.auth.currentUser===e&&(yield e.auth.signOut()),i}})}class ml{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(()=>p(this,null,function*(){yield this.iteration()}),t)}iteration(){return p(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class gl{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ul(this.lastLoginAt),this.creationTime=ul(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function vl(e){return p(this,null,function*(){var t;const n=e.auth,i=yield e.getIdToken(),r=yield pl(e,cl(n,{idToken:i}));$a(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?yl(s.providerUserInfo):[],a=(l=e.providerData,c=o,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const u=e.isAnonymous,h=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!u&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new gl(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)})}function yl(e){return e.map(e=>{var{providerId:t}=e,n=Oa(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class bl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){$a(e.idToken,"internal-error"),$a(void 0!==e.idToken,"internal-error"),$a(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):fl(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){$a(0!==e.length,"internal-error");const t=fl(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return p(this,null,function*(){return t||!this.accessToken||this.isExpired?($a(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return p(this,null,function*(){const{accessToken:n,refreshToken:i,expiresIn:r}=yield function(e,t){return p(this,null,function*(){const n=yield sl(e,{},()=>p(this,null,function*(){const n=to({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:r}=e.config,s=ol(e,i,"/v1/token",`key=${r}`),o=yield e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",el.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}})}(e,t);this.updateTokensAndExpiration(n,i,Number(r))})}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,s=new bl;return n&&($a("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&($a("string"==typeof i,"internal-error",{appName:e}),s.accessToken=i),r&&($a("number"==typeof r,"internal-error",{appName:e}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new bl,this.toJSON())}_performRefresh(){return Xa("not implemented")}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function xl(e,t){$a("string"==typeof e||void 0===e,"internal-error",{appName:t})}class wl{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,r=Oa(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ml(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new gl(r.createdAt||void 0,r.lastLoginAt||void 0)}getIdToken(e){return p(this,null,function*(){const t=yield pl(this,this.stsTokenManager.getToken(this.auth,e));return $a(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return function(e,t=!1){return p(this,null,function*(){const n=ro(e),i=yield n.getIdToken(t),r=dl(i);$a(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"==typeof r.firebase?r.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:ul(hl(r.auth_time)),issuedAtTime:ul(hl(r.iat)),expirationTime:ul(hl(r.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}})}(this,e)}reload(){return function(e){return p(this,null,function*(){const t=ro(e);yield vl(t),yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)})}(this)}_assign(e){this!==e&&($a(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new wl(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){$a(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return p(this,null,function*(){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&(yield vl(this)),yield this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)})}delete(){return p(this,null,function*(){if(ya(this.auth.app))return Promise.reject(qa(this.auth));const e=yield this.getIdToken();return yield pl(this,function(e,t){return p(this,null,function*(){return rl(e,"POST","/v1/accounts:delete",t)})}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,s,o,a,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(i=t.email)&&void 0!==i?i:void 0,d=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:b,isAnonymous:x,providerData:w,stsTokenManager:S}=t;$a(y&&S,e,"internal-error");const C=bl.fromJSON(this.name,S);$a("string"==typeof y,e,"internal-error"),xl(u,e.name),xl(h,e.name),$a("boolean"==typeof b,e,"internal-error"),$a("boolean"==typeof x,e,"internal-error"),xl(d,e.name),xl(f,e.name),xl(p,e.name),xl(m,e.name),xl(g,e.name),xl(v,e.name);const T=new wl({uid:y,auth:e,email:h,emailVerified:b,displayName:u,isAnonymous:x,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:C,createdAt:g,lastLoginAt:v});return w&&Array.isArray(w)&&(T.providerData=w.map(e=>Object.assign({},e))),m&&(T._redirectEventId=m),T}static _fromIdTokenResponse(e,t,n=!1){return p(this,null,function*(){const i=new bl;i.updateFromServerResponse(t);const r=new wl({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return yield vl(r),r})}static _fromGetAccountInfoResponse(e,t,n){return p(this,null,function*(){const i=t.users[0];$a(void 0!==i.localId,"internal-error");const r=void 0!==i.providerUserInfo?yl(i.providerUserInfo):[],s=!(i.email&&i.passwordHash||(null==r?void 0:r.length)),o=new bl;o.updateFromIdToken(n);const a=new wl({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:s}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new gl(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash||(null==r?void 0:r.length))};return Object.assign(a,l),a})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Sl=new Map;function Cl(e){Ka(e instanceof Function,"Expected a class definition");let t=Sl.get(e);return t?(Ka(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Sl.set(e,t),t)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Tl{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return p(this,null,function*(){return!0})}_set(e,t){return p(this,null,function*(){this.storage[e]=t})}_get(e){return p(this,null,function*(){const t=this.storage[e];return void 0===t?null:t})}_remove(e){return p(this,null,function*(){delete this.storage[e]})}_addListener(e,t){}_removeListener(e,t){}}Tl.type="NONE";const El=Tl;
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function kl(e,t,n){return`firebase:${e}:${t}:${n}`}class Dl{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=kl(this.userKey,i.apiKey,r),this.fullPersistenceKey=kl("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return p(this,null,function*(){const e=yield this.persistence._get(this.fullUserKey);return e?wl._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return p(this,null,function*(){if(this.persistence===e)return;const t=yield this.getCurrentUser();return yield this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,n="authUser"){return p(this,null,function*(){if(!t.length)return new Dl(Cl(El),e,n);const i=(yield Promise.all(t.map(e=>p(this,null,function*(){if(yield e._isAvailable())return e})))).filter(e=>e);let r=i[0]||Cl(El);const s=kl(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=yield n._get(s);if(t){const i=wl._fromJSON(e,t);n!==r&&(o=i),r=n;break}}catch(l){}const a=i.filter(e=>e._shouldAllowMigration);return r._shouldAllowMigration&&a.length?(r=a[0],o&&(yield r._set(s,o.toJSON())),yield Promise.all(t.map(e=>p(this,null,function*(){if(e!==r)try{yield e._remove(s)}catch(l){}}))),new Dl(r,e,n)):new Dl(r,e,n)})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Il(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Ml(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(_l(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Rl(t))return"Blackberry";if(Ol(t))return"Webos";if(jl(t))return"Safari";if((t.includes("chrome/")||Pl(t))&&!t.includes("edge/"))return"Chrome";if(Al(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function _l(e=Ks()){return/firefox\//i.test(e)}function jl(e=Ks()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Pl(e=Ks()){return/crios\//i.test(e)}function Ml(e=Ks()){return/iemobile/i.test(e)}function Al(e=Ks()){return/android/i.test(e)}function Rl(e=Ks()){return/blackberry/i.test(e)}function Ol(e=Ks()){return/webos/i.test(e)}function Nl(e=Ks()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Ll(){return function(){const e=Ks();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Vl(e=Ks()){return Nl(e)||Al(e)||Ol(e)||Rl(e)||/windows phone/i.test(e)||Ml(e)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Fl(e,t=[]){let n;switch(e){case"Browser":n=Il(Ks());break;case"Worker":n=`${Il(Ks())}-${e}`;break;default:n=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${wa}/${i}`}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ul{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,i)=>{try{n(e(t))}catch(r){i(r)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return p(this,null,function*(){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)yield n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(i){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==n?void 0:n.message})}})}}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class zl{constructor(e){var t,n,i,r;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(r=e.forceUpgradeOnSignin)&&void 0!==r&&r,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,i,r,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(i=a.containsLowercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(r=a.containsUppercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Wl{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ql(this),this.idTokenSubscription=new ql(this),this.beforeStateQueue=new Ul(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Va,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Cl(t)),this._initializationPromise=this.queue(()=>p(this,null,function*(){var n,i;if(!this._deleted&&(this.persistenceManager=yield Dl.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch(r){}yield this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return p(this,null,function*(){if(this._deleted)return;const e=yield this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void(yield this.currentUser.getIdToken())):void(yield this._updateCurrentUser(e,!0)):void 0})}initializeCurrentUserFromIdToken(e){return p(this,null,function*(){try{const t=yield cl(this,{idToken:e}),n=yield wl._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return p(this,null,function*(){var t;if(ya(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const n=yield this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==i?void 0:i._redirectEventId,o=yield this.tryRedirectSignIn(e);n&&n!==s||!(null==o?void 0:o.user)||(i=o.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{yield this.beforeStateQueue.runMiddleware(i)}catch(s){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return $a(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return p(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return p(this,null,function*(){try{yield vl(e)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}_delete(){return p(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return p(this,null,function*(){if(ya(this.app))return Promise.reject(qa(this));const t=e?ro(e):null;return t&&$a(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return p(this,null,function*(){if(!this._deleted)return e&&$a(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>p(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return p(this,null,function*(){return ya(this.app)?Promise.reject(qa(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return ya(this.app)?Promise.reject(qa(this)):this.queue(()=>p(this,null,function*(){yield this.assertedPersistence.setPersistence(Cl(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return p(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return p(this,null,function*(){const e=yield function(e){return p(this,arguments,function*(e,t={}){return rl(e,"GET","/v2/passwordPolicy",il(e,t))})}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(this),t=new zl(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Qs("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}revokeAccessToken(e){return p(this,null,function*(){if(this.currentUser){const t=yield this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};null!=this.tenantId&&(n.tenantId=this.tenantId),yield function(e,t){return p(this,null,function*(){return rl(e,"POST","/v2/accounts:revokeToken",il(e,t))})}(this,n)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}_setRedirectUser(e,t){return p(this,null,function*(){const n=yield this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return p(this,null,function*(){if(!this.redirectPersistenceManager){const t=e&&Cl(e)||this._popupRedirectResolver;$a(t,this,"argument-error"),this.redirectPersistenceManager=yield Dl.create(this,[Cl(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return p(this,null,function*(){var t,n;return this._isInitialized&&(yield this.queue(()=>p(this,null,function*(){}))),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return p(this,null,function*(){if(e===this.currentUser)return this.queue(()=>p(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"==typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if($a(o,this,"internal-error"),o.then(()=>{s||r(this.currentUser)}),"function"==typeof t){const r=e.addObserver(t,n,i);return()=>{s=!0,r()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}directlySetCurrentUser(e){return p(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return $a(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Fl(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return p(this,null,function*(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=yield null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader();n&&(t["X-Firebase-Client"]=n);const i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return p(this,null,function*(){var e;const t=yield null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken();return(null==t?void 0:t.error)&&function(e,...t){Fa.logLevel<=co.WARN&&Fa.warn(`Auth (${wa}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token})}}function Bl(e){return ro(e)}class ql{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new no(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return $a(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */let Hl={loadJS(){return p(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $l(e,t,n){const i=Bl(e);$a(i._canInitEmulator,i,"emulator-config-failed"),$a(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=Xl(t),{host:s,port:o}=function(e){const t=Xl(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:Kl(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:Kl(t)}}}(t),a=null===o?"":`:${o}`;i.config.emulator={url:`${r}//${s}${a}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:s,port:o,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:!1})}),function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */()}function Xl(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Kl(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Gl{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Xa("not implemented")}_getIdTokenResponse(e){return Xa("not implemented")}_linkToIdToken(e,t){return Xa("not implemented")}_getReauthenticationResolver(e){return Xa("not implemented")}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Yl(e,t){return p(this,null,function*(){return function(e,t,n,i){return p(this,arguments,function*(e,t,n,i,r={}){const s=yield rl(e,t,n,i,r);return"mfaPendingCredential"in s&&za(e,"multi-factor-auth-required",{_serverResponse:s}),s})}(e,"POST","/v1/accounts:signInWithIdp",il(e,t))})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ql extends Gl{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ql(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):za("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,r=Oa(t,["providerId","signInMethod"]);if(!n||!i)return null;const s=new Ql(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(e){return Yl(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Yl(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Yl(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=to(t)}return e}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Jl{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Zl extends Jl{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ec extends Zl{constructor(){super("facebook.com")}static credential(e){return Ql._fromParams({providerId:ec.PROVIDER_ID,signInMethod:ec.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ec.credentialFromTaggedObject(e)}static credentialFromError(e){return ec.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return ec.credential(e.oauthAccessToken)}catch(t){return null}}}ec.FACEBOOK_SIGN_IN_METHOD="facebook.com",ec.PROVIDER_ID="facebook.com";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class tc extends Zl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ql._fromParams({providerId:tc.PROVIDER_ID,signInMethod:tc.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return tc.credentialFromTaggedObject(e)}static credentialFromError(e){return tc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return tc.credential(t,n)}catch(i){return null}}}tc.GOOGLE_SIGN_IN_METHOD="google.com",tc.PROVIDER_ID="google.com";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class nc extends Zl{constructor(){super("github.com")}static credential(e){return Ql._fromParams({providerId:nc.PROVIDER_ID,signInMethod:nc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return nc.credentialFromTaggedObject(e)}static credentialFromError(e){return nc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return nc.credential(e.oauthAccessToken)}catch(t){return null}}}nc.GITHUB_SIGN_IN_METHOD="github.com",nc.PROVIDER_ID="github.com";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class ic extends Zl{constructor(){super("twitter.com")}static credential(e,t){return Ql._fromParams({providerId:ic.PROVIDER_ID,signInMethod:ic.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ic.credentialFromTaggedObject(e)}static credentialFromError(e){return ic.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return ic.credential(t,n)}catch(i){return null}}}ic.TWITTER_SIGN_IN_METHOD="twitter.com",ic.PROVIDER_ID="twitter.com";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class rc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,n,i=!1){return p(this,null,function*(){const r=yield wl._fromIdTokenResponse(e,n,i),s=sc(n);return new rc({user:r,providerId:s,_tokenResponse:n,operationType:t})})}static _forOperation(e,t,n){return p(this,null,function*(){yield e._updateTokensIfNecessary(n,!0);const i=sc(n);return new rc({user:e,providerId:i,_tokenResponse:n,operationType:t})})}}function sc(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class oc extends Ys{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,oc.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new oc(e,t,n,i)}}function ac(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw oc._fromErrorAndOperation(e,n,t,i);throw n})}const lc="__sak";
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class cc{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(lc,"1"),this.storage.removeItem(lc),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class uc extends cc{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Vl(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);Ll()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(e,t){return p(this,null,function*(){yield f(uc.prototype,this,"_set").call(this,e,t),this.localCache[e]=JSON.stringify(t)})}_get(e){return p(this,null,function*(){const t=yield f(uc.prototype,this,"_get").call(this,e);return this.localCache[e]=JSON.stringify(t),t})}_remove(e){return p(this,null,function*(){yield f(uc.prototype,this,"_remove").call(this,e),delete this.localCache[e]})}}uc.type="LOCAL";const hc=uc;
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class dc extends cc{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}dc.type="SESSION";const fc=dc;
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class pc{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new pc(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}handleEvent(e){return p(this,null,function*(){const t=e,{eventId:n,eventType:i,data:r}=t.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map(e=>p(this,null,function*(){return e(t.origin,r)})),a=yield function(e){return Promise.all(e.map(e=>p(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function mc(e="",t=10){let n="";for(let i=0;i<t;i++)n+=Math.floor(10*Math.random());return e+n}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */pc.receivers=[];class gc{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,n=50){return p(this,null,function*(){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise((o,a)=>{const l=mc("",20);i.port1.start();const c=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),r=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),o(t.data.response);break;default:clearTimeout(c),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function vc(){return window}
/**
     * @license
     * Copyright 2020 Google LLC.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function yc(){return void 0!==vc().WorkerGlobalScope&&"function"==typeof vc().importScripts}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const bc="firebaseLocalStorageDb",xc="firebaseLocalStorage",wc="fbase_key";class Sc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Cc(e,t){return e.transaction([xc],t?"readwrite":"readonly").objectStore(xc)}function Tc(){const e=indexedDB.open(bc,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(xc,{keyPath:wc})}catch(i){n(i)}}),e.addEventListener("success",()=>p(this,null,function*(){const n=e.result;n.objectStoreNames.contains(xc)?t(n):(n.close(),yield function(){const e=indexedDB.deleteDatabase(bc);return new Sc(e).toPromise()}(),t(yield Tc()))}))})}function Ec(e,t,n){return p(this,null,function*(){const i=Cc(e,!0).put({[wc]:t,value:n});return new Sc(i).toPromise()})}function kc(e,t){const n=Cc(e,!0).delete(t);return new Sc(n).toPromise()}class Dc{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return p(this,null,function*(){return this.db||(this.db=yield Tc()),this.db})}_withRetries(e){return p(this,null,function*(){let t=0;for(;;)try{const t=yield this._openDb();return yield e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return p(this,null,function*(){return yc()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return p(this,null,function*(){this.receiver=pc._getInstance(yc()?self:null),this.receiver._subscribe("keyChanged",(e,t)=>p(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(t.key)}})),this.receiver._subscribe("ping",(e,t)=>p(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return p(this,null,function*(){var e,t;if(this.activeServiceWorker=yield function(){return p(this,null,function*(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch(e){return null}})}(),!this.activeServiceWorker)return;this.sender=new gc(this.activeServiceWorker);const n=yield this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(e){return p(this,null,function*(){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{yield this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}})}_isAvailable(){return p(this,null,function*(){try{if(!indexedDB)return!1;const e=yield Tc();return yield Ec(e,lc,"1"),yield kc(e,lc),!0}catch(e){}return!1})}_withPendingWrite(e){return p(this,null,function*(){this.pendingWrites++;try{yield e()}finally{this.pendingWrites--}})}_set(e,t){return p(this,null,function*(){return this._withPendingWrite(()=>p(this,null,function*(){return yield this._withRetries(n=>Ec(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)}))})}_get(e){return p(this,null,function*(){const t=yield this._withRetries(t=>function(e,t){return p(this,null,function*(){const n=Cc(e,!1).get(t),i=yield new Sc(n).toPromise();return void 0===i?null:i.value})}(t,e));return this.localCache[e]=t,t})}_remove(e){return p(this,null,function*(){return this._withPendingWrite(()=>p(this,null,function*(){return yield this._withRetries(t=>kc(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)}))})}_poll(){return p(this,null,function*(){const e=yield this._withRetries(e=>{const t=Cc(e,!1).getAll();return new Sc(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t})}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>p(this,null,function*(){return this._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Dc.type="LOCAL";const Ic=Dc;new Ja(3e4,6e4);
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class _c extends Gl{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Yl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Yl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Yl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function jc(e){
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
return function(e,t,n=!1){return p(this,null,function*(){if(ya(e.app))return Promise.reject(qa(e));const i="signIn",r=yield ac(e,i,t),s=yield rc._fromIdTokenResponse(e,i,r);return n||(yield e._updateCurrentUser(s.user)),s})}(e.auth,new _c(e),e.bypassAuthState)}function Pc(e){const{auth:t,user:n}=e;return $a(n,t,"internal-error"),
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e,t,n=!1){return p(this,null,function*(){const{auth:i}=e;if(ya(i.app))return Promise.reject(qa(i));const r="reauthenticate";try{const s=yield pl(e,ac(i,r,t,e),n);$a(s.idToken,i,"internal-error");const o=dl(s.idToken);$a(o,i,"internal-error");const{sub:a}=o;return $a(e.uid===a,i,"user-mismatch"),rc._forOperation(e,r,s)}catch(s){throw"auth/user-not-found"===(null==s?void 0:s.code)&&za(i,"user-mismatch"),s}})}(n,new _c(e),e.bypassAuthState)}function Mc(e){return p(this,null,function*(){const{auth:t,user:n}=e;return $a(n,t,"internal-error"),function(e,t,n=!1){return p(this,null,function*(){const i=yield pl(e,t._linkToIdToken(e.auth,yield e.getIdToken()),n);return rc._forOperation(e,"link",i)})}(n,new _c(e),e.bypassAuthState)})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ac{constructor(e,t,n,i,r=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>p(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}onAuthEvent(e){return p(this,null,function*(){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(o)(a))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return jc;case"linkViaPopup":case"linkViaRedirect":return Mc;case"reauthViaPopup":case"reauthViaRedirect":return Pc;default:za(this.auth,"internal-error")}}resolve(e){Ka(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ka(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Rc=new Ja(2e3,1e4);class Oc extends Ac{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,Oc.currentPopupAction&&Oc.currentPopupAction.cancel(),Oc.currentPopupAction=this}executeNotNull(){return p(this,null,function*(){const e=yield this.execute();return $a(e,this.auth,"internal-error"),e})}onExecution(){return p(this,null,function*(){Ka(1===this.filter.length,"Popup operations only handle one event");const e=mc();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Wa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Wa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Oc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Wa(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Rc.get())};e()}}Oc.currentPopupAction=null;
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Nc="pendingRedirect",Lc=new Map;class Vc extends Ac{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}execute(){return p(this,null,function*(){let e=Lc.get(this.auth._key());if(!e){try{const t=(yield function(e,t){return p(this,null,function*(){const n=function(e){return kl(Nc,e.config.apiKey,e.name)}(t),i=function(e){return Cl(e._redirectPersistence)}(e);if(!(yield i._isAvailable()))return!1;const r="true"===(yield i._get(n));return yield i._remove(n),r})}(this.resolver,this.auth))?yield f(Vc.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Lc.set(this.auth._key(),e)}return this.bypassAuthState||Lc.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return p(this,null,function*(){if("signInViaRedirect"===e.type)return f(Vc.prototype,this,"onAuthEvent").call(this,e);if("unknown"!==e.type){if(e.eventId){const t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,f(Vc.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}}else this.resolve(null)})}onExecution(){return p(this,null,function*(){})}cleanUp(){}}function Fc(e,t){Lc.set(e._key(),t)}function Uc(e,t,n=!1){return p(this,null,function*(){if(ya(e.app))return Promise.reject(qa(e));const i=Bl(e),r=
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e,t){return t?Cl(t):($a(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(i,t),s=new Vc(i,r,n),o=yield s.execute();return o&&!n&&(delete o.user._redirectEventId,yield i._persistUserIfCurrent(o.user),yield i._setRedirectUser(null,t)),o})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class zc{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Bc(e);default:return!1}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Bc(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Wa(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Wc(e))}saveEventToCache(e){this.cachedEventUids.add(Wc(e)),this.lastProcessedEventTime=Date.now()}}function Wc(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function Bc({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const qc=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Hc=/^https?/;function $c(e){return p(this,null,function*(){if(e.config.emulator)return;const{authorizedDomains:t}=yield function(e){return p(this,arguments,function*(e,t={}){return rl(e,"GET","/v1/projects",t)})}(e);for(const e of t)try{if(Xc(e))return}catch(n){}za(e,"unauthorized-domain")})}function Xc(e){const t=Ga(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!Hc.test(n))return!1;if(qc.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}
/**
     * @license
     * Copyright 2020 Google LLC.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Kc=new Ja(3e4,6e4);function Gc(){const e=vc().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Yc(e){return new Promise((t,n)=>{var i,r,s,o;function a(){Gc(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Gc(),n(Wa(e,"network-request-failed"))},timeout:Kc.get()})}if(null===(r=null===(i=vc().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=vc().gapi)||void 0===s?void 0:s.load)){const t=`__iframefcb${Math.floor(1e6*Math.random())}`;return vc()[t]=()=>{gapi.load?a():n(Wa(e,"network-request-failed"))},(o=`${Hl.gapiScript}?onload=${t}`,Hl.loadJS(o)).catch(e=>n(e))}a()}}).catch(e=>{throw Qc=null,e})}let Qc=null;
/**
     * @license
     * Copyright 2020 Google LLC.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Jc=new Ja(5e3,15e3),Zc={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},eu=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function tu(e){const t=e.config;$a(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Za(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,i={apiKey:t.apiKey,appName:e.name,v:wa},r=eu.get(e.config.apiHost);r&&(i.eid=r);const s=e._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${to(i).slice(1)}`}function nu(e){return p(this,null,function*(){const t=yield function(e){return Qc=Qc||Yc(e),Qc}(e),n=vc().gapi;return $a(n,e,"internal-error"),t.open({where:document.body,url:tu(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Zc,dontclear:!0},t=>new Promise((n,i)=>p(this,null,function*(){yield t.restyle({setHideOnLeave:!1});const r=Wa(e,"network-request-failed"),s=vc().setTimeout(()=>{i(r)},Jc.get());function o(){vc().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{i(r)})})))})}
/**
     * @license
     * Copyright 2020 Google LLC.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const iu={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ru{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function su(e,t,n,i=500,r=600){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l=Object.assign(Object.assign({},iu),{width:i.toString(),height:r.toString(),top:s,left:o}),c=Ks().toLowerCase();n&&(a=Pl(c)?"_blank":n),_l(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(function(e=Ks()){var t;return Nl(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(c)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t||"",a),new ru(null);const h=window.open(t||"",a,u);$a(h,e,"popup-blocked");try{h.focus()}catch(d){}return new ru(h)}const ou="__/auth/handler",au="emulator/auth/handler",lu=encodeURIComponent("fac");function cu(e,t,n,i,r,s){return p(this,null,function*(){$a(e.config.authDomain,e,"auth-domain-config-required"),$a(e.config.apiKey,e,"invalid-api-key");const s={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:wa,eventId:r};if(t instanceof Jl){t.setDefaultLanguage(e.languageCode),s.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries({}))s[e]=t}if(t instanceof Zl){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(s.scopes=e.join(","))}e.tenantId&&(s.tid=e.tenantId);const o=s;for(const e of Object.keys(o))void 0===o[e]&&delete o[e];const a=yield e._getAppCheckToken(),l=a?`#${lu}=${encodeURIComponent(a)}`:"";return`${function({config:e}){return e.emulator?Za(e,au):`https://${e.authDomain}/${ou}`}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e)}?${to(o).slice(1)}${l}`})}const uu="webStorageSupport",hu=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fc,this._completeRedirectFn=Uc,this._overrideRedirectResult=Fc}_openPopup(e,t,n,i){return p(this,null,function*(){var r;Ka(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()");const s=yield cu(e,t,n,Ga(),i);return su(e,s,mc())})}_openRedirect(e,t,n,i){return p(this,null,function*(){return yield this._originValidation(e),function(e){vc().location.href=e}(yield cu(e,t,n,Ga(),i)),new Promise(()=>{})})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Ka(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}initAndGetManager(e){return p(this,null,function*(){const t=yield nu(e),n=new zc(e);return t.register("authEvent",t=>($a(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(uu,{type:uu},n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[uu];void 0!==r&&t(!!r),za(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=$c(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Vl()||jl()||Nl()}};var du="@firebase/auth",fu="1.7.9";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class pu{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}getToken(e){return p(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){$a(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const mu=Hs("authIdTokenMaxAge")||300;let gu=null;var vu;Hl={loadJS:e=>new Promise((t,n)=>{const i=document.createElement("script");var r,s;i.setAttribute("src",e),i.onload=t,i.onerror=e=>{const t=Wa("internal-error");t.customData=e,n(t)},i.type="text/javascript",i.charset="UTF-8",(null!==(s=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==s?s:document).appendChild(i)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},vu="Browser",ga(new so("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;$a(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:vu,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Fl(vu)},l=new Wl(n,i,r,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Cl);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null==t?void 0:t.popupRedirectResolver)}(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),ga(new so("auth-internal",e=>{const t=Bl(e.getProvider("auth").getImmediate());return new pu(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ta(du,fu,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(vu)),Ta(du,fu,"esm2017");var yu,bu,xu="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/** @license
    Copyright The Closure Library Authors.
    SPDX-License-Identifier: Apache-2.0
    */(function(){var e;
/** @license
      
       Copyright The Closure Library Authors.
       SPDX-License-Identifier: Apache-2.0
      */function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var i=Array(16);if("string"==typeof t)for(var r=0;16>r;++r)i[r]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],r=e.g[2];var s=e.g[3],o=t+(s^n&(r^s))+i[0]+3614090360&4294967295;o=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(r^s&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(r^(n|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(r^(n|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(t^(s|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+i[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+r&4294967295,e.g[3]=e.g[3]+s&4294967295}function i(e,t){this.h=t;for(var n=[],i=!0,r=e.length-1;0<=r;r--){var s=0|e[r];i&&s==t||(n[r]=s,i=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return t.prototype[n].apply(e,r)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var i=t-this.blockSize,r=this.B,s=this.h,o=0;o<t;){if(0==s)for(;o<=i;)n(this,e,o),o+=this.blockSize;if("string"==typeof e){for(;o<t;)if(r[s++]=e.charCodeAt(o++),s==this.blockSize){n(this,r),s=0;break}}else for(;o<t;)if(r[s++]=e[o++],s==this.blockSize){n(this,r),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var i=0;32>i;i+=8)e[n++]=this.g[t]>>>i&255;return e};var r={};function s(e){return-128<=e&&128>e?function(e,t){var n=r;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new i([0|e],0>e?-1:0)}):new i([0|e],0>e?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return a;if(0>e)return d(o(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new i(t,0)}var a=s(0),l=s(1),c=s(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function d(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new i(n,~e.h).add(l)}function f(e,t){return e.add(d(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(a,a);if(h(e))return t=g(d(e),t),new m(d(t.g),d(t.h));if(h(t))return t=g(e,d(t)),new m(d(t.g),t.h);if(30<e.g.length){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,i=t;0>=i.l(e);)n=v(n),i=v(i);var r=y(n,1),s=y(i,1);for(i=y(i,2),n=y(n,2);!u(i);){var c=s.add(i);0>=c.l(e)&&(r=r.add(n),s=c),i=y(i,1),n=y(n,1)}return t=f(e,r.j(t)),new m(r,t)}for(r=a;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),c=(s=o(n)).j(t);h(c)||0<c.l(e);)c=(s=o(n-=i)).j(t);u(s)&&(s=l),r=r.add(s),e=f(e,c)}return new m(r,e)}function v(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new i(n,e.h)}function y(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,s=[],o=0;o<r;o++)s[o]=0<t?e.i(o+n)>>>t|e.i(o+n+1)<<32-t:e.i(o+n);return new i(s,e.h)}(e=i.prototype).m=function(){if(h(this))return-d(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var i=this.i(n);e+=(0<=i?i:4294967296+i)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+d(this).toString(e);for(var t=o(Math.pow(e,6)),n=this,i="";;){var r=g(n,t).g,s=((0<(n=f(n,r.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return h(this)?d(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,s=0;s<=t;s++){var o=r+(65535&this.i(s))+(65535&e.i(s)),a=(o>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);r=a>>>16,o&=65535,a&=65535,n[s]=a<<16|o}return new i(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return a;if(h(this))return h(e)?d(this).j(d(e)):d(d(this).j(e));if(h(e))return d(this.j(d(e)));if(0>this.l(c)&&0>e.l(c))return o(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<e.g.length;s++){var l=this.i(r)>>>16,f=65535&this.i(r),m=e.i(s)>>>16,g=65535&e.i(s);n[2*r+2*s]+=f*g,p(n,2*r+2*s),n[2*r+2*s+1]+=l*g,p(n,2*r+2*s+1),n[2*r+2*s+1]+=f*m,p(n,2*r+2*s+1),n[2*r+2*s+2]+=l*m,p(n,2*r+2*s+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new i(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new i(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new i(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new i(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,bu=t,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=o,i.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return d(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=o(Math.pow(n,8)),r=a,s=0;s<t.length;s+=8){var l=Math.min(8,t.length-s),c=parseInt(t.substring(s,s+l),n);8>l?(l=o(Math.pow(n,l)),r=r.j(l).add(o(c))):r=(r=r.j(i)).add(o(c))}return r},yu=i}).apply(void 0!==xu?xu:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var wu,Su,Cu,Tu,Eu,ku,Du,Iu,_u="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/** @license
    Copyright The Closure Library Authors.
    SPDX-License-Identifier: Apache-2.0
    */(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof _u&&_u];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,i){if(i)e:{var r=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var o=e[s];if(!(o in r))break e;r=r[o]}(i=i(s=r[e=e[e.length-1]]))!=s&&null!=i&&t(r,e,{configurable:!0,writable:!0,value:i})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,i=!1,r={next:function(){if(!i&&n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}(this,function(e,t){return t})}});
/** @license
      
       Copyright The Closure Library Authors.
       SPDX-License-Identifier: Apache-2.0
      */
var i=i||{},r=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function h(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return t.prototype[n].apply(e,r)}}function d(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function f(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(s(t)){const n=e.length||0,i=t.length||0;e.length=n+i;for(let r=0;r<i;r++)e[n+r]=t[r]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=r.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var v=!(-1==m().indexOf("Gecko")||-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge")||-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE")||-1!=m().indexOf("Edge"));function y(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function b(e){const t={};for(const n in e)t[n]=e[n];return t}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(e,t){let n,i;for(let r=1;r<arguments.length;r++){for(n in i=arguments[r],i)e[n]=i[n];for(let t=0;t<x.length;t++)n=x[t],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function S(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function C(e){r.setTimeout(()=>{throw e},0)}function T(){var e=_;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var E=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new k,e=>e.reset());class k{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let D,I=!1,_=new class{constructor(){this.h=this.g=null}add(e,t){const n=E.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},j=()=>{const e=r.Promise.resolve(void 0);D=()=>{e.then(P)}};var P=()=>{for(var e;e=T();){try{e.h.call(e.g)}catch(n){C(n)}var t=E;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}I=!1};function M(){this.s=this.s,this.C=this.C}function A(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}M.prototype.s=!1,M.prototype.ma=function(){this.s||(this.s=!0,this.N())},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},A.prototype.h=function(){this.defaultPrevented=!0};var R=function(){if(!r.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};r.addEventListener("test",e,t),r.removeEventListener("test",e,t)}catch(n){}return e}();function O(e,t){if(A.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(v){e:{try{g(t.nodeName);var r=!0;break e}catch(s){}r=!1}r||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:N[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&O.aa.h.call(this)}}h(O,A);var N={2:"touch",3:"pen",4:"mouse"};O.prototype.h=function(){O.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var L="closure_listenable_"+(1e6*Math.random()|0),V=0;function F(e,t,n,i,r){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.ha=r,this.key=++V,this.da=this.fa=!1}function U(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function z(e){this.src=e,this.g={},this.h=0}function W(e,t){var n=t.type;if(n in e.g){var i,r=e.g[n],s=Array.prototype.indexOf.call(r,t,void 0);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(U(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function B(e,t,n,i){for(var r=0;r<e.length;++r){var s=e[r];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==i)return r}return-1}z.prototype.add=function(e,t,n,i,r){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=B(e,t,i,r);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new F(t,this.src,s,!!i,r)).fa=n,e.push(t)),t};var q="closure_lm_"+(1e6*Math.random()|0),H={};function $(e,t,n,i,r){if(Array.isArray(t)){for(var s=0;s<t.length;s++)$(e,t[s],n,i,r);return null}return n=Z(n),e&&e[L]?e.K(t,n,!!o(i)&&!!i.capture,r):function(e,t,n,i,r,s){if(!t)throw Error("Invalid event type");var a=o(r)?!!r.capture:!!r,l=Q(e);if(l||(e[q]=l=new z(e)),(n=l.add(t,n,i,a,s)).proxy)return n;if(i=function(){function e(n){return t.call(e.src,e.listener,n)}const t=Y;return e}(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)R||(r=a),void 0===r&&(r=!1),e.addEventListener(t.toString(),i,r);else if(e.attachEvent)e.attachEvent(G(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(i)}return n}(e,t,n,!1,i,r)}function X(e,t,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)X(e,t[s],n,i,r);else i=o(i)?!!i.capture:!!i,n=Z(n),e&&e[L]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=B(s=e.g[t],n,i,r))&&(U(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--))):e&&(e=Q(e))&&(t=e.g[t.toString()],e=-1,t&&(e=B(t,n,i,r)),(n=-1<e?t[e]:null)&&K(n))}function K(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[L])W(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(G(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=Q(t))?(W(n,e),0==n.h&&(n.src=null,t[q]=null)):U(e)}}}function G(e){return e in H?H[e]:H[e]="on"+e}function Y(e,t){if(e.da)e=!0;else{t=new O(t,this);var n=e.listener,i=e.ha||e.src;e.fa&&K(e),e=n.call(i,t)}return e}function Q(e){return(e=e[q])instanceof z?e:null}var J="__closure_events_fn_"+(1e9*Math.random()>>>0);function Z(e){return"function"==typeof e?e:(e[J]||(e[J]=function(t){return e.handleEvent(t)}),e[J])}function ee(){M.call(this),this.i=new z(this),this.M=this,this.F=null}function te(e,t){var n,i=e.F;if(i)for(n=[];i;i=i.F)n.push(i);if(e=e.M,i=t.type||t,"string"==typeof t)t=new A(t,e);else if(t instanceof A)t.target=t.target||e;else{var r=t;w(t=new A(i,e),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];r=ne(o,i,!0,t)&&r}if(r=ne(o=t.g=e,i,!0,t)&&r,r=ne(o,i,!1,t)&&r,n)for(s=0;s<n.length;s++)r=ne(o=t.g=n[s],i,!1,t)&&r}function ne(e,t,n,i){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var r=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.da&&o.capture==n){var a=o.listener,l=o.ha||o.src;o.fa&&W(e.i,o),r=!1!==a.call(l,i)&&r}}return r&&!i.defaultPrevented}function ie(e,t,n){if("function"==typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:r.setTimeout(e,t||0)}function re(e){e.g=ie(()=>{e.g=null,e.i&&(e.i=!1,re(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}h(ee,M),ee.prototype[L]=!0,ee.prototype.removeEventListener=function(e,t,n,i){X(this,e,t,n,i)},ee.prototype.N=function(){if(ee.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)U(n[i]);delete t.g[e],t.h--}}this.F=null},ee.prototype.K=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)},ee.prototype.L=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};class se extends M{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:re(this)}N(){super.N(),this.g&&(r.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function oe(e){M.call(this),this.h=e,this.g={}}h(oe,M);var ae=[];function le(e){y(e.g,function(e,t){this.g.hasOwnProperty(t)&&K(e)},e),e.g={}}oe.prototype.N=function(){oe.aa.N.call(this),le(this)},oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ce=r.JSON.stringify,ue=r.JSON.parse,he=class{stringify(e){return r.JSON.stringify(e,void 0)}parse(e){return r.JSON.parse(e,void 0)}};function de(){}function fe(e){return e.h||(e.h=e.i())}function pe(){}de.prototype.h=null;var me={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ge(){A.call(this,"d")}function ve(){A.call(this,"c")}h(ge,A),h(ve,A);var ye={},be=null;function xe(){return be=be||new ee}function we(e){A.call(this,ye.La,e)}function Se(e){const t=xe();te(t,new we(t))}function Ce(e,t){A.call(this,ye.STAT_EVENT,e),this.stat=t}function Te(e){const t=xe();te(t,new Ce(t,e))}function Ee(e,t){A.call(this,ye.Ma,e),this.size=t}function ke(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return r.setTimeout(function(){e()},t)}function De(){this.g=!0}function Ie(e,t,n,i){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return ce(n)}catch(a){return t}}(e,n)+(i?" "+i:"")})}ye.La="serverreachability",h(we,A),ye.STAT_EVENT="statevent",h(Ce,A),ye.Ma="timingevent",h(Ee,A),De.prototype.xa=function(){this.g=!1},De.prototype.info=function(){};var _e,je={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Pe={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Me(){}function Ae(e,t,n,i){this.j=e,this.i=t,this.l=n,this.R=i||1,this.U=new oe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Re}function Re(){this.i=null,this.g="",this.h=!1}h(Me,de),Me.prototype.g=function(){return new XMLHttpRequest},Me.prototype.i=function(){return{}},_e=new Me;var Oe={},Ne={};function Le(e,t,n){e.L=1,e.v=ct(rt(t)),e.m=n,e.P=!0,Ve(e,null)}function Ve(e,t){e.F=Date.now(),ze(e),e.A=rt(e.v);var n=e.A,i=e.R;Array.isArray(i)||(i=[String(i)]),St(n.i,"t",i),e.C=0,n=e.j.J,e.h=new Re,e.g=un(e.j,n?t:null,!e.m),0<e.O&&(e.M=new se(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,i=e.ca;var r="readystatechange";Array.isArray(r)||(r&&(ae[0]=r.toString()),r=ae);for(var s=0;s<r.length;s++){var o=$(n,r[s],i||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Se(),function(e,t,n,i,r,s){e.info(function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+c+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+t+"\n"+n+"\n"+o})}(e.i,e.u,e.A,e.l,e.R,e.m)}function Fe(e){return!!e.g&&"GET"==e.u&&2!=e.L&&e.j.Ca}function Ue(e,t){var n=e.C,i=t.indexOf("\n",n);return-1==i?Ne:(n=Number(t.substring(n,i)),isNaN(n)?Oe:(i+=1)+n>t.length?Ne:(t=t.slice(i,i+n),e.C=i+n,t))}function ze(e){e.S=Date.now()+e.I,We(e,e.I)}function We(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=ke(c(e.ba,e),t)}function Be(e){e.B&&(r.clearTimeout(e.B),e.B=null)}function qe(e){0==e.j.G||e.J||sn(e.j,e)}function He(e){Be(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,le(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function $e(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Qe(n.h,e)))if(!e.K&&Qe(n.h,e)&&3==n.G){try{var i=n.Da.g.parse(t)}catch(u){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;rn(n),Xt(n)}en(n),Te(18)}}else n.za=r[1],0<n.za-n.T&&37500>r[2]&&n.F&&0==n.v&&!n.C&&(n.C=ke(c(n.Za,n),6e3));if(1>=Ye(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else an(n,11)}else if((e.K||n.g==e)&&rn(n),!p(t))for(r=n.Da.g.parse(t),t=0;t<r.length;t++){let c=r[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const r=c[4];null!=r&&(n.Aa=r,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"==typeof u&&0<u&&(i=1.5*u,n.L=i,n.j.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=i.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Je(s,s.h),s.h=null))}if(i.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.ya=e,lt(i.I,i.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=e;if((i=n).qa=cn(i,i.J?i.ia:null,i.W),o.K){Ze(i.h,o);var a=o,l=i.L;l&&(a.I=l),a.B&&(Be(a),ze(a)),i.g=o}else Zt(i);0<n.i.length&&Gt(n)}else"stop"!=c[0]&&"close"!=c[0]||an(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?an(n,7):$t(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Se()}catch(u){}}Ae.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==Wt(e)?t.j():this.Y(e)},Ae.prototype.Y=function(e){try{if(e==this.g)e:{const d=Wt(this.g);var t=this.g.Ba();if(this.g.Z(),!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||Bt(this.g)))){this.J||4!=d||7==t||Se(),Be(this);var n=this.g.Z();this.X=n;t:if(Fe(this)){var i=Bt(this.g);e="";var s=i.length,o=4==Wt(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){He(this),qe(this);var a="";break t}this.h.i=new r.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:!(o&&t==s-1)});i.length=0,this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(e,t,n,i,r,s,o){e.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+t+"\n"+n+"\n"+s+" "+o})}(this.i,this.u,this.A,this.l,this.R,d,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Te(12),He(this),qe(this);break e}Ie(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$e(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<a.length;){if(e=Ue(this,a),e==Ne){4==d&&(this.s=4,Te(14),n=!1),Ie(this.i,this.l,null,"[Incomplete Response]");break}if(e==Oe){this.s=4,Te(15),Ie(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}Ie(this.i,this.l,e,null),$e(this,e)}if(Fe(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=a.length||this.h.h||(this.s=1,Te(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),tn(h),h.M=!0,Te(11))}}else Ie(this.i,this.l,a,"[Invalid Chunked Response]"),He(this),qe(this)}else Ie(this.i,this.l,a,null),$e(this,a);4==d&&He(this),this.o&&!this.J&&(4==d?sn(this.j,this):(this.o=!1,ze(this)))}else(function(e){const t={};e=(e.g&&2<=Wt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<e.length;i++){if(p(e[i]))continue;var n=S(e[i]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=t[r]||[];t[r]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,Te(12)):(this.s=0,Te(13)),He(this),qe(this)}}}catch(d){}},Ae.prototype.cancel=function(){this.J=!0,He(this)},Ae.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(Se(),Te(17)),He(this),this.s=2,qe(this)):We(this,this.S-e)};var Xe=class{constructor(e,t){this.g=e,this.map=t}};function Ke(e){this.l=e||10,e=r.PerformanceNavigationTiming?0<(e=r.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(r.chrome&&r.chrome.loadTimes&&r.chrome.loadTimes()&&r.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ge(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Ye(e){return e.h?1:e.g?e.g.size:0}function Qe(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Je(e,t){e.g?e.g.add(t):e.h=t}function Ze(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function et(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return d(e.i)}function tt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(s(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const i in e)t[n++]=i;return t}}}(e),i=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(s(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}for(i in t=[],n=0,e)t[n++]=e[i];return t}(e),r=i.length,o=0;o<r;o++)t.call(void 0,i[o],n&&n[o],e)}Ke.prototype.cancel=function(){if(this.i=et(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var nt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function it(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof it){this.h=e.h,st(this,e.j),this.o=e.o,this.g=e.g,ot(this,e.s),this.l=e.l;var t=e.i,n=new yt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),at(this,n),this.m=e.m}else e&&(t=String(e).match(nt))?(this.h=!1,st(this,t[1]||"",!0),this.o=ut(t[2]||""),this.g=ut(t[3]||"",!0),ot(this,t[4]),this.l=ut(t[5]||"",!0),at(this,t[6]||"",!0),this.m=ut(t[7]||"")):(this.h=!1,this.i=new yt(null,this.h))}function rt(e){return new it(e)}function st(e,t,n){e.j=n?ut(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function ot(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function at(e,t,n){t instanceof yt?(e.i=t,function(e,t){t&&!e.j&&(bt(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(xt(this,t),St(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=ht(t,gt)),e.i=new yt(t,e.h))}function lt(e,t,n){e.i.set(t,n)}function ct(e){return lt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ut(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ht(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,dt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function dt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}it.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ht(t,ft,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ht(t,ft,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ht(n,"/"==n.charAt(0)?mt:pt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ht(n,vt)),e.join("")};var ft=/[#\/\?@]/g,pt=/[#\?:]/g,mt=/[#\?]/g,gt=/[#\?@]/g,vt=/#/g;function yt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function bt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),r=null;if(0<=i){var s=e[n].substring(0,i);r=e[n].substring(i+1)}else s=e[n];t(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function xt(e,t){bt(e),t=Ct(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function wt(e,t){return bt(e),t=Ct(e,t),e.g.has(t)}function St(e,t,n){xt(e,t),0<n.length&&(e.i=null,e.g.set(Ct(e,t),d(n)),e.h+=n.length)}function Ct(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Tt(e,t,n,i,r){try{r&&(r.onload=null,r.onerror=null,r.onabort=null,r.ontimeout=null),i(n)}catch(s){}}function Et(){this.g=new he}function kt(e,t,n){const i=n||"";try{tt(e,function(e,n){let r=e;o(e)&&(r=ce(e)),t.push(i+n+"="+encodeURIComponent(r))})}catch(r){throw t.push(i+"type="+encodeURIComponent("_badmap")),r}}function Dt(e){this.l=e.Ub||null,this.j=e.eb||!1}function It(e,t){ee.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function _t(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function jt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Pt(e)}function Pt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Mt(e){let t="";return y(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function At(e,t,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=Mt(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):lt(e,t,n))}function Rt(e){ee.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=yt.prototype).add=function(e,t){bt(this),this.i=null,e=Ct(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){bt(this),this.g.forEach(function(n,i){n.forEach(function(n){e.call(t,n,i,this)},this)},this)},e.na=function(){bt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let i=0;i<t.length;i++){const r=e[i];for(let e=0;e<r.length;e++)n.push(t[i])}return n},e.V=function(e){bt(this);let t=[];if("string"==typeof e)wt(this,e)&&(t=t.concat(this.g.get(Ct(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return bt(this),this.i=null,wt(this,e=Ct(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var i=t[n];const s=encodeURIComponent(String(i)),o=this.V(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),e.push(r)}}return this.i=e.join("&")},h(Dt,de),Dt.prototype.g=function(){return new It(this.l,this.j)},Dt.prototype.i=function(e){return function(){return e}}({}),h(It,ee),(e=It.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Pt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||r).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,jt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Pt(this)),this.g&&(this.readyState=3,Pt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(void 0!==r.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;_t(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?jt(this):Pt(this),3==this.readyState&&_t(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,jt(this))},e.Qa=function(e){this.g&&(this.response=e,jt(this))},e.ga=function(){this.g&&jt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(It.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),h(Rt,ee);var Ot=/^https?$/i,Nt=["POST","PUT"];function Lt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Vt(e),Ut(e)}function Vt(e){e.A||(e.A=!0,te(e,"complete"),te(e,"error"))}function Ft(e){if(e.h&&void 0!==i&&(!e.v[1]||4!=Wt(e)||2!=e.Z()))if(e.u&&4==Wt(e))ie(e.Ea,0,e);else if(te(e,"readystatechange"),4==Wt(e)){e.h=!1;try{const i=e.Z();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var s;if(s=0===i){var o=String(e.D).match(nt)[1]||null;!o&&r.self&&r.self.location&&(o=r.self.location.protocol.slice(0,-1)),s=!Ot.test(o?o.toLowerCase():"")}n=s}if(n)te(e,"complete"),te(e,"success");else{e.m=6;try{var a=2<Wt(e)?e.g.statusText:""}catch(l){a=""}e.l=a+" ["+e.Z()+"]",Vt(e)}}finally{Ut(e)}}}function Ut(e,t){if(e.g){zt(e);const i=e.g,r=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||te(e,"ready");try{i.onreadystatechange=r}catch(n){}}}function zt(e){e.I&&(r.clearTimeout(e.I),e.I=null)}function Wt(e){return e.g?e.g.readyState:0}function Bt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function qt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Ht(e){this.Aa=0,this.i=[],this.j=new De,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=qt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=qt("baseRetryDelayMs",5e3,e),this.cb=qt("retryDelaySeedMs",1e4,e),this.Wa=qt("forwardChannelMaxRetries",2,e),this.wa=qt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Ke(e&&e.concurrentRequestLimit),this.Da=new Et,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function $t(e){if(Kt(e),3==e.G){var t=e.U++,n=rt(e.I);if(lt(n,"SID",e.K),lt(n,"RID",t),lt(n,"TYPE","terminate"),Qt(e,n),(t=new Ae(e,e.j,t)).L=2,t.v=ct(rt(n)),n=!1,r.navigator&&r.navigator.sendBeacon)try{n=r.navigator.sendBeacon(t.v.toString(),"")}catch(i){}!n&&r.Image&&((new Image).src=t.v,n=!0),n||(t.g=un(t.j,null),t.g.ea(t.v)),t.F=Date.now(),ze(t)}ln(e)}function Xt(e){e.g&&(tn(e),e.g.cancel(),e.g=null)}function Kt(e){Xt(e),e.u&&(r.clearTimeout(e.u),e.u=null),rn(e),e.h.cancel(),e.s&&("number"==typeof e.s&&r.clearTimeout(e.s),e.s=null)}function Gt(e){if(!Ge(e.h)&&!e.s){e.s=!0;var t=e.Ga;D||j(),I||(D(),I=!0),_.add(t,e),e.B=0}}function Yt(e,t){var n;n=t?t.l:e.U++;const i=rt(e.I);lt(i,"SID",e.K),lt(i,"RID",n),lt(i,"AID",e.T),Qt(e,i),e.m&&e.o&&At(i,e.m,e.o),n=new Ae(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=Jt(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),Je(e.h,n),Le(n,i,t)}function Qt(e,t){e.H&&y(e.H,function(e,n){lt(t,n,e)}),e.l&&tt({},function(e,n){lt(t,n,e)})}function Jt(e,t,n){n=Math.min(e.i.length,n);var i=e.l?c(e.l.Na,e.l,e):null;e:{var r=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=r[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let o=!0;for(let a=0;a<n;a++){let n=r[a].g;const l=r[a].map;if(n-=t,0>n)t=Math.max(0,r[a].g-100),o=!1;else try{kt(l,e,"req"+n+"_")}catch(s){i&&i(l)}}if(o){i=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,i}function Zt(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;D||j(),I||(D(),I=!0),_.add(t,e),e.v=0}}function en(e){return!(e.g||e.u||3<=e.v||(e.Y++,e.u=ke(c(e.Fa,e),on(e,e.v)),e.v++,0))}function tn(e){null!=e.A&&(r.clearTimeout(e.A),e.A=null)}function nn(e){e.g=new Ae(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=rt(e.qa);lt(t,"RID","rpc"),lt(t,"SID",e.K),lt(t,"AID",e.T),lt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&lt(t,"TO",e.ja),lt(t,"TYPE","xmlhttp"),Qt(e,t),e.m&&e.o&&At(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=ct(rt(t)),n.m=null,n.P=!0,Ve(n,e)}function rn(e){null!=e.C&&(r.clearTimeout(e.C),e.C=null)}function sn(e,t){var n=null;if(e.g==t){rn(e),tn(e),e.g=null;var i=2}else{if(!Qe(e.h,t))return;n=t.D,Ze(e.h,t),i=1}if(0!=e.G)if(t.o)if(1==i){n=t.m?t.m.length:0,t=Date.now()-t.F;var r=e.B;te(i=xe(),new Ee(i,n)),Gt(e)}else Zt(e);else if(3==(r=t.s)||0==r&&0<t.X||!(1==i&&function(e,t){return!(Ye(e.h)>=e.h.j-(e.s?1:0)||(e.s?(e.i=t.D.concat(e.i),0):1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa)||(e.s=ke(c(e.Ga,e,t),on(e,e.B)),e.B++,0)))}(e,t)||2==i&&en(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),r){case 1:an(e,5);break;case 4:an(e,10);break;case 3:an(e,6);break;default:an(e,2)}}function on(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function an(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),i=e.Xa;const t=!i;i=new it(i||"//www.google.com/images/cleardot.gif"),r.location&&"http"==r.location.protocol||st(i,"https"),ct(i),t?function(e,t){const n=new De;if(r.Image){const i=new Image;i.onload=u(Tt,n,"TestLoadImage: loaded",!0,t,i),i.onerror=u(Tt,n,"TestLoadImage: error",!1,t,i),i.onabort=u(Tt,n,"TestLoadImage: abort",!1,t,i),i.ontimeout=u(Tt,n,"TestLoadImage: timeout",!1,t,i),r.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=e}else t(!1)}(i.toString(),n):function(e,t){new De;const n=new AbortController,i=setTimeout(()=>{n.abort(),Tt(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(i),e.ok?Tt(0,0,!0,t):Tt(0,0,!1,t)}).catch(()=>{clearTimeout(i),Tt(0,0,!1,t)})}(i.toString(),n)}else Te(2);e.G=0,e.l&&e.l.sa(t),ln(e),Kt(e)}function ln(e){if(e.G=0,e.ka=[],e.l){const t=et(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,d(e.i),e.i.length=0),e.l.ra()}}function cn(e,t,n){var i=n instanceof it?rt(n):new it(n);if(""!=i.g)t&&(i.g=t+"."+i.g),ot(i,i.s);else{var s=r.location;i=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var o=new it(null);i&&st(o,i),t&&(o.g=t),s&&ot(o,s),n&&(o.l=n),i=o}return n=e.D,t=e.ya,n&&t&&lt(i,n,t),lt(i,"VER",e.la),Qt(e,i),i}function un(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Rt(new Dt({eb:n})):new Rt(e.pa)).Ha(e.J),t}function hn(){}function dn(){}function fn(e,t){ee.call(this),this.g=new Ht(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new gn(this)}function pn(e){ge.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function mn(){ve.call(this),this.status=1}function gn(e){this.g=e}(e=Rt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():_e.g(),this.v=this.o?fe(this.o):fe(_e),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(o){return void Lt(this,o)}if(e=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var s in i)n.set(s,i[s]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const e of i.keys())n.set(e,i.get(e))}i=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),s=r.FormData&&e instanceof r.FormData,!(0<=Array.prototype.indexOf.call(Nt,t,void 0))||i||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[r,a]of n)this.g.setRequestHeader(r,a);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{zt(this),this.u=!0,this.g.send(e),this.u=!1}catch(o){Lt(this,o)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,te(this,"complete"),te(this,"abort"),Ut(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ut(this,!0)),Rt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Ft(this):this.bb())},e.bb=function(){Ft(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<Wt(this)?this.g.status:-1}catch(e){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),ue(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(e=Ht.prototype).la=8,e.G=1,e.connect=function(e,t,n,i){Te(0),this.W=e,this.H=t||{},n&&void 0!==i&&(this.H.OSID=n,this.H.OAID=i),this.F=this.X,this.I=cn(this,null,this.W),Gt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const r=new Ae(this,this.j,e);let s=this.o;if(this.S&&(s?(s=b(s),w(s,this.S)):s=this.S),null!==this.m||this.O||(r.H=s,s=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var i=this.i[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Jt(this,r,t),lt(n=rt(this.I),"RID",e),lt(n,"CVER",22),this.D&&lt(n,"X-HTTP-Session-Id",this.D),Qt(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Mt(s)))+"&"+t:this.m&&At(n,this.m,s)),Je(this.h,r),this.Ua&&lt(n,"TYPE","init"),this.P?(lt(n,"$req",t),lt(n,"SID","null"),r.T=!0,Le(r,n,null)):Le(r,n,t),this.G=2}}else 3==this.G&&(e?Yt(this,e):0==this.i.length||Ge(this.h)||Yt(this))},e.Fa=function(){if(this.u=null,nn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=ke(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Te(10),Xt(this),nn(this))},e.Za=function(){null!=this.C&&(this.C=null,Xt(this),en(this),Te(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Te(2)):(this.j.info("Failed to ping google.com"),Te(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=hn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},dn.prototype.g=function(e,t){return new fn(e,t)},h(fn,ee),fn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},fn.prototype.close=function(){$t(this.g)},fn.prototype.o=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=ce(e),e=n);t.i.push(new Xe(t.Ya++,e)),3==t.G&&Gt(t)},fn.prototype.N=function(){this.g.l=null,delete this.j,$t(this.g),delete this.g,fn.aa.N.call(this)},h(pn,ge),h(mn,ve),h(gn,hn),gn.prototype.ua=function(){te(this.g,"a")},gn.prototype.ta=function(e){te(this.g,new pn(e))},gn.prototype.sa=function(e){te(this.g,new mn)},gn.prototype.ra=function(){te(this.g,"b")},dn.prototype.createWebChannel=dn.prototype.g,fn.prototype.send=fn.prototype.o,fn.prototype.open=fn.prototype.m,fn.prototype.close=fn.prototype.close,Iu=function(){return new dn},Du=function(){return xe()},ku=ye,Eu={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},je.NO_ERROR=0,je.TIMEOUT=8,je.HTTP_ERROR=6,Tu=je,Pe.COMPLETE="complete",Cu=Pe,pe.EventType=me,me.OPEN="a",me.CLOSE="b",me.ERROR="c",me.MESSAGE="d",ee.prototype.listen=ee.prototype.K,Su=pe,Rt.prototype.listenOnce=Rt.prototype.L,Rt.prototype.getLastError=Rt.prototype.Ka,Rt.prototype.getLastErrorCode=Rt.prototype.Ba,Rt.prototype.getStatus=Rt.prototype.Z,Rt.prototype.getResponseJson=Rt.prototype.Oa,Rt.prototype.getResponseText=Rt.prototype.oa,Rt.prototype.send=Rt.prototype.ea,Rt.prototype.setWithCredentials=Rt.prototype.Ha,wu=Rt}).apply(void 0!==_u?_u:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});const ju="@firebase/firestore";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Pu{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Pu.UNAUTHENTICATED=new Pu(null),Pu.GOOGLE_CREDENTIALS=new Pu("google-credentials-uid"),Pu.FIRST_PARTY=new Pu("first-party-uid"),Pu.MOCK_USER=new Pu("mock-user");
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
let Mu="10.14.0";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Au=new go("@firebase/firestore");function Ru(){return Au.logLevel}function Ou(e,...t){if(Au.logLevel<=co.DEBUG){const n=t.map(Vu);Au.debug(`Firestore (${Mu}): ${e}`,...n)}}function Nu(e,...t){if(Au.logLevel<=co.ERROR){const n=t.map(Vu);Au.error(`Firestore (${Mu}): ${e}`,...n)}}function Lu(e,...t){if(Au.logLevel<=co.WARN){const n=t.map(Vu);Au.warn(`Firestore (${Mu}): ${e}`,...n)}}function Vu(e){if("string"==typeof e)return e;try{
/**
        * @license
        * Copyright 2020 Google LLC
        *
        * Licensed under the Apache License, Version 2.0 (the "License");
        * you may not use this file except in compliance with the License.
        * You may obtain a copy of the License at
        *
        *   http://www.apache.org/licenses/LICENSE-2.0
        *
        * Unless required by applicable law or agreed to in writing, software
        * distributed under the License is distributed on an "AS IS" BASIS,
        * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
        * See the License for the specific language governing permissions and
        * limitations under the License.
        */
return t=e,JSON.stringify(t)}catch(n){return e}var t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Fu(e="Unexpected state"){const t=`FIRESTORE (${Mu}) INTERNAL ASSERTION FAILED: `+e;throw Nu(t),new Error(t)}function Uu(e,t){e||Fu()}function zu(e,t){return e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Wu={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Bu extends Ys{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class qu{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Hu{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class $u{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Pu.UNAUTHENTICATED))}shutdown(){}}class Xu{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Ku{constructor(e){this.t=e,this.currentUser=Pu.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Uu(void 0===this.o);let n=this.i;const i=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let r=new qu;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new qu,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const t=r;e.enqueueRetryable(()=>p(this,null,function*(){yield t.promise,yield i(this.currentUser)}))},o=e=>{Ou("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(Ou("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new qu)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(Ou("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Uu("string"==typeof t.accessToken),new Hu(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Uu(null===e||"string"==typeof e),new Pu(e)}}class Gu{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Pu.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Yu{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Gu(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Pu.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Qu{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ju{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Uu(void 0===this.o);const n=e=>{null!=e.error&&Ou("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,Ou("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const i=e=>{Ou("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(e=>i(e)),setTimeout(()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?i(e):Ou("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(Uu("string"==typeof e.token),this.R=e.token,new Qu(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Zu(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let i=0;i<e;i++)n[i]=Math.floor(256*Math.random());return n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class eh{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=Zu(40);for(let r=0;r<i.length;++r)n.length<20&&i[r]<t&&(n+=e.charAt(i[r]%62))}return n}}function th(e,t){return e<t?-1:e>t?1:0}function nh(e,t,n){return e.length===t.length&&e.every((e,i)=>n(e,t[i]))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ih{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Bu(Wu.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Bu(Wu.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Bu(Wu.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Bu(Wu.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ih.fromMillis(Date.now())}static fromDate(e){return ih.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new ih(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?th(this.nanoseconds,e.nanoseconds):th(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class rh{constructor(e){this.timestamp=e}static fromTimestamp(e){return new rh(e)}static min(){return new rh(new ih(0,0))}static max(){return new rh(new ih(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class sh{constructor(e,t,n){void 0===t?t=0:t>e.length&&Fu(),void 0===n?n=e.length-t:n>e.length-t&&Fu(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===sh.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof sh?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const n=e.get(i),r=t.get(i);if(n<r)return-1;if(n>r)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class oh extends sh{construct(e,t,n){return new oh(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Bu(Wu.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new oh(t)}static emptyPath(){return new oh([])}}const ah=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class lh extends sh{construct(e,t,n){return new lh(e,t,n)}static isValidIdentifier(e){return ah.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),lh.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new lh(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const r=()=>{if(0===n.length)throw new Bu(Wu.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;i<e.length;){const t=e[i];if("\\"===t){if(i+1===e.length)throw new Bu(Wu.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[i+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Bu(Wu.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,i+=2}else"`"===t?(s=!s,i++):"."!==t||s?(n+=t,i++):(r(),i++)}if(r(),s)throw new Bu(Wu.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new lh(t)}static emptyPath(){return new lh([])}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ch{constructor(e){this.path=e}static fromPath(e){return new ch(oh.fromString(e))}static fromName(e){return new ch(oh.fromString(e).popFirst(5))}static empty(){return new ch(oh.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===oh.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return oh.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ch(new oh(e.slice()))}}function uh(e){return new hh(e.readTime,e.key,-1)}class hh{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new hh(rh.min(),ch.empty(),-1)}static max(){return new hh(rh.max(),ch.empty(),-1)}}function dh(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=ch.comparator(e.documentKey,t.documentKey),0!==n?n:th(e.largestBatchId,t.largestBatchId)
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */)}class fh{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ph(e){return p(this,null,function*(){if(e.code!==Wu.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;Ou("LocalStore","Unexpectedly lost primary lease")})}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class mh{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Fu(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new mh((n,i)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,i)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof mh?t:mh.resolve(t)}catch(t){return mh.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):mh.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):mh.reject(t)}static resolve(e){return new mh((t,n)=>{t(e)})}static reject(e){return new mh((t,n)=>{n(e)})}static waitFor(e){return new mh((t,n)=>{let i=0,r=0,s=!1;e.forEach(e=>{++i,e.next(()=>{++r,s&&r===i&&t()},e=>n(e))}),s=!0,r===i&&t()})}static or(e){let t=mh.resolve(!1);for(const n of e)t=t.next(e=>e?mh.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,i)=>{n.push(t.call(this,e,i))}),this.waitFor(n)}static mapArray(e,t){return new mh((n,i)=>{const r=e.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const l=a;t(e[l]).next(e=>{s[l]=e,++o,o===r&&n(s)},e=>i(e))}})}static doWhile(e,t){return new mh((n,i)=>{const r=()=>{!0===e()?t().next(()=>{r()},i):n()};r()})}}function gh(e){return"IndexedDbTransactionError"===e.name}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class vh{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function yh(e){return null==e}function bh(e){return 0===e&&1/e==-1/0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function xh(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function wh(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Sh(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */vh.oe=-1;class Ch{constructor(e,t){this.comparator=e,this.root=t||Eh.EMPTY}insert(e,t){return new Ch(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Eh.BLACK,null,null))}remove(e){return new Ch(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Eh.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Th(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Th(this.root,e,this.comparator,!1)}getReverseIterator(){return new Th(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Th(this.root,e,this.comparator,!0)}}class Th{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(0===r){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Eh{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:Eh.RED,this.left=null!=i?i:Eh.EMPTY,this.right=null!=r?r:Eh.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,r){return new Eh(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Eh.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return Eh.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Eh.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Eh.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Fu();if(this.right.isRed())throw Fu();const e=this.left.check();if(e!==this.right.check())throw Fu();return e+(this.isRed()?0:1)}}Eh.EMPTY=null,Eh.RED=!0,Eh.BLACK=!1,Eh.EMPTY=new class{constructor(){this.size=0}get key(){throw Fu()}get value(){throw Fu()}get color(){throw Fu()}get left(){throw Fu()}get right(){throw Fu()}copy(e,t,n,i,r){return this}insert(e,t,n){return new Eh(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class kh{constructor(e){this.comparator=e,this.data=new Ch(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Dh(this.data.getIterator())}getIteratorFrom(e){return new Dh(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof kh))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new kh(this.comparator);return t.data=e,t}}class Dh{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ih{constructor(e){this.fields=e,e.sort(lh.comparator)}static empty(){return new Ih([])}unionWith(e){let t=new kh(lh.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Ih(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return nh(this.fields,e.fields,(e,t)=>e.isEqual(t))}}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class _h extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class jh{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new _h("Invalid base64 string: "+t):t}}(e);return new jh(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new jh(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return th(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}jh.EMPTY_BYTE_STRING=new jh("");const Ph=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Mh(e){if(Uu(!!e),"string"==typeof e){let t=0;const n=Ph.exec(e);if(Uu(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Ah(e.seconds),nanos:Ah(e.nanos)}}function Ah(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Rh(e){return"string"==typeof e?jh.fromBase64String(e):jh.fromUint8Array(e)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Oh(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Nh(e){const t=e.mapValue.fields.__previous_value__;return Oh(t)?Nh(t):t}function Lh(e){const t=Mh(e.mapValue.fields.__local_write_time__.timestampValue);return new ih(t.seconds,t.nanos)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Vh{constructor(e,t,n,i,r,s,o,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l}}class Fh{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Fh("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Fh&&e.projectId===this.projectId&&e.database===this.database}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Uh={};function zh(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Oh(e)?4:function(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e)?9007199254740991:function(e){var t,n;return"__vector__"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}(e)?10:11:Fu()}function Wh(e,t){if(e===t)return!0;const n=zh(e);if(n!==zh(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Lh(e).isEqual(Lh(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Mh(e.timestampValue),i=Mh(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return i=t,Rh(e.bytesValue).isEqual(Rh(i.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Ah(e.geoPointValue.latitude)===Ah(t.geoPointValue.latitude)&&Ah(e.geoPointValue.longitude)===Ah(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Ah(e.integerValue)===Ah(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Ah(e.doubleValue),i=Ah(t.doubleValue);return n===i?bh(n)===bh(i):isNaN(n)&&isNaN(i)}return!1}(e,t);case 9:return nh(e.arrayValue.values||[],t.arrayValue.values||[],Wh);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},i=t.mapValue.fields||{};if(xh(n)!==xh(i))return!1;for(const r in n)if(n.hasOwnProperty(r)&&(void 0===i[r]||!Wh(n[r],i[r])))return!1;return!0}(e,t);default:return Fu()}var i}function Bh(e,t){return void 0!==(e.values||[]).find(e=>Wh(e,t))}function qh(e,t){if(e===t)return 0;const n=zh(e),i=zh(t);if(n!==i)return th(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return th(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Ah(e.integerValue||e.doubleValue),i=Ah(t.integerValue||t.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(e,t);case 3:return Hh(e.timestampValue,t.timestampValue);case 4:return Hh(Lh(e),Lh(t));case 5:return th(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Rh(e),i=Rh(t);return n.compareTo(i)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),i=t.split("/");for(let r=0;r<n.length&&r<i.length;r++){const e=th(n[r],i[r]);if(0!==e)return e}return th(n.length,i.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=th(Ah(e.latitude),Ah(t.latitude));return 0!==n?n:th(Ah(e.longitude),Ah(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return $h(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,i,r,s;const o=e.fields||{},a=t.fields||{},l=null===(n=o.value)||void 0===n?void 0:n.arrayValue,c=null===(i=a.value)||void 0===i?void 0:i.arrayValue,u=th((null===(r=null==l?void 0:l.values)||void 0===r?void 0:r.length)||0,(null===(s=null==c?void 0:c.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:$h(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Uh&&t===Uh)return 0;if(e===Uh)return 1;if(t===Uh)return-1;const n=e.fields||{},i=Object.keys(n),r=t.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let o=0;o<i.length&&o<s.length;++o){const e=th(i[o],s[o]);if(0!==e)return e;const t=qh(n[i[o]],r[s[o]]);if(0!==t)return t}return th(i.length,s.length)}(e.mapValue,t.mapValue);default:throw Fu()}}function Hh(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return th(e,t);const n=Mh(e),i=Mh(t),r=th(n.seconds,i.seconds);return 0!==r?r:th(n.nanos,i.nanos)}function $h(e,t){const n=e.values||[],i=t.values||[];for(let r=0;r<n.length&&r<i.length;++r){const e=qh(n[r],i[r]);if(e)return e}return th(n.length,i.length)}function Xh(e){return Kh(e)}function Kh(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Mh(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Rh(e.bytesValue).toBase64():"referenceValue"in e?function(e){return ch.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const i of e.values||[])n?n=!1:t+=",",t+=Kh(i);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",i=!0;for(const r of t)i?i=!1:n+=",",n+=`${r}:${Kh(e.fields[r])}`;return n+"}"}(e.mapValue):Fu()}function Gh(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Yh(e){return!!e&&"integerValue"in e}function Qh(e){return!!e&&"arrayValue"in e}function Jh(e){return!!e&&"nullValue"in e}function Zh(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function ed(e){return!!e&&"mapValue"in e}function td(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return wh(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=td(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=td(e.arrayValue.values[n]);return t}return Object.assign({},e)}class nd{constructor(e){this.value=e}static empty(){return new nd({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!ed(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=td(t)}setAll(e){let t=lh.emptyPath(),n={},i=[];e.forEach((e,r)=>{if(!t.isImmediateParentOf(r)){const e=this.getFieldsMap(t);this.applyChanges(e,n,i),n={},i=[],t=r.popLast()}e?n[r.lastSegment()]=td(e):i.push(r.lastSegment())});const r=this.getFieldsMap(t);this.applyChanges(r,n,i)}delete(e){const t=this.field(e.popLast());ed(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Wh(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];ed(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){wh(t,(t,n)=>e[t]=n);for(const i of n)delete e[i]}clone(){return new nd(td(this.value))}}function id(e){const t=[];return wh(e.fields,(e,n)=>{const i=new lh([e]);if(ed(n)){const e=id(n.mapValue).fields;if(0===e.length)t.push(i);else for(const n of e)t.push(i.child(n))}else t.push(i)}),new Ih(t)
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}class rd{constructor(e,t,n,i,r,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=r,this.data=s,this.documentState=o}static newInvalidDocument(e){return new rd(e,0,rh.min(),rh.min(),rh.min(),nd.empty(),0)}static newFoundDocument(e,t,n,i){return new rd(e,1,t,rh.min(),n,i,0)}static newNoDocument(e,t){return new rd(e,2,t,rh.min(),rh.min(),nd.empty(),0)}static newUnknownDocument(e,t){return new rd(e,3,t,rh.min(),rh.min(),nd.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(rh.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=nd.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=nd.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=rh.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof rd&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new rd(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class sd{constructor(e,t){this.position=e,this.inclusive=t}}function od(e,t,n){let i=0;for(let r=0;r<e.position.length;r++){const s=t[r],o=e.position[r];if(i=s.field.isKeyField()?ch.comparator(ch.fromName(o.referenceValue),n.key):qh(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function ad(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Wh(e.position[n],t.position[n]))return!1;return!0}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ld{constructor(e,t="asc"){this.field=e,this.dir=t}}function cd(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ud{}class hd extends ud{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new yd(e,t,n):"array-contains"===t?new Sd(e,n):"in"===t?new Cd(e,n):"not-in"===t?new Td(e,n):"array-contains-any"===t?new Ed(e,n):new hd(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new bd(e,n):new xd(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(qh(t,this.value)):null!==t&&zh(this.value)===zh(t)&&this.matchesComparison(qh(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Fu()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class dd extends ud{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new dd(e,t)}matches(e){return fd(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function fd(e){return"and"===e.op}function pd(e){return function(e){for(const t of e.filters)if(t instanceof dd)return!1;return!0}(e)&&fd(e)}function md(e){if(e instanceof hd)return e.field.canonicalString()+e.op.toString()+Xh(e.value);if(pd(e))return e.filters.map(e=>md(e)).join(",");{const t=e.filters.map(e=>md(e)).join(",");return`${e.op}(${t})`}}function gd(e,t){return e instanceof hd?(n=e,(i=t)instanceof hd&&n.op===i.op&&n.field.isEqual(i.field)&&Wh(n.value,i.value)):e instanceof dd?function(e,t){return t instanceof dd&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,i)=>e&&gd(n,t.filters[i]),!0)}(e,t):void Fu();var n,i}function vd(e){return e instanceof hd?`${(t=e).field.canonicalString()} ${t.op} ${Xh(t.value)}`:e instanceof dd?function(e){return e.op.toString()+" {"+e.getFilters().map(vd).join(" ,")+"}"}(e):"Filter";var t}class yd extends hd{constructor(e,t,n){super(e,t,n),this.key=ch.fromName(n.referenceValue)}matches(e){const t=ch.comparator(e.key,this.key);return this.matchesComparison(t)}}class bd extends hd{constructor(e,t){super(e,"in",t),this.keys=wd(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class xd extends hd{constructor(e,t){super(e,"not-in",t),this.keys=wd(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function wd(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>ch.fromName(e.referenceValue))}class Sd extends hd{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Qh(t)&&Bh(t.arrayValue,this.value)}}class Cd extends hd{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Bh(this.value.arrayValue,t)}}class Td extends hd{constructor(e,t){super(e,"not-in",t)}matches(e){if(Bh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Bh(this.value.arrayValue,t)}}class Ed extends hd{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Qh(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Bh(this.value.arrayValue,e))}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class kd{constructor(e,t=null,n=[],i=[],r=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.ue=null}}function Dd(e,t=null,n=[],i=[],r=null,s=null,o=null){return new kd(e,t,n,i,r,s,o)}function Id(e){const t=zu(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>md(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>{return(t=e).field.canonicalString()+t.dir;var t}).join(","),yh(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Xh(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Xh(e)).join(",")),t.ue=e}return t.ue}function _d(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!cd(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!gd(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!ad(e.startAt,t.startAt)&&ad(e.endAt,t.endAt)}function jd(e){return ch.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Pd{constructor(e,t=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Md(e){return new Pd(e)}function Ad(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Rd(e){return null!==e.collectionGroup}function Od(e){const t=zu(e);if(null===t.ce){t.ce=[];const e=new Set;for(const i of t.explicitOrderBy)t.ce.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(e){let t=new kh(lh.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t})(t).forEach(i=>{e.has(i.canonicalString())||i.isKeyField()||t.ce.push(new ld(i,n))}),e.has(lh.keyField().canonicalString())||t.ce.push(new ld(lh.keyField(),n))}return t.ce}function Nd(e){const t=zu(e);return t.le||(t.le=function(e,t){if("F"===e.limitType)return Dd(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new ld(e.field,t)});const n=e.endAt?new sd(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new sd(e.startAt.position,e.startAt.inclusive):null;return Dd(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}}(t,Od(e))),t.le}function Ld(e,t){const n=e.filters.concat([t]);return new Pd(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Vd(e,t,n){return new Pd(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Fd(e,t){return _d(Nd(e),Nd(t))&&e.limitType===t.limitType}function Ud(e){return`${Id(Nd(e))}|lt:${e.limitType}`}function zd(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>vd(e)).join(", ")}]`),yh(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>{return`${(t=e).field.canonicalString()} (${t.dir})`;var t}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Xh(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Xh(e)).join(",")),`Target(${t})`}(Nd(e))}; limitType=${e.limitType})`}function Wd(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):ch.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Od(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&(i=t,!((n=e).startAt&&!function(e,t,n){const i=od(e,t,n);return e.inclusive?i<=0:i<0}(n.startAt,Od(n),i)||n.endAt&&!function(e,t,n){const i=od(e,t,n);return e.inclusive?i>=0:i>0}(n.endAt,Od(n),i)));var n,i}function Bd(e){return(t,n)=>{let i=!1;for(const r of Od(e)){const e=qd(r,t,n);if(0!==e)return e;i=i||r.field.isKeyField()}return 0}}function qd(e,t,n){const i=e.field.isKeyField()?ch.comparator(t.key,n.key):function(e,t,n){const i=t.data.field(e),r=n.data.field(e);return null!==i&&null!==r?qh(i,r):Fu()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return Fu()}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Hd{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[i,r]of n)if(this.equalsFn(i,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return void(i[r]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){wh(this.inner,(t,n)=>{for(const[i,r]of n)e(i,r)})}isEmpty(){return Sh(this.inner)}size(){return this.innerSize}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const $d=new Ch(ch.comparator);function Xd(){return $d}const Kd=new Ch(ch.comparator);function Gd(...e){let t=Kd;for(const n of e)t=t.insert(n.key,n);return t}function Yd(e){let t=Kd;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Qd(){return Zd()}function Jd(){return Zd()}function Zd(){return new Hd(e=>e.toString(),(e,t)=>e.isEqual(t))}const ef=new Ch(ch.comparator),tf=new kh(ch.comparator);function nf(...e){let t=tf;for(const n of e)t=t.add(n);return t}const rf=new kh(th);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function sf(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bh(t)?"-0":t}}function of(e){return{integerValue:""+e}}function af(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!bh(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?of(t):sf(e,t)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class lf{constructor(){this._=void 0}}function cf(e,t,n){return e instanceof df?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Oh(t)&&(t=Nh(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof ff?pf(e,t):e instanceof mf?gf(e,t):function(e,t){const n=hf(e,t),i=yf(n)+yf(e.Pe);return Yh(n)&&Yh(e.Pe)?of(i):sf(e.serializer,i)}(e,t)}function uf(e,t,n){return e instanceof ff?pf(e,t):e instanceof mf?gf(e,t):n}function hf(e,t){return e instanceof vf?Yh(n=t)||(i=n)&&"doubleValue"in i?t:{integerValue:0}:null;var n,i}class df extends lf{}class ff extends lf{constructor(e){super(),this.elements=e}}function pf(e,t){const n=bf(t);for(const i of e.elements)n.some(e=>Wh(e,i))||n.push(i);return{arrayValue:{values:n}}}class mf extends lf{constructor(e){super(),this.elements=e}}function gf(e,t){let n=bf(t);for(const i of e.elements)n=n.filter(e=>!Wh(e,i));return{arrayValue:{values:n}}}class vf extends lf{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function yf(e){return Ah(e.integerValue||e.doubleValue)}function bf(e){return Qh(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class xf{constructor(e,t){this.version=e,this.transformResults=t}}class wf{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new wf}static exists(e){return new wf(void 0,e)}static updateTime(e){return new wf(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Sf(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Cf{}function Tf(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Rf(e.key,wf.none()):new _f(e.key,e.data,wf.none());{const n=e.data,i=nd.empty();let r=new kh(lh.comparator);for(let e of t.fields)if(!r.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?i.delete(e):i.set(e,t),r=r.add(e)}return new jf(e.key,i,new Ih(r.toArray()),wf.none())}}function Ef(e,t,n){var i;e instanceof _f?function(e,t,n){const i=e.value.clone(),r=Mf(e.fieldTransforms,t,n.transformResults);i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):e instanceof jf?function(e,t,n){if(!Sf(e.precondition,t))return void t.convertToUnknownDocument(n.version);const i=Mf(e.fieldTransforms,t,n.transformResults),r=t.data;r.setAll(Pf(e)),r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):(i=n,t.convertToNoDocument(i.version).setHasCommittedMutations())}function kf(e,t,n,i){return e instanceof _f?function(e,t,n,i){if(!Sf(e.precondition,t))return n;const r=e.value.clone(),s=Af(e.fieldTransforms,i,t);return r.setAll(s),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null}(e,t,n,i):e instanceof jf?function(e,t,n,i){if(!Sf(e.precondition,t))return n;const r=Af(e.fieldTransforms,i,t),s=t.data;return s.setAll(Pf(e)),s.setAll(r),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,i):(r=t,s=n,Sf(e.precondition,r)?(r.convertToNoDocument(r.version).setHasLocalMutations(),null):s);var r,s}function Df(e,t){let n=null;for(const i of e.fieldTransforms){const e=t.data.field(i.field),r=hf(i.transform,e||null);null!=r&&(null===n&&(n=nd.empty()),n.set(i.field,r))}return n||null}function If(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,i=t.fieldTransforms,!!(void 0===n&&void 0===i||n&&i&&nh(n,i,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&(n=e.transform,i=t.transform,n instanceof ff&&i instanceof ff||n instanceof mf&&i instanceof mf?nh(n.elements,i.elements,Wh):n instanceof vf&&i instanceof vf?Wh(n.Pe,i.Pe):n instanceof df&&i instanceof df);var n,i}(e,t)))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask)));var n,i}class _f extends Cf{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class jf extends Cf{constructor(e,t,n,i,r=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function Pf(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}}),t}function Mf(e,t,n){const i=new Map;Uu(e.length===n.length);for(let r=0;r<n.length;r++){const s=e[r],o=s.transform,a=t.data.field(s.field);i.set(s.field,uf(o,a,n[r]))}return i}function Af(e,t,n){const i=new Map;for(const r of e){const e=r.transform,s=n.data.field(r.field);i.set(r.field,cf(e,s,t))}return i}class Rf extends Cf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Of extends Cf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Nf{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const t=this.mutations[i];t.key.isEqual(e.key)&&Ef(t,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=kf(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=kf(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Jd();return this.mutations.forEach(i=>{const r=e.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=t.has(i.key)?null:o;const a=Tf(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(rh.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),nf())}isEqual(e){return this.batchId===e.batchId&&nh(this.mutations,e.mutations,(e,t)=>If(e,t))&&nh(this.baseMutations,e.baseMutations,(e,t)=>If(e,t))}}class Lf{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){Uu(e.mutations.length===n.length);let i=function(){return ef}();const r=e.mutations;for(let s=0;s<r.length;s++)i=i.insert(r[s].key,n[s].version);return new Lf(e,t,n,i)}}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Vf{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ff{constructor(e,t){this.count=e,this.unchangedNames=t}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Uf,zf;function Wf(e){if(void 0===e)return Nu("GRPC error has no .code"),Wu.UNKNOWN;switch(e){case Uf.OK:return Wu.OK;case Uf.CANCELLED:return Wu.CANCELLED;case Uf.UNKNOWN:return Wu.UNKNOWN;case Uf.DEADLINE_EXCEEDED:return Wu.DEADLINE_EXCEEDED;case Uf.RESOURCE_EXHAUSTED:return Wu.RESOURCE_EXHAUSTED;case Uf.INTERNAL:return Wu.INTERNAL;case Uf.UNAVAILABLE:return Wu.UNAVAILABLE;case Uf.UNAUTHENTICATED:return Wu.UNAUTHENTICATED;case Uf.INVALID_ARGUMENT:return Wu.INVALID_ARGUMENT;case Uf.NOT_FOUND:return Wu.NOT_FOUND;case Uf.ALREADY_EXISTS:return Wu.ALREADY_EXISTS;case Uf.PERMISSION_DENIED:return Wu.PERMISSION_DENIED;case Uf.FAILED_PRECONDITION:return Wu.FAILED_PRECONDITION;case Uf.ABORTED:return Wu.ABORTED;case Uf.OUT_OF_RANGE:return Wu.OUT_OF_RANGE;case Uf.UNIMPLEMENTED:return Wu.UNIMPLEMENTED;case Uf.DATA_LOSS:return Wu.DATA_LOSS;default:return Fu()}}(zf=Uf||(Uf={}))[zf.OK=0]="OK",zf[zf.CANCELLED=1]="CANCELLED",zf[zf.UNKNOWN=2]="UNKNOWN",zf[zf.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",zf[zf.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",zf[zf.NOT_FOUND=5]="NOT_FOUND",zf[zf.ALREADY_EXISTS=6]="ALREADY_EXISTS",zf[zf.PERMISSION_DENIED=7]="PERMISSION_DENIED",zf[zf.UNAUTHENTICATED=16]="UNAUTHENTICATED",zf[zf.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",zf[zf.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",zf[zf.ABORTED=10]="ABORTED",zf[zf.OUT_OF_RANGE=11]="OUT_OF_RANGE",zf[zf.UNIMPLEMENTED=12]="UNIMPLEMENTED",zf[zf.INTERNAL=13]="INTERNAL",zf[zf.UNAVAILABLE=14]="UNAVAILABLE",zf[zf.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Bf=new yu([4294967295,4294967295],0);function qf(e){const t=(new TextEncoder).encode(e),n=new bu;return n.update(t),new Uint8Array(n.digest())}function Hf(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),r=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new yu([n,i],0),new yu([r,s],0)]}class $f{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Xf(`Invalid padding: ${t}`);if(n<0)throw new Xf(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Xf(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Xf(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=yu.fromNumber(this.Ie)}Ee(e,t,n){let i=e.add(t.multiply(yu.fromNumber(n)));return 1===i.compare(Bf)&&(i=new yu([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=qf(e),[n,i]=Hf(t);for(let r=0;r<this.hashCount;r++){const e=this.Ee(n,i,r);if(!this.de(e))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),s=new $f(r,i,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.Ie)return;const t=qf(e),[n,i]=Hf(t);for(let r=0;r<this.hashCount;r++){const e=this.Ee(n,i,r);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Xf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Kf{constructor(e,t,n,i,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,Gf.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Kf(rh.min(),i,new Ch(th),Xd(),nf())}}class Gf{constructor(e,t,n,i,r){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Gf(n,t,nf(),nf(),nf())}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Yf{constructor(e,t,n,i){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=i}}class Qf{constructor(e,t){this.targetId=e,this.me=t}}class Jf{constructor(e,t,n=jh.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class Zf{constructor(){this.fe=0,this.ge=np(),this.pe=jh.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=nf(),t=nf(),n=nf();return this.ge.forEach((i,r)=>{switch(r){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:Fu()}}),new Gf(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=np()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Uu(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class ep{constructor(e){this.Le=e,this.Be=new Map,this.ke=Xd(),this.qe=tp(),this.Qe=new Ch(th)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:Fu()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((e,n)=>{this.ze(n)&&t(n)})}He(e){const t=e.targetId,n=e.me.count,i=this.Je(t);if(i){const r=i.target;if(jd(r))if(0===n){const e=new ch(r.path);this.Ue(t,e,rd.newNoDocument(e,rh.min()))}else Uu(1===n);else{const i=this.Ye(t);if(i!==n){const n=this.Ze(e),r=n?this.Xe(n,e,i):1;if(0!==r){this.je(t);const e=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:r=0}=t;let s,o;try{s=Rh(n).toUint8Array()}catch(a){if(a instanceof _h)return Lu("Decoding the base64 bloom filter in existence filter failed ("+a.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw a}try{o=new $f(s,i,r)}catch(a){return Lu(a instanceof Xf?"BloomFilter error: ":"Applying bloom filter failed: ",a),null}return 0===o.Ie?null:o}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let i=0;return n.forEach(n=>{const r=this.Le.tt(),s=`projects/${r.projectId}/databases/${r.database}/documents/${n.path.canonicalString()}`;e.mightContain(s)||(this.Ue(t,n,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((n,i)=>{const r=this.Je(i);if(r){if(n.current&&jd(r.target)){const t=new ch(r.target.path);null!==this.ke.get(t)||this.it(i,t)||this.Ue(i,t,rd.newNoDocument(t,e))}n.be&&(t.set(i,n.ve()),n.Ce())}});let n=nf();this.qe.forEach((e,t)=>{let i=!0;t.forEachWhile(e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(i=!1,!1)}),i&&(n=n.add(e))}),this.ke.forEach((t,n)=>n.setReadTime(e));const i=new Kf(e,t,this.Qe,this.ke,n);return this.ke=Xd(),this.qe=tp(),this.Qe=new Ch(th),i}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Zf,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new kh(th),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||Ou("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Zf),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function tp(){return new Ch(ch.comparator)}function np(){return new Ch(ch.comparator)}const ip=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),rp=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),sp=(()=>({and:"AND",or:"OR"}))();class op{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ap(e,t){return e.useProto3Json||yh(t)?t:{value:t}}function lp(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function cp(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function up(e,t){return lp(e,t.toTimestamp())}function hp(e){return Uu(!!e),rh.fromTimestamp(function(e){const t=Mh(e);return new ih(t.seconds,t.nanos)}(e))}function dp(e,t){return fp(e,t).canonicalString()}function fp(e,t){const n=(i=e,new oh(["projects",i.projectId,"databases",i.database])).child("documents");var i;return void 0===t?n:n.child(t)}function pp(e){const t=oh.fromString(e);return Uu(Mp(t)),t}function mp(e,t){return dp(e.databaseId,t.path)}function gp(e,t){const n=pp(t);if(n.get(1)!==e.databaseId.projectId)throw new Bu(Wu.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Bu(Wu.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new ch(bp(n))}function vp(e,t){return dp(e.databaseId,t)}function yp(e){return new oh(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function bp(e){return Uu(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function xp(e,t,n){return{name:mp(e,t),fields:n.value.mapValue.fields}}function wp(e,t){return{documents:[vp(e,t.path)]}}function Sp(e,t){const n={structuredQuery:{}},i=t.path;let r;null!==t.collectionGroup?(r=i,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=vp(e,r);const s=function(e){if(0!==e.length)return jp(dd.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map(e=>{return{field:Ip((t=e).field),direction:Ep(t.dir)};var t})}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=ap(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt={before:(l=t.startAt).inclusive,values:l.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:r};var l}function Cp(e){let t=function(e){const t=pp(e);return 4===t.length?oh.emptyPath():bp(t)}(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){Uu(1===i);const e=n.from[0];e.allDescendants?r=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Tp(e);return t instanceof dd&&pd(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(e=>{return new ld(_p((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,yh(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new sd(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new sd(n,t)}(n.endAt)),function(e,t,n,i,r,s,o,a){return new Pd(e,t,n,i,r,s,o,a)}(t,r,o,s,a,"F",l,c)}function Tp(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=_p(e.unaryFilter.field);return hd.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=_p(e.unaryFilter.field);return hd.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=_p(e.unaryFilter.field);return hd.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=_p(e.unaryFilter.field);return hd.create(r,"!=",{nullValue:"NULL_VALUE"});default:return Fu()}}(e):void 0!==e.fieldFilter?(t=e,hd.create(_p(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Fu()}}(t.fieldFilter.op),t.fieldFilter.value)):void 0!==e.compositeFilter?function(e){return dd.create(e.compositeFilter.filters.map(e=>Tp(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Fu()}}(e.compositeFilter.op))}(e):Fu();var t}function Ep(e){return ip[e]}function kp(e){return rp[e]}function Dp(e){return sp[e]}function Ip(e){return{fieldPath:e.canonicalString()}}function _p(e){return lh.fromServerFormat(e.fieldPath)}function jp(e){return e instanceof hd?function(e){if("=="===e.op){if(Zh(e.value))return{unaryFilter:{field:Ip(e.field),op:"IS_NAN"}};if(Jh(e.value))return{unaryFilter:{field:Ip(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Zh(e.value))return{unaryFilter:{field:Ip(e.field),op:"IS_NOT_NAN"}};if(Jh(e.value))return{unaryFilter:{field:Ip(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ip(e.field),op:kp(e.op),value:e.value}}}(e):e instanceof dd?function(e){const t=e.getFilters().map(e=>jp(e));return 1===t.length?t[0]:{compositeFilter:{op:Dp(e.op),filters:t}}}(e):Fu()}function Pp(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function Mp(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ap{constructor(e,t,n,i,r=rh.min(),s=rh.min(),o=jh.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new Ap(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ap(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ap(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ap(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Rp{constructor(e){this.ct=e}}function Op(e){const t=Cp({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Vd(t,t.limit,"L"):t}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Np{constructor(){this.un=new Lp}addToCollectionParentIndex(e,t){return this.un.add(t),mh.resolve()}getCollectionParents(e,t){return mh.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return mh.resolve()}deleteFieldIndex(e,t){return mh.resolve()}deleteAllFieldIndexes(e){return mh.resolve()}createTargetIndexes(e,t){return mh.resolve()}getDocumentsMatchingTarget(e,t){return mh.resolve(null)}getIndexType(e,t){return mh.resolve(0)}getFieldIndexes(e,t){return mh.resolve([])}getNextCollectionGroupToUpdate(e){return mh.resolve(null)}getMinOffset(e,t){return mh.resolve(hh.min())}getMinOffsetFromCollectionGroup(e,t){return mh.resolve(hh.min())}updateCollectionGroup(e,t,n){return mh.resolve()}updateIndexEntries(e,t){return mh.resolve()}}class Lp{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new kh(oh.comparator),r=!i.has(n);return this.index[t]=i.add(n),r}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new kh(oh.comparator)).toArray()}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Vp{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Vp(0)}static kn(){return new Vp(-1)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Fp{constructor(){this.changes=new Hd(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,rd.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?mh.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Up{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class zp{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&kf(n.mutation,e,Ih.empty(),ih.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,nf()).next(()=>t))}getLocalViewOfDocuments(e,t,n=nf()){const i=Qd();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(e=>{let t=Gd();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Qd();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,nf()))}populateOverlays(e,t,n){const i=[];return n.forEach(e=>{t.has(e)||i.push(e)}),this.documentOverlayCache.getOverlays(e,i).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,i){let r=Xd();const s=Zd(),o=Zd();return t.forEach((e,t)=>{const o=n.get(t.key);i.has(t.key)&&(void 0===o||o.mutation instanceof jf)?r=r.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),kf(o.mutation,t,o.mutation.getFieldMask(),ih.now())):s.set(t.key,Ih.empty())}),this.recalculateAndSaveOverlays(e,r).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new Up(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){const n=Zd();let i=new Ch((e,t)=>e-t),r=nf();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const r of e)r.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||Ih.empty();o=r.applyToLocalView(s,o),n.set(e,o);const a=(i.get(r.batchId)||nf()).add(e);i=i.insert(r.batchId,a)})}).next(()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,l=i.value,c=Jd();l.forEach(e=>{if(!r.has(e)){const i=Tf(t.get(e),n.get(e));null!==i&&c.set(e,i),r=r.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return mh.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,i){return r=t,ch.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Rd(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i);var r}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-r.size):mh.resolve(Qd());let o=-1,a=r;return s.next(t=>mh.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(t)?mh.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,r)).next(()=>this.computeViews(e,a,t,nf())).next(e=>({batchId:o,changes:Yd(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ch(t)).next(e=>{let t=Gd();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const r=t.collectionGroup;let s=Gd();return this.indexManager.getCollectionParents(e,r).next(o=>mh.forEach(o,o=>{const a=(l=t,c=o.child(r),new Pd(c,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt));var l,c;return this.getDocumentsMatchingCollectionQuery(e,a,n,i).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,i){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r,i))).next(e=>{r.forEach((t,n)=>{const i=n.getKey();null===e.get(i)&&(e=e.insert(i,rd.newInvalidDocument(i)))});let n=Gd();return e.forEach((e,i)=>{const s=r.get(e);void 0!==s&&kf(s.mutation,i,Ih.empty(),ih.now()),Wd(t,i)&&(n=n.insert(e,i))}),n})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Wp{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return mh.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,{id:(n=t).id,version:n.version,createTime:hp(n.createTime)}),mh.resolve();var n}getNamedQuery(e,t){return mh.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,{name:(n=t).name,query:Op(n.bundledQuery),readTime:hp(n.readTime)}),mh.resolve();var n}}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Bp{constructor(){this.overlays=new Ch(ch.comparator),this.Ir=new Map}getOverlay(e,t){return mh.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Qd();return mh.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,i)=>{this.ht(e,t,i)}),mh.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Ir.get(n);return void 0!==i&&(i.forEach(e=>this.overlays=this.overlays.remove(e)),this.Ir.delete(n)),mh.resolve()}getOverlaysForCollection(e,t,n){const i=Qd(),r=t.length+1,s=new ch(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===r&&e.largestBatchId>n&&i.set(e.getKey(),e)}return mh.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let r=new Ch((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=r.get(e.largestBatchId);null===t&&(t=Qd(),r=r.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Qd(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=i)););return mh.resolve(o)}ht(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const e=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Vf(t,n));let r=this.Ir.get(t);void 0===r&&(r=nf(),this.Ir.set(t,r)),this.Ir.set(t,r.add(n.key))}}
/**
     * @license
     * Copyright 2024 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class qp{constructor(){this.sessionToken=jh.EMPTY_BYTE_STRING}getSessionToken(e){return mh.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,mh.resolve()}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Hp{constructor(){this.Tr=new kh($p.Er),this.dr=new kh($p.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new $p(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Vr(new $p(e,t))}mr(e,t){e.forEach(e=>this.removeReference(e,t))}gr(e){const t=new ch(new oh([])),n=new $p(t,e),i=new $p(t,e+1),r=[];return this.dr.forEachInRange([n,i],e=>{this.Vr(e),r.push(e.key)}),r}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new ch(new oh([])),n=new $p(t,e),i=new $p(t,e+1);let r=nf();return this.dr.forEachInRange([n,i],e=>{r=r.add(e.key)}),r}containsKey(e){const t=new $p(e,0),n=this.Tr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class $p{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return ch.comparator(e.key,t.key)||th(e.wr,t.wr)}static Ar(e,t){return th(e.wr,t.wr)||ch.comparator(e.key,t.key)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Xp{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new kh($p.Er)}checkEmpty(e){return mh.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const r=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Nf(r,t,n,i);this.mutationQueue.push(s);for(const o of i)this.br=this.br.add(new $p(o.key,r)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return mh.resolve(s)}lookupMutationBatch(e,t){return mh.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.vr(n),r=i<0?0:i;return mh.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return mh.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return mh.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new $p(t,0),i=new $p(t,Number.POSITIVE_INFINITY),r=[];return this.br.forEachInRange([n,i],e=>{const t=this.Dr(e.wr);r.push(t)}),mh.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new kh(th);return t.forEach(e=>{const t=new $p(e,0),i=new $p(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,i],e=>{n=n.add(e.wr)})}),mh.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let r=n;ch.isDocumentKey(r)||(r=r.child(""));const s=new $p(new ch(r),0);let o=new kh(th);return this.br.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===i&&(o=o.add(e.wr)),!0)},s),mh.resolve(this.Cr(o))}Cr(e){const t=[];return e.forEach(e=>{const n=this.Dr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){Uu(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.br;return mh.forEach(t.mutations,i=>{const r=new $p(i.key,t.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,t){const n=new $p(t,0),i=this.br.firstAfterOrEqual(n);return mh.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,mh.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Kp{constructor(e){this.Mr=e,this.docs=new Ch(ch.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),r=i?i.size:0,s=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return mh.resolve(n?n.document.mutableCopy():rd.newInvalidDocument(t))}getEntries(e,t){let n=Xd();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():rd.newInvalidDocument(e))}),mh.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let r=Xd();const s=t.path,o=new ch(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||dh(uh(o),n)<=0||(i.has(o.key)||Wd(t,o))&&(r=r.insert(o.key,o.mutableCopy()))}return mh.resolve(r)}getAllFromCollectionGroup(e,t,n,i){Fu()}Or(e,t){return mh.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Gp(this)}getSize(e){return mh.resolve(this.size)}}class Gp extends Fp{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),mh.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Yp{constructor(e){this.persistence=e,this.Nr=new Hd(e=>Id(e),_d),this.lastRemoteSnapshotVersion=rh.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Hp,this.targetCount=0,this.kr=Vp.Bn()}forEachTarget(e,t){return this.Nr.forEach((e,n)=>t(n)),mh.resolve()}getLastRemoteSnapshotVersion(e){return mh.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return mh.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),mh.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),mh.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Vp(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,mh.resolve()}updateTargetData(e,t){return this.Kn(t),mh.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,mh.resolve()}removeTargets(e,t,n){let i=0;const r=[];return this.Nr.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Nr.delete(s),r.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),mh.waitFor(r).next(()=>i)}getTargetCount(e){return mh.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return mh.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),mh.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const i=this.persistence.referenceDelegate,r=[];return i&&t.forEach(t=>{r.push(i.markPotentiallyOrphaned(e,t))}),mh.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),mh.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return mh.resolve(n)}containsKey(e,t){return mh.resolve(this.Br.containsKey(t))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Qp{constructor(e,t){this.qr={},this.overlays={},this.Qr=new vh(0),this.Kr=!1,this.Kr=!0,this.$r=new qp,this.referenceDelegate=e(this),this.Ur=new Yp(this),this.indexManager=new Np,this.remoteDocumentCache=new Kp(e=>this.referenceDelegate.Wr(e)),this.serializer=new Rp(t),this.Gr=new Wp(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Bp,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new Xp(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){Ou("MemoryPersistence","Starting transaction:",e);const i=new Jp(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(e=>this.referenceDelegate.jr(i).next(()=>e)).toPromise().then(e=>(i.raiseOnCommittedEvent(),e))}Hr(e,t){return mh.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,t)))}}class Jp extends fh{constructor(e){super(),this.currentSequenceNumber=e}}class Zp{constructor(e){this.persistence=e,this.Jr=new Hp,this.Yr=null}static Zr(e){return new Zp(e)}get Xr(){if(this.Yr)return this.Yr;throw Fu()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),mh.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),mh.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),mh.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(e=>this.Xr.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.Xr.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return mh.forEach(this.Xr,n=>{const i=ch.fromPath(n);return this.ei(e,i).next(e=>{e||t.removeEntry(i,rh.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return mh.or([()=>mh.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class em{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=i}static Wi(e,t){let n=nf(),i=nf();for(const r of t.docChanges)switch(r.type){case 0:n=n.add(r.doc.key);break;case 1:i=i.add(r.doc.key)}return new em(e,t.fromCache,n,i)}}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class tm{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class nm{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=Gs()?8:function(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}(Ks())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,i){const r={result:null};return this.Yi(e,t).next(e=>{r.result=e}).next(()=>{if(!r.result)return this.Zi(e,t,i,n).next(e=>{r.result=e})}).next(()=>{if(r.result)return;const n=new tm;return this.Xi(e,t,n).next(i=>{if(r.result=i,this.zi)return this.es(e,t,n,i.size)})}).next(()=>r.result)}es(e,t,n,i){return n.documentReadCount<this.ji?(Ru()<=co.DEBUG&&Ou("QueryEngine","SDK will not create cache indexes for query:",zd(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),mh.resolve()):(Ru()<=co.DEBUG&&Ou("QueryEngine","Query:",zd(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(Ru()<=co.DEBUG&&Ou("QueryEngine","The SDK decides to create cache indexes for query:",zd(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Nd(t))):mh.resolve())}Yi(e,t){if(Ad(t))return mh.resolve(null);let n=Nd(t);return this.indexManager.getIndexType(e,n).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=Vd(t,null,"F"),n=Nd(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const r=nf(...i);return this.Ji.getDocuments(e,r).next(i=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.ts(t,i);return this.ns(t,s,r,n.readTime)?this.Yi(e,Vd(t,null,"F")):this.rs(e,s,t,n)}))})))}Zi(e,t,n,i){return Ad(t)||i.isEqual(rh.min())?mh.resolve(null):this.Ji.getDocuments(e,n).next(r=>{const s=this.ts(t,r);return this.ns(t,s,n,i)?mh.resolve(null):(Ru()<=co.DEBUG&&Ou("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),zd(t)),this.rs(e,s,t,function(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,r=rh.fromTimestamp(1e9===i?new ih(n+1,0):new ih(n,i));return new hh(r,ch.empty(),t)}(i,-1)).next(e=>e))})}ts(e,t){let n=new kh(Bd(e));return t.forEach((t,i)=>{Wd(e,i)&&(n=n.add(i))}),n}ns(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const r="F"===e.limitType?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Xi(e,t,n){return Ru()<=co.DEBUG&&Ou("QueryEngine","Using full collection scan to execute query:",zd(t)),this.Ji.getDocumentsMatchingQuery(e,t,hh.min(),n)}rs(e,t,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class im{constructor(e,t,n,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Ch(th),this._s=new Hd(e=>Id(e),_d),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new zp(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function rm(e,t){return p(this,null,function*(){const n=zu(e);return yield n.persistence.runTransaction("Handle user change","readonly",e=>{let i;return n.mutationQueue.getAllMutationBatches(e).next(r=>(i=r,n.ls(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const r=[],s=[];let o=nf();for(const e of i){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({hs:e,removedBatchIds:r,addedBatchIds:s}))})})})}function sm(e){const t=zu(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Ur.getLastRemoteSnapshotVersion(e))}function om(e,t){const n=zu(e),i=t.snapshotVersion;let r=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.cs.newChangeBuffer({trackRemovals:!0});r=n.os;const o=[];t.targetChanges.forEach((s,a)=>{const l=r.get(a);if(!l)return;o.push(n.Ur.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.Ur.addMatchingKeys(e,s.addedDocuments,a)));let c=l.withSequenceNumber(e.currentSequenceNumber);var u,h,d;null!==t.targetMismatches.get(a)?c=c.withResumeToken(jh.EMPTY_BYTE_STRING,rh.min()).withLastLimboFreeSnapshotVersion(rh.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,i)),r=r.insert(a,c),h=c,d=s,(0===(u=l).resumeToken.approximateByteSize()||h.snapshotVersion.toMicroseconds()-u.snapshotVersion.toMicroseconds()>=3e8||d.addedDocuments.size+d.modifiedDocuments.size+d.removedDocuments.size>0)&&o.push(n.Ur.updateTargetData(e,c))});let a=Xd(),l=nf();if(t.documentUpdates.forEach(i=>{t.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,i))}),o.push(function(e,t,n){let i=nf(),r=nf();return n.forEach(e=>i=i.add(e)),t.getEntries(e,i).next(e=>{let i=Xd();return n.forEach((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(r=r.add(n)),s.isNoDocument()&&s.version.isEqual(rh.min())?(t.removeEntry(n,s.readTime),i=i.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),i=i.insert(n,s)):Ou("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{Ps:i,Is:r}})}(e,s,t.documentUpdates).next(e=>{a=e.Ps,l=e.Is})),!i.isEqual(rh.min())){const t=n.Ur.getLastRemoteSnapshotVersion(e).next(t=>n.Ur.setTargetsMetadata(e,e.currentSequenceNumber,i));o.push(t)}return mh.waitFor(o).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,l)).next(()=>a)}).then(e=>(n.os=r,e))}function am(e,t){const n=zu(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function lm(e,t,n){return p(this,null,function*(){const i=zu(e),r=i.os.get(t),s=n?"readwrite":"readwrite-primary";try{n||(yield i.persistence.runTransaction("Release target",s,e=>i.persistence.referenceDelegate.removeTarget(e,r)))}catch(o){if(!gh(o))throw o;Ou("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}i.os=i.os.remove(t),i._s.delete(r.target)})}function cm(e,t,n){const i=zu(e);let r=rh.min(),s=nf();return i.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const i=zu(e),r=i._s.get(n);return void 0!==r?mh.resolve(i.os.get(r)):i.Ur.getTargetData(t,n)}(i,e,Nd(t)).next(t=>{if(t)return r=t.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>i.ss.getDocumentsMatchingQuery(e,t,n?r:rh.min(),n?s:nf())).next(e=>(function(e,t,n){let i=e.us.get(t)||rh.min();n.forEach((e,t)=>{t.readTime.compareTo(i)>0&&(i=t.readTime)}),e.us.set(t,i)}(i,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,Ts:s})))}class um{constructor(){this.activeTargetIds=rf}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class hm{constructor(){this.so=new um,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new um,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class dm{_o(e){}shutdown(){}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class fm{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Ou("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Ou("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */let pm=null;function mm(){return null===pm?pm=268435456+Math.round(2147483648*Math.random()):pm++,"0x"+pm.toString(16)
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}const gm={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class vm{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const ym="WebChannelConnection";class bm extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo=`projects/${n}/databases/${i}`,this.Co="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${i}`}get Fo(){return!1}Mo(e,t,n,i,r){const s=mm(),o=this.xo(e,t.toUriEncodedString());Ou("RestConnection",`Sending RPC '${e}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(a,i,r),this.No(e,o,a,n).then(t=>(Ou("RestConnection",`Received RPC '${e}' ${s}: `,t),t),t=>{throw Lu("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t})}Lo(e,t,n,i,r,s){return this.Mo(e,t,n,i,r)}Oo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Mu,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}xo(e,t){const n=gm[e];return`${this.Do}/v1/${t}:${n}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,i){const r=mm();return new Promise((s,o)=>{const a=new wu;a.setWithCredentials(!0),a.listenOnce(Cu.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Tu.NO_ERROR:const t=a.getResponseJson();Ou(ym,`XHR for RPC '${e}' ${r} received:`,JSON.stringify(t)),s(t);break;case Tu.TIMEOUT:Ou(ym,`RPC '${e}' ${r} timed out`),o(new Bu(Wu.DEADLINE_EXCEEDED,"Request time out"));break;case Tu.HTTP_ERROR:const n=a.getStatus();if(Ou(ym,`RPC '${e}' ${r} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Wu).indexOf(t)>=0?t:Wu.UNKNOWN}(t.status);o(new Bu(e,t.message))}else o(new Bu(Wu.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Bu(Wu.UNAVAILABLE,"Connection failed."));break;default:Fu()}}finally{Ou(ym,`RPC '${e}' ${r} completed.`)}});const l=JSON.stringify(i);Ou(ym,`RPC '${e}' ${r} sending request:`,i),a.send(t,"POST",l,n,15)})}Bo(e,t,n){const i=mm(),r=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Iu(),o=Du(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Oo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const c=r.join("");Ou(ym,`Creating RPC '${e}' stream ${i}: ${c}`,a);const u=s.createWebChannel(c,a);let h=!1,d=!1;const f=new vm({Io:t=>{d?Ou(ym,`Not sending because RPC '${e}' stream ${i} is closed:`,t):(h||(Ou(ym,`Opening RPC '${e}' stream ${i} transport.`),u.open(),h=!0),Ou(ym,`RPC '${e}' stream ${i} sending:`,t),u.send(t))},To:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(t){setTimeout(()=>{throw t},0)}})};return p(u,Su.EventType.OPEN,()=>{d||(Ou(ym,`RPC '${e}' stream ${i} transport opened.`),f.yo())}),p(u,Su.EventType.CLOSE,()=>{d||(d=!0,Ou(ym,`RPC '${e}' stream ${i} transport closed`),f.So())}),p(u,Su.EventType.ERROR,t=>{d||(d=!0,Lu(ym,`RPC '${e}' stream ${i} transport errored:`,t),f.So(new Bu(Wu.UNAVAILABLE,"The operation could not be completed")))}),p(u,Su.EventType.MESSAGE,t=>{var n;if(!d){const r=t.data[0];Uu(!!r);const s=r,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){Ou(ym,`RPC '${e}' stream ${i} received error:`,o);const t=o.status;let n=function(e){const t=Uf[e];if(void 0!==t)return Wf(t)}(t),r=o.message;void 0===n&&(n=Wu.INTERNAL,r="Unknown error status: "+t+" with message "+o.message),d=!0,f.So(new Bu(n,r)),u.close()}else Ou(ym,`RPC '${e}' stream ${i} received:`,r),f.bo(r)}}),p(o,ku.STAT_EVENT,t=>{t.stat===Eu.PROXY?Ou(ym,`RPC '${e}' stream ${i} detected buffering proxy`):t.stat===Eu.NOPROXY&&Ou(ym,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{f.wo()},0),f}}function xm(){return"undefined"!=typeof document?document:null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function wm(e){return new op(e,!0)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Sm{constructor(e,t,n=1e3,i=1.5,r=6e4){this.ui=e,this.timerId=t,this.ko=n,this.qo=i,this.Qo=r,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-n);i>0&&Ou("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Cm{constructor(e,t,n,i,r,s,o,a){this.ui=e,this.Ho=n,this.Jo=i,this.connection=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Sm(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}stop(){return p(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return p(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return p(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===Wu.RESOURCE_EXHAUSTED?(Nu(t.toString()),Nu("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===Wu.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,n])=>{this.Yo===t&&this.P_(e,n)},t=>{e(()=>{const e=new Bu(Wu.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)})})}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(e=>{n(()=>this.I_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.e_?this.E_(e):this.onNext(e))})}i_(){this.state=5,this.t_.Go(()=>p(this,null,function*(){this.state=0,this.start()}))}I_(e){return Ou("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(Ou("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Tm extends Cm{constructor(e,t,n,i,r,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,s),this.serializer=r}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r="NO_CHANGE"===(i=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Fu(),s=t.targetChange.targetIds||[],o=function(e,t){return e.useProto3Json?(Uu(void 0===t||"string"==typeof t),jh.fromBase64String(t||"")):(Uu(void 0===t||t instanceof Buffer||t instanceof Uint8Array),jh.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,l=a&&function(e){const t=void 0===e.code?Wu.UNKNOWN:Wf(e.code);return new Bu(t,e.message||"")}(a);n=new Jf(r,s,o,l||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const r=gp(e,i.document.name),s=hp(i.document.updateTime),o=i.document.createTime?hp(i.document.createTime):rh.min(),a=new nd({mapValue:{fields:i.document.fields}}),l=rd.newFoundDocument(r,s,o,a),c=i.targetIds||[],u=i.removedTargetIds||[];n=new Yf(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const r=gp(e,i.document),s=i.readTime?hp(i.readTime):rh.min(),o=rd.newNoDocument(r,s),a=i.removedTargetIds||[];n=new Yf([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const r=gp(e,i.document),s=i.removedTargetIds||[];n=new Yf([],s,r,null)}else{if(!("filter"in t))return Fu();{t.filter;const e=t.filter;e.targetId;const{count:i=0,unchangedNames:r}=e,s=new Ff(i,r),o=e.targetId;n=new Qf(o,s)}}var i;return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return rh.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?rh.min():t.readTime?hp(t.readTime):rh.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=yp(this.serializer),t.addTarget=function(e,t){let n;const i=t.target;if(n=jd(i)?{documents:wp(e,i)}:{query:Sp(e,i)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=cp(e,t.resumeToken);const i=ap(e,t.expectedCount);null!==i&&(n.expectedCount=i)}else if(t.snapshotVersion.compareTo(rh.min())>0){n.readTime=lp(e,t.snapshotVersion.toTimestamp());const i=ap(e,t.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Fu()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=yp(this.serializer),t.removeTarget=e,this.a_(t)}}class Em extends Cm{constructor(e,t,n,i,r,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,s),this.serializer=r}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Uu(!!e.streamToken),this.lastStreamToken=e.streamToken,Uu(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){Uu(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(Uu(void 0!==t),e.map(e=>function(e,t){let n=e.updateTime?hp(e.updateTime):hp(t);return n.isEqual(rh.min())&&(n=hp(t)),new xf(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=hp(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=yp(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>function(e,t){let n;if(t instanceof _f)n={update:xp(e,t.key,t.value)};else if(t instanceof Rf)n={delete:mp(e,t.key)};else if(t instanceof jf)n={update:xp(e,t.key,t.data),updateMask:Pp(t.fieldMask)};else{if(!(t instanceof Of))return Fu();n={verify:mp(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof df)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ff)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof mf)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof vf)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw Fu()}(0,e))),t.precondition.isNone||(n.currentDocument=(i=e,void 0!==(r=t.precondition).updateTime?{updateTime:up(i,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:Fu())),n;var i,r}(this.serializer,e))};this.a_(t)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class km extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new Bu(Wu.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.connection.Mo(e,fp(t,n),i,r,s)).catch(e=>{throw"FirebaseError"===e.name?(e.code===Wu.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Bu(Wu.UNKNOWN,e.toString())})}Lo(e,t,n,i,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Lo(e,fp(t,n),i,s,o,r)).catch(e=>{throw"FirebaseError"===e.name?(e.code===Wu.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Bu(Wu.UNKNOWN,e.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class Dm{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Nu(t),this.D_=!1):Ou("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Im{constructor(e,t,n,i,r){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=r,this.k_._o(e=>{n.enqueueAndForget(()=>p(this,null,function*(){Lm(this)&&(Ou("RemoteStore","Restarting streams for network reachability change."),yield function(e){return p(this,null,function*(){const t=zu(e);t.L_.add(4),yield jm(t),t.q_.set("Unknown"),t.L_.delete(4),yield _m(t)})}(this))}))}),this.q_=new Dm(n,i)}}function _m(e){return p(this,null,function*(){if(Lm(e))for(const t of e.B_)yield t(!0)})}function jm(e){return p(this,null,function*(){for(const t of e.B_)yield t(!1)})}function Pm(e,t){const n=zu(e);n.N_.has(t.targetId)||(n.N_.set(t.targetId,t),Nm(n)?Om(n):tg(n).r_()&&Am(n,t))}function Mm(e,t){const n=zu(e),i=tg(n);n.N_.delete(t),i.r_()&&Rm(n,t),0===n.N_.size&&(i.r_()?i.o_():Lm(n)&&n.q_.set("Unknown"))}function Am(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(rh.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}tg(e).A_(t)}function Rm(e,t){e.Q_.xe(t),tg(e).R_(t)}function Om(e){e.Q_=new ep({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),tg(e).start(),e.q_.v_()}function Nm(e){return Lm(e)&&!tg(e).n_()&&e.N_.size>0}function Lm(e){return 0===zu(e).L_.size}function Vm(e){e.Q_=void 0}function Fm(e){return p(this,null,function*(){e.q_.set("Online")})}function Um(e){return p(this,null,function*(){e.N_.forEach((t,n)=>{Am(e,t)})})}function zm(e,t){return p(this,null,function*(){Vm(e),Nm(e)?(e.q_.M_(t),Om(e)):e.q_.set("Unknown")})}function Wm(e,t,n){return p(this,null,function*(){if(e.q_.set("Online"),t instanceof Jf&&2===t.state&&t.cause)try{yield function(e,t){return p(this,null,function*(){const n=t.cause;for(const i of t.targetIds)e.N_.has(i)&&(yield e.remoteSyncer.rejectListen(i,n),e.N_.delete(i),e.Q_.removeTarget(i))})}(e,t)}catch(i){Ou("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),i),yield Bm(e,i)}else if(t instanceof Yf?e.Q_.Ke(t):t instanceof Qf?e.Q_.He(t):e.Q_.We(t),!n.isEqual(rh.min()))try{const t=yield sm(e.localStore);n.compareTo(t)>=0&&(yield function(e,t){const n=e.Q_.rt(t);return n.targetChanges.forEach((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=e.N_.get(i);r&&e.N_.set(i,r.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const i=e.N_.get(t);if(!i)return;e.N_.set(t,i.withResumeToken(jh.EMPTY_BYTE_STRING,i.snapshotVersion)),Rm(e,t);const r=new Ap(i.target,t,n,i.sequenceNumber);Am(e,r)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n))}catch(r){Ou("RemoteStore","Failed to raise snapshot:",r),yield Bm(e,r)}})}function Bm(e,t,n){return p(this,null,function*(){if(!gh(t))throw t;e.L_.add(1),yield jm(e),e.q_.set("Offline"),n||(n=()=>sm(e.localStore)),e.asyncQueue.enqueueRetryable(()=>p(this,null,function*(){Ou("RemoteStore","Retrying IndexedDB access"),yield n(),e.L_.delete(1),yield _m(e)}))})}function qm(e,t){return t().catch(n=>Bm(e,n,t))}function Hm(e){return p(this,null,function*(){const t=zu(e),n=ng(t);let i=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;$m(t);)try{const e=yield am(t.localStore,i);if(null===e){0===t.O_.length&&n.o_();break}i=e.batchId,Xm(t,e)}catch(r){yield Bm(t,r)}Km(t)&&Gm(t)})}function $m(e){return Lm(e)&&e.O_.length<10}function Xm(e,t){e.O_.push(t);const n=ng(e);n.r_()&&n.V_&&n.m_(t.mutations)}function Km(e){return Lm(e)&&!ng(e).n_()&&e.O_.length>0}function Gm(e){ng(e).start()}function Ym(e){return p(this,null,function*(){ng(e).p_()})}function Qm(e){return p(this,null,function*(){const t=ng(e);for(const n of e.O_)t.m_(n.mutations)})}function Jm(e,t,n){return p(this,null,function*(){const i=e.O_.shift(),r=Lf.from(i,t,n);yield qm(e,()=>e.remoteSyncer.applySuccessfulWrite(r)),yield Hm(e)})}function Zm(e,t){return p(this,null,function*(){t&&ng(e).V_&&(yield function(e,t){return p(this,null,function*(){if(function(e){switch(e){default:return Fu();case Wu.CANCELLED:case Wu.UNKNOWN:case Wu.DEADLINE_EXCEEDED:case Wu.RESOURCE_EXHAUSTED:case Wu.INTERNAL:case Wu.UNAVAILABLE:case Wu.UNAUTHENTICATED:return!1;case Wu.INVALID_ARGUMENT:case Wu.NOT_FOUND:case Wu.ALREADY_EXISTS:case Wu.PERMISSION_DENIED:case Wu.FAILED_PRECONDITION:case Wu.ABORTED:case Wu.OUT_OF_RANGE:case Wu.UNIMPLEMENTED:case Wu.DATA_LOSS:return!0}}(n=t.code)&&n!==Wu.ABORTED){const n=e.O_.shift();ng(e).s_(),yield qm(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),yield Hm(e)}var n})}(e,t)),Km(e)&&Gm(e)})}function eg(e,t){return p(this,null,function*(){const n=zu(e);n.asyncQueue.verifyOperationInProgress(),Ou("RemoteStore","RemoteStore received new credentials");const i=Lm(n);n.L_.add(3),yield jm(n),i&&n.q_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(t),n.L_.delete(3),yield _m(n)})}function tg(e){return e.K_||(e.K_=function(e,t,n){const i=zu(e);return i.w_(),new Tm(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{Eo:Fm.bind(null,e),Ro:Um.bind(null,e),mo:zm.bind(null,e),d_:Wm.bind(null,e)}),e.B_.push(t=>p(this,null,function*(){t?(e.K_.s_(),Nm(e)?Om(e):e.q_.set("Unknown")):(yield e.K_.stop(),Vm(e))}))),e.K_}function ng(e){return e.U_||(e.U_=function(e,t,n){const i=zu(e);return i.w_(),new Em(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Ym.bind(null,e),mo:Zm.bind(null,e),f_:Qm.bind(null,e),g_:Jm.bind(null,e)}),e.B_.push(t=>p(this,null,function*(){t?(e.U_.s_(),yield Hm(e)):(yield e.U_.stop(),e.O_.length>0&&(Ou("RemoteStore",`Stopping write stream with ${e.O_.length} pending writes`),e.O_=[]))}))),e.U_
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}class ig{constructor(e,t,n,i,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new qu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,r){const s=Date.now()+n,o=new ig(e,t,s,i,r);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Bu(Wu.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function rg(e,t){if(Nu("AsyncQueue",`${t}: ${e}`),gh(e))return new Bu(Wu.UNAVAILABLE,`${t}: ${e}`);throw e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class sg{constructor(e){this.comparator=e?(t,n)=>e(t,n)||ch.comparator(t.key,n.key):(e,t)=>ch.comparator(e.key,t.key),this.keyedMap=Gd(),this.sortedSet=new Ch(this.comparator)}static emptySet(e){return new sg(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof sg))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(!e.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new sg;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class og{constructor(){this.W_=new Ch(ch.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?0!==e.type&&3===n.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==n.type?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.W_=this.W_.remove(t):1===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Fu():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,n)=>{e.push(n)}),e}}class ag{constructor(e,t,n,i,r,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,r){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new ag(e,t,sg.emptySet(t),s,n,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Fd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class lg{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class cg{constructor(){this.queries=ug(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const n=zu(e),i=n.queries;n.queries=ug(),i.forEach((e,n)=>{for(const i of n.j_)i.onError(t)})}(this,new Bu(Wu.ABORTED,"Firestore shutting down"))}}function ug(){return new Hd(e=>Ud(e),Fd)}function hg(e,t){const n=zu(e);let i=!1;for(const r of t){const e=r.query,t=n.queries.get(e);if(t){for(const e of t.j_)e.X_(r)&&(i=!0);t.z_=r}}i&&fg(n)}function dg(e,t,n){const i=zu(e),r=i.queries.get(t);if(r)for(const s of r.j_)s.onError(n);i.queries.delete(t)}function fg(e){e.Y_.forEach(e=>{e.next()})}var pg,mg;(mg=pg||(pg={})).ea="default",mg.Cache="cache";class gg{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new ag(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache)return!0;if(!this.J_())return!0;const n="Offline"!==t;return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}oa(e){e=ag.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==pg.Cache}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class vg{constructor(e){this.key=e}}class yg{constructor(e){this.key=e}}class bg{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=nf(),this.mutatedKeys=nf(),this.Aa=Bd(e),this.Ra=new sg(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new og,i=t?t.Ra:this.Ra;let r=t?t.mutatedKeys:this.mutatedKeys,s=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((e,t)=>{const c=i.get(e),u=Wd(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.ga(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.Aa(u,a)>0||l&&this.Aa(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),r=d?r.add(e):r.delete(e)):(s=s.delete(e),r=r.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),r=r.delete(e.key),n.track({type:1,doc:e})}return{Ra:s,fa:n,ns:o,mutatedKeys:r}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const r=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const s=e.fa.G_();s.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Fu()}};return n(e)-n(t)}(e.type,t.type)||this.Aa(e.doc,t.doc)),this.pa(n),i=null!=i&&i;const o=t&&!i?this.ya():[],a=0===this.da.size&&this.current&&!i?1:0,l=a!==this.Ea;return this.Ea=a,0!==s.length||l?{snapshot:new ag(this.query,e.Ra,r,s,e.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new og,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(e=>this.Ta=this.Ta.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ta=this.Ta.delete(e)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=nf(),this.Ra.forEach(e=>{this.Sa(e.key)&&(this.da=this.da.add(e.key))});const t=[];return e.forEach(e=>{this.da.has(e)||t.push(new yg(e))}),this.da.forEach(n=>{e.has(n)||t.push(new vg(n))}),t}ba(e){this.Ta=e.Ts,this.da=nf();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return ag.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class xg{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class wg{constructor(e){this.key=e,this.va=!1}}class Sg{constructor(e,t,n,i,r,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new Hd(e=>Ud(e),Fd),this.Ma=new Map,this.xa=new Set,this.Oa=new Ch(ch.comparator),this.Na=new Map,this.La=new Hp,this.Ba={},this.ka=new Map,this.qa=Vp.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}function Cg(e,t,n=!0){return p(this,null,function*(){const i=qg(e);let r;const s=i.Fa.get(t);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.Da()):r=yield Eg(i,t,n,!0),r})}function Tg(e,t){return p(this,null,function*(){const n=qg(e);yield Eg(n,t,!0,!1)})}function Eg(e,t,n,i){return p(this,null,function*(){const r=yield function(e,t){const n=zu(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let i;return n.Ur.getTargetData(e,t).next(r=>r?(i=r,mh.resolve(i)):n.Ur.allocateTargetId(e).next(r=>(i=new Ap(t,r,"TargetPurposeListen",e.currentSequenceNumber),n.Ur.addTargetData(e,i).next(()=>i))))}).then(e=>{const i=n.os.get(e.targetId);return(null===i||e.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(e.targetId,e),n._s.set(t,e.targetId)),e})}(e.localStore,Nd(t)),s=r.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return i&&(a=yield function(e,t,n,i,r){return p(this,null,function*(){e.Ka=(t,n,i)=>function(e,t,n,i){return p(this,null,function*(){let r=t.view.ma(n);r.ns&&(r=yield cm(e.localStore,t.query,!1).then(({documents:e})=>t.view.ma(e,r)));const s=i&&i.targetChanges.get(t.targetId),o=i&&null!=i.targetMismatches.get(t.targetId),a=t.view.applyChanges(r,e.isPrimaryClient,s,o);return Vg(e,t.targetId,a.wa),a.snapshot})}(e,t,n,i);const s=yield cm(e.localStore,t,!0),o=new bg(t,s.Ts),a=o.ma(s.documents),l=Gf.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==e.onlineState,r),c=o.applyChanges(a,e.isPrimaryClient,l);Vg(e,n,c.wa);const u=new xg(t,n,o);return e.Fa.set(t,u),e.Ma.has(n)?e.Ma.get(n).push(t):e.Ma.set(n,[t]),c.snapshot})}(e,t,s,"current"===o,r.resumeToken)),e.isPrimaryClient&&n&&Pm(e.remoteStore,r),a})}function kg(e,t,n){return p(this,null,function*(){const i=zu(e),r=i.Fa.get(t),s=i.Ma.get(r.targetId);if(s.length>1)return i.Ma.set(r.targetId,s.filter(e=>!Fd(e,t))),void i.Fa.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||(yield lm(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),n&&Mm(i.remoteStore,r.targetId),Ng(i,r.targetId)}).catch(ph))):(Ng(i,r.targetId),yield lm(i.localStore,r.targetId,!0))})}function Dg(e,t){return p(this,null,function*(){const n=zu(e),i=n.Fa.get(t),r=n.Ma.get(i.targetId);n.isPrimaryClient&&1===r.length&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),Mm(n.remoteStore,i.targetId))})}function Ig(e,t,n){return p(this,null,function*(){const i=function(e){const t=zu(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Mg.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Ag.bind(null,t),t}(e);try{const e=yield function(e,t){const n=zu(e),i=ih.now(),r=t.reduce((e,t)=>e.add(t.key),nf());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=Xd(),l=nf();return n.cs.getEntries(e,r).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(r=>{s=r;const o=[];for(const e of t){const t=Df(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new jf(e.key,t,id(t.value.mapValue),wf.exists(!0)))}return n.mutationQueue.addMutationBatch(e,i,o,t)}).next(t=>{o=t;const i=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,i)})}).then(()=>({batchId:o.batchId,changes:Yd(s)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let i=e.Ba[e.currentUser.toKey()];i||(i=new Ch(th)),i=i.insert(t,n),e.Ba[e.currentUser.toKey()]=i}(i,e.batchId,n),yield zg(i,e.changes),yield Hm(i.remoteStore)}catch(r){const e=rg(r,"Failed to persist write");n.reject(e)}})}function _g(e,t){return p(this,null,function*(){const n=zu(e);try{const e=yield om(n.localStore,t);t.targetChanges.forEach((e,t)=>{const i=n.Na.get(t);i&&(Uu(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?i.va=!0:e.modifiedDocuments.size>0?Uu(i.va):e.removedDocuments.size>0&&(Uu(i.va),i.va=!1))}),yield zg(n,e,t)}catch(i){yield ph(i)}})}function jg(e,t,n){const i=zu(e);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const e=[];i.Fa.forEach((n,i)=>{const r=i.view.Z_(t);r.snapshot&&e.push(r.snapshot)}),function(e,t){const n=zu(e);n.onlineState=t;let i=!1;n.queries.forEach((e,n)=>{for(const r of n.j_)r.Z_(t)&&(i=!0)}),i&&fg(n)}(i.eventManager,t),e.length&&i.Ca.d_(e),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}function Pg(e,t,n){return p(this,null,function*(){const i=zu(e);i.sharedClientState.updateQueryState(t,"rejected",n);const r=i.Na.get(t),s=r&&r.key;if(s){let e=new Ch(ch.comparator);e=e.insert(s,rd.newNoDocument(s,rh.min()));const n=nf().add(s),r=new Kf(rh.min(),new Map,new Ch(th),e,n);yield _g(i,r),i.Oa=i.Oa.remove(s),i.Na.delete(t),Ug(i)}else yield lm(i.localStore,t,!1).then(()=>Ng(i,t,n)).catch(ph)})}function Mg(e,t){return p(this,null,function*(){const n=zu(e),i=t.batch.batchId;try{const e=yield function(e,t){const n=zu(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const i=t.batch.keys(),r=n.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,i){const r=n.batch,s=r.keys();let o=mh.resolve();return s.forEach(e=>{o=o.next(()=>i.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);Uu(null!==s),t.version.compareTo(s)<0&&(r.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),i.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,r))}(n,e,t,r).next(()=>r.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=nf();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,i))})}(n.localStore,t);Og(n,i,null),Rg(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),yield zg(n,e)}catch(r){yield ph(r)}})}function Ag(e,t,n){return p(this,null,function*(){const i=zu(e);try{const e=yield function(e,t){const n=zu(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let i;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(Uu(null!==t),i=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,i)).next(()=>n.localDocuments.getDocuments(e,i))})}(i.localStore,t);Og(i,t,n),Rg(i,t),i.sharedClientState.updateMutationState(t,"rejected",n),yield zg(i,e)}catch(r){yield ph(r)}})}function Rg(e,t){(e.ka.get(t)||[]).forEach(e=>{e.resolve()}),e.ka.delete(t)}function Og(e,t,n){const i=zu(e);let r=i.Ba[i.currentUser.toKey()];if(r){const e=r.get(t);e&&(n?e.reject(n):e.resolve(),r=r.remove(t)),i.Ba[i.currentUser.toKey()]=r}}function Ng(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.Ma.get(t))e.Fa.delete(i),n&&e.Ca.$a(i,n);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach(t=>{e.La.containsKey(t)||Lg(e,t)})}function Lg(e,t){e.xa.delete(t.path.canonicalString());const n=e.Oa.get(t);null!==n&&(Mm(e.remoteStore,n),e.Oa=e.Oa.remove(t),e.Na.delete(n),Ug(e))}function Vg(e,t,n){for(const i of n)i instanceof vg?(e.La.addReference(i.key,t),Fg(e,i)):i instanceof yg?(Ou("SyncEngine","Document no longer in limbo: "+i.key),e.La.removeReference(i.key,t),e.La.containsKey(i.key)||Lg(e,i.key)):Fu()}function Fg(e,t){const n=t.key,i=n.path.canonicalString();e.Oa.get(n)||e.xa.has(i)||(Ou("SyncEngine","New document in limbo: "+n),e.xa.add(i),Ug(e))}function Ug(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const n=new ch(oh.fromString(t)),i=e.qa.next();e.Na.set(i,new wg(n)),e.Oa=e.Oa.insert(n,i),Pm(e.remoteStore,new Ap(Nd(Md(n.path)),i,"TargetPurposeLimboResolution",vh.oe))}}function zg(e,t,n){return p(this,null,function*(){const i=zu(e),r=[],s=[],o=[];i.Fa.isEmpty()||(i.Fa.forEach((e,a)=>{o.push(i.Ka(a,t,n).then(e=>{var t;if((e||n)&&i.isPrimaryClient){const r=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(a.targetId))||void 0===t?void 0:t.current;i.sharedClientState.updateQueryState(a.targetId,r?"current":"not-current")}if(e){r.push(e);const t=em.Wi(a.targetId,e);s.push(t)}}))}),yield Promise.all(o),i.Ca.d_(r),yield function(e,t){return p(this,null,function*(){const n=zu(e);try{yield n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>mh.forEach(t,t=>mh.forEach(t.$i,i=>n.persistence.referenceDelegate.addReference(e,t.targetId,i)).next(()=>mh.forEach(t.Ui,i=>n.persistence.referenceDelegate.removeReference(e,t.targetId,i)))))}catch(i){if(!gh(i))throw i;Ou("LocalStore","Failed to update sequence numbers: "+i)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.os.get(t),i=e.snapshotVersion,r=e.withLastLimboFreeSnapshotVersion(i);n.os=n.os.insert(t,r)}}})}(i.localStore,s))})}function Wg(e,t){return p(this,null,function*(){const n=zu(e);if(!n.currentUser.isEqual(t)){Ou("SyncEngine","User change. New user:",t.toKey());const e=yield rm(n.localStore,t);n.currentUser=t,r="'waitForPendingWrites' promise is rejected due to a user change.",(i=n).ka.forEach(e=>{e.forEach(e=>{e.reject(new Bu(Wu.CANCELLED,r))})}),i.ka.clear(),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),yield zg(n,e.hs)}var i,r})}function Bg(e,t){const n=zu(e),i=n.Na.get(t);if(i&&i.va)return nf().add(i.key);{let e=nf();const i=n.Ma.get(t);if(!i)return e;for(const t of i){const i=n.Fa.get(t);e=e.unionWith(i.view.Va)}return e}}function qg(e){const t=zu(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=_g.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Bg.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Pg.bind(null,t),t.Ca.d_=hg.bind(null,t.eventManager),t.Ca.$a=dg.bind(null,t.eventManager),t}class Hg{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(e){return p(this,null,function*(){this.serializer=wm(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),yield this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)})}ja(e,t){return null}Ha(e,t){return null}za(e){return function(e,t,n,i){return new im(e,t,n,i)}(this.persistence,new nm,e.initialUser,this.serializer)}Ga(e){return new Qp(Zp.Zr,this.serializer)}Wa(e){return new hm}terminate(){return p(this,null,function*(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}Hg.provider={build:()=>new Hg};class $g{initialize(e,t){return p(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>jg(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Wg.bind(null,this.syncEngine),yield function(e,t){return p(this,null,function*(){const n=zu(e);t?(n.L_.delete(2),yield _m(n)):t||(n.L_.add(2),yield jm(n),n.q_.set("Unknown"))})}(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return new cg}createDatastore(e){const t=wm(e.databaseInfo.databaseId),n=(i=e.databaseInfo,new bm(i));var i;return function(e,t,n,i){return new km(e,t,n,i)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,i=e.asyncQueue,r=e=>jg(this.syncEngine,e,0),s=fm.D()?new fm:new dm,new Im(t,n,i,r,s);var t,n,i,r,s}createSyncEngine(e,t){return function(e,t,n,i,r,s,o){const a=new Sg(e,t,n,i,r,s);return o&&(a.Qa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return p(this,null,function*(){var e,t;yield function(e){return p(this,null,function*(){const t=zu(e);Ou("RemoteStore","RemoteStore shutting down."),t.L_.add(5),yield jm(t),t.k_.shutdown(),t.q_.set("Unknown")})}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()})}}$g.provider={build:()=>new $g};
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Xg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Nu("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Kg{constructor(e,t,n,i,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Pu.UNAUTHENTICATED,this.clientId=eh.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(n,e=>p(this,null,function*(){Ou("FirestoreClient","Received user=",e.uid),yield this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,e=>(Ou("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new qu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>p(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=rg(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}function Gg(e,t){return p(this,null,function*(){e.asyncQueue.verifyOperationInProgress(),Ou("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;yield t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener(e=>p(this,null,function*(){i.isEqual(e)||(yield rm(t.localStore,e),i=e)})),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t})}function Yg(e,t){return p(this,null,function*(){e.asyncQueue.verifyOperationInProgress();const n=yield function(e){return p(this,null,function*(){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Ou("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Gg(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!("FirebaseError"===(n=r).name?n.code===Wu.FAILED_PRECONDITION||n.code===Wu.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code))throw r;Lu("Error using user provided cache. Falling back to memory cache: "+r),yield Gg(e,new Hg)}}else Ou("FirestoreClient","Using default OfflineComponentProvider"),yield Gg(e,new Hg);var n;return e._offlineComponents})}(e);Ou("FirestoreClient","Initializing OnlineComponentProvider"),yield t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>eg(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>eg(t.remoteStore,n)),e._onlineComponents=t})}function Qg(e){return p(this,null,function*(){return e._onlineComponents||(e._uninitializedComponentsProvider?(Ou("FirestoreClient","Using user provided OnlineComponentProvider"),yield Yg(e,e._uninitializedComponentsProvider._online)):(Ou("FirestoreClient","Using default OnlineComponentProvider"),yield Yg(e,new $g))),e._onlineComponents})}function Jg(e){return p(this,null,function*(){const t=yield Qg(e),n=t.eventManager;return n.onListen=Cg.bind(null,t.syncEngine),n.onUnlisten=kg.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Tg.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Dg.bind(null,t.syncEngine),n})}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Zg(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}const ev=new Map;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function tv(e,t,n){if(!n)throw new Bu(Wu.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function nv(e){if(!ch.isDocumentKey(e))throw new Bu(Wu.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function iv(e){if(ch.isDocumentKey(e))throw new Bu(Wu.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function rv(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const n=(t=e).constructor?t.constructor.name:null;return n?`a custom ${n} object`:"an object"}}var t;return"function"==typeof e?"a function":Fu()}function sv(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Bu(Wu.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=rv(e);throw new Bu(Wu.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ov{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Bu(Wu.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Bu(Wu.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,i){if(!0===t&&!0===i)throw new Bu(Wu.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Zg(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Bu(Wu.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Bu(Wu.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Bu(Wu.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}class av{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ov({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Bu(Wu.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Bu(Wu.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ov(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new $u;switch(e.type){case"firstParty":return new Yu(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Bu(Wu.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return p(this,null,function*(){"notTerminated"===this._terminateTask?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=ev.get(e);t&&(Ou("ComponentProvider","Removing Datastore"),ev.delete(e),t.terminate())}(this),Promise.resolve()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class lv{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new lv(this.firestore,e,this._query)}}class cv{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new uv(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new cv(this.firestore,e,this._key)}}class uv extends lv{constructor(e,t,n){super(e,t,Md(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new cv(this.firestore,null,new ch(e))}withConverter(e){return new uv(this.firestore,e,this._path)}}function hv(e,t,...n){if(e=ro(e),1===arguments.length&&(t=eh.newId()),tv("doc","path",t),e instanceof av){const i=oh.fromString(t,...n);return nv(i),new cv(e,null,new ch(i))}{if(!(e instanceof cv||e instanceof uv))throw new Bu(Wu.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(oh.fromString(t,...n));return nv(i),new cv(e.firestore,e instanceof uv?e.converter:null,new ch(i))}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class dv{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Sm(this,"async_queue_retry"),this.Vu=()=>{const e=xm();e&&Ou("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=xm();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=xm();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new qu;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return p(this,null,function*(){if(0!==this.Pu.length){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!gh(e))throw e;Ou("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(e=>{throw this.Eu=e,this.du=!1,Nu("INTERNAL UNHANDLED ERROR: ",function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e}).then(e=>(this.du=!1,e))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=ig.createAndSchedule(this,e,t,n,e=>this.yu(e));return this.Tu.push(i),i}fu(){this.Eu&&Fu()}verifyOperationInProgress(){}wu(){return p(this,null,function*(){let e;do{e=this.mu,yield e}while(e!==this.mu)})}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function fv(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const i of t)if(i in n&&"function"==typeof n[i])return!0;return!1}(e,["next","error","complete"])}class pv extends av{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new dv,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return p(this,null,function*(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new dv(e),this._firestoreClient=void 0,yield e}})}}function mv(e){if(e._terminated)throw new Bu(Wu.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||function(e){var t,n,i;const r=e._freezeSettings(),s=(o=e._databaseId,a=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",l=e._persistenceKey,new Vh(o,a,l,(c=r).host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,Zg(c.experimentalLongPollingOptions),c.useFetchStreams));var o,a,l,c;e._componentsProvider||(null===(n=r.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(e._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),e._firestoreClient=new Kg(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e),e._firestoreClient}class gv{constructor(e){this._byteString=e}static fromBase64String(e){try{return new gv(jh.fromBase64String(e))}catch(t){throw new Bu(Wu.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new gv(jh.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class vv{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Bu(Wu.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lh(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class yv{constructor(e){this._methodName=e}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class bv{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Bu(Wu.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Bu(Wu.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return th(this._lat,e._lat)||th(this._long,e._long)}}
/**
     * @license
     * Copyright 2024 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class xv{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const wv=/^__.*__$/;class Sv{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new jf(e,this.data,this.fieldMask,t,this.fieldTransforms):new _f(e,this.data,t,this.fieldTransforms)}}class Cv{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new jf(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Tv(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Fu()}}class Ev{constructor(e,t,n,i,r,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.vu(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Ev(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Lv(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(Tv(this.Cu)&&wv.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class kv{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||wm(e)}Qu(e,t,n,i=!1){return new Ev({Cu:e,methodName:t,qu:n,path:lh.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Dv(e){const t=e._freezeSettings(),n=wm(e._databaseId);return new kv(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Iv(e,t,n,i,r,s={}){const o=e.Qu(s.merge||s.mergeFields?2:0,t,n,r);Av("Data must be an object, but it was:",o,i);const a=Pv(i,o);let l,c;if(s.merge)l=new Ih(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const i of s.mergeFields){const r=Rv(t,i,n);if(!o.contains(r))throw new Bu(Wu.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);Vv(e,r)||e.push(r)}l=new Ih(e),c=o.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=o.fieldTransforms;return new Sv(new nd(a),l,c)}class _v extends yv{_toFieldTransform(e){if(2!==e.Cu)throw 1===e.Cu?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof _v}}function jv(e,t){if(Mv(e=ro(e)))return Av("Unsupported field value:",t,e),Pv(e,t);if(e instanceof yv)return function(e,t){if(!Tv(t.Cu))throw t.Bu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Bu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const n=[];let i=0;for(const r of e){let e=jv(r,t.Lu(i));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),i++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=ro(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return af(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=ih.fromDate(e);return{timestampValue:lp(t.serializer,n)}}if(e instanceof ih){const n=new ih(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:lp(t.serializer,n)}}if(e instanceof bv)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof gv)return{bytesValue:cp(t.serializer,e._byteString)};if(e instanceof cv){const n=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(n))throw t.Bu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:dp(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof xv)return n=t,{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw n.Bu("VectorValues must only contain numeric values.");return sf(n.serializer,e)})}}}}};var n;throw t.Bu(`Unsupported field value: ${rv(e)}`)}(e,t)}function Pv(e,t){const n={};return Sh(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):wh(e,(e,i)=>{const r=jv(i,t.Mu(e));null!=r&&(n[e]=r)}),{mapValue:{fields:n}}}function Mv(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ih||e instanceof bv||e instanceof gv||e instanceof cv||e instanceof yv||e instanceof xv)}function Av(e,t,n){if(!Mv(n)||"object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const i=rv(n);throw"an object"===i?t.Bu(e+" a custom object"):t.Bu(e+" "+i)}var i}function Rv(e,t,n){if((t=ro(t))instanceof vv)return t._internalPath;if("string"==typeof t)return Nv(e,t);throw Lv("Field path arguments must be of type string or ",e,!1,void 0,n)}const Ov=new RegExp("[~\\*/\\[\\]]");function Nv(e,t,n){if(t.search(Ov)>=0)throw Lv(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new vv(...t.split("."))._internalPath}catch(i){throw Lv(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Lv(e,t,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new Bu(Wu.INVALID_ARGUMENT,a+e+l)}function Vv(e,t){return e.some(e=>e.isEqual(t))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Fv{constructor(e,t,n,i,r){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new cv(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Uv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(zv("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Uv extends Fv{data(){return super.data()}}function zv(e,t){return"string"==typeof t?Nv(e,t):t instanceof vv?t._internalPath:t._delegate._internalPath}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Wv{}class Bv extends Wv{}class qv extends Bv{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new qv(e,t,n)}_apply(e){const t=this._parse(e);return Gv(e._query,t),new lv(e.firestore,e.converter,Ld(e._query,t))}_parse(e){const t=Dv(e.firestore),n=function(e,t,n,i,r,s,o){let a;if(r.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new Bu(Wu.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){Kv(o,s);const t=[];for(const n of o)t.push(Xv(i,e,n));a={arrayValue:{values:t}}}else a=Xv(i,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Kv(o,s),a=function(e,t,n,i=!1){return jv(n,e.Qu(i?4:3,t))}(n,t,o,"in"===s||"not-in"===s);return hd.create(r,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class Hv extends Wv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Hv(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:dd.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const i=t.getFlattenedFilters();for(const r of i)Gv(n,r),n=Ld(n,r)}(e._query,t),new lv(e.firestore,e.converter,Ld(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class $v extends Bv{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new $v(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Bu(Wu.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Bu(Wu.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ld(t,n)}(e._query,this._field,this._direction);return new lv(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Pd(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Xv(e,t,n){if("string"==typeof(n=ro(n))){if(""===n)throw new Bu(Wu.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Rd(t)&&-1!==n.indexOf("/"))throw new Bu(Wu.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=t.path.child(oh.fromString(n));if(!ch.isDocumentKey(i))throw new Bu(Wu.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Gh(e,new ch(i))}if(n instanceof cv)return Gh(e,n._key);throw new Bu(Wu.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${rv(n)}.`)}function Kv(e,t){if(!Array.isArray(e)||0===e.length)throw new Bu(Wu.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Gv(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Bu(Wu.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Bu(Wu.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class Yv{convertValue(e,t="none"){switch(zh(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ah(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Rh(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Fu()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return wh(e,(e,i)=>{n[e]=this.convertValue(i,t)}),n}convertVectorValue(e){var t,n,i;const r=null===(i=null===(n=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===i?void 0:i.map(e=>Ah(e.doubleValue));return new xv(r)}convertGeoPoint(e){return new bv(Ah(e.latitude),Ah(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Nh(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Lh(e));default:return null}}convertTimestamp(e){const t=Mh(e);return new ih(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=oh.fromString(e);Uu(Mp(n));const i=new Fh(n.get(1),n.get(3)),r=new ch(n.popFirst(5));return i.isEqual(t)||Nu(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Qv{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Jv extends Fv{constructor(e,t,n,i,r,s){super(e,t,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Zv(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(zv("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Zv extends Jv{data(e={}){return super.data(e)}}class ey{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Qv(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Zv(this._firestore,this._userDataWriter,n.key,n,new Qv(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Bu(Wu.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const i=new Zv(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Qv(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const i=new Zv(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Qv(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let r=-1,s=-1;return 0!==t.type&&(r=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:ty(t.type),doc:i,oldIndex:r,newIndex:s}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function ty(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Fu()}}class ny extends Yv{constructor(e){super(),this.firestore=e}convertBytes(e){return new gv(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new cv(this.firestore,null,t)}}function iy(e,t,n,...i){e=sv(e,cv);const r=sv(e.firestore,pv),s=Dv(r);let o;return o="string"==typeof(t=ro(t))||t instanceof vv?function(e,t,n,i,r,s){const o=e.Qu(1,t,n),a=[Rv(t,i,n)],l=[r];if(s.length%2!=0)throw new Bu(Wu.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(Rv(t,s[d])),l.push(s[d+1]);const c=[],u=nd.empty();for(let d=a.length-1;d>=0;--d)if(!Vv(c,a[d])){const e=a[d];let t=l[d];t=ro(t);const n=o.Nu(e);if(t instanceof _v)c.push(e);else{const i=jv(t,n);null!=i&&(c.push(e),u.set(e,i))}}const h=new Ih(c);return new Cv(u,h,o.fieldTransforms)}(s,"updateDoc",e._key,t,n,i):function(e,t,n,i){const r=e.Qu(1,t,n);Av("Data must be an object, but it was:",r,i);const s=[],o=nd.empty();wh(i,(e,i)=>{const a=Nv(t,e,n);i=ro(i);const l=r.Nu(a);if(i instanceof _v)s.push(a);else{const e=jv(i,l);null!=e&&(s.push(a),o.set(a,e))}});const a=new Ih(s);return new Cv(o,a,r.fieldTransforms)}(s,"updateDoc",e._key,t),sy(r,[o.toMutation(e._key,wf.exists(!0))])}function ry(e,...t){var n,i,r;e=ro(e);let s={includeMetadataChanges:!1,source:"default"},o=0;"object"!=typeof t[o]||fv(t[o])||(s=t[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(fv(t[o])){const e=t[o];t[o]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[o+1]=null===(i=e.error)||void 0===i?void 0:i.bind(e),t[o+2]=null===(r=e.complete)||void 0===r?void 0:r.bind(e)}let l,c,u;if(e instanceof cv)c=sv(e.firestore,pv),u=Md(e._key.path),l={next:n=>{t[o]&&t[o](function(e,t,n){const i=n.docs.get(t._key),r=new ny(e);return new Jv(e,r,t._key,i,new Qv(n.hasPendingWrites,n.fromCache),t.converter)}(c,e,n))},error:t[o+1],complete:t[o+2]};else{const n=sv(e,lv);c=sv(n.firestore,pv),u=n._query;const i=new ny(c);l={next:e=>{t[o]&&t[o](new ey(c,i,n,e))},error:t[o+1],complete:t[o+2]},function(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Bu(Wu.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(e._query)}return function(e,t,n,i){const r=new Xg(i),s=new gg(t,r,n);return e.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){return function(t,n){return p(this,null,function*(){const i=zu(t);let r=3;const s=n.query;let o=i.queries.get(s);o?!o.H_()&&n.J_()&&(r=2):(o=new lg,r=n.J_()?0:1);try{switch(r){case 0:o.z_=yield i.onListen(s,!0);break;case 1:o.z_=yield i.onListen(s,!1);break;case 2:yield i.onFirstRemoteStoreListen(s)}}catch(e){const i=rg(e,`Initialization of query '${zd(n.query)}' failed`);return void n.onError(i)}i.queries.set(s,o),o.j_.push(n),n.Z_(i.onlineState),o.z_&&n.X_(o.z_)&&fg(i)})}(yield Jg(e),s)})),()=>{r.Za(),e.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){return function(e,t){return p(this,null,function*(){const n=zu(e),i=t.query;let r=3;const s=n.queries.get(i);if(s){const e=s.j_.indexOf(t);e>=0&&(s.j_.splice(e,1),0===s.j_.length?r=t.J_()?0:1:!s.H_()&&t.J_()&&(r=2))}switch(r){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}})}(yield Jg(e),s)}))}}(mv(c),u,a,l)}function sy(e,t){return function(e,t){const n=new qu;return e.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){return Ig(yield function(e){return Qg(e).then(e=>e.syncEngine)}(e),t,n)})),n.promise}(mv(e),t)}!function(e,t=!0){Mu=wa,ga(new so("firestore",(e,{instanceIdentifier:n,options:i})=>{const r=e.getProvider("app").getImmediate(),s=new pv(new Ku(e.getProvider("auth-internal")),new Ju(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Bu(Wu.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fh(e.options.projectId,t)}(r,n),r);return i=Object.assign({useFetchStreams:t},i),s._setSettings(i),s},"PUBLIC").setMultipleInstances(!0)),Ta(ju,"4.7.3",e),Ta(ju,"4.7.3","esm2017")}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const oy="firebasestorage.googleapis.com";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class ay extends Ys{constructor(e,t,n=0){super(dy(e),`Firebase Storage: ${t} (${dy(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ay.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return dy(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var ly,cy,uy,hy;function dy(e){return"storage/"+e}function fy(e){return new ay(ly.INVALID_ARGUMENT,e)}function py(){return new ay(ly.APP_DELETED,"The Firebase app was deleted.")}(cy=ly||(ly={})).UNKNOWN="unknown",cy.OBJECT_NOT_FOUND="object-not-found",cy.BUCKET_NOT_FOUND="bucket-not-found",cy.PROJECT_NOT_FOUND="project-not-found",cy.QUOTA_EXCEEDED="quota-exceeded",cy.UNAUTHENTICATED="unauthenticated",cy.UNAUTHORIZED="unauthorized",cy.UNAUTHORIZED_APP="unauthorized-app",cy.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",cy.INVALID_CHECKSUM="invalid-checksum",cy.CANCELED="canceled",cy.INVALID_EVENT_NAME="invalid-event-name",cy.INVALID_URL="invalid-url",cy.INVALID_DEFAULT_BUCKET="invalid-default-bucket",cy.NO_DEFAULT_BUCKET="no-default-bucket",cy.CANNOT_SLICE_BLOB="cannot-slice-blob",cy.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",cy.NO_DOWNLOAD_URL="no-download-url",cy.INVALID_ARGUMENT="invalid-argument",cy.INVALID_ARGUMENT_COUNT="invalid-argument-count",cy.APP_DELETED="app-deleted",cy.INVALID_ROOT_OPERATION="invalid-root-operation",cy.INVALID_FORMAT="invalid-format",cy.INTERNAL_ERROR="internal-error",cy.UNSUPPORTED_ENVIRONMENT="unsupported-environment";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class my{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=my.makeFromUrl(e,t)}catch(r){return new my(e,"")}if(""===n.path)return n;throw i=e,new ay(ly.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.");var i}static makeFromUrl(e,t){let n=null;const i="([A-Za-z0-9.\\-_]+)",r=new RegExp("^gs://"+i+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),a=[{regex:r,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp(`^https?://${t===oy?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let l=0;l<a.length;l++){const t=a[l],i=t.regex.exec(e);if(i){const e=i[t.indices.bucket];let r=i[t.indices.path];r||(r=""),n=new my(e,r),t.postModify(n);break}}if(null==n)throw function(e){return new ay(ly.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class gy{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function vy(e,t,n,i){if(i<t)throw fy(`Invalid value for '${e}'. Expected ${t} or greater.`);if(i>n)throw fy(`Invalid value for '${e}'. Expected ${n} or less.`)}(hy=uy||(uy={}))[hy.NO_ERROR=0]="NO_ERROR",hy[hy.NETWORK_ERROR=1]="NETWORK_ERROR",hy[hy.ABORT=2]="ABORT";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class yy{constructor(e,t,n,i,r,s,o,a,l,c,u,h=!0){this.url_=e,this.method_=t,this.headers_=n,this.body_=i,this.successCodes_=r,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=l,this.progressCallback_=c,this.connectionFactory_=u,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new by(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const i=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(i),n.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(i),this.pendingConnection_=null;const t=n.getErrorCode()===uy.NO_ERROR,r=n.getStatus();if(!t||
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e,t){const n=e>=500&&e<600,i=-1!==[408,429].indexOf(e),r=-1!==t.indexOf(e);return n||i||r}(r,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===uy.ABORT;return void e(!1,new by(!1,null,t))}const s=-1!==this.successCodes_.indexOf(r);e(!0,new by(s,n))})},t=(e,t)=>{const n=this.resolve_,i=this.reject_,r=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(r,r.getResponse());!
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e){return void 0!==e}(e)?n():n(e)}catch(s){i(s)}else if(null!==r){const e=new ay(ly.UNKNOWN,"An unknown error occurred, please check the error payload for server response.");e.serverResponse=r.getErrorText(),this.errorCallback_?i(this.errorCallback_(r,e)):i(e)}else t.canceled?i(this.appDelete_?py():new ay(ly.CANCELED,"User canceled the upload/download.")):i(new ay(ly.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))};this.canceled_?t(0,new by(!1,null,!0)):this.backoffId_=function(e,t,n){let i=1,r=null,s=null,o=!1,a=0;function l(){return 2===a}let c=!1;function u(...e){c||(c=!0,t.apply(null,e))}function h(t){r=setTimeout(()=>{r=null,e(f,l())},t)}function d(){s&&clearTimeout(s)}function f(e,...t){if(c)return void d();if(e)return d(),void u.call(null,e,...t);if(l()||o)return d(),void u.call(null,e,...t);let n;i<64&&(i*=2),1===a?(a=2,n=0):n=1e3*(i+Math.random()),h(n)}let p=!1;function m(e){p||(p=!0,d(),c||(null!==r?(e||(a=2),clearTimeout(r),h(0)):e||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,m(!0)},n),m}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class by{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function xy(e,t,n,i,r,s,o=!0){const a=function(e){const t=encodeURIComponent;let n="?";for(const i in e)e.hasOwnProperty(i)&&(n=n+(t(i)+"=")+t(e[i])+"&");return n=n.slice(0,-1),n}(e.urlParams),l=e.url+a,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(c,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,i),new yy(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,r,o)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class wy{constructor(e,t){this._service=e,this._location=t instanceof my?t:my.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new wy(e,t)}get root(){const e=new my(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return function(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new my(this._location.bucket,e);return new wy(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new ay(ly.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function Sy(e,t){const n=null==t?void 0:t.storageBucket;return null==n?null:my.makeFromBucketSpec(n,e)}class Cy{constructor(e,t,n,i,r){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=i,this._firebaseVersion=r,this._bucket=null,this._host=oy,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?my.makeFromBucketSpec(i,this._host):Sy(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=my.makeFromBucketSpec(this._url,e):this._bucket=Sy(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){vy("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){vy("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return p(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=yield e.getToken();if(null!==t)return t.accessToken}return null})}_getAppCheckToken(){return p(this,null,function*(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new wy(this,e)}_makeRequest(e,t,n,i,r=!0){if(this._deleted)return new gy(py());{const s=xy(e,this._appId,n,i,t,this._firebaseVersion,r);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}makeRequestWithTokens(e,t){return p(this,null,function*(){const[n,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,i).getPromise()})}}const Ty="@firebase/storage",Ey="0.13.2",ky="storage";function Dy(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return new Cy(n,i,r,t,wa)}ga(new so(ky,Dy,"PUBLIC").setMultipleInstances(!0)),Ta(Ty,Ey,""),Ta(Ty,Ey,"esm2017");const Iy={apiKey:"AIzaSyBXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",authDomain:"task-management-app-xxxxx.firebaseapp.com",projectId:"task-management-app-xxxxx",storageBucket:"task-management-app-xxxxx.appspot.com",messagingSenderId:"123456789012",appId:"1:123456789012:web:abcdefghijklmnop"},_y=Sa(Iy);!function(t=Ca()){const n=va(t,"auth");if(n.isInitialized())return n.getImmediate();const i=
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e,t){const n=va(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(Zs(n.getOptions(),null!=t?t:{}))return e;za(e,"already-initialized")}return n.initialize({options:t})}(t,{popupRedirectResolver:hu,persistence:[Ic,hc,fc]}),r=Hs("authTokenSyncURL");if(r&&"boolean"==typeof isSecureContext&&isSecureContext){const t=new URL(r,location.origin);if(location.origin===t.origin){const n=(s=t.toString(),t=>p(e,null,function*(){const e=t&&(yield t.getIdTokenResult()),n=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>mu)return;const i=null==e?void 0:e.token;gu!==i&&(gu=i,yield fetch(s,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))}));!function(e,t,n){ro(e).beforeAuthStateChanged(t,n)}(i,n,()=>n(i.currentUser)),function(e,t,n,i){ro(e).onIdTokenChanged(t,n,i)}(i,e=>n(e))}}var s;const o=Ws("auth");o&&$l(i,`http://${o}`)}(_y);const jy=function(e){const t="string"==typeof e?e:"(default)",n=va("object"==typeof e?e:Ca(),"firestore").getImmediate({identifier:t});if(!n._initialized){const e=Bs("firestore");e&&function(e,t,n,i={}){var r;const s=(e=sv(e,av))._getSettings(),o=`${t}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Lu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let t,n;if("string"==typeof i.mockUserToken)t=i.mockUserToken,n=Pu.MOCK_USER;else{t=Xs(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);const s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new Bu(Wu.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Pu(s)}e._authCredentials=new Xu(new Hu(t,n))}}(n,...e)}return n}(_y);!function(e=Ca(),t){const n=va(e=ro(e),ky).getImmediate({identifier:t}),i=Bs("storage");i&&function(e,t,n,i={}){!function(e,t,n,i={}){e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:r}=i;r&&(e._overrideAuthToken="string"==typeof r?r:Xs(r,e.app.options.projectId))}(e,t,n,i)}(n,...i)}(_y);const Py=(e,t)=>{try{if(console.log("Firebaseリスナーを設定中...",e),"AIzaSyBXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"===Iy.apiKey){console.log("Firebase設定がダミーのため、ローカルストレージを使用します"),(e=>{const t=localStorage.getItem(`tasks_${e}`);if(t){const n=JSON.parse(t),i=n.filter((e,t,n)=>t===n.findIndex(t=>t.id===e.id));if(i.length!==n.length)console.log("重複データをクリアしました"),localStorage.setItem(`tasks_${e}`,JSON.stringify(i))}})(e);const n=localStorage.getItem(`tasks_${e}`);if(console.log("ローカルストレージから取得したタスク:",n),n){const e=JSON.parse(n);console.log("パースしたタスク:",e),t(e)}else console.log("ローカルストレージにタスクがありません"),t([]);const i=setInterval(()=>{const n=localStorage.getItem(`tasks_${e}`);if(n){const e=JSON.parse(n);t(e)}else t([])},1e3);return()=>{clearInterval(i)}}const n=function(e,t,...n){if(e=ro(e),tv("collection","path",t),e instanceof av){const i=oh.fromString(t,...n);return iv(i),new uv(e,null,i)}{if(!(e instanceof cv||e instanceof uv))throw new Bu(Wu.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(oh.fromString(t,...n));return iv(i),new uv(e.firestore,null,i)}}(jy,"users",e,"tasks");return ry(function(e,t,...n){let i=[];t instanceof Wv&&i.push(t),i=i.concat(n),function(e){const t=e.filter(e=>e instanceof Hv).length,n=e.filter(e=>e instanceof qv).length;if(t>1||t>0&&n>0)throw new Bu(Wu.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)e=r._apply(e);return e}(n,function(e,t="asc"){const n=t,i=zv("orderBy",e);return $v._create(i,n)}("createdAt","desc")),e=>{const n=[];e.forEach(e=>{n.push(u({id:e.id},e.data()))}),console.log("Firebaseからタスクを取得:",n.length),t(n)},n=>{console.error("Firebaseリスナーエラー:",n);const i=localStorage.getItem(`tasks_${e}`);if(i){const e=JSON.parse(i);t(e)}})}catch(n){console.error("Firebaseリスナーの設定に失敗しました:",n);const i=localStorage.getItem(`tasks_${e}`);if(i){const e=JSON.parse(i);t(e)}return()=>{}}},My=(t,n)=>p(e,null,function*(){try{if(console.log("タスクを保存中...",n),"AIzaSyBXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"===Iy.apiKey){console.log("Firebase設定がダミーのため、ローカルストレージに保存します");const e=localStorage.getItem(`tasks_${t}`),i=e?JSON.parse(e):[],r=i.findIndex(e=>e.id===n.id);return-1!==r?(i[r]=u(u({},i[r]),n),console.log("既存のタスクを更新しました")):(i.push(n),console.log("新しいタスクを追加しました")),void localStorage.setItem(`tasks_${t}`,JSON.stringify(i))}const e=hv(jy,"users",t,"tasks",n.id);yield function(e,t,n){e=sv(e,cv);const i=sv(e.firestore,pv),r=function(e,t){let n;return n=e?e.toFirestore(t):t,n}(e.converter,t);return sy(i,[Iv(Dv(i),"setDoc",e._key,r,null!==e.converter,n).toMutation(e._key,wf.none())])}(e,n),console.log("タスク保存成功");const i=localStorage.getItem(`tasks_${t}`),r=i?JSON.parse(i):[],s=r.findIndex(e=>e.id===n.id);-1!==s?r[s]=u(u({},r[s]),n):r.push(n),localStorage.setItem(`tasks_${t}`,JSON.stringify(r))}catch(e){console.error("タスクの保存に失敗しました:",e);const i=localStorage.getItem(`tasks_${t}`),r=i?JSON.parse(i):[],s=r.findIndex(e=>e.id===n.id);throw-1!==s?r[s]=u(u({},r[s]),n):r.push(n),localStorage.setItem(`tasks_${t}`,JSON.stringify(r)),e}}),Ay=(t,n,i)=>p(e,null,function*(){try{if(console.log("タスクを更新中...",n,i),"AIzaSyBXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"===Iy.apiKey){console.log("Firebase設定がダミーのため、ローカルストレージを更新します");const e=localStorage.getItem(`tasks_${t}`);if(e){const r=JSON.parse(e).map(e=>e.id===n?u(u({},e),i):e);localStorage.setItem(`tasks_${t}`,JSON.stringify(r))}return}const e=hv(jy,"users",t,"tasks",n);yield iy(e,i),console.log("タスク更新成功");const r=localStorage.getItem(`tasks_${t}`);if(r){const e=JSON.parse(r).map(e=>e.id===n?u(u({},e),i):e);localStorage.setItem(`tasks_${t}`,JSON.stringify(e))}}catch(e){console.error("タスクの更新に失敗しました:",e);const r=localStorage.getItem(`tasks_${t}`);if(r){const e=JSON.parse(r).map(e=>e.id===n?u(u({},e),i):e);localStorage.setItem(`tasks_${t}`,JSON.stringify(e))}throw e}}),Ry=(t,n)=>p(e,null,function*(){try{if(console.log("タスクを削除中...",n),"AIzaSyBXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"===Iy.apiKey){console.log("Firebase設定がダミーのため、ローカルストレージから削除します");const e=localStorage.getItem(`tasks_${t}`);if(e){const i=JSON.parse(e).filter(e=>e.id!==n);localStorage.setItem(`tasks_${t}`,JSON.stringify(i)),console.log("ローカルストレージからタスクを削除しました"),setTimeout(()=>{const e=localStorage.getItem(`tasks_${t}`);if(e){const t=JSON.parse(e);console.log("削除後のタスク更新:",t)}},100)}return}const i=hv(jy,"users",t,"tasks",n);yield(e=i,sy(sv(e.firestore,pv),[new Rf(e._key,wf.none())])),console.log("タスク削除成功");const r=localStorage.getItem(`tasks_${t}`);if(r){const e=JSON.parse(r).filter(e=>e.id!==n);localStorage.setItem(`tasks_${t}`,JSON.stringify(e))}}catch(i){console.error("タスクの削除に失敗しました:",i);const e=localStorage.getItem(`tasks_${t}`);if(e){const i=JSON.parse(e).filter(e=>e.id!==n);localStorage.setItem(`tasks_${t}`,JSON.stringify(i))}throw i}var e}),Oy=({onMenuClick:e})=>{const t=Nt(),{user:n,logout:i}=Ds(),{isDarkMode:r,toggleTheme:s}=Ms(),[o,a]=Rt.useState(null),[l,c]=Rt.useState(null),[d,f]=Rt.useState([]),[p,m]=Rt.useState([]),g=()=>{if(!(null==n?void 0:n.id))return[];const e=localStorage.getItem(`notifications_${n.id}`);return e?JSON.parse(e):[]},y=e=>{(null==n?void 0:n.id)&&localStorage.setItem(`notifications_${n.id}`,JSON.stringify(e))},b=()=>{a(null),c(null)};Rt.useEffect(()=>{if(!(null==n?void 0:n.id))return;const e=g();f(e)},[null==n?void 0:n.id]),Rt.useEffect(()=>{if(!(null==n?void 0:n.id))return;const e=Py(n.id,e=>{m(e);const t=g(),n=((e,t)=>{const n=[],i=new Date;return e.forEach(e=>{const r=new Date(e.dueDate),s=Math.ceil((r.getTime()-i.getTime())/864e5);if(s<=1&&s>=0&&"done"!==e.status){const i=`due-${e.id}`;t.some(e=>e.id===i)||n.push({id:i,title:"タスクの期限が近づいています",message:`「${e.title}」の期限が${0===s?"今日":"明日"}です`,time:0===s?"今日":"明日",read:!1,type:"task",createdAt:(new Date).toISOString()})}}),e.filter(e=>{const t=new Date(e.createdAt);return(i.getTime()-t.getTime())/36e5<=24}).forEach(e=>{const i=`new-${e.id}`;t.some(e=>e.id===i)||n.push({id:i,title:"新しいタスクが作成されました",message:`「${e.title}」が作成されました`,time:"新着",read:!1,type:"task",createdAt:(new Date).toISOString()})}),n})(e,t),i=new Date;i.setDate(i.getDate()-7);const r=[...t.filter(e=>new Date(e.createdAt)>i),...n];f(r),y(r)});return()=>e()},[null==n?void 0:n.id]);const B=d.filter(e=>!e.read).length;return n?v.jsx(x,{position:"fixed",sx:{zIndex:e=>e.zIndex.drawer+1,backgroundColor:"#ffffff",color:"#1a1a1a",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.08)",borderBottom:"1px solid #e9ecef"},children:v.jsxs(w,{sx:{minHeight:"64px !important"},children:[v.jsx(S,{edge:"start",color:"inherit","aria-label":"menu",onClick:e,sx:{mr:2,color:"#6c757d","&:hover":{backgroundColor:"#f8f9fa"}},children:v.jsx(C,{})}),v.jsx(T,{variant:"h5",component:"div",sx:{flexGrow:1,fontWeight:700,color:"#6366f1",cursor:"pointer",fontSize:"1.5rem"},onClick:()=>t("/"),children:"TaskFlow"}),v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:1},children:[v.jsx(k,{title:"検索",children:v.jsx(S,{color:"inherit",sx:{color:"#6c757d","&:hover":{backgroundColor:"#f8f9fa"}},children:v.jsx(D,{})})}),v.jsx(k,{title:"新しいタスク",children:v.jsx(I,{size:"small",onClick:()=>t("/task/new"),sx:{backgroundColor:"#6366f1",color:"white",width:36,height:36,boxShadow:"0 2px 8px rgba(99, 102, 241, 0.3)","&:hover":{backgroundColor:"#4f46e5",boxShadow:"0 4px 12px rgba(99, 102, 241, 0.4)"}},children:v.jsx(_,{sx:{fontSize:18}})})}),v.jsx(k,{title:"通知",children:v.jsx(S,{color:"inherit",onClick:e=>{c(e.currentTarget)},sx:{color:"#6c757d","&:hover":{backgroundColor:"#f8f9fa"}},children:v.jsx(j,{badgeContent:B,color:"error",sx:{"& .MuiBadge-badge":{backgroundColor:"#dc3545",color:"white",fontSize:"0.75rem",fontWeight:600}},children:v.jsx(P,{})})})}),v.jsx(k,{title:r?"ライトモード":"ダークモード",children:v.jsx(S,{color:"inherit",onClick:s,sx:{color:"#6c757d","&:hover":{backgroundColor:"#f8f9fa"}},children:r?v.jsx(M,{}):v.jsx(A,{})})}),v.jsx(k,{title:"アカウント",children:v.jsx(S,{color:"inherit",onClick:e=>{a(e.currentTarget)},sx:{color:"#6c757d","&:hover":{backgroundColor:"#f8f9fa"}},children:v.jsx(R,{sx:{width:32,height:32,bgcolor:"#6366f1",fontSize:"0.875rem",fontWeight:600},children:n.name.charAt(0)})})})]}),v.jsxs(O,{anchorEl:l,open:Boolean(l),onClose:b,PaperProps:{sx:{width:360,maxHeight:400,borderRadius:2,boxShadow:"0 8px 24px rgba(0, 0, 0, 0.12)",border:"1px solid #e9ecef"}},children:[v.jsxs(E,{sx:{p:2,borderBottom:1,borderColor:"divider",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[v.jsx(T,{variant:"h6",sx:{fontWeight:600,color:"#1a1a1a"},children:"通知"}),B>0&&v.jsx(T,{variant:"body2",sx:{color:"#6366f1",cursor:"pointer",fontWeight:500,"&:hover":{textDecoration:"underline"}},onClick:()=>{const e=d.map(e=>h(u({},e),{read:!0}));f(e),y(e)},children:"すべて既読にする"})]}),d.map(e=>v.jsx(N,{onClick:()=>(e=>{const t=d.map(t=>t.id===e?h(u({},t),{read:!0}):t);f(t),y(t)})(e.id),sx:{py:1.5,px:2,backgroundColor:e.read?"transparent":"#f8f9fa","&:hover":{backgroundColor:"#f8f9fa"},cursor:"pointer"},children:v.jsxs(E,{sx:{width:"100%"},children:[v.jsx(T,{variant:"body2",sx:{fontWeight:500,mb:.5,color:e.read?"#6c757d":"#1a1a1a"},children:e.title}),v.jsx(T,{variant:"caption",color:"text.secondary",sx:{lineHeight:1.4},children:e.message}),v.jsx(T,{variant:"caption",color:"text.secondary",display:"block",sx:{mt:.5},children:e.time})]})},e.id)),0===d.length&&v.jsx(N,{children:v.jsx(T,{variant:"body2",color:"text.secondary",children:"通知はありません"})})]}),v.jsxs(O,{anchorEl:o,open:Boolean(o),onClose:b,PaperProps:{sx:{width:240,borderRadius:2,boxShadow:"0 8px 24px rgba(0, 0, 0, 0.12)",border:"1px solid #e9ecef"}},children:[v.jsx(E,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:2},children:[v.jsx(R,{sx:{width:48,height:48,bgcolor:"#6366f1",fontSize:"1.25rem",fontWeight:600},children:n.name.charAt(0)}),v.jsxs(E,{children:[v.jsx(T,{variant:"body1",sx:{fontWeight:600,color:"#1a1a1a"},children:n.name}),v.jsx(T,{variant:"caption",color:"text.secondary",children:n.email})]})]})}),v.jsxs(N,{onClick:()=>{t("/profile"),b()},sx:{py:1.5},children:[v.jsx(L,{children:v.jsx(V,{fontSize:"small",sx:{color:"#6c757d"}})}),v.jsx(F,{primary:"プロフィール",primaryTypographyProps:{sx:{fontWeight:500,color:"#1a1a1a"}}})]}),v.jsxs(N,{onClick:()=>{t("/settings"),b()},sx:{py:1.5},children:[v.jsx(L,{children:v.jsx(U,{fontSize:"small",sx:{color:"#6c757d"}})}),v.jsx(F,{primary:"設定",primaryTypographyProps:{sx:{fontWeight:500,color:"#1a1a1a"}}})]}),v.jsx(z,{}),v.jsxs(N,{onClick:()=>{i(),b(),t("/login")},sx:{py:1.5},children:[v.jsx(L,{children:v.jsx(W,{fontSize:"small",sx:{color:"#dc3545"}})}),v.jsx(F,{primary:"ログアウト",primaryTypographyProps:{sx:{fontWeight:500,color:"#dc3545"}}})]})]})]})}):null},Ny=({open:e,onToggle:t})=>{const n=Nt(),i=Lt(),{user:r}=Ds(),{isDarkMode:s,toggleTheme:o}=Ms(),[a,l]=Rt.useState(null),[c,u]=Rt.useState(null),[h,d]=Rt.useState([]),f=[{text:"ダッシュボード",icon:v.jsx(K,{}),path:"/",badge:null},{text:"カンバンボード",icon:v.jsx(G,{}),path:"/kanban",badge:null},{text:"カレンダー",icon:v.jsx(Y,{}),path:"/calendar",badge:null},{text:"タイムライン",icon:v.jsx(Q,{}),path:"/timeline",badge:null},{text:"リスト",icon:v.jsx(J,{}),path:"/list",badge:null}],p=[{text:"個人プロジェクト",icon:v.jsx(V,{}),path:"/workspace/personal",badge:0},{text:"チームA",icon:v.jsx(te,{}),path:"/workspace/team-a",badge:0},{text:"プロジェクトX",icon:v.jsx(te,{}),path:"/workspace/project-x",badge:0}],m=[{text:"個人プロジェクト",icon:v.jsx(V,{}),path:"/project/personal",badge:0},{text:"仕事",icon:v.jsx(Z,{}),path:"/project/work",badge:0},{text:"学習",icon:v.jsx(ee,{}),path:"/project/study",badge:0}];return Rt.useEffect(()=>{if(!(null==r?void 0:r.id))return;const e=Py(r.id,e=>{d(e),(()=>{const e=h.filter(e=>!e.assignee||"デモユーザー"===e.assignee||"個人"===e.assignee).length;p[0].badge=e>0?e:null;const t=h.filter(e=>"inProgress"===e.status).length;p[1].badge=t>0?t:null;const n=h.filter(e=>"high"===e.priority).length;p[2].badge=n>0?n:null,m[0].badge=e>0?e:null;const i=h.filter(e=>"仕事"===e.assignee||"high"===e.priority).length;m[1].badge=i>0?i:null;const r=h.filter(e=>"学習"===e.assignee||"medium"===e.priority).length;m[2].badge=r>0?r:null})()}),t=localStorage.getItem("currentProject"),n=localStorage.getItem("currentWorkspace");return t&&l(t),n&&u(n),()=>e()},[null==r?void 0:r.id]),Rt.useEffect(()=>{const e=localStorage.getItem("currentProject"),t=localStorage.getItem("currentWorkspace");e!==a&&l(e),t!==c&&u(t)},[]),r?v.jsxs(B,{variant:"permanent",open:e,sx:{width:e?240:64,flexShrink:0,"& .MuiDrawer-paper":{width:e?240:64,overflowX:"hidden",transition:"width 0.3s ease-in-out"}},children:[v.jsxs(E,{sx:{p:2,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e&&v.jsx(Yn.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3},children:v.jsx(T,{variant:"h6",sx:{fontWeight:600,color:"primary.main"},children:"TaskFlow"})}),v.jsx(k,{title:e?"サイドバーを閉じる":"サイドバーを開く",children:v.jsx(S,{onClick:t,size:"small",children:v.jsx(D,{})})})]}),v.jsx(z,{}),v.jsx(E,{sx:{p:2},children:v.jsx(k,{title:"新しいタスク",placement:"right",children:v.jsxs(S,{color:"primary",sx:{width:"100%",height:48,borderRadius:2,backgroundColor:"primary.main",color:"white","&:hover":{backgroundColor:"primary.dark"}},onClick:()=>n("/task/new"),children:[v.jsx(_,{}),e&&v.jsx(Yn.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3},style:{marginLeft:8},children:v.jsx(T,{variant:"body2",sx:{fontWeight:500},children:"新しいタスク"})})]})})}),v.jsx(z,{}),v.jsx(q,{sx:{px:1},children:f.map(t=>v.jsx(H,{disablePadding:!0,sx:{mb:.5},children:v.jsxs($,{onClick:()=>{return e=t.path,void n(e);var e},selected:i.pathname===t.path,sx:{borderRadius:2,minHeight:48,"&.Mui-selected":{backgroundColor:"primary.main",color:"white","&:hover":{backgroundColor:"primary.dark"}},"&:hover":{backgroundColor:"action.hover"}},children:[v.jsx(L,{sx:{minWidth:40,color:i.pathname===t.path?"white":"inherit"},children:t.icon}),e&&v.jsxs(Yn.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3},style:{flex:1,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[v.jsx(F,{primary:t.text,primaryTypographyProps:{fontSize:"0.875rem",fontWeight:i.pathname===t.path?600:500}}),t.badge&&v.jsx(j,{badgeContent:t.badge,color:"error",sx:{"& .MuiBadge-badge":{backgroundColor:i.pathname===t.path?"white":"primary.main",color:i.pathname===t.path?"primary.main":"white"}}})]})]})},t.text))}),v.jsx(z,{}),e&&v.jsx(Yn.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{duration:.3},children:v.jsx(E,{sx:{p:2},children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[v.jsx(T,{variant:"overline",sx:{color:"text.secondary",fontWeight:600},children:"プロジェクト"}),v.jsx(S,{size:"small",onClick:()=>{const e=prompt("新しいプロジェクト名を入力してください:");if(e&&e.trim()){const t={text:e.trim(),icon:v.jsx(Z,{}),path:`/project/${e.toLowerCase().replace(/\s+/g,"-")}`,badge:0};m.push(t),zt.success(`プロジェクト「${e}」を作成しました`)}},sx:{color:"primary.main","&:hover":{backgroundColor:"primary.50"}},children:v.jsx(_,{sx:{fontSize:16}})})]})})}),v.jsx(q,{sx:{px:1},children:m.map(t=>v.jsx(H,{disablePadding:!0,sx:{mb:.5},children:v.jsxs($,{onClick:()=>(e=>{console.log(`プロジェクト "${e}" が選択されました`),l(e),u(null);let t=[];switch(e){case"個人プロジェクト":t=h.filter(e=>!e.assignee||"個人"===e.assignee||"デモユーザー"===e.assignee);break;case"仕事":t=h.filter(e=>"仕事"===e.assignee||"high"===e.priority);break;case"学習":t=h.filter(e=>"学習"===e.assignee||"medium"===e.priority);break;default:t=h}localStorage.setItem("filteredTasks",JSON.stringify(t)),localStorage.setItem("currentProject",e),localStorage.removeItem("currentWorkspace"),window.dispatchEvent(new CustomEvent("filterChanged",{detail:{type:"project",value:e,filteredTasks:t}})),zt.success(`${e}のタスクを表示中`)})(t.text),selected:a===t.text,sx:{borderRadius:2,minHeight:48,"&.Mui-selected":{backgroundColor:"primary.main",color:"primary.contrastText","&:hover":{backgroundColor:"primary.dark"}}},children:[v.jsx(L,{sx:{minWidth:40},children:t.icon}),e&&v.jsxs(E,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",flex:1},children:[v.jsx(F,{primary:t.text,primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500}}),v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:1},children:[v.jsx(j,{badgeContent:t.badge,color:"primary",sx:{"& .MuiBadge-badge":{fontSize:"0.625rem",height:18,minWidth:18}}}),"個人プロジェクト"!==t.text&&v.jsx(S,{size:"small",onClick:e=>{e.stopPropagation(),(e=>{if(confirm(`プロジェクト「${e}」を削除しますか？`)){const t=m.findIndex(t=>t.text===e);t>-1&&(m.splice(t,1),zt.success(`プロジェクト「${e}」を削除しました`))}})(t.text)},sx:{color:"error.main","&:hover":{backgroundColor:"error.50"},ml:1},children:v.jsx(X,{sx:{fontSize:14}})})]})]})]})},t.text))}),v.jsx(z,{}),e&&v.jsx(Yn.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{duration:.3},children:v.jsx(E,{sx:{p:2},children:v.jsx(T,{variant:"overline",sx:{color:"text.secondary",fontWeight:600},children:"ワークスペース"})})}),v.jsx(q,{sx:{px:1},children:p.map(t=>v.jsx(H,{disablePadding:!0,sx:{mb:.5},children:v.jsxs($,{onClick:()=>(e=>{console.log(`ワークスペース "${e}" が選択されました`),u(e),l(null);let t=[];switch(e){case"個人プロジェクト":t=h.filter(e=>!e.assignee||"個人"===e.assignee||"デモユーザー"===e.assignee);break;case"チームA":t=h.filter(e=>"チームA"===e.assignee||"inProgress"===e.status);break;case"プロジェクトX":t=h.filter(e=>"プロジェクトX"===e.assignee||"high"===e.priority);break;default:t=h}localStorage.setItem("filteredTasks",JSON.stringify(t)),localStorage.setItem("currentWorkspace",e),localStorage.removeItem("currentProject"),window.dispatchEvent(new CustomEvent("filterChanged",{detail:{type:"workspace",value:e,filteredTasks:t}})),zt.success(`${e}のタスクを表示中`)})(t.text),selected:c===t.text,sx:{borderRadius:2,minHeight:48,"&.Mui-selected":{backgroundColor:"primary.main",color:"white","&:hover":{backgroundColor:"primary.dark"}},"&:hover":{backgroundColor:"action.hover"}},children:[v.jsx(L,{sx:{minWidth:40,color:c===t.text?"white":"inherit"},children:t.icon}),e&&v.jsxs(Yn.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3},style:{flex:1,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[v.jsx(F,{primary:t.text,primaryTypographyProps:{fontSize:"0.875rem",fontWeight:c===t.text?600:500}}),v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:1},children:[t.badge&&v.jsx(j,{badgeContent:t.badge,color:"error",sx:{"& .MuiBadge-badge":{backgroundColor:c===t.text?"white":"primary.main",color:c===t.text?"primary.main":"white"}}}),"個人プロジェクト"!==t.text&&v.jsx(S,{size:"small",onClick:e=>{e.stopPropagation(),(e=>{if(confirm(`ワークスペース「${e}」を削除しますか？`)){const t=p.findIndex(t=>t.text===e);t>-1&&(p.splice(t,1),zt.success(`ワークスペース「${e}」を削除しました`))}})(t.text)},sx:{color:"error.main","&:hover":{backgroundColor:"error.50"},ml:1},children:v.jsx(X,{sx:{fontSize:14}})})]})]})]})},t.text))}),v.jsx(E,{sx:{flexGrow:1}}),v.jsx(z,{}),v.jsxs(q,{sx:{px:1},children:[v.jsx(H,{disablePadding:!0,sx:{mb:.5},children:v.jsxs($,{onClick:()=>n("/profile"),sx:{borderRadius:2,minHeight:48,"&:hover":{backgroundColor:"action.hover"}},children:[v.jsx(L,{sx:{minWidth:40},children:v.jsx(V,{})}),e&&v.jsx(Yn.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3},children:v.jsx(F,{primary:"プロフィール",primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500}})})]})}),v.jsx(H,{disablePadding:!0,sx:{mb:.5},children:v.jsxs($,{onClick:()=>n("/settings"),sx:{borderRadius:2,minHeight:48,"&:hover":{backgroundColor:"action.hover"}},children:[v.jsx(L,{sx:{minWidth:40},children:v.jsx(U,{})}),e&&v.jsx(Yn.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3},children:v.jsx(F,{primary:"設定",primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500}})})]})})]})]}):null};var Ly={lessThanXSeconds:{one:"1秒未満",other:"{{count}}秒未満",oneWithSuffix:"約1秒",otherWithSuffix:"約{{count}}秒"},xSeconds:{one:"1秒",other:"{{count}}秒"},halfAMinute:"30秒",lessThanXMinutes:{one:"1分未満",other:"{{count}}分未満",oneWithSuffix:"約1分",otherWithSuffix:"約{{count}}分"},xMinutes:{one:"1分",other:"{{count}}分"},aboutXHours:{one:"約1時間",other:"約{{count}}時間"},xHours:{one:"1時間",other:"{{count}}時間"},xDays:{one:"1日",other:"{{count}}日"},aboutXWeeks:{one:"約1週間",other:"約{{count}}週間"},xWeeks:{one:"1週間",other:"{{count}}週間"},aboutXMonths:{one:"約1か月",other:"約{{count}}か月"},xMonths:{one:"1か月",other:"{{count}}か月"},aboutXYears:{one:"約1年",other:"約{{count}}年"},xYears:{one:"1年",other:"{{count}}年"},overXYears:{one:"1年以上",other:"{{count}}年以上"},almostXYears:{one:"1年近く",other:"{{count}}年近く"}},Vy={date:Wt({formats:{full:"y年M月d日EEEE",long:"y年M月d日",medium:"y/MM/dd",short:"y/MM/dd"},defaultWidth:"full"}),time:Wt({formats:{full:"H時mm分ss秒 zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},defaultWidth:"full"}),dateTime:Wt({formats:{full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},defaultWidth:"full"})},Fy={lastWeek:"先週のeeeeのp",yesterday:"昨日のp",today:"今日のp",tomorrow:"明日のp",nextWeek:"翌週のeeeeのp",other:"P"},Uy={code:"ja",formatDistance:function(e,t,n){var i;n=n||{};var r=Ly[e];return i="string"==typeof r?r:1===t?n.addSuffix&&r.oneWithSuffix?r.oneWithSuffix:r.one:n.addSuffix&&r.otherWithSuffix?r.otherWithSuffix.replace("{{count}}",String(t)):r.other.replace("{{count}}",String(t)),n.addSuffix?n.comparison&&n.comparison>0?i+"後":i+"前":i},formatLong:Vy,formatRelative:function(e,t,n,i){return Fy[e]},localize:{ordinalNumber:function(e,t){var n=Number(e);switch(String(null==t?void 0:t.unit)){case"year":return"".concat(n,"年");case"quarter":return"第".concat(n,"四半期");case"month":return"".concat(n,"月");case"week":return"第".concat(n,"週");case"date":return"".concat(n,"日");case"hour":return"".concat(n,"時");case"minute":return"".concat(n,"分");case"second":return"".concat(n,"秒");default:return"".concat(n)}},era:Bt({values:{narrow:["BC","AC"],abbreviated:["紀元前","西暦"],wide:["紀元前","西暦"]},defaultWidth:"wide"}),quarter:Bt({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["第1四半期","第2四半期","第3四半期","第4四半期"]},defaultWidth:"wide",argumentCallback:function(e){return Number(e)-1}}),month:Bt({values:{narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],wide:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]},defaultWidth:"wide"}),day:Bt({values:{narrow:["日","月","火","水","木","金","土"],short:["日","月","火","水","木","金","土"],abbreviated:["日","月","火","水","木","金","土"],wide:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"]},defaultWidth:"wide"}),dayPeriod:Bt({values:{narrow:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},abbreviated:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},wide:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"}},defaultWidth:"wide",formattingValues:{narrow:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},abbreviated:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},wide:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:Ht({matchPattern:/^第?\d+(年|四半期|月|週|日|時|分|秒)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:qt({matchPatterns:{narrow:/^(B\.?C\.?|A\.?D\.?)/i,abbreviated:/^(紀元[前後]|西暦)/i,wide:/^(紀元[前後]|西暦)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^B/i,/^A/i],any:[/^(紀元前)/i,/^(西暦|紀元後)/i]},defaultParseWidth:"any"}),quarter:qt({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^Q[1234]/i,wide:/^第[1234一二三四１２３４]四半期/i},defaultMatchWidth:"wide",parsePatterns:{any:[/(1|一|１)/i,/(2|二|２)/i,/(3|三|３)/i,/(4|四|４)/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:qt({matchPatterns:{narrow:/^([123456789]|1[012])/,abbreviated:/^([123456789]|1[012])月/i,wide:/^([123456789]|1[012])月/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^1\D/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},defaultParseWidth:"any"}),day:qt({matchPatterns:{narrow:/^[日月火水木金土]/,short:/^[日月火水木金土]/,abbreviated:/^[日月火水木金土]/,wide:/^[日月火水木金土]曜日/},defaultMatchWidth:"wide",parsePatterns:{any:[/^日/,/^月/,/^火/,/^水/,/^木/,/^金/,/^土/]},defaultParseWidth:"any"}),dayPeriod:qt({matchPatterns:{any:/^(AM|PM|午前|午後|正午|深夜|真夜中|夜|朝)/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^(A|午前)/i,pm:/^(P|午後)/i,midnight:/^深夜|真夜中/i,noon:/^正午/i,morning:/^朝/i,afternoon:/^午後/i,evening:/^夜/i,night:/^深夜/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function zy(e,t,n){return"function"==typeof e?e(t,n):e}function Wy(e){if(void 0===e)return{};const t={};return Object.keys(e).filter(t=>!(t.match(/^on[A-Z]/)&&"function"==typeof e[t])).forEach(n=>{t[n]=e[n]}),t}function By(e){const{getSlotProps:t,additionalProps:n,externalSlotProps:i,externalForwardedProps:r,className:s}=e;if(!t){const e=ne(null==n?void 0:n.className,s,null==r?void 0:r.className,null==i?void 0:i.className),t=u(u(u({},null==n?void 0:n.style),null==r?void 0:r.style),null==i?void 0:i.style),o=u(u(u({},n),r),i);return e.length>0&&(o.className=e),Object.keys(t).length>0&&(o.style=t),{props:o,internalRef:void 0}}const o=function(e,t=[]){if(void 0===e)return{};const n={};return Object.keys(e).filter(n=>n.match(/^on[A-Z]/)&&"function"==typeof e[n]&&!t.includes(n)).forEach(t=>{n[t]=e[t]}),n}(u(u({},r),i)),a=Wy(i),l=Wy(r),c=t(o),h=ne(null==c?void 0:c.className,null==n?void 0:n.className,s,null==r?void 0:r.className,null==i?void 0:i.className),d=u(u(u(u({},null==c?void 0:c.style),null==n?void 0:n.style),null==r?void 0:r.style),null==i?void 0:i.style),f=u(u(u(u({},c),n),l),a);return h.length>0&&(f.className=h),Object.keys(d).length>0&&(f.style=d),{props:f,internalRef:c.ref}}function qy(e){var t;const n=e,{elementType:i,externalSlotProps:r,ownerState:s,skipResolvingSlotProps:o=!1}=n,a=d(n,["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"]),l=o?{}:zy(r,s),{props:c,internalRef:f}=By(h(u({},a),{externalSlotProps:l})),p=function(...e){const t=Rt.useRef(void 0),n=Rt.useCallback(t=>{const n=e.map(e=>{if(null==e)return null;if("function"==typeof e){const n=e,i=n(t);return"function"==typeof i?i:()=>{n(null)}}return e.current=t,()=>{e.current=null}});return()=>{n.forEach(e=>null==e?void 0:e())}},e);return Rt.useMemo(()=>e.every(e=>null==e)?null:e=>{t.current&&(t.current(),t.current=void 0),null!=e&&(t.current=n(e))},e)}(f,null==l?void 0:l.ref,null==(t=e.additionalProps)?void 0:t.ref),m=function(e,t,n){return void 0===e||"string"==typeof e?t:h(u({},t),{ownerState:u(u({},t.ownerState),n)})}(i,h(u({},c),{ref:p}),s);return m}const Hy=(e,t)=>e.length===t.length&&t.every(t=>e.includes(t)),$y=(e,t,n)=>{let i=t;return i=e.setHours(i,e.getHours(n)),i=e.setMinutes(i,e.getMinutes(n)),i=e.setSeconds(i,e.getSeconds(n)),i},Xy=({date:e,disableFuture:t,disablePast:n,maxDate:i,minDate:r,isDateDisabled:s,utils:o,timezone:a})=>{const l=$y(o,o.dateWithTimezone(void 0,a),e);n&&o.isBefore(r,l)&&(r=l),t&&o.isAfter(i,l)&&(i=l);let c=e,u=e;for(o.isBefore(e,r)&&(c=r,u=null),o.isAfter(e,i)&&(u&&(u=i),c=null);c||u;){if(c&&o.isAfter(c,i)&&(c=null),u&&o.isBefore(u,r)&&(u=null),c){if(!s(c))return c;c=o.addDays(c,1)}if(u){if(!s(u))return u;u=o.addDays(u,-1)}}return null},Ky=(e,t,n)=>null!=t&&e.isValid(t)?t:n,Gy=(e,t)=>{const n=[e.startOfYear(t)];for(;n.length<12;){const t=n[n.length-1];n.push(e.addMonths(t,1))}return n},Yy=(e,t,n)=>"date"===n?e.startOfDay(e.dateWithTimezone(void 0,t)):e.dateWithTimezone(void 0,t),Qy=["year","month","day"],Jy=e=>Qy.includes(e),Zy=(e,{format:t,views:n},i)=>{if(null!=t)return t;const r=e.formats;return Hy(n,["year"])?r.year:Hy(n,["month"])?r.month:Hy(n,["day"])?r.dayOfMonth:Hy(n,["month","year"])?`${r.month} ${r.year}`:Hy(n,["day","month"])?`${r.month} ${r.dayOfMonth}`:i?/en/.test(e.getCurrentLocaleCode())?r.normalDateWithWeekday:r.normalDate:r.keyboardDate},eb=(e,t)=>{const n=e.startOfWeek(t);return[0,1,2,3,4,5,6].map(t=>e.addDays(n,t))},tb=["hours","minutes","seconds"],nb=(e,t)=>3600*t.getHours(e)+60*t.getMinutes(e)+t.getSeconds(e),ib={year:1,month:2,day:3,hours:4,minutes:5,seconds:6,milliseconds:7},rb=(e,t,n)=>{if(t===ib.year)return e.startOfYear(n);if(t===ib.month)return e.startOfMonth(n);if(t===ib.day)return e.startOfDay(n);let i=n;return t<ib.minutes&&(i=e.setMinutes(i,0)),t<ib.seconds&&(i=e.setSeconds(i,0)),t<ib.milliseconds&&(i=e.setMilliseconds(i,0)),i},sb=({props:e,utils:t,granularity:n,timezone:i,getTodayDate:r})=>{var s;let o=r?r():rb(t,n,Yy(t,i));null!=e.minDate&&t.isAfterDay(e.minDate,o)&&(o=rb(t,n,e.minDate)),null!=e.maxDate&&t.isBeforeDay(e.maxDate,o)&&(o=rb(t,n,e.maxDate));const a=((e,t)=>(n,i)=>e?t.isAfter(n,i):nb(n,t)>nb(i,t))(null!=(s=e.disableIgnoringDatePartForTimeValidation)&&s,t);return null!=e.minTime&&a(e.minTime,o)&&(o=rb(t,n,e.disableIgnoringDatePartForTimeValidation?e.minTime:$y(t,o,e.minTime))),null!=e.maxTime&&a(o,e.maxTime)&&(o=rb(t,n,e.disableIgnoringDatePartForTimeValidation?e.maxTime:$y(t,o,e.maxTime))),o},ob=(e,t)=>{const n=e.formatTokenMap[t];if(null==n)throw new Error([`MUI: The token "${t}" is not supported by the Date and Time Pickers.`,"Please try using another token or open an issue on https://github.com/mui/mui-x/issues/new/choose if you think it should be supported."].join("\n"));return"string"==typeof n?{type:n,contentType:"meridiem"===n?"letter":"digit",maxLength:void 0}:{type:n.sectionType,contentType:n.contentType,maxLength:n.maxLength}},ab=(e,t,n)=>{const i=[],r=e.dateWithTimezone(void 0,t),s=e.startOfWeek(r),o=e.endOfWeek(r);let a=s;for(;e.isBefore(a,o);)i.push(a),a=e.addDays(a,1);return i.map(t=>e.formatByString(t,n))},lb=(e,t,n,i)=>{switch(n){case"month":return Gy(e,e.dateWithTimezone(void 0,t)).map(t=>e.formatByString(t,i));case"weekDay":return ab(e,t,i);case"meridiem":{const n=e.dateWithTimezone(void 0,t);return[e.startOfDay(n),e.endOfDay(n)].map(t=>e.formatByString(t,i))}default:return[]}},cb=(e,t,n)=>{let i=t;for(i=Number(i).toString();i.length<n;)i=`0${i}`;return i},ub=(e,t,n,i,r)=>{if("day"===r.type&&"digit-with-letter"===r.contentType){const t=e.setDate(i.longestMonth,n);return e.formatByString(t,r.format)}const s=n.toString();return r.hasLeadingZerosInInput?cb(0,s,r.maxLength):s},hb=(e,t,n,i,r,s,o)=>{const a=(e=>{switch(e){case"ArrowUp":return 1;case"ArrowDown":return-1;case"PageUp":return 5;case"PageDown":return-5;default:return 0}})(i),l="Home"===i,c="End"===i,u=""===n.value||l||c;return"digit"===n.contentType||"digit-with-letter"===n.contentType?(()=>{const i=r[n.type]({currentDate:s,format:n.format,contentType:n.contentType}),h=t=>ub(e,0,t,i,n),d="minutes"===n.type&&null!=o&&o.minutesStep?o.minutesStep:1;let f=parseInt(n.value,10)+a*d;if(u){if("year"===n.type&&!c&&!l)return e.formatByString(e.dateWithTimezone(void 0,t),n.format);f=a>0||l?i.minimum:i.maximum}return f%d!==0&&((a<0||l)&&(f+=d-(d+f)%d),(a>0||c)&&(f-=f%d)),f>i.maximum?h(i.minimum+(f-i.maximum-1)%(i.maximum-i.minimum+1)):f<i.minimum?h(i.maximum-(i.minimum-f-1)%(i.maximum-i.minimum+1)):h(f)})():(()=>{const i=lb(e,t,n.type,n.format);if(0===i.length)return n.value;if(u)return a>0||l?i[0]:i[i.length-1];const r=i.indexOf(n.value);return i[(r+i.length+a)%i.length]})()},db=(e,t)=>{let n=e.value||e.placeholder;const i="non-input"===t?e.hasLeadingZerosInFormat:e.hasLeadingZerosInInput;return"non-input"===t&&e.hasLeadingZerosInInput&&!e.hasLeadingZerosInFormat&&(n=Number(n).toString()),["input-rtl","input-ltr"].includes(t)&&"digit"===e.contentType&&!i&&1===n.length&&(n=`${n}‎`),"input-rtl"===t&&(n=`⁨${n}⁩`),n},fb=e=>e.replace(/[\u2066\u2067\u2068\u2069]/g,""),pb=(e,t)=>{let n=0,i=t?1:0;const r=[];for(let s=0;s<e.length;s+=1){const o=e[s],a=db(o,t?"input-rtl":"input-ltr"),l=`${o.startSeparator}${a}${o.endSeparator}`,c=fb(l).length,u=l.length,h=fb(a),d=i+a.indexOf(h[0])+o.startSeparator.length,f=d+h.length;r.push(m({},o,{start:n,end:n+c,startInInput:d,endInInput:f})),n+=c,i+=u}return r},mb=(e,t,n,i,r)=>{switch(i.type){case"year":return n.fieldYearPlaceholder({digitAmount:e.formatByString(e.dateWithTimezone(void 0,t),r).length,format:r});case"month":return n.fieldMonthPlaceholder({contentType:i.contentType,format:r});case"day":return n.fieldDayPlaceholder({format:r});case"weekDay":return n.fieldWeekDayPlaceholder({contentType:i.contentType,format:r});case"hours":return n.fieldHoursPlaceholder({format:r});case"minutes":return n.fieldMinutesPlaceholder({format:r});case"seconds":return n.fieldSecondsPlaceholder({format:r});case"meridiem":return n.fieldMeridiemPlaceholder({format:r});default:return r}},gb=(e,t,n,i)=>e.formatByString(e.parse(t,n),i),vb=(e,t,n)=>4===e.formatByString(e.dateWithTimezone(void 0,t),n).length,yb=(e,t,n,i,r)=>{if("digit"!==n)return!1;const s=e.dateWithTimezone(void 0,t);switch(i){case"year":return vb(e,t,r)?"0001"===e.formatByString(e.setYear(s,1),r):"01"===e.formatByString(e.setYear(s,2001),r);case"month":return e.formatByString(e.startOfYear(s),r).length>1;case"day":return e.formatByString(e.startOfMonth(s),r).length>1;case"weekDay":return e.formatByString(e.startOfWeek(s),r).length>1;case"hours":return e.formatByString(e.setHours(s,1),r).length>1;case"minutes":return e.formatByString(e.setMinutes(s,1),r).length>1;case"seconds":return e.formatByString(e.setSeconds(s,1),r).length>1;default:throw new Error("Invalid section type")}},bb=(e,t,n,i,r,s,o,a)=>{let l="";const c=[],u=e.date(),h=i=>{if(""===i)return null;const s=ob(e,i),a=yb(e,t,s.contentType,s.type,i),h=o?a:"digit"===s.contentType,d=null!=r&&e.isValid(r);let f=d?e.formatByString(r,i):"",p=null;if(h)if(a)p=""===f?e.formatByString(u,i).length:f.length;else{if(null==s.maxLength)throw new Error(`MUI: The token ${i} should have a 'maxDigitNumber' property on it's adapter`);p=s.maxLength,d&&(f=cb(0,f,p))}return c.push(m({},s,{format:i,maxLength:p,value:f,placeholder:mb(e,t,n,s,i),hasLeadingZeros:a,hasLeadingZerosInFormat:a,hasLeadingZerosInInput:h,startSeparator:0===c.length?l:"",endSeparator:"",modified:!1})),null};let d=10,f=i,p=e.expandFormat(i);for(;p!==f;)if(f=p,p=e.expandFormat(f),d-=1,d<0)throw new Error("MUI: The format expansion seems to be  enter in an infinite loop. Please open an issue with the format passed to the picker component");const g=p,v=((e,t)=>{const n=[],{start:i,end:r}=e.escapedCharacters,s=new RegExp(`(\\${i}[^\\${r}]*\\${r})+`,"g");let o=null;for(;o=s.exec(t);)n.push({start:o.index,end:s.lastIndex-1});return n})(e,g),y=new RegExp(`^(${Object.keys(e.formatTokenMap).sort((e,t)=>t.length-e.length).join("|")})`,"g");let b="";for(let m=0;m<g.length;m+=1){const e=v.find(e=>e.start<=m&&e.end>=m),t=g[m],n=null!=e,i=`${b}${g.slice(m)}`,r=y.test(i);!n&&t.match(/([A-Za-z]+)/)&&r?(b=i.slice(0,y.lastIndex),m+=y.lastIndex-1):n&&(null==e?void 0:e.start)===m||(null==e?void 0:e.end)===m||(h(b),b="",0===c.length?l+=t:c[c.length-1].endSeparator+=t)}return h(b),c.map(e=>{const t=e=>{let t=e;return a&&null!==t&&t.includes(" ")&&(t=`⁩${t}⁦`),"spacious"===s&&["/",".","-"].includes(t)&&(t=` ${t} `),t};return e.startSeparator=t(e.startSeparator),e.endSeparator=t(e.endSeparator),e})},xb={year:1,month:2,day:3,weekDay:4,hours:5,minutes:6,seconds:7,meridiem:8},wb=(e,t,n,i,r,s)=>[...i].sort((e,t)=>xb[e.type]-xb[t.type]).reduce((i,r)=>!s||r.modified?((e,t,n,i,r)=>{switch(n.type){case"year":return e.setYear(r,e.getYear(i));case"month":return e.setMonth(r,e.getMonth(i));case"weekDay":{const r=ab(e,t,n.format),s=e.formatByString(i,n.format),o=r.indexOf(s),a=r.indexOf(n.value)-o;return e.addDays(i,a)}case"day":return e.setDate(r,e.getDate(i));case"meridiem":{const t=e.getHours(i)<12,n=e.getHours(r);return t&&n>=12?e.addHours(r,-12):!t&&n<12?e.addHours(r,12):r}case"hours":return e.setHours(r,e.getHours(i));case"minutes":return e.setMinutes(r,e.getMinutes(i));case"seconds":return e.setSeconds(r,e.getSeconds(i));default:return r}})(e,t,r,n,i):i,r),Sb=["value","referenceDate"],Cb={emptyValue:null,getTodayValue:Yy,getInitialReferenceValue:e=>{let{value:t,referenceDate:n}=e,i=ie(e,Sb);return null!=t&&i.utils.isValid(t)?t:null!=n?n:sb(i)},cleanValue:(e,t)=>null!=t&&e.isValid(t)?t:null,areValuesEqual:(e,t,n)=>!e.isValid(t)&&null!=t&&!e.isValid(n)&&null!=n||e.isEqual(t,n),isSameError:(e,t)=>e===t,hasError:e=>null!=e,defaultErrorState:null,getTimezone:(e,t)=>null!=t&&e.isValid(t)?e.getTimezone(t):null,setTimezone:(e,t,n)=>null==n?null:e.setTimezone(n,t)},Tb={updateReferenceValue:(e,t,n)=>null!=t&&e.isValid(t)?t:n,getSectionsFromValue:(e,t,n,i,r)=>!e.isValid(t)&&n?n:pb(r(t),i),getValueStrFromSections:(e,t)=>{const n=e.map(e=>{const n=db(e,t?"input-rtl":"input-ltr");return`${e.startSeparator}${n}${e.endSeparator}`}).join("");return t?`⁦${n}⁩`:n},getActiveDateManager:(e,t)=>({date:t.value,referenceDate:t.referenceValue,getSections:e=>e,getNewValuesFromNewActiveDate:n=>({value:n,referenceValue:null!=n&&e.isValid(n)?n:t.referenceValue})}),parseValueStr:(e,t,n)=>n(e.trim(),t)},Eb=["localeText"],kb=Rt.createContext(null),Db=function(e){var t;const{localeText:n}=e,i=ie(e,Eb),{utils:r,localeText:s}=null!=(t=Rt.useContext(kb))?t:{utils:void 0,localeText:void 0},o=re({props:i,name:"MuiLocalizationProvider"}),{children:a,dateAdapter:l,dateFormats:c,dateLibInstance:u,adapterLocale:h,localeText:d}=o,f=Rt.useMemo(()=>m({},d,s,n),[d,s,n]),p=Rt.useMemo(()=>{if(!l)return r||null;const e=new l({locale:h,formats:c,instance:u});if(!e.isMUIAdapter)throw new Error(["MUI: The date adapter should be imported from `@mui/x-date-pickers` or `@mui/x-date-pickers-pro`, not from `@date-io`","For example, `import { AdapterDayjs } from '@mui/x-date-pickers/AdapterDayjs'` instead of `import AdapterDayjs from '@date-io/dayjs'`","More information on the installation documentation: https://mui.com/x/react-date-pickers/getting-started/#installation"].join("\n"));return e},[l,h,c,u,r]),g=Rt.useMemo(()=>p?{minDate:p.date("1900-01-01T00:00:00.000"),maxDate:p.date("2099-12-31T00:00:00.000")}:null,[p]),y=Rt.useMemo(()=>({utils:p,defaultDates:g,localeText:f}),[g,p,f]);return v.jsx(kb.Provider,{value:y,children:a})},Ib={previousMonth:"Previous month",nextMonth:"Next month",openPreviousView:"open previous view",openNextView:"open next view",calendarViewSwitchingButtonAriaLabel:e=>"year"===e?"year view is open, switch to calendar view":"calendar view is open, switch to year view",start:"Start",end:"End",cancelButtonLabel:"Cancel",clearButtonLabel:"Clear",okButtonLabel:"OK",todayButtonLabel:"Today",datePickerToolbarTitle:"Select date",dateTimePickerToolbarTitle:"Select date & time",timePickerToolbarTitle:"Select time",dateRangePickerToolbarTitle:"Select date range",clockLabelText:(e,t,n)=>`Select ${e}. ${null===t?"No time selected":`Selected time is ${n.format(t,"fullTime")}`}`,hoursClockNumberText:e=>`${e} hours`,minutesClockNumberText:e=>`${e} minutes`,secondsClockNumberText:e=>`${e} seconds`,selectViewText:e=>`Select ${e}`,calendarWeekNumberHeaderLabel:"Week number",calendarWeekNumberHeaderText:"#",calendarWeekNumberAriaLabelText:e=>`Week ${e}`,calendarWeekNumberText:e=>`${e}`,openDatePickerDialogue:(e,t)=>null!==e&&t.isValid(e)?`Choose date, selected date is ${t.format(e,"fullDate")}`:"Choose date",openTimePickerDialogue:(e,t)=>null!==e&&t.isValid(e)?`Choose time, selected time is ${t.format(e,"fullTime")}`:"Choose time",fieldClearLabel:"Clear value",timeTableLabel:"pick time",dateTableLabel:"pick date",fieldYearPlaceholder:e=>"Y".repeat(e.digitAmount),fieldMonthPlaceholder:e=>"letter"===e.contentType?"MMMM":"MM",fieldDayPlaceholder:()=>"DD",fieldWeekDayPlaceholder:e=>"letter"===e.contentType?"EEEE":"EE",fieldHoursPlaceholder:()=>"hh",fieldMinutesPlaceholder:()=>"mm",fieldSecondsPlaceholder:()=>"ss",fieldMeridiemPlaceholder:()=>"aa"},_b=Ib;m({},Ib);const jb=()=>{const e=Rt.useContext(kb);if(null===e)throw new Error(["MUI: Can not find the date and time pickers localization context.","It looks like you forgot to wrap your component in LocalizationProvider.","This can also happen if you are bundling multiple versions of the `@mui/x-date-pickers` package"].join("\n"));if(null===e.utils)throw new Error(["MUI: Can not find the date and time pickers adapter from its localization context.","It looks like you forgot to pass a `dateAdapter` to your LocalizationProvider."].join("\n"));const t=Rt.useMemo(()=>m({},_b,e.localeText),[e.localeText]);return Rt.useMemo(()=>m({},e,{localeText:t}),[e,t])},Pb=()=>jb().utils,Mb=()=>jb().defaultDates,Ab=()=>jb().localeText,Rb=e=>{const t=Pb(),n=Rt.useRef();return void 0===n.current&&(n.current=t.dateWithTimezone(void 0,e)),n.current};function Ob(e){return se("MuiPickersToolbar",e)}oe("MuiPickersToolbar",["root","content"]);const Nb=ae("div",{name:"MuiPickersToolbar",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>m({display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",padding:e.spacing(2,3)},t.isLandscape&&{height:"auto",maxWidth:160,padding:16,justifyContent:"flex-start",flexWrap:"wrap"})),Lb=ae("div",{name:"MuiPickersToolbar",slot:"Content",overridesResolver:(e,t)=>t.content})(({ownerState:e})=>{var t;return{display:"flex",flexWrap:"wrap",width:"100%",justifyContent:e.isLandscape?"flex-start":"space-between",flexDirection:e.isLandscape?null!=(t=e.landscapeDirection)?t:"column":"row",flex:1,alignItems:e.isLandscape?"flex-start":"center"}}),Vb=Rt.forwardRef(function(e,t){const n=re({props:e,name:"MuiPickersToolbar"}),{children:i,className:r,toolbarTitle:s,hidden:o,titleId:a}=n,l=n,c=(e=>{const{classes:t,isLandscape:n}=e;return le({root:["root"],content:["content"],penIconButton:["penIconButton",n&&"penIconButtonLandscape"]},Ob,t)})(l);return o?null:v.jsxs(Nb,{ref:t,className:ne(c.root,r),ownerState:l,children:[v.jsx(T,{color:"text.secondary",variant:"overline",id:a,children:s}),v.jsx(Lb,{className:c.content,ownerState:l,children:i})]})});function Fb(e){return se("MuiDatePickerToolbar",e)}oe("MuiDatePickerToolbar",["root","title"]);const Ub=["value","isLandscape","onChange","toolbarFormat","toolbarPlaceholder","views","className"],zb=ae(Vb,{name:"MuiDatePickerToolbar",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Wb=ae(T,{name:"MuiDatePickerToolbar",slot:"Title",overridesResolver:(e,t)=>t.title})(({ownerState:e})=>m({},e.isLandscape&&{margin:"auto 16px auto auto"})),Bb=Rt.forwardRef(function(e,t){const n=re({props:e,name:"MuiDatePickerToolbar"}),{value:i,isLandscape:r,toolbarFormat:s,toolbarPlaceholder:o="––",views:a,className:l}=n,c=ie(n,Ub),u=Pb(),h=Ab(),d=(e=>{const{classes:t}=e;return le({root:["root"],title:["title"]},Fb,t)})(n),f=Rt.useMemo(()=>{if(!i)return o;const e=Zy(u,{format:s,views:a},!0);return u.formatByString(i,e)},[i,s,o,u,a]),p=n;return v.jsx(zb,m({ref:t,toolbarTitle:h.datePickerToolbarTitle,isLandscape:r,className:ne(d.root,l)},c,{children:v.jsx(Wb,{variant:"h4",align:r?"left":"center",ownerState:p,className:d.title,children:f})}))}),qb=e=>{if(void 0!==e)return Object.keys(e).reduce((t,n)=>m({},t,{[`${n.slice(0,1).toLowerCase()}${n.slice(1)}`]:e[n]}),{})};function Hb(e,t){var n,i,r,s;const o=Pb(),a=Mb(),l=re({props:e,name:t}),c=Rt.useMemo(()=>{var e;return null==(null==(e=l.localeText)?void 0:e.toolbarTitle)?l.localeText:m({},l.localeText,{datePickerToolbarTitle:l.localeText.toolbarTitle})},[l.localeText]),u=null!=(n=l.slots)?n:qb(l.components);return m({},l,{localeText:c},(({openTo:e,defaultOpenTo:t,views:n,defaultViews:i})=>{const r=null!=n?n:i;let s;if(null!=e)s=e;else if(r.includes(t))s=t;else{if(!(r.length>0))throw new Error("MUI: The `views` prop must contain at least one view");s=r[0]}return{views:r,openTo:s}})({views:l.views,openTo:l.openTo,defaultViews:["year","day"],defaultOpenTo:"day"}),{disableFuture:null!=(i=l.disableFuture)&&i,disablePast:null!=(r=l.disablePast)&&r,minDate:Ky(o,l.minDate,a.minDate),maxDate:Ky(o,l.maxDate,a.maxDate),slots:m({toolbar:Bb},u),slotProps:null!=(s=l.slotProps)?s:l.componentsProps})}const $b=ce(v.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),Xb=ce(v.jsx("path",{d:"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"}),"ArrowLeft"),Kb=ce(v.jsx("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"ArrowRight"),Gb=ce(v.jsx("path",{d:"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"}),"Calendar");ce(v.jsxs(Rt.Fragment,{children:[v.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),v.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Clock"),ce(v.jsx("path",{d:"M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"}),"DateRange"),ce(v.jsxs(Rt.Fragment,{children:[v.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),v.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Time");const Yb=ce(v.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");function Qb(e){return se("MuiPickersArrowSwitcher",e)}oe("MuiPickersArrowSwitcher",["root","spacer","button"]);const Jb=["children","className","slots","slotProps","isNextDisabled","isNextHidden","onGoToNext","nextLabel","isPreviousDisabled","isPreviousHidden","onGoToPrevious","previousLabel"],Zb=["ownerState"],ex=["ownerState"],tx=ae("div",{name:"MuiPickersArrowSwitcher",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex"}),nx=ae("div",{name:"MuiPickersArrowSwitcher",slot:"Spacer",overridesResolver:(e,t)=>t.spacer})(({theme:e})=>({width:e.spacing(3)})),ix=ae(S,{name:"MuiPickersArrowSwitcher",slot:"Button",overridesResolver:(e,t)=>t.button})(({ownerState:e})=>m({},e.hidden&&{visibility:"hidden"})),rx=Rt.forwardRef(function(e,t){var n,i,r,s;const o="rtl"===ue().direction,a=re({props:e,name:"MuiPickersArrowSwitcher"}),{children:l,className:c,slots:u,slotProps:h,isNextDisabled:d,isNextHidden:f,onGoToNext:p,nextLabel:g,isPreviousDisabled:y,isPreviousHidden:b,onGoToPrevious:x,previousLabel:w}=a,S=ie(a,Jb),C=a,E=(e=>{const{classes:t}=e;return le({root:["root"],spacer:["spacer"],button:["button"]},Qb,t)})(C),k={isDisabled:d,isHidden:f,goTo:p,label:g},D={isDisabled:y,isHidden:b,goTo:x,label:w},I=null!=(n=null==u?void 0:u.previousIconButton)?n:ix,_=qy({elementType:I,externalSlotProps:null==h?void 0:h.previousIconButton,additionalProps:{size:"medium",title:D.label,"aria-label":D.label,disabled:D.isDisabled,edge:"end",onClick:D.goTo},ownerState:m({},C,{hidden:D.isHidden}),className:E.button}),j=null!=(i=null==u?void 0:u.nextIconButton)?i:ix,P=qy({elementType:j,externalSlotProps:null==h?void 0:h.nextIconButton,additionalProps:{size:"medium",title:k.label,"aria-label":k.label,disabled:k.isDisabled,edge:"start",onClick:k.goTo},ownerState:m({},C,{hidden:k.isHidden}),className:E.button}),M=null!=(r=null==u?void 0:u.leftArrowIcon)?r:Xb,A=qy({elementType:M,externalSlotProps:null==h?void 0:h.leftArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:void 0}),R=ie(A,Zb),O=null!=(s=null==u?void 0:u.rightArrowIcon)?s:Kb,N=qy({elementType:O,externalSlotProps:null==h?void 0:h.rightArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:void 0}),L=ie(N,ex);return v.jsxs(tx,m({ref:t,className:ne(E.root,c),ownerState:C},S,{children:[v.jsx(I,m({},_,{children:o?v.jsx(O,m({},L)):v.jsx(M,m({},R))})),l?v.jsx(T,{variant:"subtitle1",component:"span",children:l}):v.jsx(nx,{className:E.spacer,ownerState:C}),v.jsx(j,m({},P,{children:o?v.jsx(M,m({},R)):v.jsx(O,m({},L))}))]}))}),sx=320,ox=ae(de)({[`& .${fe.container}`]:{outline:0},[`& .${fe.paper}`]:{outline:0,minWidth:sx}}),ax=ae(pe)({"&:first-of-type":{padding:0}});function lx(e){var t,n;const{children:i,onDismiss:r,open:s,slots:o,slotProps:a}=e,l=null!=(t=null==o?void 0:o.dialog)?t:ox,c=null!=(n=null==o?void 0:o.mobileTransition)?n:he;return v.jsx(l,m({open:s,onClose:r},null==a?void 0:a.dialog,{TransitionComponent:c,TransitionProps:null==a?void 0:a.mobileTransition,PaperComponent:null==o?void 0:o.mobilePaper,PaperProps:null==a?void 0:a.mobilePaper,children:v.jsx(ax,{children:i})}))}function cx(e){return se("MuiPickersPopper",e)}oe("MuiPickersPopper",["root","paper"]);const ux=(e=document)=>{const t=e.activeElement;return t?t.shadowRoot?ux(t.shadowRoot):t:null},hx="@media (pointer: fine)",dx="undefined"!=typeof navigator&&navigator.userAgent.match(/android\s(\d+)|OS\s(\d+)/i),fx=dx&&dx[1]?parseInt(dx[1],10):null,px=dx&&dx[2]?parseInt(dx[2],10):null,mx=fx&&fx<10||px&&px<13||!1,gx=()=>me("@media (prefers-reduced-motion: reduce)",{defaultMatches:!1})||mx,vx=["PaperComponent","popperPlacement","ownerState","children","paperSlotProps","paperClasses","onPaperClick","onPaperTouchStart"],yx=ae(Se,{name:"MuiPickersPopper",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({zIndex:e.zIndex.modal})),bx=ae(we,{name:"MuiPickersPopper",slot:"Paper",overridesResolver:(e,t)=>t.paper})(({ownerState:e})=>m({outline:0,transformOrigin:"top center"},e.placement.includes("top")&&{transformOrigin:"bottom center"})),xx=Rt.forwardRef((e,t)=>{const{PaperComponent:n,popperPlacement:i,ownerState:r,children:s,paperSlotProps:o,paperClasses:a,onPaperClick:l,onPaperTouchStart:c}=e,u=ie(e,vx),h=m({},r,{placement:i}),d=qy({elementType:n,externalSlotProps:o,additionalProps:{tabIndex:-1,elevation:8,ref:t},className:a,ownerState:h});return v.jsx(n,m({},u,d,{onClick:e=>{var t;l(e),null==(t=d.onClick)||t.call(d,e)},onTouchStart:e=>{var t;c(e),null==(t=d.onTouchStart)||t.call(d,e)},ownerState:h,children:s}))});function wx(e){var t,n,i,r;const s=re({props:e,name:"MuiPickersPopper"}),{anchorEl:o,children:a,containerRef:l=null,shouldRestoreFocus:c,onBlur:u,onDismiss:h,open:d,role:f,placement:p,slots:g,slotProps:y,reduceAnimations:b}=s;Rt.useEffect(()=>{function e(e){!d||"Escape"!==e.key&&"Esc"!==e.key||h()}return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[h,d]);const x=Rt.useRef(null);Rt.useEffect(()=>{"tooltip"===f||c&&!c()||(d?x.current=ux(document):x.current&&x.current instanceof HTMLElement&&setTimeout(()=>{x.current instanceof HTMLElement&&x.current.focus()}))},[d,f,c]);const[w,S,C]=function(e,t){const n=Rt.useRef(!1),i=Rt.useRef(!1),r=Rt.useRef(null),s=Rt.useRef(!1);Rt.useEffect(()=>{if(e)return document.addEventListener("mousedown",t,!0),document.addEventListener("touchstart",t,!0),()=>{document.removeEventListener("mousedown",t,!0),document.removeEventListener("touchstart",t,!0),s.current=!1};function t(){s.current=!0}},[e]);const o=be(e=>{if(!s.current)return;const o=i.current;i.current=!1;const a=xe(r.current);if(!r.current||"clientX"in e&&function(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}(e,a))return;if(n.current)return void(n.current=!1);let l;l=e.composedPath?e.composedPath().indexOf(r.current)>-1:!a.documentElement.contains(e.target)||r.current.contains(e.target),l||o||t(e)}),a=()=>{i.current=!0};return Rt.useEffect(()=>{if(e){const e=xe(r.current),t=()=>{n.current=!0};return e.addEventListener("touchstart",o),e.addEventListener("touchmove",t),()=>{e.removeEventListener("touchstart",o),e.removeEventListener("touchmove",t)}}},[e,o]),Rt.useEffect(()=>{if(e){const e=xe(r.current);return e.addEventListener("click",o),()=>{e.removeEventListener("click",o),i.current=!1}}},[e,o]),[r,a,a]}(d,null!=u?u:h),T=Rt.useRef(null),E=ge(T,l),k=ge(E,w),D=s,I=(e=>{const{classes:t}=e;return le({root:["root"],paper:["paper"]},cx,t)})(D),_=gx(),j=null!=b?b:_,P=(null!=(t=null==g?void 0:g.desktopTransition)?t:j)?he:ve,M=null!=(n=null==g?void 0:g.desktopTrapFocus)?n:ye,A=null!=(i=null==g?void 0:g.desktopPaper)?i:bx,R=null!=(r=null==g?void 0:g.popper)?r:yx,O=qy({elementType:R,externalSlotProps:null==y?void 0:y.popper,additionalProps:{transition:!0,role:f,open:d,anchorEl:o,placement:p,onKeyDown:e=>{"Escape"===e.key&&(e.stopPropagation(),h())}},className:I.root,ownerState:s});return v.jsx(R,m({},O,{children:({TransitionProps:e,placement:t})=>v.jsx(M,m({open:d,disableAutoFocus:!0,disableRestoreFocus:!0,disableEnforceFocus:"tooltip"===f,isEnabled:()=>!0},null==y?void 0:y.desktopTrapFocus,{children:v.jsx(P,m({},e,null==y?void 0:y.desktopTransition,{children:v.jsx(xx,{PaperComponent:A,ownerState:D,popperPlacement:t,ref:k,onPaperClick:S,onPaperTouchStart:C,paperClasses:I.paper,paperSlotProps:null==y?void 0:y.desktopPaper,children:a})}))}))}))}const Sx=({timezone:e,value:t,defaultValue:n,onChange:i,valueManager:r})=>{var s,o;const a=Pb(),l=Rt.useRef(n),c=null!=(s=null!=t?t:l.current)?s:r.emptyValue,u=Rt.useMemo(()=>r.getTimezone(a,c),[a,r,c]),h=be(e=>null==u?e:r.setTimezone(a,u,e)),d=null!=(o=null!=e?e:u)?o:"default";return{value:Rt.useMemo(()=>r.setTimezone(a,d,c),[r,a,d,c]),handleValueChange:be((e,...t)=>{const n=h(e);null==i||i(n,...t)}),timezone:d}},Cx=({name:e,timezone:t,value:n,defaultValue:i,onChange:r,valueManager:s})=>{const[o,a]=Ce({name:e,state:"value",controlled:n,default:null!=i?i:s.emptyValue}),l=be((e,...t)=>{a(e),null==r||r(e,...t)});return Sx({timezone:t,value:o,defaultValue:void 0,onChange:l,valueManager:s})};function Tx(e,t,n,i){const{value:r,onError:s}=e,o=jb(),a=Rt.useRef(i),l=t({adapter:o,value:r,props:e});return Rt.useEffect(()=>{s&&!n(l,a.current)&&s(l,r),a.current=l},[n,s,a,l,r]),l}const Ex=e=>{const t=Pb(),n=Ab(),i=jb(),r="rtl"===ue().direction,{valueManager:s,fieldValueManager:o,validator:a,internalProps:l,internalProps:{value:c,defaultValue:u,referenceDate:h,onChange:d,format:f,formatDensity:p="dense",selectedSections:g,onSelectedSectionsChange:v,shouldRespectLeadingZeros:y=!1,timezone:b}}=e,{timezone:x,value:w,handleValueChange:S}=Sx({timezone:b,value:c,defaultValue:u,onChange:d,valueManager:s}),C=Rt.useMemo(()=>((e,t)=>{const n=e.dateWithTimezone(void 0,t),i=e.endOfYear(n),r=e.endOfDay(n),{maxDaysInMonth:s,longestMonth:o}=Gy(e,n).reduce((t,n)=>{const i=e.getDaysInMonth(n);return i>t.maxDaysInMonth?{maxDaysInMonth:i,longestMonth:n}:t},{maxDaysInMonth:0,longestMonth:null});return{year:({format:n})=>({minimum:0,maximum:vb(e,t,n)?9999:99}),month:()=>({minimum:1,maximum:e.getMonth(i)+1}),day:({currentDate:t})=>({minimum:1,maximum:null!=t&&e.isValid(t)?e.getDaysInMonth(t):s,longestMonth:o}),weekDay:({format:n,contentType:i})=>{if("digit"===i){const i=ab(e,t,n).map(Number);return{minimum:Math.min(...i),maximum:Math.max(...i)}}return{minimum:1,maximum:7}},hours:({format:t})=>{const i=e.getHours(r);return e.formatByString(e.endOfDay(n),t)!==i.toString()?{minimum:1,maximum:Number(e.formatByString(e.startOfDay(n),t))}:{minimum:0,maximum:i}},minutes:()=>({minimum:0,maximum:e.getMinutes(r)}),seconds:()=>({minimum:0,maximum:e.getSeconds(r)}),meridiem:()=>({minimum:0,maximum:0})}})(t,x),[t,x]),T=Rt.useCallback((e,i=null)=>o.getSectionsFromValue(t,e,i,r,e=>bb(t,x,n,f,e,p,y,r)),[o,f,n,r,y,t,p,x]),E=Rt.useMemo(()=>o.getValueStrFromSections(T(s.emptyValue),r),[o,T,s.emptyValue,r]),[k,D]=Rt.useState(()=>{const e=T(w),n={sections:e,value:w,referenceValue:s.emptyValue,tempValueStrAndroid:null},i=(e=>Math.max(...e.map(e=>{var t;return null!=(t=ib[e.type])?t:1})))(e),r=s.getInitialReferenceValue({referenceDate:h,value:w,utils:t,props:l,granularity:i,timezone:x});return m({},n,{referenceValue:r})}),[I,_]=Ce({controlled:g,default:null,name:"useField",state:"selectedSectionIndexes"}),j=e=>{_(e),null==v||v(e),D(e=>m({},e,{selectedSectionQuery:null}))},P=Rt.useMemo(()=>{if(null==I)return null;if("all"===I)return{startIndex:0,endIndex:k.sections.length-1,shouldSelectBoundarySelectors:!0};if("number"==typeof I)return{startIndex:I,endIndex:I};if("string"==typeof I){const e=k.sections.findIndex(e=>e.type===I);return{startIndex:e,endIndex:e}}return I},[I,k.sections]),M=({value:e,referenceValue:n,sections:r})=>{if(D(t=>m({},t,{sections:r,value:e,referenceValue:n,tempValueStrAndroid:null})),s.areValuesEqual(t,k.value,e))return;const o={validationError:a({adapter:i,value:e,props:m({},l,{value:e,timezone:x})})};S(e,o)},A=(e,t)=>{const n=[...k.sections];return n[e]=m({},n[e],{value:t,modified:!0}),pb(n,r)};return Rt.useEffect(()=>{const e=T(k.value);D(t=>m({},t,{sections:e}))},[f,t.locale]),Rt.useEffect(()=>{let e=!1;e=!s.areValuesEqual(t,k.value,w)||s.getTimezone(t,k.value)!==s.getTimezone(t,w),e&&D(e=>m({},e,{value:w,referenceValue:o.updateReferenceValue(t,w,e.referenceValue),sections:T(w)}))},[w]),{state:k,selectedSectionIndexes:P,setSelectedSections:j,clearValue:()=>{M({value:s.emptyValue,referenceValue:k.referenceValue,sections:T(s.emptyValue)})},clearActiveSection:()=>{if(null==P)return;const e=k.sections[P.startIndex],n=o.getActiveDateManager(t,k,e),i=n.getSections(k.sections).filter(e=>""!==e.value).length===(""===e.value?0:1),r=A(P.startIndex,""),s=i?null:t.date(new Date("")),a=n.getNewValuesFromNewActiveDate(s);(null!=s&&!t.isValid(s))!=(null!=n.date&&!t.isValid(n.date))?M(m({},a,{sections:r})):D(e=>m({},e,a,{sections:r,tempValueStrAndroid:null}))},updateSectionValue:({activeSection:e,newSectionValue:n,shouldGoToNextSection:i})=>{i&&P&&P.startIndex<k.sections.length-1?j(P.startIndex+1):P&&P.startIndex!==P.endIndex&&j(P.startIndex);const r=o.getActiveDateManager(t,k,e),s=A(P.startIndex,n),a=r.getSections(s),l=((e,t)=>{const n=t.some(e=>"day"===e.type),i=[],r=[];for(let a=0;a<t.length;a+=1){const e=t[a];n&&"weekDay"===e.type||(i.push(e.format),r.push(db(e,"non-input")))}const s=i.join(" "),o=r.join(" ");return e.parse(o,s)})(t,a);let c,u;if(null!=l&&t.isValid(l)){const e=wb(t,x,l,a,r.referenceDate,!0);c=r.getNewValuesFromNewActiveDate(e),u=!0}else c=r.getNewValuesFromNewActiveDate(l),u=(null!=l&&!t.isValid(l))!=(null!=r.date&&!t.isValid(r.date));return u?M(m({},c,{sections:s})):D(e=>m({},e,c,{sections:s,tempValueStrAndroid:null}))},updateValueFromValueStr:e=>{const i=o.parseValueStr(e,k.referenceValue,(e,i)=>{const s=t.parse(e,f);if(null==s||!t.isValid(s))return null;const o=bb(t,x,n,f,s,p,y,r);return wb(t,x,s,o,i,!1)}),s=o.updateReferenceValue(t,i,k.referenceValue);M({value:i,referenceValue:s,sections:T(i,k.sections)})},setTempAndroidValueStr:e=>D(t=>m({},t,{tempValueStrAndroid:e})),sectionsValueBoundaries:C,placeholder:E,timezone:x}},kx=e=>null!=e.saveQuery,Dx=({sections:e,updateSectionValue:t,sectionsValueBoundaries:n,setTempAndroidValueStr:i,timezone:r})=>{const s=Pb(),[o,a]=Rt.useState(null),l=be(()=>a(null));Rt.useEffect(()=>{var t;null!=o&&(null==(t=e[o.sectionIndex])?void 0:t.type)!==o.sectionType&&l()},[e,o,l]),Rt.useEffect(()=>{if(null!=o){const e=setTimeout(()=>l(),5e3);return()=>{window.clearTimeout(e)}}return()=>{}},[o,l]);const c=({keyPressed:t,sectionIndex:n},i,r)=>{const s=t.toLowerCase(),c=e[n];if(null!=o&&(!r||r(o.value))&&o.sectionIndex===n){const e=`${o.value}${s}`,t=i(e,c);if(!kx(t))return a({sectionIndex:n,value:e,sectionType:c.type}),t}const u=i(s,c);return kx(u)&&!u.saveQuery?(l(),null):(a({sectionIndex:n,value:s,sectionType:c.type}),kx(u)?null:u)};return{applyCharacterEditing:be(o=>{const a=e[o.sectionIndex],l=" "===o.keyPressed||Number.isNaN(Number(o.keyPressed))?(e=>{const t=(e,t,n)=>{const i=t.filter(e=>e.toLowerCase().startsWith(n));return 0===i.length?{saveQuery:!1}:{sectionValue:i[0],shouldGoToNextSection:1===i.length}},n=(e,n,i,o)=>{const a=e=>lb(s,r,n.type,e);if("letter"===n.contentType)return t(n.format,a(n.format),e);if(i&&null!=o&&"letter"===ob(s,i).contentType){const n=a(i),r=t(0,n,e);return kx(r)?{saveQuery:!1}:m({},r,{sectionValue:o(r.sectionValue,n)})}return{saveQuery:!1}};return c(e,(e,t)=>{switch(t.type){case"month":{const i=e=>gb(s,e,s.formats.month,t.format);return n(e,t,s.formats.month,i)}case"weekDay":{const i=(e,t)=>t.indexOf(e).toString();return n(e,t,s.formats.weekday,i)}case"meridiem":return n(e,t);default:return{saveQuery:!1}}})})(o):(e=>{const t=(e,t)=>{const i=Number(`${e}`),r=n[t.type]({currentDate:null,format:t.format,contentType:t.contentType});if(i>r.maximum)return{saveQuery:!1};if(i<r.minimum)return{saveQuery:!0};const o=Number(`${e}0`)>r.maximum||e.length===r.maximum.toString().length;return{sectionValue:ub(s,0,i,r,t),shouldGoToNextSection:o}};return c(e,(e,n)=>{if("digit"===n.contentType||"digit-with-letter"===n.contentType)return t(e,n);if("month"===n.type){yb(s,r,"digit","month","MM");const i=t(e,{type:n.type,format:"MM",hasLeadingZerosInInput:!0,contentType:"digit",maxLength:2});if(kx(i))return i;const o=gb(s,i.sectionValue,"MM",n.format);return m({},i,{sectionValue:o})}if("weekDay"===n.type){const i=t(e,n);if(kx(i))return i;const o=ab(s,r,n.format)[Number(i.sectionValue)-1];return m({},i,{sectionValue:o})}return{saveQuery:!1}},e=>!Number.isNaN(Number(e)))})(o);null==l?i(null):t({activeSection:a,newSectionValue:l.sectionValue,shouldGoToNextSection:l.shouldGoToNextSection})}),resetCharacterQuery:l}},Ix=["onClick","onKeyDown","onFocus","onBlur","onMouseUp","onPaste","error","clearable","onClear","disabled"],_x=e=>{const t=Pb(),{state:n,selectedSectionIndexes:i,setSelectedSections:r,clearValue:s,clearActiveSection:o,updateSectionValue:a,updateValueFromValueStr:l,setTempAndroidValueStr:c,sectionsValueBoundaries:u,placeholder:h,timezone:d}=Ex(e),{inputRef:f,internalProps:p,internalProps:{readOnly:g=!1,unstableFieldRef:v,minutesStep:y},forwardedProps:{onClick:b,onKeyDown:x,onFocus:w,onBlur:S,onMouseUp:C,onPaste:T,error:E,clearable:k,onClear:D,disabled:I},fieldValueManager:_,valueManager:j,validator:P}=e,M=ie(e.forwardedProps,Ix),{applyCharacterEditing:A,resetCharacterQuery:R}=Dx({sections:n.sections,updateSectionValue:a,sectionsValueBoundaries:u,setTempAndroidValueStr:c,timezone:d}),O=Rt.useRef(null),N=ge(f,O),L=Rt.useRef(void 0),V="rtl"===ue().direction,F=Rt.useMemo(()=>((e,t)=>{const n={};if(!t)return e.forEach((t,i)=>{const r=0===i?null:i-1,s=i===e.length-1?null:i+1;n[i]={leftIndex:r,rightIndex:s}}),{neighbors:n,startIndex:0,endIndex:e.length-1};const i={},r={};let s=0,o=0,a=e.length-1;for(;a>=0;){o=e.findIndex((e,t)=>{var n;return t>=s&&(null==(n=e.endSeparator)?void 0:n.includes(" "))&&" / "!==e.endSeparator}),-1===o&&(o=e.length-1);for(let e=o;e>=s;e-=1)r[e]=a,i[a]=e,a-=1;s=o+1}return e.forEach((t,s)=>{const o=r[s],a=0===o?null:i[o-1],l=o===e.length-1?null:i[o+1];n[s]={leftIndex:a,rightIndex:l}}),{neighbors:n,startIndex:i[0],endIndex:i[e.length-1]}})(n.sections,V),[n.sections,V]),U=()=>{var e;if(g)return void r(null);const t=null!=(e=O.current.selectionStart)?e:0;let i;i=t<=n.sections[0].startInInput||t>=n.sections[n.sections.length-1].endInInput?1:n.sections.findIndex(e=>e.startInInput-e.startSeparator.length>t);const s=-1===i?n.sections.length-1:i-1;r(s)},z=be((e,...t)=>{e.isDefaultPrevented()||(null==b||b(e,...t),U())}),W=be(e=>{null==C||C(e),e.preventDefault()}),B=be((...e)=>{null==w||w(...e);const t=O.current;window.clearTimeout(L.current),L.current=setTimeout(()=>{t&&t===O.current&&(null!=i||g||(t.value.length&&Number(t.selectionEnd)-Number(t.selectionStart)===t.value.length?r("all"):U()))})}),q=be((...e)=>{null==S||S(...e),r(null)}),H=be(e=>{if(null==T||T(e),g)return void e.preventDefault();const t=e.clipboardData.getData("text");if(i&&i.startIndex===i.endIndex){const r=n.sections[i.startIndex],s=/^[a-zA-Z]+$/.test(t),o=/^[0-9]+$/.test(t),l=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test(t);if("letter"===r.contentType&&s||"digit"===r.contentType&&o||"digit-with-letter"===r.contentType&&l)return R(),a({activeSection:r,newSectionValue:t,shouldGoToNextSection:!0}),void e.preventDefault();if(s||o)return void e.preventDefault()}e.preventDefault(),R(),l(t)}),$=be(e=>{if(g)return;const t=e.target.value;if(""===t)return R(),void s();const r=e.nativeEvent.data,a=r&&r.length>1,u=a?r:t,h=fb(u);if(null==i||a)return void l(a?r:h);let d;if(0===i.startIndex&&i.endIndex===n.sections.length-1&&1===h.length)d=h;else{const e=fb(_.getValueStrFromSections(n.sections,V));let t=-1,r=-1;for(let n=0;n<e.length;n+=1)-1===t&&e[n]!==h[n]&&(t=n),-1===r&&e[e.length-n-1]!==h[h.length-n-1]&&(r=n);const s=n.sections[i.startIndex];if(t<s.start||e.length-r-1>s.end)return;const o=h.length-e.length+s.end-fb(s.endSeparator||"").length;d=h.slice(s.start+fb(s.startSeparator||"").length,o)}0!==d.length?A({keyPressed:d,sectionIndex:i.startIndex}):navigator.userAgent.toLowerCase().indexOf("android")>-1?c(u):(R(),o())}),X=be(e=>{switch(null==x||x(e),!0){case"a"===e.key&&(e.ctrlKey||e.metaKey):e.preventDefault(),r("all");break;case"ArrowRight"===e.key:if(e.preventDefault(),null==i)r(F.startIndex);else if(i.startIndex!==i.endIndex)r(i.endIndex);else{const e=F.neighbors[i.startIndex].rightIndex;null!==e&&r(e)}break;case"ArrowLeft"===e.key:if(e.preventDefault(),null==i)r(F.endIndex);else if(i.startIndex!==i.endIndex)r(i.startIndex);else{const e=F.neighbors[i.startIndex].leftIndex;null!==e&&r(e)}break;case"Delete"===e.key:if(e.preventDefault(),g)break;null==i||0===i.startIndex&&i.endIndex===n.sections.length-1?s():o(),R();break;case["ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(e.key):{if(e.preventDefault(),g||null==i)break;const r=n.sections[i.startIndex],s=_.getActiveDateManager(t,n,r),o=hb(t,d,r,e.key,u,s.date,{minutesStep:y});a({activeSection:r,newSectionValue:o,shouldGoToNextSection:!1});break}}});Te(()=>{if(!O.current)return;if(null==i)return void(O.current.scrollLeft&&(O.current.scrollLeft=0));const e=n.sections[i.startIndex],t=n.sections[i.endIndex];let r=e.startInInput,s=t.endInInput;if(i.shouldSelectBoundarySelectors&&(r-=e.startSeparator.length,s+=t.endSeparator.length),r!==O.current.selectionStart||s!==O.current.selectionEnd){const e=O.current.scrollTop;O.current===ux(document)&&O.current.setSelectionRange(r,s),O.current.scrollTop=e}});const K=Tx(m({},p,{value:n.value,timezone:d}),P,j.isSameError,j.defaultErrorState),G=Rt.useMemo(()=>void 0!==E?E:j.hasError(K),[j,K,E]);Rt.useEffect(()=>{G||i||R()},[n.referenceValue,i,G]),Rt.useEffect(()=>(O.current&&O.current===document.activeElement&&r("all"),()=>window.clearTimeout(L.current)),[]),Rt.useEffect(()=>{null!=n.tempValueStrAndroid&&null!=i&&(R(),o())},[n.tempValueStrAndroid]);const Y=Rt.useMemo(()=>{var e;return null!=(e=n.tempValueStrAndroid)?e:_.getValueStrFromSections(n.sections,V)},[n.sections,_,n.tempValueStrAndroid,V]),Q=Rt.useMemo(()=>null==i||"letter"===n.sections[i.startIndex].contentType?"text":"numeric",[i,n.sections]),J=O.current&&O.current===ux(document),Z=j.areValuesEqual(t,n.value,j.emptyValue),ee=!J&&Z;Rt.useImperativeHandle(v,()=>({getSections:()=>n.sections,getActiveSectionIndex:()=>{var e,t,i;const r=null!=(e=O.current.selectionStart)?e:0,s=null!=(t=O.current.selectionEnd)?t:0,o=!(null==(i=O.current)||!i.readOnly);if(0===r&&0===s||o)return null;const a=r<=n.sections[0].startInInput?1:n.sections.findIndex(e=>e.startInInput-e.startSeparator.length>r);return-1===a?n.sections.length-1:a-1},setSelectedSections:e=>r(e)}));const te=be((e,...t)=>{var n;e.preventDefault(),null==D||D(e,...t),s(),null==O||null==(n=O.current)||n.focus(),r(0)});return m({placeholder:h,autoComplete:"off",disabled:Boolean(I)},M,{value:ee?"":Y,inputMode:Q,readOnly:g,onClick:z,onFocus:B,onBlur:q,onPaste:H,onChange:$,onKeyDown:X,onMouseUp:W,onClear:te,error:G,ref:N,clearable:Boolean(k&&!Z&&!g&&!I)})},jx=({props:e,valueManager:t,valueType:n,wrapperVariant:i,validator:r})=>{const{onAccept:s,onChange:o,value:a,defaultValue:l,closeOnSelect:c="desktop"===i,selectedSections:u,onSelectedSectionsChange:h,timezone:d}=e,{current:f}=Rt.useRef(l),{current:p}=Rt.useRef(void 0!==a),g=Pb(),v=jb(),[y,b]=Ce({controlled:u,default:null,name:"usePickerValue",state:"selectedSections"}),{isOpen:x,setIsOpen:w}=(({open:e,onOpen:t,onClose:n})=>{const i=Rt.useRef("boolean"==typeof e).current,[r,s]=Rt.useState(!1);return Rt.useEffect(()=>{if(i){if("boolean"!=typeof e)throw new Error("You must not mix controlling and uncontrolled mode for `open` prop");s(e)}},[i,e]),{isOpen:r,setIsOpen:Rt.useCallback(e=>{i||s(e),e&&t&&t(),!e&&n&&n()},[i,t,n])}})(e),[S,C]=Rt.useState(()=>{let e;return e=void 0!==a?a:void 0!==f?f:t.emptyValue,{draft:e,lastPublishedValue:e,lastCommittedValue:e,lastControlledValue:a,hasBeenModifiedSinceMount:!1}}),{timezone:T,handleValueChange:E}=Sx({timezone:d,value:a,defaultValue:f,onChange:o,valueManager:t});Tx(m({},e,{value:S.draft,timezone:T}),r,t.isSameError,t.defaultErrorState);const k=be(n=>{const i={action:n,dateState:S,hasChanged:e=>!t.areValuesEqual(g,n.value,e),isControlled:p,closeOnSelect:c},o=(e=>{const{action:t,hasChanged:n,dateState:i,isControlled:r}=e,s=!r&&!i.hasBeenModifiedSinceMount;return"setValueFromField"===t.name||("setValueFromAction"===t.name?!(!s||!["accept","today","clear"].includes(t.pickerAction))||n(i.lastPublishedValue):("setValueFromView"===t.name&&"shallow"!==t.selectionState||"setValueFromShortcut"===t.name)&&(!!s||n(i.lastPublishedValue)))})(i),a=(e=>{const{action:t,hasChanged:n,dateState:i,isControlled:r,closeOnSelect:s}=e,o=!r&&!i.hasBeenModifiedSinceMount;return"setValueFromAction"===t.name?!(!o||!["accept","today","clear"].includes(t.pickerAction))||n(i.lastCommittedValue):"setValueFromView"===t.name&&"finish"===t.selectionState&&s?!!o||n(i.lastCommittedValue):"setValueFromShortcut"===t.name&&"accept"===t.changeImportance&&n(i.lastCommittedValue)})(i),l=(e=>{const{action:t,closeOnSelect:n}=e;return"setValueFromAction"===t.name||("setValueFromView"===t.name?"finish"===t.selectionState&&n:"setValueFromShortcut"===t.name&&"accept"===t.changeImportance)})(i);if(C(e=>m({},e,{draft:n.value,lastPublishedValue:o?n.value:e.lastPublishedValue,lastCommittedValue:a?n.value:e.lastCommittedValue,hasBeenModifiedSinceMount:!0})),o){const t={validationError:"setValueFromField"===n.name?n.context.validationError:r({adapter:v,value:n.value,props:m({},e,{value:n.value,timezone:T})})};"setValueFromShortcut"===n.name&&null!=n.shortcut&&(t.shortcut=n.shortcut),E(n.value,t)}a&&s&&s(n.value),l&&w(!1)});if(void 0!==a&&(void 0===S.lastControlledValue||!t.areValuesEqual(g,S.lastControlledValue,a))){const e=t.areValuesEqual(g,S.draft,a);C(t=>m({},t,{lastControlledValue:a},e?{}:{lastCommittedValue:a,lastPublishedValue:a,draft:a,hasBeenModifiedSinceMount:!0}))}const D=be(()=>{k({value:t.emptyValue,name:"setValueFromAction",pickerAction:"clear"})}),I=be(()=>{k({value:S.lastPublishedValue,name:"setValueFromAction",pickerAction:"accept"})}),_=be(()=>{k({value:S.lastPublishedValue,name:"setValueFromAction",pickerAction:"dismiss"})}),j=be(()=>{k({value:S.lastCommittedValue,name:"setValueFromAction",pickerAction:"cancel"})}),P=be(()=>{k({value:t.getTodayValue(g,T,n),name:"setValueFromAction",pickerAction:"today"})}),M=be(()=>w(!0)),A=be(()=>w(!1)),R=be((e,t="partial")=>k({name:"setValueFromView",value:e,selectionState:t})),O=be((e,t,n)=>k({name:"setValueFromShortcut",value:e,changeImportance:null!=t?t:"accept",shortcut:n})),N=be((e,t)=>k({name:"setValueFromField",value:e,context:t})),L=be(e=>{b(e),null==h||h(e)}),V={onClear:D,onAccept:I,onDismiss:_,onCancel:j,onSetToday:P,onOpen:M,onClose:A},F={value:S.draft,onChange:N,selectedSections:y,onSelectedSectionsChange:L},U=Rt.useMemo(()=>t.cleanValue(g,S.draft),[g,t,S.draft]);return{open:x,fieldProps:F,viewProps:{value:U,onChange:R,onClose:A,open:x,onSelectedSectionsChange:L},layoutProps:m({},V,{value:U,onChange:R,onSelectShortcut:O,isValid:n=>{const i=r({adapter:v,value:n,props:m({},e,{value:n,timezone:T})});return!t.hasError(i)}}),actions:V}};function Px({onChange:e,onViewChange:t,openTo:n,view:i,views:r,autoFocus:s,focusedView:o,onFocusedViewChange:a}){var l,c;const u=Rt.useRef(n),h=Rt.useRef(r),d=Rt.useRef(r.includes(n)?n:r[0]),[f,p]=Ce({name:"useViews",state:"view",controlled:i,default:d.current}),m=Rt.useRef(s?f:null),[g,v]=Ce({name:"useViews",state:"focusedView",controlled:o,default:m.current});Rt.useEffect(()=>{(u.current&&u.current!==n||h.current&&h.current.some(e=>!r.includes(e)))&&(p(r.includes(n)?n:r[0]),h.current=r,u.current=n)},[n,p,f,r]);const y=r.indexOf(f),b=null!=(l=r[y-1])?l:null,x=null!=(c=r[y+1])?c:null,w=be((e,t)=>{v(t?e:t=>e===t?null:t),null==a||a(e,t)}),S=be(e=>{w(e,!0),e!==f&&(p(e),t&&t(e))}),C=be(()=>{x&&S(x)}),T=be((t,n,i)=>{const s="finish"===n,o=i?r.indexOf(i)<r.length-1:Boolean(x);if(e(t,s&&o?"partial":n,i),i&&i!==f){const e=r[r.indexOf(i)+1];e&&S(e)}else s&&C()});return{view:f,setView:S,focusedView:g,setFocusedView:w,nextView:x,previousView:b,defaultView:r.includes(n)?n:r[0],goToNextView:C,setValueAndGoToNextView:T}}const Mx=["className","sx"],Ax=({props:e,propsFromPickerValue:t,additionalViewProps:n,inputRef:i,autoFocusView:r})=>{const{onChange:s,open:o,onSelectedSectionsChange:a,onClose:l}=t,{view:c,views:u,openTo:h,onViewChange:d,viewRenderers:f,timezone:p}=e,g=ie(e,Mx),{view:v,setView:y,defaultView:b,focusedView:x,setFocusedView:w,setValueAndGoToNextView:S}=Px({view:c,views:u,openTo:h,onChange:s,onViewChange:d,autoFocus:r}),{hasUIView:C,viewModeLookup:T}=Rt.useMemo(()=>u.reduce((e,t)=>{let n;return n=null!=f[t]?"UI":"field",e.viewModeLookup[t]=n,"UI"===n&&(e.hasUIView=!0),e},{hasUIView:!1,viewModeLookup:{}}),[f,u]),E=Rt.useMemo(()=>u.reduce((e,t)=>null!=f[t]&&(e=>tb.includes(e))(t)?e+1:e,0),[f,u]),k=T[v],D=be(()=>"UI"===k),[I,_]=Rt.useState("UI"===k?v:null);return I!==v&&"UI"===T[v]&&_(v),Te(()=>{"field"===k&&o&&(l(),setTimeout(()=>{null==i||i.current.focus(),a(v)}))},[v]),Te(()=>{if(!o)return;let e=v;"field"===k&&null!=I&&(e=I),e!==b&&"UI"===T[e]&&"UI"===T[b]&&(e=b),e!==v&&y(e),w(e,!0)},[o]),{hasUIView:C,shouldRestoreFocus:D,layoutProps:{views:u,view:I,onViewChange:y},renderCurrentView:()=>{if(null==I)return null;const e=f[I];return null==e?null:e(m({},g,n,t,{views:u,timezone:p,onChange:S,view:I,onViewChange:y,focusedView:x,onFocusedViewChange:w,showViewSwitcher:E>1,timeViewsCount:E}))}}};function Rx(){return"undefined"==typeof window?"portrait":window.screen&&window.screen.orientation&&window.screen.orientation.angle?90===Math.abs(window.screen.orientation.angle)?"landscape":"portrait":window.orientation&&90===Math.abs(Number(window.orientation))?"landscape":"portrait"}const Ox=(e,t)=>{const[n,i]=Rt.useState(Rx);return Te(()=>{const e=()=>{i(Rx())};return window.addEventListener("orientationchange",e),()=>{window.removeEventListener("orientationchange",e)}},[]),r=e,s=["hours","minutes","seconds"],!(Array.isArray(s)?s.every(e=>-1!==r.indexOf(e)):-1!==r.indexOf(s))&&"landscape"===(t||n);var r,s},Nx=({props:e,valueManager:t,valueType:n,wrapperVariant:i,inputRef:r,additionalViewProps:s,validator:o,autoFocusView:a})=>{const l=jx({props:e,valueManager:t,valueType:n,wrapperVariant:i,validator:o}),c=Ax({props:e,inputRef:r,additionalViewProps:s,autoFocusView:a,propsFromPickerValue:l.viewProps}),u=(({props:e,propsFromPickerValue:t,propsFromPickerViews:n,wrapperVariant:i})=>{const{orientation:r}=e,s=Ox(n.views,r);return{layoutProps:m({},n,t,{isLandscape:s,wrapperVariant:i,disabled:e.disabled,readOnly:e.readOnly})}})({props:e,wrapperVariant:i,propsFromPickerValue:l.layoutProps,propsFromPickerViews:c.layoutProps});return{open:l.open,actions:l.actions,fieldProps:l.fieldProps,renderCurrentView:c.renderCurrentView,hasUIView:c.hasUIView,shouldRestoreFocus:c.shouldRestoreFocus,layoutProps:u.layoutProps}};function Lx(e){return se("MuiPickersLayout",e)}const Vx=oe("MuiPickersLayout",["root","landscape","contentWrapper","toolbar","actionBar","tabs","shortcuts"]),Fx=["onAccept","onClear","onCancel","onSetToday","actions"];function Ux(e){const{onAccept:t,onClear:n,onCancel:i,onSetToday:r,actions:s}=e,o=ie(e,Fx),a=Ab();if(null==s||0===s.length)return null;const l=null==s?void 0:s.map(e=>{switch(e){case"clear":return v.jsx(Ee,{onClick:n,children:a.clearButtonLabel},e);case"cancel":return v.jsx(Ee,{onClick:i,children:a.cancelButtonLabel},e);case"accept":return v.jsx(Ee,{onClick:t,children:a.okButtonLabel},e);case"today":return v.jsx(Ee,{onClick:r,children:a.todayButtonLabel},e);default:return null}});return v.jsx(ke,m({},o,{children:l}))}const zx=["items","changeImportance","isLandscape","onChange","isValid"],Wx=["getValue"];function Bx(e){const{items:t,changeImportance:n,onChange:i,isValid:r}=e,s=ie(e,zx);if(null==t||0===t.length)return null;const o=t.map(e=>{let{getValue:t}=e,s=ie(e,Wx);const o=t({isValid:r});return{label:s.label,onClick:()=>{i(o,n,s)},disabled:!r(o)}});return v.jsx(q,m({dense:!0,sx:[{maxHeight:334,maxWidth:200,overflow:"auto"},...Array.isArray(s.sx)?s.sx:[s.sx]]},s,{children:o.map(e=>v.jsx(H,{children:v.jsx(De,m({},e))},e.label))}))}const qx=e=>{var t,n;const{wrapperVariant:i,onAccept:r,onClear:s,onCancel:o,onSetToday:a,view:l,views:c,onViewChange:u,value:h,onChange:d,onSelectShortcut:f,isValid:p,isLandscape:g,disabled:y,readOnly:b,children:x,components:w,componentsProps:S,slots:C,slotProps:T}=e,E=null!=C?C:qb(w),k=null!=T?T:S,D=(e=>{const{classes:t,isLandscape:n}=e;return le({root:["root",n&&"landscape"],contentWrapper:["contentWrapper"],toolbar:["toolbar"],actionBar:["actionBar"],tabs:["tabs"],landscape:["landscape"],shortcuts:["shortcuts"]},Lx,t)})(e),I=null!=(t=null==E?void 0:E.actionBar)?t:Ux,_=qy({elementType:I,externalSlotProps:null==k?void 0:k.actionBar,additionalProps:{onAccept:r,onClear:s,onCancel:o,onSetToday:a,actions:"desktop"===i?[]:["cancel","accept"],className:D.actionBar},ownerState:m({},e,{wrapperVariant:i})}),j=v.jsx(I,m({},_)),P=null==E?void 0:E.toolbar,M=qy({elementType:P,externalSlotProps:null==k?void 0:k.toolbar,additionalProps:{isLandscape:g,onChange:d,value:h,view:l,onViewChange:u,views:c,disabled:y,readOnly:b,className:D.toolbar},ownerState:m({},e,{wrapperVariant:i})}),A=function(e){return null!==e.view}(M)&&P?v.jsx(P,m({},M)):null,R=x,O=null==E?void 0:E.tabs,N=l&&O?v.jsx(O,m({view:l,onViewChange:u,className:D.tabs},null==k?void 0:k.tabs)):null,L=null!=(n=null==E?void 0:E.shortcuts)?n:Bx,V=qy({elementType:L,externalSlotProps:null==k?void 0:k.shortcuts,additionalProps:{isValid:p,isLandscape:g,onChange:f,className:D.shortcuts},ownerState:{isValid:p,isLandscape:g,onChange:f,className:D.shortcuts,wrapperVariant:i}});return{toolbar:A,content:R,tabs:N,actionBar:j,shortcuts:l&&L?v.jsx(L,m({},V)):null}},Hx=ae("div",{name:"MuiPickersLayout",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>({display:"grid",gridAutoColumns:"max-content auto max-content",gridAutoRows:"max-content auto max-content",[`& .${Vx.toolbar}`]:t.isLandscape?{gridColumn:"rtl"===e.direction?3:1,gridRow:"2 / 3"}:{gridColumn:"2 / 4",gridRow:1},[`.${Vx.shortcuts}`]:t.isLandscape?{gridColumn:"2 / 4",gridRow:1}:{gridColumn:"rtl"===e.direction?3:1,gridRow:"2 / 3"},[`& .${Vx.actionBar}`]:{gridColumn:"1 / 4",gridRow:3}}));Hx.propTypes={as:Ie.elementType,ownerState:Ie.shape({isLandscape:Ie.bool.isRequired}).isRequired,sx:Ie.oneOfType([Ie.arrayOf(Ie.oneOfType([Ie.func,Ie.object,Ie.bool])),Ie.func,Ie.object])};const $x=ae("div",{name:"MuiPickersLayout",slot:"ContentWrapper",overridesResolver:(e,t)=>t.contentWrapper})({gridColumn:2,gridRow:2,display:"flex",flexDirection:"column"}),Xx=function(e){const t=re({props:e,name:"MuiPickersLayout"}),{toolbar:n,content:i,tabs:r,actionBar:s,shortcuts:o}=qx(t),{sx:a,className:l,isLandscape:c,ref:u,wrapperVariant:h}=t,d=t,f=(e=>{const{isLandscape:t,classes:n}=e;return le({root:["root",t&&"landscape"],contentWrapper:["contentWrapper"]},Lx,n)})(d);return v.jsxs(Hx,{ref:u,sx:a,className:ne(l,f.root),ownerState:d,children:[c?o:n,c?n:o,v.jsx($x,{className:f.contentWrapper,children:"desktop"===h?v.jsxs(Rt.Fragment,{children:[i,r]}):v.jsxs(Rt.Fragment,{children:[r,i]})}),s]})},Kx=["disablePast","disableFuture","minDate","maxDate","shouldDisableDate","shouldDisableMonth","shouldDisableYear"],Gx=[...Kx,"disablePast","disableFuture","minTime","maxTime","shouldDisableClock","shouldDisableTime","minutesStep","ampm","disableIgnoringDatePartForTimeValidation","minDateTime","maxDateTime"],Yx=e=>Gx.reduce((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t),{}),Qx=["value","defaultValue","referenceDate","format","formatDensity","onChange","timezone","readOnly","onError","shouldRespectLeadingZeros","selectedSections","onSelectedSectionsChange","unstableFieldRef"],Jx=({props:e,value:t,adapter:n})=>{if(null===t)return null;const{shouldDisableDate:i,shouldDisableMonth:r,shouldDisableYear:s,disablePast:o,disableFuture:a,timezone:l}=e,c=n.utils.dateWithTimezone(void 0,l),u=Ky(n.utils,e.minDate,n.defaultDates.minDate),h=Ky(n.utils,e.maxDate,n.defaultDates.maxDate);switch(!0){case!n.utils.isValid(t):return"invalidDate";case Boolean(i&&i(t)):return"shouldDisableDate";case Boolean(r&&r(t)):return"shouldDisableMonth";case Boolean(s&&s(t)):return"shouldDisableYear";case Boolean(a&&n.utils.isAfterDay(t,c)):return"disableFuture";case Boolean(o&&n.utils.isBeforeDay(t,c)):return"disablePast";case Boolean(u&&n.utils.isBeforeDay(t,u)):return"minDate";case Boolean(h&&n.utils.isAfterDay(t,h)):return"maxDate";default:return null}};function Zx(e){return se("MuiPickersDay",e)}const ew=oe("MuiPickersDay",["root","dayWithMargin","dayOutsideMonth","hiddenDaySpacingFiller","today","selected","disabled"]),tw=["autoFocus","className","day","disabled","disableHighlightToday","disableMargin","hidden","isAnimating","onClick","onDaySelect","onFocus","onBlur","onKeyDown","onMouseDown","onMouseEnter","outsideCurrentMonth","selected","showDaysOutsideCurrentMonth","children","today","isFirstVisibleCell","isLastVisibleCell"],nw=({theme:e,ownerState:t})=>m({},e.typography.caption,{width:36,height:36,borderRadius:"50%",padding:0,backgroundColor:"transparent",transition:e.transitions.create("background-color",{duration:e.transitions.duration.short}),color:(e.vars||e).palette.text.primary,"@media (pointer: fine)":{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.hoverOpacity})`:je(e.palette.primary.main,e.palette.action.hoverOpacity)}},"&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.focusOpacity})`:je(e.palette.primary.main,e.palette.action.focusOpacity),[`&.${ew.selected}`]:{willChange:"background-color",backgroundColor:(e.vars||e).palette.primary.dark}},[`&.${ew.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,fontWeight:e.typography.fontWeightMedium,"&:hover":{willChange:"background-color",backgroundColor:(e.vars||e).palette.primary.dark}},[`&.${ew.disabled}:not(.${ew.selected})`]:{color:(e.vars||e).palette.text.disabled},[`&.${ew.disabled}&.${ew.selected}`]:{opacity:.6}},!t.disableMargin&&{margin:"0 2px"},t.outsideCurrentMonth&&t.showDaysOutsideCurrentMonth&&{color:(e.vars||e).palette.text.secondary},!t.disableHighlightToday&&t.today&&{[`&:not(.${ew.selected})`]:{border:`1px solid ${(e.vars||e).palette.text.secondary}`}}),iw=(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disableMargin&&t.dayWithMargin,!n.disableHighlightToday&&n.today&&t.today,!n.outsideCurrentMonth&&n.showDaysOutsideCurrentMonth&&t.dayOutsideMonth,n.outsideCurrentMonth&&!n.showDaysOutsideCurrentMonth&&t.hiddenDaySpacingFiller]},rw=ae(_e,{name:"MuiPickersDay",slot:"Root",overridesResolver:iw})(nw),sw=ae("div",{name:"MuiPickersDay",slot:"Root",overridesResolver:iw})(({theme:e,ownerState:t})=>m({},nw({theme:e,ownerState:t}),{opacity:0,pointerEvents:"none"})),ow=()=>{},aw=Rt.forwardRef(function(e,t){const n=re({props:e,name:"MuiPickersDay"}),{autoFocus:i=!1,className:r,day:s,disabled:o=!1,disableHighlightToday:a=!1,disableMargin:l=!1,isAnimating:c,onClick:u,onDaySelect:h,onFocus:d=ow,onBlur:f=ow,onKeyDown:p=ow,onMouseDown:g=ow,onMouseEnter:y=ow,outsideCurrentMonth:b,selected:x=!1,showDaysOutsideCurrentMonth:w=!1,children:S,today:C=!1}=n,T=ie(n,tw),E=m({},n,{autoFocus:i,disabled:o,disableHighlightToday:a,disableMargin:l,selected:x,showDaysOutsideCurrentMonth:w,today:C}),k=(e=>{const{selected:t,disableMargin:n,disableHighlightToday:i,today:r,disabled:s,outsideCurrentMonth:o,showDaysOutsideCurrentMonth:a,classes:l}=e,c=o&&!a;return le({root:["root",t&&!c&&"selected",s&&"disabled",!n&&"dayWithMargin",!i&&r&&"today",o&&a&&"dayOutsideMonth",c&&"hiddenDaySpacingFiller"],hiddenDaySpacingFiller:["hiddenDaySpacingFiller"]},Zx,l)})(E),D=Pb(),I=Rt.useRef(null),_=ge(I,t);return Te(()=>{!i||o||c||b||I.current.focus()},[i,o,c,b]),b&&!w?v.jsx(sw,{className:ne(k.root,k.hiddenDaySpacingFiller,r),ownerState:E,role:T.role}):v.jsx(rw,m({className:ne(k.root,r),ref:_,centerRipple:!0,disabled:o,tabIndex:x?0:-1,onKeyDown:e=>p(e,s),onFocus:e=>d(e,s),onBlur:e=>f(e,s),onMouseEnter:e=>y(e,s),onClick:e=>{o||h(s),b&&e.currentTarget.focus(),u&&u(e)},onMouseDown:e=>{g(e),b&&e.preventDefault()}},T,{ownerState:E,children:S||D.format(s,"dayOfMonth")}))}),lw=Rt.memo(aw),cw=e=>se("MuiPickersSlideTransition",e),uw=oe("MuiPickersSlideTransition",["root","slideEnter-left","slideEnter-right","slideEnterActive","slideExit","slideExitActiveLeft-left","slideExitActiveLeft-right"]),hw=["children","className","reduceAnimations","slideDirection","transKey","classes"],dw=ae(Me,{name:"MuiPickersSlideTransition",slot:"Root",overridesResolver:(e,t)=>[t.root,{[`.${uw["slideEnter-left"]}`]:t["slideEnter-left"]},{[`.${uw["slideEnter-right"]}`]:t["slideEnter-right"]},{[`.${uw.slideEnterActive}`]:t.slideEnterActive},{[`.${uw.slideExit}`]:t.slideExit},{[`.${uw["slideExitActiveLeft-left"]}`]:t["slideExitActiveLeft-left"]},{[`.${uw["slideExitActiveLeft-right"]}`]:t["slideExitActiveLeft-right"]}]})(({theme:e})=>{const t=e.transitions.create("transform",{duration:e.transitions.duration.complex,easing:"cubic-bezier(0.35, 0.8, 0.4, 1)"});return{display:"block",position:"relative",overflowX:"hidden","& > *":{position:"absolute",top:0,right:0,left:0},[`& .${uw["slideEnter-left"]}`]:{willChange:"transform",transform:"translate(100%)",zIndex:1},[`& .${uw["slideEnter-right"]}`]:{willChange:"transform",transform:"translate(-100%)",zIndex:1},[`& .${uw.slideEnterActive}`]:{transform:"translate(0%)",transition:t},[`& .${uw.slideExit}`]:{transform:"translate(0%)"},[`& .${uw["slideExitActiveLeft-left"]}`]:{willChange:"transform",transform:"translate(-100%)",transition:t,zIndex:0},[`& .${uw["slideExitActiveLeft-right"]}`]:{willChange:"transform",transform:"translate(100%)",transition:t,zIndex:0}}}),fw=({shouldDisableDate:e,shouldDisableMonth:t,shouldDisableYear:n,minDate:i,maxDate:r,disableFuture:s,disablePast:o,timezone:a})=>{const l=jb();return Rt.useCallback(c=>null!==Jx({adapter:l,value:c,props:{shouldDisableDate:e,shouldDisableMonth:t,shouldDisableYear:n,minDate:i,maxDate:r,disableFuture:s,disablePast:o,timezone:a}}),[l,e,t,n,i,r,s,o,a])},pw=e=>se("MuiDayCalendar",e);oe("MuiDayCalendar",["root","header","weekDayLabel","loadingContainer","slideTransition","monthContainer","weekContainer","weekNumberLabel","weekNumber"]);const mw=["parentProps","day","focusableDay","selectedDays","isDateDisabled","currentMonthNumber","isViewFocused"],gw=["ownerState"],vw=ae("div",{name:"MuiDayCalendar",slot:"Root",overridesResolver:(e,t)=>t.root})({}),yw=ae("div",{name:"MuiDayCalendar",slot:"Header",overridesResolver:(e,t)=>t.header})({display:"flex",justifyContent:"center",alignItems:"center"}),bw=ae(T,{name:"MuiDayCalendar",slot:"WeekDayLabel",overridesResolver:(e,t)=>t.weekDayLabel})(({theme:e})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(e.vars||e).palette.text.secondary})),xw=ae(T,{name:"MuiDayCalendar",slot:"WeekNumberLabel",overridesResolver:(e,t)=>t.weekNumberLabel})(({theme:e})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:e.palette.text.disabled})),ww=ae(T,{name:"MuiDayCalendar",slot:"WeekNumber",overridesResolver:(e,t)=>t.weekNumber})(({theme:e})=>m({},e.typography.caption,{width:36,height:36,padding:0,margin:"0 2px",color:e.palette.text.disabled,fontSize:"0.75rem",alignItems:"center",justifyContent:"center",display:"inline-flex"})),Sw=ae("div",{name:"MuiDayCalendar",slot:"LoadingContainer",overridesResolver:(e,t)=>t.loadingContainer})({display:"flex",justifyContent:"center",alignItems:"center",minHeight:240}),Cw=ae(function(e){const t=re({props:e,name:"MuiPickersSlideTransition"}),{children:n,className:i,reduceAnimations:r,transKey:s}=t,o=ie(t,hw),a=(e=>{const{classes:t,slideDirection:n}=e;return le({root:["root"],exit:["slideExit"],enterActive:["slideEnterActive"],enter:[`slideEnter-${n}`],exitActive:[`slideExitActiveLeft-${n}`]},cw,t)})(t),l=ue();if(r)return v.jsx("div",{className:ne(a.root,i),children:n});const c={exit:a.exit,enterActive:a.enterActive,enter:a.enter,exitActive:a.exitActive};return v.jsx(dw,{className:ne(a.root,i),childFactory:e=>Rt.cloneElement(e,{classNames:c}),role:"presentation",children:v.jsx(Pe,m({mountOnEnter:!0,unmountOnExit:!0,timeout:l.transitions.duration.complex,classNames:c},o,{children:n}),s)})},{name:"MuiDayCalendar",slot:"SlideTransition",overridesResolver:(e,t)=>t.slideTransition})({minHeight:240}),Tw=ae("div",{name:"MuiDayCalendar",slot:"MonthContainer",overridesResolver:(e,t)=>t.monthContainer})({overflow:"hidden"}),Ew=ae("div",{name:"MuiDayCalendar",slot:"WeekContainer",overridesResolver:(e,t)=>t.weekContainer})({margin:"2px 0",display:"flex",justifyContent:"center"});function kw(e){var t,n,i;let{parentProps:r,day:s,focusableDay:o,selectedDays:a,isDateDisabled:l,currentMonthNumber:c,isViewFocused:u}=e,h=ie(e,mw);const{disabled:d,disableHighlightToday:f,isMonthSwitchingAnimating:p,showDaysOutsideCurrentMonth:g,components:y,componentsProps:b,slots:x,slotProps:w,timezone:S}=r,C=Pb(),T=Rb(S),E=null!==o&&C.isSameDay(s,o),k=a.some(e=>C.isSameDay(e,s)),D=C.isSameDay(s,T),I=null!=(t=null!=(n=null==x?void 0:x.day)?n:null==y?void 0:y.Day)?t:lw,_=qy({elementType:I,externalSlotProps:null!=(i=null==w?void 0:w.day)?i:null==b?void 0:b.day,additionalProps:m({disableHighlightToday:f,showDaysOutsideCurrentMonth:g,role:"gridcell",isAnimating:p,"data-timestamp":C.toJsDate(s).valueOf()},h),ownerState:m({},r,{day:s,selected:k})}),j=ie(_,gw),P=Rt.useMemo(()=>d||l(s),[d,l,s]),M=Rt.useMemo(()=>C.getMonth(s)!==c,[C,s,c]),A=Rt.useMemo(()=>{const e=C.startOfMonth(C.setMonth(s,c));return g?C.isSameDay(s,C.startOfWeek(e)):C.isSameDay(s,e)},[c,s,g,C]),R=Rt.useMemo(()=>{const e=C.endOfMonth(C.setMonth(s,c));return g?C.isSameDay(s,C.endOfWeek(e)):C.isSameDay(s,e)},[c,s,g,C]);return v.jsx(I,m({},j,{day:s,disabled:P,autoFocus:u&&E,today:D,outsideCurrentMonth:M,isFirstVisibleCell:A,isLastVisibleCell:R,selected:k,tabIndex:E?0:-1,"aria-selected":k,"aria-current":D?"date":void 0}))}function Dw(e){const t=re({props:e,name:"MuiDayCalendar"}),{onFocusedDayChange:n,className:i,currentMonth:r,selectedDays:s,focusedDay:o,loading:a,onSelectedDaysChange:l,onMonthSwitchingAnimationEnd:c,readOnly:u,reduceAnimations:h,renderLoading:d=()=>v.jsx("span",{children:"..."}),slideDirection:f,TransitionProps:p,disablePast:g,disableFuture:y,minDate:b,maxDate:x,shouldDisableDate:w,shouldDisableMonth:S,shouldDisableYear:C,dayOfWeekFormatter:T,hasFocus:E,onFocusedViewChange:k,gridLabelId:D,displayWeekNumber:I,fixedWeekNumber:_,autoFocus:j,timezone:P}=t,M=Rb(P),A=Pb(),R=(e=>{const{classes:t}=e;return le({root:["root"],header:["header"],weekDayLabel:["weekDayLabel"],loadingContainer:["loadingContainer"],slideTransition:["slideTransition"],monthContainer:["monthContainer"],weekContainer:["weekContainer"],weekNumberLabel:["weekNumberLabel"],weekNumber:["weekNumber"]},pw,t)})(t),O="rtl"===ue().direction,N=T||((e,t)=>A.format(t,"weekdayShort").charAt(0).toUpperCase()),L=fw({shouldDisableDate:w,shouldDisableMonth:S,shouldDisableYear:C,minDate:b,maxDate:x,disablePast:g,disableFuture:y,timezone:P}),V=Ab(),[F,U]=Ce({name:"DayCalendar",state:"hasFocus",controlled:E,default:null!=j&&j}),[z,W]=Rt.useState(()=>o||M),B=be(e=>{u||l(e)}),q=e=>{L(e)||(n(e),W(e),null==k||k(!0),U(!0))},H=be((e,t)=>{switch(e.key){case"ArrowUp":q(A.addDays(t,-7)),e.preventDefault();break;case"ArrowDown":q(A.addDays(t,7)),e.preventDefault();break;case"ArrowLeft":{const n=A.addDays(t,O?1:-1),i=A.addMonths(t,O?1:-1),r=Xy({utils:A,date:n,minDate:O?n:A.startOfMonth(i),maxDate:O?A.endOfMonth(i):n,isDateDisabled:L,timezone:P});q(r||n),e.preventDefault();break}case"ArrowRight":{const n=A.addDays(t,O?-1:1),i=A.addMonths(t,O?-1:1),r=Xy({utils:A,date:n,minDate:O?A.startOfMonth(i):n,maxDate:O?n:A.endOfMonth(i),isDateDisabled:L,timezone:P});q(r||n),e.preventDefault();break}case"Home":q(A.startOfWeek(t)),e.preventDefault();break;case"End":q(A.endOfWeek(t)),e.preventDefault();break;case"PageUp":q(A.addMonths(t,1)),e.preventDefault();break;case"PageDown":q(A.addMonths(t,-1)),e.preventDefault()}}),$=be((e,t)=>q(t)),X=be((e,t)=>{F&&A.isSameDay(z,t)&&(null==k||k(!1))}),K=A.getMonth(r),G=Rt.useMemo(()=>s.filter(e=>!!e).map(e=>A.startOfDay(e)),[A,s]),Y=K,Q=Rt.useMemo(()=>Rt.createRef(),[Y]),J=A.startOfWeek(M),Z=Rt.useMemo(()=>{const e=A.startOfMonth(r),t=A.endOfMonth(r);return L(z)||A.isAfterDay(z,t)||A.isBeforeDay(z,e)?Xy({utils:A,date:z,minDate:e,maxDate:t,disablePast:g,disableFuture:y,isDateDisabled:L,timezone:P}):z},[r,y,g,z,L,A,P]),ee=Rt.useMemo(()=>{const e=A.setTimezone(r,P),t=A.getWeekArray(e);let n=A.addMonths(e,1);for(;_&&t.length<_;){const e=A.getWeekArray(n),i=A.isSameDay(t[t.length-1][0],e[0][0]);e.slice(i?1:0).forEach(e=>{t.length<_&&t.push(e)}),n=A.addMonths(n,1)}return t},[r,_,A,P]);return v.jsxs(vw,{role:"grid","aria-labelledby":D,className:R.root,children:[v.jsxs(yw,{role:"row",className:R.header,children:[I&&v.jsx(xw,{variant:"caption",role:"columnheader","aria-label":V.calendarWeekNumberHeaderLabel,className:R.weekNumberLabel,children:V.calendarWeekNumberHeaderText}),eb(A,M).map((e,t)=>{var n;const i=A.format(e,"weekdayShort");return v.jsx(bw,{variant:"caption",role:"columnheader","aria-label":A.format(A.addDays(J,t),"weekday"),className:R.weekDayLabel,children:null!=(n=null==N?void 0:N(i,e))?n:i},i+t.toString())})]}),a?v.jsx(Sw,{className:R.loadingContainer,children:d()}):v.jsx(Cw,m({transKey:Y,onExited:c,reduceAnimations:h,slideDirection:f,className:ne(i,R.slideTransition)},p,{nodeRef:Q,children:v.jsx(Tw,{ref:Q,role:"rowgroup",className:R.monthContainer,children:ee.map((e,n)=>v.jsxs(Ew,{role:"row",className:R.weekContainer,"aria-rowindex":n+1,children:[I&&v.jsx(ww,{className:R.weekNumber,role:"rowheader","aria-label":V.calendarWeekNumberAriaLabelText(A.getWeekNumber(e[0])),children:V.calendarWeekNumberText(A.getWeekNumber(e[0]))}),e.map((e,n)=>v.jsx(kw,{parentProps:t,day:e,selectedDays:G,focusableDay:Z,onKeyDown:H,onFocus:$,onBlur:X,onDaySelect:B,isDateDisabled:L,currentMonthNumber:K,isViewFocused:F,"aria-colindex":n+1},e.toString()))]},`week-${e[0]}`))})}))]})}const Iw=e=>{const{value:t,referenceDate:n,defaultCalendarMonth:i,disableFuture:r,disablePast:s,disableSwitchToMonthOnDayFocus:o=!1,maxDate:a,minDate:l,onMonthChange:c,reduceAnimations:u,shouldDisableDate:h,timezone:d}=e,f=Pb(),p=Rt.useRef(((e,t,n)=>(i,r)=>{switch(r.type){case"changeMonth":return m({},i,{slideDirection:r.direction,currentMonth:r.newMonth,isMonthSwitchingAnimating:!e});case"finishMonthSwitchingAnimation":return m({},i,{isMonthSwitchingAnimating:!1});case"changeFocusedDay":{if(null!=i.focusedDay&&null!=r.focusedDay&&n.isSameDay(r.focusedDay,i.focusedDay))return i;const s=null!=r.focusedDay&&!t&&!n.isSameMonth(i.currentMonth,r.focusedDay);return m({},i,{focusedDay:r.focusedDay,isMonthSwitchingAnimating:s&&!e&&!r.withoutMonthSwitchingAnimation,currentMonth:s?n.startOfMonth(r.focusedDay):i.currentMonth,slideDirection:null!=r.focusedDay&&n.isAfterDay(r.focusedDay,i.currentMonth)?"left":"right"})}default:throw new Error("missing support")}})(Boolean(u),o,f)).current,g=Rt.useMemo(()=>{let r=null;return n?r=n:i&&(r=f.startOfMonth(i)),Cb.getInitialReferenceValue({value:t,utils:f,timezone:d,props:e,referenceDate:r,granularity:ib.day})},[]),[v,y]=Rt.useReducer(p,{isMonthSwitchingAnimating:!1,focusedDay:g,currentMonth:f.startOfMonth(g),slideDirection:"left"}),b=Rt.useCallback(e=>{y(m({type:"changeMonth"},e)),c&&c(e.newMonth)},[c]),x=Rt.useCallback(e=>{const t=e;f.isSameMonth(t,v.currentMonth)||b({newMonth:f.startOfMonth(t),direction:f.isAfterDay(t,v.currentMonth)?"left":"right"})},[v.currentMonth,b,f]),w=fw({shouldDisableDate:h,minDate:l,maxDate:a,disableFuture:r,disablePast:s,timezone:d}),S=Rt.useCallback(()=>{y({type:"finishMonthSwitchingAnimation"})},[]),C=be((e,t)=>{w(e)||y({type:"changeFocusedDay",focusedDay:e,withoutMonthSwitchingAnimation:t})});return{referenceDate:g,calendarState:v,changeMonth:x,changeFocusedDay:C,isDateDisabled:w,onMonthSwitchingAnimationEnd:S,handleChangeMonth:b}},_w=["props","getOpenDialogAriaText"],jw=["ownerState"],Pw=["ownerState"],Mw=({props:e,inputRef:t})=>{const n=(e=>{var t,n,i;const r=Pb(),s=Mb();return m({},e,{disablePast:null!=(t=e.disablePast)&&t,disableFuture:null!=(n=e.disableFuture)&&n,format:null!=(i=e.format)?i:r.formats.keyboardDate,minDate:Ky(r,e.minDate,s.minDate),maxDate:Ky(r,e.maxDate,s.maxDate)})})(e),{forwardedProps:i,internalProps:r}=(e=>{const t=m({},e),n={},i=e=>{t.hasOwnProperty(e)&&(n[e]=t[e],delete t[e])};return Qx.forEach(i),Kx.forEach(i),{forwardedProps:t,internalProps:n}})(n);return _x({inputRef:t,forwardedProps:i,internalProps:r,valueManager:Cb,fieldValueManager:Tb,validator:Jx})},Aw=["ownerState"],Rw=["components","componentsProps","slots","slotProps","InputProps","inputProps"],Ow=["inputRef"],Nw=["ref","onPaste","onKeyDown","inputMode","readOnly","clearable","onClear"],Lw=Rt.forwardRef(function(e,t){var n,i,r;const s=re({props:e,name:"MuiDateField"}),{components:o,componentsProps:a,slots:l,slotProps:c,InputProps:u,inputProps:h}=s,d=ie(s,Rw),f=s,p=null!=(n=null!=(i=null==l?void 0:l.textField)?i:null==o?void 0:o.TextField)?n:Oe,g=qy({elementType:p,externalSlotProps:null!=(r=null==c?void 0:c.textField)?r:null==a?void 0:a.textField,externalForwardedProps:d,ownerState:f}),{inputRef:y}=g,b=ie(g,Ow);b.inputProps=m({},h,b.inputProps),b.InputProps=m({},u,b.InputProps);const x=Mw({props:b,inputRef:y}),{ref:w,onPaste:C,onKeyDown:T,inputMode:E,readOnly:k,clearable:D,onClear:I}=x,_=ie(x,Nw),{InputProps:j,fieldProps:P}=(({clearable:e,fieldProps:t,InputProps:n,onClear:i,slots:r,slotProps:s,components:o,componentsProps:a})=>{var l,c,u,h,d,f;const p=Ab(),g=null!=(l=null!=(c=null==r?void 0:r.clearButton)?c:null==o?void 0:o.ClearButton)?l:S,y=qy({elementType:g,externalSlotProps:null!=(u=null==s?void 0:s.clearButton)?u:null==a?void 0:a.clearButton,ownerState:{},className:"clearButton",additionalProps:{title:p.fieldClearLabel}}),b=ie(y,Aw),x=null!=(h=null!=(d=null==r?void 0:r.clearIcon)?d:null==o?void 0:o.ClearIcon)?h:Yb,w=qy({elementType:x,externalSlotProps:null!=(f=null==s?void 0:s.clearIcon)?f:null==a?void 0:a.clearIcon,ownerState:{}});return{InputProps:m({},n,{endAdornment:v.jsxs(Rt.Fragment,{children:[e&&v.jsx(Re,{position:"end",sx:{marginRight:null!=n&&n.endAdornment?-1:-1.5},children:v.jsx(g,m({},b,{onClick:i,children:v.jsx(x,m({fontSize:"small"},w))}))}),null==n?void 0:n.endAdornment]})}),fieldProps:m({},t,{sx:[{"& .clearButton":{opacity:1},"@media (pointer: fine)":{"& .clearButton":{opacity:0},"&:hover, &:focus-within":{".clearButton":{opacity:1}}}},...Array.isArray(t.sx)?t.sx:[t.sx]]})}})({onClear:I,clearable:D,fieldProps:_,InputProps:_.InputProps,slots:l,slotProps:c,components:o,componentsProps:a});return v.jsx(p,m({ref:t},P,{InputProps:m({},j,{readOnly:k}),inputProps:m({},_.inputProps,{inputMode:E,onPaste:C,onKeyDown:T,ref:w})}))}),Vw=e=>se("MuiPickersFadeTransitionGroup",e);oe("MuiPickersFadeTransitionGroup",["root"]);const Fw=ae(Me,{name:"MuiPickersFadeTransitionGroup",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"block",position:"relative"});function Uw(e){const t=re({props:e,name:"MuiPickersFadeTransitionGroup"}),{children:n,className:i,reduceAnimations:r,transKey:s}=t,o=(e=>{const{classes:t}=e;return le({root:["root"]},Vw,t)})(t),a=ue();return r?n:v.jsx(Fw,{className:ne(o.root,i),children:v.jsx(he,{appear:!1,mountOnEnter:!0,unmountOnExit:!0,timeout:{appear:a.transitions.duration.enteringScreen,enter:a.transitions.duration.enteringScreen,exit:0},children:n},s)})}function zw(e){return se("MuiPickersMonth",e)}const Ww=oe("MuiPickersMonth",["root","monthButton","disabled","selected"]),Bw=["autoFocus","children","disabled","selected","value","tabIndex","onClick","onKeyDown","onFocus","onBlur","aria-current","aria-label","monthsPerRow"],qw=ae("div",{name:"MuiPickersMonth",slot:"Root",overridesResolver:(e,t)=>[t.root]})(({ownerState:e})=>({flexBasis:3===e.monthsPerRow?"33.3%":"25%",display:"flex",alignItems:"center",justifyContent:"center"})),Hw=ae("button",{name:"MuiPickersMonth",slot:"MonthButton",overridesResolver:(e,t)=>[t.monthButton,{[`&.${Ww.disabled}`]:t.disabled},{[`&.${Ww.selected}`]:t.selected}]})(({theme:e})=>m({color:"unset",backgroundColor:"transparent",border:0,outline:0},e.typography.subtitle1,{margin:"8px 0",height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:je(e.palette.action.active,e.palette.action.hoverOpacity)},"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:je(e.palette.action.active,e.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${Ww.disabled}`]:{color:(e.vars||e).palette.text.secondary},[`&.${Ww.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,"&:focus, &:hover":{backgroundColor:(e.vars||e).palette.primary.dark}}})),$w=Rt.memo(function(e){const t=re({props:e,name:"MuiPickersMonth"}),{autoFocus:n,children:i,disabled:r,selected:s,value:o,tabIndex:a,onClick:l,onKeyDown:c,onFocus:u,onBlur:h,"aria-current":d,"aria-label":f}=t,p=ie(t,Bw),g=Rt.useRef(null),y=(e=>{const{disabled:t,selected:n,classes:i}=e;return le({root:["root"],monthButton:["monthButton",t&&"disabled",n&&"selected"]},zw,i)})(t);return Te(()=>{var e;n&&(null==(e=g.current)||e.focus())},[n]),v.jsx(qw,m({className:y.root,ownerState:t},p,{children:v.jsx(Hw,{ref:g,disabled:r,type:"button",role:"radio",tabIndex:r?-1:a,"aria-current":d,"aria-checked":s,"aria-label":f,onClick:e=>l(e,o),onKeyDown:e=>c(e,o),onFocus:e=>u(e,o),onBlur:e=>h(e,o),className:y.monthButton,ownerState:t,children:i})}))});function Xw(e){return se("MuiMonthCalendar",e)}oe("MuiMonthCalendar",["root"]);const Kw=["className","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","shouldDisableMonth","readOnly","disableHighlightToday","autoFocus","onMonthFocus","hasFocus","onFocusedViewChange","monthsPerRow","timezone","gridLabelId"],Gw=ae("div",{name:"MuiMonthCalendar",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",flexWrap:"wrap",alignContent:"stretch",padding:"0 4px",width:sx,boxSizing:"border-box"}),Yw=Rt.forwardRef(function(e,t){const n=function(e,t){const n=Pb(),i=Mb(),r=re({props:e,name:t});return m({disableFuture:!1,disablePast:!1},r,{minDate:Ky(n,r.minDate,i.minDate),maxDate:Ky(n,r.maxDate,i.maxDate)})}(e,"MuiMonthCalendar"),{className:i,value:r,defaultValue:s,referenceDate:o,disabled:a,disableFuture:l,disablePast:c,maxDate:u,minDate:h,onChange:d,shouldDisableMonth:f,readOnly:p,disableHighlightToday:g,autoFocus:y=!1,onMonthFocus:b,hasFocus:x,onFocusedViewChange:w,monthsPerRow:S=3,timezone:C,gridLabelId:T}=n,E=ie(n,Kw),{value:k,handleValueChange:D,timezone:I}=Cx({name:"MonthCalendar",timezone:C,value:r,defaultValue:s,onChange:d,valueManager:Cb}),_=Rb(I),j=Ne(),P=Pb(),M=Rt.useMemo(()=>Cb.getInitialReferenceValue({value:k,utils:P,props:n,timezone:I,referenceDate:o,granularity:ib.month}),[]),A=n,R=(e=>{const{classes:t}=e;return le({root:["root"]},Xw,t)})(A),O=Rt.useMemo(()=>P.getMonth(_),[P,_]),N=Rt.useMemo(()=>null!=k?P.getMonth(k):g?null:P.getMonth(M),[k,P,g,M]),[L,V]=Rt.useState(()=>N||O),[F,U]=Ce({name:"MonthCalendar",state:"hasFocus",controlled:x,default:null!=y&&y}),z=be(e=>{U(e),w&&w(e)}),W=Rt.useCallback(e=>{const t=P.startOfMonth(c&&P.isAfter(_,h)?_:h),n=P.startOfMonth(l&&P.isBefore(_,u)?_:u),i=P.startOfMonth(e);return!!P.isBefore(i,t)||!!P.isAfter(i,n)||!!f&&f(i)},[l,c,u,h,_,f,P]),B=be((e,t)=>{if(p)return;const n=P.setMonth(null!=k?k:M,t);D(n)}),q=be(e=>{W(P.setMonth(null!=k?k:M,e))||(V(e),z(!0),b&&b(e))});Rt.useEffect(()=>{V(e=>null!==N&&e!==N?N:e)},[N]);const H=be((e,t)=>{const n=12;switch(e.key){case"ArrowUp":q((n+t-3)%n),e.preventDefault();break;case"ArrowDown":q((n+t+3)%n),e.preventDefault();break;case"ArrowLeft":q((n+t+("ltr"===j.direction?-1:1))%n),e.preventDefault();break;case"ArrowRight":q((n+t+("ltr"===j.direction?1:-1))%n),e.preventDefault()}}),$=be((e,t)=>{q(t)}),X=be((e,t)=>{L===t&&z(!1)});return v.jsx(Gw,m({ref:t,className:ne(R.root,i),ownerState:A,role:"radiogroup","aria-labelledby":T},E,{children:Gy(P,null!=k?k:M).map(e=>{const t=P.getMonth(e),n=P.format(e,"monthShort"),i=P.format(e,"month"),r=t===N,s=a||W(e);return v.jsx($w,{selected:r,value:t,onClick:B,onKeyDown:H,autoFocus:F&&t===L,disabled:s,tabIndex:t===L?0:-1,onFocus:$,onBlur:X,"aria-current":O===t?"date":void 0,"aria-label":i,monthsPerRow:S,children:n},n)})}))});function Qw(e){return se("MuiPickersYear",e)}const Jw=oe("MuiPickersYear",["root","yearButton","selected","disabled"]),Zw=["autoFocus","className","children","disabled","selected","value","tabIndex","onClick","onKeyDown","onFocus","onBlur","aria-current","yearsPerRow"],eS=ae("div",{name:"MuiPickersYear",slot:"Root",overridesResolver:(e,t)=>[t.root]})(({ownerState:e})=>({flexBasis:3===e.yearsPerRow?"33.3%":"25%",display:"flex",alignItems:"center",justifyContent:"center"})),tS=ae("button",{name:"MuiPickersYear",slot:"YearButton",overridesResolver:(e,t)=>[t.yearButton,{[`&.${Jw.disabled}`]:t.disabled},{[`&.${Jw.selected}`]:t.selected}]})(({theme:e})=>m({color:"unset",backgroundColor:"transparent",border:0,outline:0},e.typography.subtitle1,{margin:"6px 0",height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.focusOpacity})`:je(e.palette.action.active,e.palette.action.focusOpacity)},"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:je(e.palette.action.active,e.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${Jw.disabled}`]:{color:(e.vars||e).palette.text.secondary},[`&.${Jw.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,"&:focus, &:hover":{backgroundColor:(e.vars||e).palette.primary.dark}}})),nS=Rt.memo(function(e){const t=re({props:e,name:"MuiPickersYear"}),{autoFocus:n,className:i,children:r,disabled:s,selected:o,value:a,tabIndex:l,onClick:c,onKeyDown:u,onFocus:h,onBlur:d,"aria-current":f}=t,p=ie(t,Zw),g=Rt.useRef(null),y=(e=>{const{disabled:t,selected:n,classes:i}=e;return le({root:["root"],yearButton:["yearButton",t&&"disabled",n&&"selected"]},Qw,i)})(t);return Rt.useEffect(()=>{n&&g.current.focus()},[n]),v.jsx(eS,m({className:ne(y.root,i),ownerState:t},p,{children:v.jsx(tS,{ref:g,disabled:s,type:"button",role:"radio",tabIndex:s?-1:l,"aria-current":f,"aria-checked":o,onClick:e=>c(e,a),onKeyDown:e=>u(e,a),onFocus:e=>h(e,a),onBlur:e=>d(e,a),className:y.yearButton,ownerState:t,children:r})}))});function iS(e){return se("MuiYearCalendar",e)}oe("MuiYearCalendar",["root"]);const rS=["autoFocus","className","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","readOnly","shouldDisableYear","disableHighlightToday","onYearFocus","hasFocus","onFocusedViewChange","yearsPerRow","timezone","gridLabelId"],sS=ae("div",{name:"MuiYearCalendar",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",flexDirection:"row",flexWrap:"wrap",overflowY:"auto",height:"100%",padding:"0 4px",width:sx,maxHeight:280,boxSizing:"border-box",position:"relative"}),oS=Rt.forwardRef(function(e,t){const n=function(e,t){var n;const i=Pb(),r=Mb(),s=re({props:e,name:t});return m({disablePast:!1,disableFuture:!1},s,{yearsPerRow:null!=(n=s.yearsPerRow)?n:3,minDate:Ky(i,s.minDate,r.minDate),maxDate:Ky(i,s.maxDate,r.maxDate)})}(e,"MuiYearCalendar"),{autoFocus:i,className:r,value:s,defaultValue:o,referenceDate:a,disabled:l,disableFuture:c,disablePast:u,maxDate:h,minDate:d,onChange:f,readOnly:p,shouldDisableYear:g,disableHighlightToday:y,onYearFocus:b,hasFocus:x,onFocusedViewChange:w,yearsPerRow:S,timezone:C,gridLabelId:T}=n,E=ie(n,rS),{value:k,handleValueChange:D,timezone:I}=Cx({name:"YearCalendar",timezone:C,value:s,defaultValue:o,onChange:f,valueManager:Cb}),_=Rb(I),j=Ne(),P=Pb(),M=Rt.useMemo(()=>Cb.getInitialReferenceValue({value:k,utils:P,props:n,timezone:I,referenceDate:a,granularity:ib.year}),[]),A=n,R=(e=>{const{classes:t}=e;return le({root:["root"]},iS,t)})(A),O=Rt.useMemo(()=>P.getYear(_),[P,_]),N=Rt.useMemo(()=>null!=k?P.getYear(k):y?null:P.getYear(M),[k,P,y,M]),[L,V]=Rt.useState(()=>N||O),[F,U]=Ce({name:"YearCalendar",state:"hasFocus",controlled:x,default:null!=i&&i}),z=be(e=>{U(e),w&&w(e)}),W=Rt.useCallback(e=>{if(u&&P.isBeforeYear(e,_))return!0;if(c&&P.isAfterYear(e,_))return!0;if(d&&P.isBeforeYear(e,d))return!0;if(h&&P.isAfterYear(e,h))return!0;if(!g)return!1;const t=P.startOfYear(e);return g(t)},[c,u,h,d,_,g,P]),B=be((e,t)=>{if(p)return;const n=P.setYear(null!=k?k:M,t);D(n)}),q=be(e=>{W(P.setYear(null!=k?k:M,e))||(V(e),z(!0),null==b||b(e))});Rt.useEffect(()=>{V(e=>null!==N&&e!==N?N:e)},[N]);const H=be((e,t)=>{switch(e.key){case"ArrowUp":q(t-S),e.preventDefault();break;case"ArrowDown":q(t+S),e.preventDefault();break;case"ArrowLeft":q(t+("ltr"===j.direction?-1:1)),e.preventDefault();break;case"ArrowRight":q(t+("ltr"===j.direction?1:-1)),e.preventDefault()}}),$=be((e,t)=>{q(t)}),X=be((e,t)=>{L===t&&z(!1)}),K=Rt.useRef(null),G=ge(t,K);return Rt.useEffect(()=>{if(i||null===K.current)return;const e=K.current.querySelector('[tabindex="0"]');if(!e)return;const t=e.offsetHeight,n=e.offsetTop,r=K.current.clientHeight,s=K.current.scrollTop,o=n+t;t>r||n<s||(K.current.scrollTop=o-r/2-t/2)},[i]),v.jsx(sS,m({ref:G,className:ne(R.root,r),ownerState:A,role:"radiogroup","aria-labelledby":T},E,{children:P.getYearRange(d,h).map(e=>{const t=P.getYear(e),n=t===N,i=l||W(e);return v.jsx(nS,{selected:n,value:t,onClick:B,onKeyDown:H,autoFocus:F&&t===L,disabled:i,tabIndex:t===L?0:-1,onFocus:$,onBlur:X,"aria-current":O===t?"date":void 0,yearsPerRow:S,children:P.format(e,"year")},P.format(e,"year"))})}))}),aS=e=>se("MuiPickersCalendarHeader",e),lS=oe("MuiPickersCalendarHeader",["root","labelContainer","label","switchViewButton","switchViewIcon"]),cS=["slots","slotProps","components","componentsProps","currentMonth","disabled","disableFuture","disablePast","maxDate","minDate","onMonthChange","onViewChange","view","reduceAnimations","views","labelId","className","timezone"],uS=["ownerState"],hS=ae("div",{name:"MuiPickersCalendarHeader",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",alignItems:"center",marginTop:16,marginBottom:8,paddingLeft:24,paddingRight:12,maxHeight:30,minHeight:30}),dS=ae("div",{name:"MuiPickersCalendarHeader",slot:"LabelContainer",overridesResolver:(e,t)=>t.labelContainer})(({theme:e})=>m({display:"flex",overflow:"hidden",alignItems:"center",cursor:"pointer",marginRight:"auto"},e.typography.body1,{fontWeight:e.typography.fontWeightMedium})),fS=ae("div",{name:"MuiPickersCalendarHeader",slot:"Label",overridesResolver:(e,t)=>t.label})({marginRight:6}),pS=ae(S,{name:"MuiPickersCalendarHeader",slot:"SwitchViewButton",overridesResolver:(e,t)=>t.switchViewButton})(({ownerState:e})=>m({marginRight:"auto"},"year"===e.view&&{[`.${lS.switchViewIcon}`]:{transform:"rotate(180deg)"}})),mS=ae($b,{name:"MuiPickersCalendarHeader",slot:"SwitchViewIcon",overridesResolver:(e,t)=>t.switchViewIcon})(({theme:e})=>({willChange:"transform",transition:e.transitions.create("transform"),transform:"rotate(0deg)"})),gS=Rt.forwardRef(function(e,t){var n,i,r,s;const o=Ab(),a=Pb(),l=re({props:e,name:"MuiPickersCalendarHeader"}),{slots:c,slotProps:u,components:h,currentMonth:d,disabled:f,disableFuture:p,disablePast:g,maxDate:y,minDate:b,onMonthChange:x,onViewChange:w,view:S,reduceAnimations:C,views:T,labelId:E,className:k,timezone:D}=l,I=ie(l,cS),_=l,j=(e=>{const{classes:t}=e;return le({root:["root"],labelContainer:["labelContainer"],label:["label"],switchViewButton:["switchViewButton"],switchViewIcon:["switchViewIcon"]},aS,t)})(l),P=null!=(n=null!=(i=null==c?void 0:c.switchViewButton)?i:null==h?void 0:h.SwitchViewButton)?n:pS,M=qy({elementType:P,externalSlotProps:null==u?void 0:u.switchViewButton,additionalProps:{size:"small","aria-label":o.calendarViewSwitchingButtonAriaLabel(S)},ownerState:_,className:j.switchViewButton}),A=null!=(r=null!=(s=null==c?void 0:c.switchViewIcon)?s:null==h?void 0:h.SwitchViewIcon)?r:mS,R=qy({elementType:A,externalSlotProps:null==u?void 0:u.switchViewIcon,ownerState:void 0,className:j.switchViewIcon}),O=ie(R,uS),N=function(e,{disableFuture:t,maxDate:n,timezone:i}){const r=Pb();return Rt.useMemo(()=>{const s=r.dateWithTimezone(void 0,i),o=r.startOfMonth(t&&r.isBefore(s,n)?s:n);return!r.isAfter(o,e)},[t,n,e,r,i])}(d,{disableFuture:p,maxDate:y,timezone:D}),L=function(e,{disablePast:t,minDate:n,timezone:i}){const r=Pb();return Rt.useMemo(()=>{const s=r.dateWithTimezone(void 0,i),o=r.startOfMonth(t&&r.isAfter(s,n)?s:n);return!r.isBefore(o,e)},[t,n,e,r,i])}(d,{disablePast:g,minDate:b,timezone:D});return 1===T.length&&"year"===T[0]?null:v.jsxs(hS,m({},I,{ownerState:_,className:ne(k,j.root),ref:t,children:[v.jsxs(dS,{role:"presentation",onClick:()=>{if(1!==T.length&&w&&!f)if(2===T.length)w(T.find(e=>e!==S)||T[0]);else{const e=0!==T.indexOf(S)?0:1;w(T[e])}},ownerState:_,"aria-live":"polite",className:j.labelContainer,children:[v.jsx(Uw,{reduceAnimations:C,transKey:a.format(d,"monthAndYear"),children:v.jsx(fS,{id:E,ownerState:_,className:j.label,children:a.format(d,"monthAndYear")})}),T.length>1&&!f&&v.jsx(P,m({},M,{children:v.jsx(A,m({},O))}))]}),v.jsx(he,{in:"day"===S,children:v.jsx(rx,{slots:c,slotProps:u,onGoToPrevious:()=>x(a.addMonths(d,-1),"right"),isPreviousDisabled:L,previousLabel:o.previousMonth,onGoToNext:()=>x(a.addMonths(d,1),"left"),isNextDisabled:N,nextLabel:o.nextMonth})})]}))}),vS=ae("div")({overflow:"hidden",width:sx,maxHeight:334,display:"flex",flexDirection:"column",margin:"0 auto"}),yS=e=>se("MuiDateCalendar",e);oe("MuiDateCalendar",["root","viewTransitionContainer"]);const bS=["autoFocus","onViewChange","value","defaultValue","referenceDate","disableFuture","disablePast","defaultCalendarMonth","onChange","onYearChange","onMonthChange","reduceAnimations","shouldDisableDate","shouldDisableMonth","shouldDisableYear","view","views","openTo","className","disabled","readOnly","minDate","maxDate","disableHighlightToday","focusedView","onFocusedViewChange","showDaysOutsideCurrentMonth","fixedWeekNumber","dayOfWeekFormatter","components","componentsProps","slots","slotProps","loading","renderLoading","displayWeekNumber","yearsPerRow","monthsPerRow","timezone"],xS=ae(vS,{name:"MuiDateCalendar",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",flexDirection:"column",height:334}),wS=ae(Uw,{name:"MuiDateCalendar",slot:"ViewTransitionContainer",overridesResolver:(e,t)=>t.viewTransitionContainer})({}),SS=Rt.forwardRef(function(e,t){var n,i,r;const s=Pb(),o=Ae(),a=function(e,t){var n,i,r,s,o,a,l;const c=Pb(),u=Mb(),h=gx(),d=re({props:e,name:t});return m({},d,{loading:null!=(n=d.loading)&&n,disablePast:null!=(i=d.disablePast)&&i,disableFuture:null!=(r=d.disableFuture)&&r,openTo:null!=(s=d.openTo)?s:"day",views:null!=(o=d.views)?o:["year","day"],reduceAnimations:null!=(a=d.reduceAnimations)?a:h,renderLoading:null!=(l=d.renderLoading)?l:()=>v.jsx("span",{children:"..."}),minDate:Ky(c,d.minDate,u.minDate),maxDate:Ky(c,d.maxDate,u.maxDate)})}(e,"MuiDateCalendar"),{autoFocus:l,onViewChange:c,value:u,defaultValue:h,referenceDate:d,disableFuture:f,disablePast:p,defaultCalendarMonth:g,onChange:y,onYearChange:b,onMonthChange:x,reduceAnimations:w,shouldDisableDate:S,shouldDisableMonth:C,shouldDisableYear:T,view:E,views:k,openTo:D,className:I,disabled:_,readOnly:j,minDate:P,maxDate:M,disableHighlightToday:A,focusedView:R,onFocusedViewChange:O,showDaysOutsideCurrentMonth:N,fixedWeekNumber:L,dayOfWeekFormatter:V,components:F,componentsProps:U,slots:z,slotProps:W,loading:B,renderLoading:q,displayWeekNumber:H,yearsPerRow:$,monthsPerRow:X,timezone:K}=a,G=ie(a,bS),{value:Y,handleValueChange:Q,timezone:J}=Cx({name:"DateCalendar",timezone:K,value:u,defaultValue:h,onChange:y,valueManager:Cb}),{view:Z,setView:ee,focusedView:te,setFocusedView:se,goToNextView:oe,setValueAndGoToNextView:ae}=Px({view:E,views:k,openTo:D,onChange:Q,onViewChange:c,autoFocus:l,focusedView:R,onFocusedViewChange:O}),{referenceDate:ce,calendarState:ue,changeFocusedDay:he,changeMonth:de,handleChangeMonth:fe,isDateDisabled:pe,onMonthSwitchingAnimationEnd:me}=Iw({value:Y,defaultCalendarMonth:g,referenceDate:d,reduceAnimations:w,onMonthChange:x,minDate:P,maxDate:M,shouldDisableDate:S,disablePast:p,disableFuture:f,timezone:J}),ge=_&&Y||P,ve=_&&Y||M,ye=`${o}-grid-label`,xe=null!==te,we=null!=(n=null!=(i=null==z?void 0:z.calendarHeader)?i:null==F?void 0:F.CalendarHeader)?n:gS,Se=qy({elementType:we,externalSlotProps:null!=(r=null==W?void 0:W.calendarHeader)?r:null==U?void 0:U.calendarHeader,additionalProps:{views:k,view:Z,currentMonth:ue.currentMonth,onViewChange:ee,onMonthChange:(e,t)=>fe({newMonth:e,direction:t}),minDate:ge,maxDate:ve,disabled:_,disablePast:p,disableFuture:f,reduceAnimations:w,timezone:J,labelId:ye,slots:z,slotProps:W},ownerState:a}),Ce=be(e=>{const t=s.startOfMonth(e),n=s.endOfMonth(e),i=pe(e)?Xy({utils:s,date:e,minDate:s.isBefore(P,t)?t:P,maxDate:s.isAfter(M,n)?n:M,disablePast:p,disableFuture:f,isDateDisabled:pe,timezone:J}):e;i?(ae(i,"finish"),null==x||x(t)):(oe(),de(t)),he(i,!0)}),Te=be(e=>{const t=s.startOfYear(e),n=s.endOfYear(e),i=pe(e)?Xy({utils:s,date:e,minDate:s.isBefore(P,t)?t:P,maxDate:s.isAfter(M,n)?n:M,disablePast:p,disableFuture:f,isDateDisabled:pe,timezone:J}):e;i?(ae(i,"finish"),null==b||b(i)):(oe(),de(t)),he(i,!0)}),Ee=be(e=>Q(e?$y(s,e,null!=Y?Y:ce):e,"finish",Z));Rt.useEffect(()=>{null!=Y&&s.isValid(Y)&&de(Y)},[Y]);const ke=a,De=(e=>{const{classes:t}=e;return le({root:["root"],viewTransitionContainer:["viewTransitionContainer"]},yS,t)})(ke),Ie={disablePast:p,disableFuture:f,maxDate:M,minDate:P},_e={disableHighlightToday:A,readOnly:j,disabled:_,timezone:J,gridLabelId:ye},je=Rt.useRef(Z);Rt.useEffect(()=>{je.current!==Z&&(te===je.current&&se(Z,!0),je.current=Z)},[te,se,Z]);const Pe=Rt.useMemo(()=>[Y],[Y]);return v.jsxs(xS,m({ref:t,className:ne(De.root,I),ownerState:ke},G,{children:[v.jsx(we,m({},Se)),v.jsx(wS,{reduceAnimations:w,className:De.viewTransitionContainer,transKey:Z,ownerState:ke,children:v.jsxs("div",{children:["year"===Z&&v.jsx(oS,m({},Ie,_e,{value:Y,onChange:Te,shouldDisableYear:T,hasFocus:xe,onFocusedViewChange:e=>se("year",e),yearsPerRow:$,referenceDate:ce})),"month"===Z&&v.jsx(Yw,m({},Ie,_e,{hasFocus:xe,className:I,value:Y,onChange:Ce,shouldDisableMonth:C,onFocusedViewChange:e=>se("month",e),monthsPerRow:X,referenceDate:ce})),"day"===Z&&v.jsx(Dw,m({},ue,Ie,_e,{onMonthSwitchingAnimationEnd:me,onFocusedDayChange:he,reduceAnimations:w,selectedDays:Pe,onSelectedDaysChange:Ee,shouldDisableDate:S,shouldDisableMonth:C,shouldDisableYear:T,hasFocus:xe,onFocusedViewChange:e=>se("day",e),showDaysOutsideCurrentMonth:N,fixedWeekNumber:L,dayOfWeekFormatter:V,displayWeekNumber:H,components:F,componentsProps:U,slots:z,slotProps:W,loading:B,renderLoading:q}))]})})]}))}),CS=({view:e,onViewChange:t,views:n,focusedView:i,onFocusedViewChange:r,value:s,defaultValue:o,referenceDate:a,onChange:l,className:c,classes:u,disableFuture:h,disablePast:d,minDate:f,maxDate:p,shouldDisableDate:m,shouldDisableMonth:g,shouldDisableYear:y,reduceAnimations:b,onMonthChange:x,monthsPerRow:w,onYearChange:S,yearsPerRow:C,defaultCalendarMonth:T,components:E,componentsProps:k,slots:D,slotProps:I,loading:_,renderLoading:j,disableHighlightToday:P,readOnly:M,disabled:A,showDaysOutsideCurrentMonth:R,dayOfWeekFormatter:O,sx:N,autoFocus:L,fixedWeekNumber:V,displayWeekNumber:F,timezone:U})=>v.jsx(SS,{view:e,onViewChange:t,views:n.filter(Jy),focusedView:i&&Jy(i)?i:null,onFocusedViewChange:r,value:s,defaultValue:o,referenceDate:a,onChange:l,className:c,classes:u,disableFuture:h,disablePast:d,minDate:f,maxDate:p,shouldDisableDate:m,shouldDisableMonth:g,shouldDisableYear:y,reduceAnimations:b,onMonthChange:x,monthsPerRow:w,onYearChange:S,yearsPerRow:C,defaultCalendarMonth:T,components:E,componentsProps:k,slots:D,slotProps:I,loading:_,renderLoading:j,disableHighlightToday:P,readOnly:M,disabled:A,showDaysOutsideCurrentMonth:R,dayOfWeekFormatter:O,sx:N,autoFocus:L,fixedWeekNumber:V,displayWeekNumber:F,timezone:U}),TS=Rt.forwardRef(function(e,t){var n,i,r,s;const o=Ab(),a=Pb(),l=Hb(e,"MuiDesktopDatePicker"),c=m({day:CS,month:CS,year:CS},l.viewRenderers),u=m({},l,{viewRenderers:c,format:Zy(a,l,!1),yearsPerRow:null!=(n=l.yearsPerRow)?n:4,slots:m({openPickerIcon:Gb,field:Lw},l.slots),slotProps:m({},l.slotProps,{field:e=>{var n;return m({},zy(null==(n=l.slotProps)?void 0:n.field,e),Yx(l),{ref:t})},toolbar:m({hidden:!0},null==(i=l.slotProps)?void 0:i.toolbar)})}),{renderPicker:h}=(e=>{var t,n,i,r,s;let{props:o,getOpenDialogAriaText:a}=e,l=ie(e,_w);const{slots:c,slotProps:u,className:h,sx:d,format:f,formatDensity:p,timezone:g,name:y,label:b,inputRef:x,readOnly:w,disabled:C,autoFocus:T,localeText:E,reduceAnimations:k}=o,D=Pb(),I=Rt.useRef(null),_=Rt.useRef(null),j=Ae(),P=null!=(t=null==u||null==(n=u.toolbar)?void 0:n.hidden)&&t,{open:M,actions:A,hasUIView:R,layoutProps:O,renderCurrentView:N,shouldRestoreFocus:L,fieldProps:V}=Nx(m({},l,{props:o,inputRef:I,autoFocusView:!0,additionalViewProps:{},wrapperVariant:"desktop"})),F=null!=(i=c.inputAdornment)?i:Re,U=qy({elementType:F,externalSlotProps:null==u?void 0:u.inputAdornment,additionalProps:{position:"end"},ownerState:o}),z=ie(U,jw),W=null!=(r=c.openPickerButton)?r:S,B=qy({elementType:W,externalSlotProps:null==u?void 0:u.openPickerButton,additionalProps:{disabled:C||w,onClick:M?A.onClose:A.onOpen,"aria-label":a(V.value,D),edge:z.position},ownerState:o}),q=ie(B,Pw),H=c.openPickerIcon,$=c.field,X=qy({elementType:$,externalSlotProps:null==u?void 0:u.field,additionalProps:m({},V,P&&{id:j},{readOnly:w,disabled:C,className:h,sx:d,format:f,formatDensity:p,timezone:g,label:b,name:y,autoFocus:T&&!o.open,focused:!!M||void 0}),ownerState:o});R&&(X.InputProps=m({},X.InputProps,{ref:_},!o.disableOpenPicker&&{[`${z.position}Adornment`]:v.jsx(F,m({},z,{children:v.jsx(W,m({},q,{children:v.jsx(H,m({},null==u?void 0:u.openPickerIcon))}))}))}));const K=m({textField:c.textField,clearIcon:c.clearIcon,clearButton:c.clearButton},X.slots),G=null!=(s=c.layout)?s:Xx,Y=ge(I,X.inputRef,x);let Q=j;P&&(Q=b?`${j}-label`:void 0);const J=m({},u,{toolbar:m({},null==u?void 0:u.toolbar,{titleId:j}),popper:m({"aria-labelledby":Q},null==u?void 0:u.popper)});return{renderPicker:()=>v.jsxs(Db,{localeText:E,children:[v.jsx($,m({},X,{slots:K,slotProps:J,inputRef:Y})),v.jsx(wx,m({role:"dialog",placement:"bottom-start",anchorEl:_.current},A,{open:M,slots:c,slotProps:J,shouldRestoreFocus:L,reduceAnimations:k,children:v.jsx(G,m({},O,null==J?void 0:J.layout,{slots:c,slotProps:J,children:N()}))}))]})}})({props:u,valueManager:Cb,valueType:"date",getOpenDialogAriaText:null!=(r=null==(s=u.localeText)?void 0:s.openDatePickerDialogue)?r:o.openDatePickerDialogue,validator:Jx});return h()});TS.propTypes={autoFocus:Ie.bool,className:Ie.string,closeOnSelect:Ie.bool,components:Ie.object,componentsProps:Ie.object,dayOfWeekFormatter:Ie.func,defaultCalendarMonth:Ie.any,defaultValue:Ie.any,disabled:Ie.bool,disableFuture:Ie.bool,disableHighlightToday:Ie.bool,disableOpenPicker:Ie.bool,disablePast:Ie.bool,displayWeekNumber:Ie.bool,fixedWeekNumber:Ie.number,format:Ie.string,formatDensity:Ie.oneOf(["dense","spacious"]),inputRef:Le,label:Ie.node,loading:Ie.bool,localeText:Ie.object,maxDate:Ie.any,minDate:Ie.any,monthsPerRow:Ie.oneOf([3,4]),name:Ie.string,onAccept:Ie.func,onChange:Ie.func,onClose:Ie.func,onError:Ie.func,onMonthChange:Ie.func,onOpen:Ie.func,onSelectedSectionsChange:Ie.func,onViewChange:Ie.func,onYearChange:Ie.func,open:Ie.bool,openTo:Ie.oneOf(["day","month","year"]),orientation:Ie.oneOf(["landscape","portrait"]),readOnly:Ie.bool,reduceAnimations:Ie.bool,referenceDate:Ie.any,renderLoading:Ie.func,selectedSections:Ie.oneOfType([Ie.oneOf(["all","day","hours","meridiem","minutes","month","seconds","weekDay","year"]),Ie.number,Ie.shape({endIndex:Ie.number.isRequired,startIndex:Ie.number.isRequired})]),shouldDisableDate:Ie.func,shouldDisableMonth:Ie.func,shouldDisableYear:Ie.func,showDaysOutsideCurrentMonth:Ie.bool,slotProps:Ie.object,slots:Ie.object,sx:Ie.oneOfType([Ie.arrayOf(Ie.oneOfType([Ie.func,Ie.object,Ie.bool])),Ie.func,Ie.object]),timezone:Ie.string,value:Ie.any,view:Ie.oneOf(["day","month","year"]),viewRenderers:Ie.shape({day:Ie.func,month:Ie.func,year:Ie.func}),views:Ie.arrayOf(Ie.oneOf(["day","month","year"]).isRequired),yearsPerRow:Ie.oneOf([3,4])};const ES=["props","getOpenDialogAriaText"],kS=Rt.forwardRef(function(e,t){var n,i,r;const s=Ab(),o=Pb(),a=Hb(e,"MuiMobileDatePicker"),l=m({day:CS,month:CS,year:CS},a.viewRenderers),c=m({},a,{viewRenderers:l,format:Zy(o,a,!1),slots:m({field:Lw},a.slots),slotProps:m({},a.slotProps,{field:e=>{var n;return m({},zy(null==(n=a.slotProps)?void 0:n.field,e),Yx(a),{ref:t})},toolbar:m({hidden:!1},null==(n=a.slotProps)?void 0:n.toolbar)})}),{renderPicker:u}=(e=>{var t,n,i;let{props:r,getOpenDialogAriaText:s}=e,o=ie(e,ES);const{slots:a,slotProps:l,className:c,sx:u,format:h,formatDensity:d,timezone:f,name:p,label:g,inputRef:y,readOnly:b,disabled:x,localeText:w}=r,S=Pb(),C=Rt.useRef(null),T=Ae(),E=null!=(t=null==l||null==(n=l.toolbar)?void 0:n.hidden)&&t,{open:k,actions:D,layoutProps:I,renderCurrentView:_,fieldProps:j}=Nx(m({},o,{props:r,inputRef:C,autoFocusView:!0,additionalViewProps:{},wrapperVariant:"mobile"})),P=a.field,M=qy({elementType:P,externalSlotProps:null==l?void 0:l.field,additionalProps:m({},j,E&&{id:T},!(x||b)&&{onClick:D.onOpen,onKeyDown:(A=D.onOpen,e=>{"Enter"!==e.key&&" "!==e.key||(A(e),e.preventDefault(),e.stopPropagation())})},{readOnly:null==b||b,disabled:x,className:c,sx:u,format:h,formatDensity:d,timezone:f,label:g,name:p}),ownerState:r});var A;M.inputProps=m({},M.inputProps,{"aria-label":s(j.value,S)});const R=m({textField:a.textField},M.slots),O=null!=(i=a.layout)?i:Xx,N=ge(C,M.inputRef,y);let L=T;E&&(L=g?`${T}-label`:void 0);const V=m({},l,{toolbar:m({},null==l?void 0:l.toolbar,{titleId:T}),mobilePaper:m({"aria-labelledby":L},null==l?void 0:l.mobilePaper)});return{renderPicker:()=>v.jsxs(Db,{localeText:w,children:[v.jsx(P,m({},M,{slots:R,slotProps:V,inputRef:N})),v.jsx(lx,m({},D,{open:k,slots:a,slotProps:V,children:v.jsx(O,m({},I,null==V?void 0:V.layout,{slots:a,slotProps:V,children:_()}))}))]})}})({props:c,valueManager:Cb,valueType:"date",getOpenDialogAriaText:null!=(i=null==(r=c.localeText)?void 0:r.openDatePickerDialogue)?i:s.openDatePickerDialogue,validator:Jx});return u()});kS.propTypes={autoFocus:Ie.bool,className:Ie.string,closeOnSelect:Ie.bool,components:Ie.object,componentsProps:Ie.object,dayOfWeekFormatter:Ie.func,defaultCalendarMonth:Ie.any,defaultValue:Ie.any,disabled:Ie.bool,disableFuture:Ie.bool,disableHighlightToday:Ie.bool,disableOpenPicker:Ie.bool,disablePast:Ie.bool,displayWeekNumber:Ie.bool,fixedWeekNumber:Ie.number,format:Ie.string,formatDensity:Ie.oneOf(["dense","spacious"]),inputRef:Le,label:Ie.node,loading:Ie.bool,localeText:Ie.object,maxDate:Ie.any,minDate:Ie.any,monthsPerRow:Ie.oneOf([3,4]),name:Ie.string,onAccept:Ie.func,onChange:Ie.func,onClose:Ie.func,onError:Ie.func,onMonthChange:Ie.func,onOpen:Ie.func,onSelectedSectionsChange:Ie.func,onViewChange:Ie.func,onYearChange:Ie.func,open:Ie.bool,openTo:Ie.oneOf(["day","month","year"]),orientation:Ie.oneOf(["landscape","portrait"]),readOnly:Ie.bool,reduceAnimations:Ie.bool,referenceDate:Ie.any,renderLoading:Ie.func,selectedSections:Ie.oneOfType([Ie.oneOf(["all","day","hours","meridiem","minutes","month","seconds","weekDay","year"]),Ie.number,Ie.shape({endIndex:Ie.number.isRequired,startIndex:Ie.number.isRequired})]),shouldDisableDate:Ie.func,shouldDisableMonth:Ie.func,shouldDisableYear:Ie.func,showDaysOutsideCurrentMonth:Ie.bool,slotProps:Ie.object,slots:Ie.object,sx:Ie.oneOfType([Ie.arrayOf(Ie.oneOfType([Ie.func,Ie.object,Ie.bool])),Ie.func,Ie.object]),timezone:Ie.string,value:Ie.any,view:Ie.oneOf(["day","month","year"]),viewRenderers:Ie.shape({day:Ie.func,month:Ie.func,year:Ie.func}),views:Ie.arrayOf(Ie.oneOf(["day","month","year"]).isRequired),yearsPerRow:Ie.oneOf([3,4])};const DS=["desktopModeMediaQuery"],IS=Rt.forwardRef(function(e,t){const n=re({props:e,name:"MuiDatePicker"}),{desktopModeMediaQuery:i=hx}=n,r=ie(n,DS);return me(i,{defaultMatches:!0})?v.jsx(TS,m({ref:t},r)):v.jsx(kS,m({ref:t},r))});var _S={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},i=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},r={p:i,P:function(e,t){var r,s=e.match(/(P+)(p+)?/)||[],o=s[1],a=s[2];if(!a)return n(e,t);switch(o){case"P":r=t.dateTime({width:"short"});break;case"PP":r=t.dateTime({width:"medium"});break;case"PPP":r=t.dateTime({width:"long"});break;default:r=t.dateTime({width:"full"})}return r.replace("{{date}}",n(o,t)).replace("{{time}}",i(a,t))}};t.default=r,e.exports=t.default}(_S,_S.exports);const jS=Ot(_S.exports),PS={y:{sectionType:"year",contentType:"digit",maxLength:4},yy:"year",yyy:{sectionType:"year",contentType:"digit",maxLength:4},yyyy:"year",M:{sectionType:"month",contentType:"digit",maxLength:2},MM:"month",MMMM:{sectionType:"month",contentType:"letter"},MMM:{sectionType:"month",contentType:"letter"},L:{sectionType:"month",contentType:"digit",maxLength:2},LL:"month",LLL:{sectionType:"month",contentType:"letter"},LLLL:{sectionType:"month",contentType:"letter"},d:{sectionType:"day",contentType:"digit",maxLength:2},dd:"day",do:{sectionType:"day",contentType:"digit-with-letter"},E:{sectionType:"weekDay",contentType:"letter"},EE:{sectionType:"weekDay",contentType:"letter"},EEE:{sectionType:"weekDay",contentType:"letter"},EEEE:{sectionType:"weekDay",contentType:"letter"},EEEEE:{sectionType:"weekDay",contentType:"letter"},i:{sectionType:"weekDay",contentType:"digit",maxLength:1},ii:"weekDay",iii:{sectionType:"weekDay",contentType:"letter"},iiii:{sectionType:"weekDay",contentType:"letter"},e:{sectionType:"weekDay",contentType:"digit",maxLength:1},ee:"weekDay",eee:{sectionType:"weekDay",contentType:"letter"},eeee:{sectionType:"weekDay",contentType:"letter"},eeeee:{sectionType:"weekDay",contentType:"letter"},eeeeee:{sectionType:"weekDay",contentType:"letter"},c:{sectionType:"weekDay",contentType:"digit",maxLength:1},cc:"weekDay",ccc:{sectionType:"weekDay",contentType:"letter"},cccc:{sectionType:"weekDay",contentType:"letter"},ccccc:{sectionType:"weekDay",contentType:"letter"},cccccc:{sectionType:"weekDay",contentType:"letter"},a:"meridiem",aa:"meridiem",aaa:"meridiem",H:{sectionType:"hours",contentType:"digit",maxLength:2},HH:"hours",h:{sectionType:"hours",contentType:"digit",maxLength:2},hh:"hours",m:{sectionType:"minutes",contentType:"digit",maxLength:2},mm:"minutes",s:{sectionType:"seconds",contentType:"digit",maxLength:2},ss:"seconds"},MS={year:"yyyy",month:"LLLL",monthShort:"MMM",dayOfMonth:"d",weekday:"EEEE",weekdayShort:"EEEEEE",hours24h:"HH",hours12h:"hh",meridiem:"aa",minutes:"mm",seconds:"ss",fullDate:"PP",fullDateWithWeekday:"PPPP",keyboardDate:"P",shortDate:"MMM d",normalDate:"d MMMM",normalDateWithWeekday:"EEE, MMM d",monthAndYear:"LLLL yyyy",monthAndDate:"MMMM d",fullTime:"p",fullTime12h:"hh:mm aa",fullTime24h:"HH:mm",fullDateTime:"PP p",fullDateTime12h:"PP hh:mm aa",fullDateTime24h:"PP HH:mm",keyboardDateTime:"P p",keyboardDateTime12h:"P hh:mm aa",keyboardDateTime24h:"P HH:mm"};class AS{constructor(e){this.isMUIAdapter=!0,this.isTimezoneCompatible=!1,this.lib="date-fns",this.locale=void 0,this.formats=void 0,this.formatTokenMap=PS,this.escapedCharacters={start:"'",end:"'"},this.longFormatters=void 0,this.date=e=>void 0===e?new Date:null===e?null:new Date(e),this.dateWithTimezone=e=>this.date(e),this.getTimezone=()=>"default",this.setTimezone=e=>e,this.toJsDate=e=>e,this.getCurrentLocaleCode=()=>{var e;return(null==(e=this.locale)?void 0:e.code)||"en-US"},this.is12HourCycleInCurrentLocale=()=>!this.locale||/a/.test(this.locale.formatLong.time({width:"short"})),this.expandFormat=e=>e.match(/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g).map(e=>{const t=e[0];return"p"===t||"P"===t?(0,this.longFormatters[t])(e,this.locale.formatLong):e}).join(""),this.getFormatHelperText=e=>this.expandFormat(e).replace(/(aaa|aa|a)/g,"(a|p)m").toLocaleLowerCase(),this.isNull=e=>null===e,this.formatNumber=e=>e,this.getMeridiemText=e=>"am"===e?"AM":"PM";const{locale:t,formats:n,longFormatters:i}=e;this.locale=t,this.formats=m({},MS,n),this.longFormatters=i}}class RS extends AS{constructor({locale:e,formats:t}={}){if("function"!=typeof $t)throw new Error(["MUI: The `date-fns` package v3.x is not compatible with this adapter.","Please, install v2.x of the package or use the `AdapterDateFnsV3` instead."].join("\n"));super({locale:null!=e?e:Xt,formats:t,longFormatters:jS}),this.parseISO=e=>Kt(e),this.toISO=e=>Gt(e,{format:"extended"}),this.parse=(e,t)=>""===e?null:Yt(e,t,new Date,{locale:this.locale}),this.isValid=e=>Qt(this.date(e)),this.format=(e,t)=>this.formatByString(e,this.formats[t]),this.formatByString=(e,t)=>Jt(e,t,{locale:this.locale}),this.getDiff=(e,t,n)=>{switch(n){case"years":return ln(e,this.date(t));case"quarters":return an(e,this.date(t));case"months":return on(e,this.date(t));case"weeks":return sn(e,this.date(t));case"days":return rn(e,this.date(t));case"hours":return nn(e,this.date(t));case"minutes":return tn(e,this.date(t));case"seconds":return en(e,this.date(t));default:return Zt(e,this.date(t))}},this.isEqual=(e,t)=>null===e&&null===t||cn(e,t),this.isSameYear=(e,t)=>un(e,t),this.isSameMonth=(e,t)=>hn(e,t),this.isSameDay=(e,t)=>dn(e,t),this.isSameHour=(e,t)=>fn(e,t),this.isAfter=(e,t)=>pn(e,t),this.isAfterYear=(e,t)=>pn(e,mn(t)),this.isAfterDay=(e,t)=>pn(e,gn(t)),this.isBefore=(e,t)=>vn(e,t),this.isBeforeYear=(e,t)=>vn(e,yn(t)),this.isBeforeDay=(e,t)=>vn(e,bn(t)),this.isWithinRange=(e,[t,n])=>xn(e,{start:t,end:n}),this.startOfYear=e=>yn(e),this.startOfMonth=e=>wn(e),this.startOfWeek=e=>Sn(e,{locale:this.locale}),this.startOfDay=e=>bn(e),this.endOfYear=e=>mn(e),this.endOfMonth=e=>Cn(e),this.endOfWeek=e=>Tn(e,{locale:this.locale}),this.endOfDay=e=>gn(e),this.addYears=(e,t)=>En(e,t),this.addMonths=(e,t)=>kn(e,t),this.addWeeks=(e,t)=>Dn(e,t),this.addDays=(e,t)=>$t(e,t),this.addHours=(e,t)=>In(e,t),this.addMinutes=(e,t)=>_n(e,t),this.addSeconds=(e,t)=>jn(e,t),this.getYear=e=>Pn(e),this.getMonth=e=>Mn(e),this.getDate=e=>An(e),this.getHours=e=>Rn(e),this.getMinutes=e=>On(e),this.getSeconds=e=>Nn(e),this.getMilliseconds=e=>Ln(e),this.setYear=(e,t)=>Vn(e,t),this.setMonth=(e,t)=>Fn(e,t),this.setDate=(e,t)=>Un(e,t),this.setHours=(e,t)=>zn(e,t),this.setMinutes=(e,t)=>Wn(e,t),this.setSeconds=(e,t)=>Bn(e,t),this.setMilliseconds=(e,t)=>qn(e,t),this.getDaysInMonth=e=>Hn(e),this.getNextMonth=e=>kn(e,1),this.getPreviousMonth=e=>kn(e,-1),this.getMonthArray=e=>{const t=[yn(e)];for(;t.length<12;){const e=t[t.length-1];t.push(this.getNextMonth(e))}return t},this.mergeDateAndTime=(e,t)=>this.setSeconds(this.setMinutes(this.setHours(e,this.getHours(t)),this.getMinutes(t)),this.getSeconds(t)),this.getWeekdays=()=>{const e=new Date;return $n({start:Sn(e,{locale:this.locale}),end:Tn(e,{locale:this.locale})}).map(e=>this.formatByString(e,"EEEEEE"))},this.getWeekArray=e=>{const t=Sn(wn(e),{locale:this.locale}),n=Tn(Cn(e),{locale:this.locale});let i=0,r=t;const s=[];for(;vn(r,n);){const e=Math.floor(i/7);s[e]=s[e]||[],s[e].push(r),r=$t(r,1),i+=1}return s},this.getWeekNumber=e=>Xn(e,{locale:this.locale}),this.getYearRange=(e,t)=>{const n=yn(e),i=mn(t),r=[];let s=n;for(;vn(s,i);)r.push(s),s=En(s,1);return r}}}const OS=({open:t,onClose:n,editingTask:i})=>{const{user:r}=Ds(),[s,o]=Rt.useState(!1),[a,l]=Rt.useState(""),[c,d]=Rt.useState(new Date),[f,m]=Rt.useState({title:"",description:"",status:"todo",priority:"medium"}),g=Boolean(i);Rt.useEffect(()=>{i?(m({title:i.title,description:i.description,status:i.status,priority:i.priority}),d(new Date(i.dueDate))):(m({title:"",description:"",status:"todo",priority:"medium"}),d(new Date))},[i]);const y=t=>p(e,null,function*(){if(t.preventDefault(),o(!0),l(""),!r)return l("ユーザー情報が見つかりません"),void o(!1);if(!c)return l("期限日を設定してください"),void o(!1);try{const e={id:g?i.id:Date.now().toString(),title:f.title,description:f.description,status:f.status,priority:f.priority,dueDate:c.toISOString().split("T")[0],assignee:r.name||"未設定",createdAt:g?i.createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};g?yield Ay(r.id,e.id,e):yield My(r.id,e),zt.success(g?"タスクを更新しました":"タスクを作成しました"),n()}catch(e){console.error("タスク保存エラー:",e),l("タスクの保存に失敗しました"),zt.error("タスクの保存に失敗しました")}finally{o(!1)}});return v.jsxs(de,{open:t,onClose:n,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:3,background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)"}},children:[v.jsxs(Ve,{sx:{pb:1,background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",color:"white",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:2},children:[v.jsx(R,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)",width:40,height:40},children:v.jsx(Fe,{})}),v.jsx(T,{variant:"h6",sx:{fontWeight:600},children:g?"タスクを編集":"新しいタスクを作成"})]}),v.jsx(S,{onClick:n,sx:{color:"white"},children:v.jsx(Ue,{})})]}),v.jsxs(pe,{sx:{pt:3},children:[a&&v.jsx(ze,{severity:"error",sx:{mb:2},children:a}),v.jsxs(E,{component:"form",onSubmit:y,children:[v.jsx(Oe,{fullWidth:!0,label:"タスク名",value:f.title,onChange:e=>m(h(u({},f),{title:e.target.value})),margin:"normal",required:!0,disabled:s,placeholder:"タスクのタイトルを入力...",sx:{mb:2}}),v.jsx(Oe,{fullWidth:!0,label:"説明",value:f.description,onChange:e=>m(h(u({},f),{description:e.target.value})),margin:"normal",multiline:!0,rows:3,disabled:s,placeholder:"タスクの詳細を入力...",sx:{mb:2}}),v.jsxs(E,{sx:{display:"flex",gap:2,mb:2},children:[v.jsxs(We,{fullWidth:!0,children:[v.jsx(Be,{children:"ステータス"}),v.jsxs(qe,{value:f.status,label:"ステータス",onChange:e=>m(h(u({},f),{status:e.target.value})),disabled:s,startAdornment:v.jsx(E,{sx:{display:"flex",alignItems:"center",mr:1},children:v.jsx(He,{sx:{fontSize:18,color:(e=>{switch(e){case"todo":default:return"#64748b";case"inProgress":return"#6366f1";case"done":return"#10b981"}})(f.status)}})}),children:[v.jsx(N,{value:"todo",children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:1},children:[v.jsx(E,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#64748b"}}),"未着手"]})}),v.jsx(N,{value:"inProgress",children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:1},children:[v.jsx(E,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#6366f1"}}),"進行中"]})}),v.jsx(N,{value:"done",children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:1},children:[v.jsx(E,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#10b981"}}),"完了"]})})]})]}),v.jsxs(We,{fullWidth:!0,children:[v.jsx(Be,{children:"優先度"}),v.jsxs(qe,{value:f.priority,label:"優先度",onChange:e=>m(h(u({},f),{priority:e.target.value})),disabled:s,startAdornment:v.jsx(E,{sx:{display:"flex",alignItems:"center",mr:1},children:v.jsx($e,{sx:{fontSize:18,color:(e=>{switch(e){case"high":return"#ef4444";case"medium":return"#f59e0b";case"low":return"#10b981";default:return"#64748b"}})(f.priority)}})}),children:[v.jsx(N,{value:"low",children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:1},children:[v.jsx(E,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#10b981"}}),"低"]})}),v.jsx(N,{value:"medium",children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:1},children:[v.jsx(E,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#f59e0b"}}),"中"]})}),v.jsx(N,{value:"high",children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:1},children:[v.jsx(E,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#ef4444"}}),"高"]})})]})]})]}),v.jsx(Db,{dateAdapter:RS,adapterLocale:Uy,children:v.jsx(IS,{label:"期限日",value:c,onChange:e=>d(e),sx:{width:"100%"},disabled:s,slots:{openPickerIcon:Y}})}),v.jsxs(E,{sx:{mt:2,display:"flex",alignItems:"center",gap:1},children:[v.jsx(V,{sx:{fontSize:18,color:"text.secondary"}}),v.jsxs(T,{variant:"body2",color:"text.secondary",children:["担当者: ",(null==r?void 0:r.name)||"未設定"]})]})]})]}),v.jsxs(ke,{sx:{p:3,pt:1},children:[v.jsx(Ee,{onClick:n,variant:"outlined",disabled:s,sx:{minWidth:100},children:"キャンセル"}),v.jsx(Ee,{type:"submit",variant:"contained",disabled:s||!f.title,onClick:y,sx:{minWidth:100,background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)","&:hover":{background:"linear-gradient(135deg, #4f46e5 0%, #3730a3 100%)"}},children:s?v.jsx(Xe,{size:20}):g?"更新":"作成"})]})]})},NS=()=>{const t=Nt(),n=ue(),{user:i}=Ds(),[r,s]=Rt.useState([]),[o,a]=Rt.useState(!0),[l,c]=Rt.useState(""),[f,m]=Rt.useState(null),[g,y]=Rt.useState(!1),[b,x]=Rt.useState("個人プロジェクト"),[w,C]=Rt.useState("個人プロジェクト"),[k,D]=Rt.useState(!1),[j,P]=Rt.useState(null);Rt.useEffect(()=>{if(!(null==i?void 0:i.id))return;const e=localStorage.getItem("currentProject"),t=localStorage.getItem("currentWorkspace");e?x(e):(localStorage.setItem("currentProject","個人プロジェクト"),x("個人プロジェクト")),t?C(t):(localStorage.setItem("currentWorkspace","個人プロジェクト"),C("個人プロジェクト"));const n=Py(i.id,e=>{s(e),a(!1)});if(localStorage.getItem("filteredTasks")&&c(e||t||""),!localStorage.getItem("hasVisited")){console.log("サンプルデータを追加中...");const e=[{id:"sample_1",title:"プロジェクト計画の作成",description:"新しいプロジェクトの計画書を作成する",status:"todo",priority:"high",dueDate:new Date(Date.now()+6048e5).toISOString().split("T")[0],assignee:i.name||"未設定",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),project:"仕事",workspace:"チームA"},{id:"sample_2",title:"チームミーティング",description:"週次チームミーティングの準備",status:"inProgress",priority:"medium",dueDate:new Date(Date.now()+1728e5).toISOString().split("T")[0],assignee:i.name||"未設定",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),project:"学習",workspace:"プロジェクトX"},{id:"sample_3",title:"ドキュメントの更新",description:"技術文書の最新版に更新",status:"done",priority:"low",dueDate:new Date(Date.now()-864e5).toISOString().split("T")[0],assignee:i.name||"未設定",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),project:"仕事",workspace:"チームA"}];localStorage.setItem(`tasks_${i.id}`,JSON.stringify(e)),console.log("サンプルデータをローカルストレージに保存しました"),localStorage.setItem("hasVisited","true")}return()=>n()},[null==i?void 0:i.id]),Rt.useEffect(()=>{const e=e=>{const{type:t,value:n,filteredTasks:i}=e.detail;console.log("フィルタ変更を検知:",t,n,i),"project"===t?(x(n),C(null)):"workspace"===t&&(C(n),x(null)),i&&s(i)};return window.addEventListener("filterChanged",e),()=>{window.removeEventListener("filterChanged",e)}},[]);const M=b||w?r.filter(e=>{if(b)switch(b){case"個人プロジェクト":return!e.assignee||"個人"===e.assignee||"デモユーザー"===e.assignee;case"仕事":return"仕事"===e.assignee||"high"===e.priority;case"学習":return"学習"===e.assignee||"medium"===e.priority;default:return!0}if(w)switch(w){case"個人プロジェクト":return!e.assignee||"個人"===e.assignee||"デモユーザー"===e.assignee;case"チームA":return"チームA"===e.assignee||"inProgress"===e.status;case"プロジェクトX":return"プロジェクトX"===e.assignee||"high"===e.priority;default:return!0}return!0}):r,A=M.filter(e=>"todo"===e.status),O=M.filter(e=>"inProgress"===e.status),L=M.filter(e=>"done"===e.status),V=M.filter(e=>new Date(e.dueDate)<new Date&&"done"!==e.status),U=M.length>0?L.length/M.length*100:0,W=[{title:"総タスク数",value:M.length,change:0,icon:v.jsx(Fe,{}),color:"#6366f1",gradient:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)"},{title:"進行中",value:O.length,change:0,icon:v.jsx(He,{}),color:"#f59e0b",gradient:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)"},{title:"完了済み",value:L.length,change:0,icon:v.jsx(Ke,{}),color:"#10b981",gradient:"linear-gradient(135deg, #10b981 0%, #059669 100%)"},{title:"期限超過",value:V.length,change:0,icon:v.jsx(Ge,{}),color:"#ef4444",gradient:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)"}],B=M.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()).slice(0,5),$=e=>{switch(e){case"high":return"#ef4444";case"medium":return"#f59e0b";case"low":return"#10b981";default:return"#64748b"}},X=e=>{switch(e){case"todo":default:return"#64748b";case"inProgress":return"#6366f1";case"done":return"#10b981"}};return o?v.jsx(E,{sx:{p:3,display:"flex",justifyContent:"center",alignItems:"center",minHeight:"calc(100vh - 120px)"},children:v.jsxs(E,{sx:{width:"100%",maxWidth:400},children:[v.jsx(Ye,{sx:{height:4,borderRadius:2}}),v.jsx(T,{variant:"body2",sx:{mt:2,textAlign:"center",color:"text.secondary"},children:"データを読み込み中..."})]})}):v.jsx(E,{sx:{p:{xs:2,md:4},backgroundColor:"background.default",minHeight:"calc(100vh - 120px)",maxWidth:"100%",background:`linear-gradient(135deg, ${je(n.palette.primary.main,.02)} 0%, ${je(n.palette.background.default,1)} 100%)`},children:v.jsxs(Yn.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[v.jsx(E,{sx:{mb:4},children:v.jsx(Yn.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.1},children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",mb:2},children:[v.jsx(R,{sx:{bgcolor:"primary.main",mr:2,width:56,height:56,background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)"},children:v.jsx(K,{})}),v.jsxs(E,{children:[v.jsxs(T,{variant:"h3",sx:{fontWeight:800,mb:.5,color:"text.primary",background:"linear-gradient(135deg, #1a1a1a 0%, #4a5568 100%)",backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:["おかえりなさい、",(null==i?void 0:i.name)||"ユーザー","さん"]}),v.jsx(T,{variant:"body1",color:"text.secondary",sx:{fontWeight:500},children:Jt(new Date,"yyyy年M月d日 EEEE",{locale:Uy})})]})]})})}),(b||w)&&v.jsx(Yn.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},children:v.jsx(we,{sx:{mb:4,p:3,background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",borderRadius:3,boxShadow:"0 8px 32px rgba(99, 102, 241, 0.2)"},children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[v.jsxs(E,{sx:{display:"flex",alignItems:"center"},children:[v.jsx(R,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)",mr:2,width:40,height:40},children:"📁"}),v.jsxs(T,{variant:"h6",sx:{color:"white",fontWeight:600},children:[b||w," のタスクを表示中 (",M.length,"件)"]})]}),v.jsx(Ee,{variant:"outlined",size:"small",onClick:()=>{c(""),localStorage.removeItem("filteredTasks"),localStorage.removeItem("currentProject"),localStorage.removeItem("currentWorkspace"),x("個人プロジェクト"),C("個人プロジェクト")},sx:{color:"white",borderColor:"rgba(255, 255, 255, 0.3)","&:hover":{borderColor:"white",backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:"フィルターをクリア"})]})})}),v.jsx(Qe,{container:!0,spacing:3,sx:{mb:4},children:W.map((e,n)=>v.jsx(Qe,{item:!0,xs:12,sm:6,md:3,children:v.jsx(Yn.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1*n},children:v.jsxs(we,{sx:{height:"100%",borderRadius:3,background:e.gradient,boxShadow:`0 8px 32px ${je(e.color,.3)}`,border:"1px solid rgba(255, 255, 255, 0.1)",cursor:"pointer","&:hover":{transform:"translateY(-4px)",boxShadow:`0 12px 40px ${je(e.color,.4)}`},transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",overflow:"hidden",position:"relative"},onClick:()=>{console.log("統計カードをクリックしました:",e.title),("総タスク数"===e.title||"進行中"===e.title||"完了済み"===e.title||"期限超過"===e.title)&&t("/kanban")},children:[v.jsx(E,{sx:{position:"absolute",top:0,right:0,width:100,height:100,background:"rgba(255, 255, 255, 0.1)",borderRadius:"50%",transform:"translate(30px, -30px)"}}),v.jsxs(Je,{sx:{p:3,position:"relative",zIndex:1},children:[v.jsxs(E,{sx:{display:"flex",alignItems:"center",mb:2},children:[v.jsx(R,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)",mr:2,width:56,height:56,backdropFilter:"blur(10px)"},children:e.icon}),v.jsxs(E,{sx:{flexGrow:1},children:[v.jsx(T,{variant:"h2",sx:{fontWeight:800,color:"white",textShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:e.value}),v.jsx(T,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.9)",fontWeight:600,fontSize:"0.875rem"},children:e.title})]})]}),0!==e.change&&v.jsxs(E,{sx:{display:"flex",alignItems:"center"},children:[e.change>0?v.jsx(Ze,{sx:{color:"rgba(255, 255, 255, 0.9)",fontSize:18,mr:1}}):v.jsx(et,{sx:{color:"rgba(255, 255, 255, 0.9)",fontSize:18,mr:1}}),v.jsxs(T,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.9)",fontWeight:600,fontSize:"0.875rem"},children:[Math.abs(e.change),"%"]})]})]})]})})},e.title))}),v.jsxs(Qe,{container:!0,spacing:4,children:[v.jsx(Qe,{item:!0,xs:12,md:8,children:v.jsx(Yn.div,{initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{duration:.5,delay:.4},children:v.jsx(we,{sx:{borderRadius:3,background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.08)",border:"1px solid rgba(226, 232, 240, 0.8)",overflow:"hidden"},children:v.jsxs(E,{sx:{p:4,background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",color:"white"},children:[v.jsxs(E,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[v.jsxs(E,{sx:{display:"flex",alignItems:"center"},children:[v.jsx(R,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)",mr:2,width:48,height:48},children:v.jsx(tt,{})}),v.jsx(T,{variant:"h5",sx:{fontWeight:700},children:"進捗状況"})]}),v.jsx(Ee,{variant:"contained",startIcon:v.jsx(_,{}),onClick:()=>t("/task/new"),sx:{backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white",backdropFilter:"blur(10px)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.3)"}},children:"新しいタスク"})]}),v.jsxs(E,{sx:{mb:4},children:[v.jsxs(E,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[v.jsx(T,{variant:"body1",sx:{fontWeight:600,color:"rgba(255, 255, 255, 0.9)"},children:"完了率"}),v.jsxs(T,{variant:"h6",sx:{fontWeight:700,color:"white"},children:[U.toFixed(1),"%"]})]}),v.jsx(Ye,{variant:"determinate",value:U,sx:{height:12,borderRadius:6,backgroundColor:"rgba(255, 255, 255, 0.2)","& .MuiLinearProgress-bar":{borderRadius:6,background:"linear-gradient(90deg, #ffffff 0%, #f0f0f0 100%)"}}})]}),v.jsxs(Qe,{container:!0,spacing:3,children:[v.jsx(Qe,{item:!0,xs:4,children:v.jsxs(E,{sx:{textAlign:"center"},children:[v.jsx(T,{variant:"h2",sx:{fontWeight:800,color:"rgba(255, 255, 255, 0.9)",mb:1,textShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:A.length}),v.jsx(T,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.8)",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:"To Do"})]})}),v.jsx(Qe,{item:!0,xs:4,children:v.jsxs(E,{sx:{textAlign:"center"},children:[v.jsx(T,{variant:"h2",sx:{fontWeight:800,color:"white",mb:1,textShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:O.length}),v.jsx(T,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.8)",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:"In Progress"})]})}),v.jsx(Qe,{item:!0,xs:4,children:v.jsxs(E,{sx:{textAlign:"center"},children:[v.jsx(T,{variant:"h2",sx:{fontWeight:800,color:"rgba(255, 255, 255, 0.9)",mb:1,textShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:L.length}),v.jsx(T,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.8)",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Done"})]})})]})]})})})}),v.jsx(Qe,{item:!0,xs:12,md:4,children:v.jsx(Yn.div,{initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{duration:.5,delay:.5},children:v.jsxs(we,{sx:{borderRadius:3,background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.08)",border:"1px solid rgba(226, 232, 240, 0.8)",height:"100%",overflow:"hidden"},children:[v.jsx(E,{sx:{p:3,background:"linear-gradient(135deg, #1a1a1a 0%, #2d3748 100%)",color:"white"},children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",mb:3},children:[v.jsx(R,{sx:{bgcolor:"rgba(255, 255, 255, 0.1)",mr:2,width:40,height:40},children:v.jsx(Q,{})}),v.jsx(T,{variant:"h6",sx:{fontWeight:700},children:"最近のタスク"})]})}),v.jsx(E,{sx:{p:3},children:v.jsx(q,{sx:{p:0},children:v.jsx(Qn,{children:B.map((e,t)=>v.jsxs(Yn.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3,delay:.1*t},children:[v.jsxs(H,{sx:{px:0,py:1.5,borderRadius:2,mb:1,cursor:"pointer","&:hover":{backgroundColor:"rgba(99, 102, 241, 0.05)",transform:"translateX(4px)"},transition:"all 0.2s ease"},onClick:()=>{console.log("タスクをクリックしました:",e),P(e),D(!0)},children:[v.jsx(nt,{children:v.jsx(R,{sx:{background:`linear-gradient(135deg, ${X(e.status)} 0%, ${je(X(e.status),.8)} 100%)`,width:36,height:36,fontSize:"0.875rem",boxShadow:`0 4px 12px ${je(X(e.status),.3)}`},children:v.jsx(Fe,{sx:{fontSize:16}})})}),v.jsx(F,{primary:v.jsx(T,{variant:"body2",sx:{fontWeight:600,lineHeight:1.4,color:"text.primary"},children:e.title}),secondary:v.jsxs(E,{sx:{display:"flex",alignItems:"center",mt:1},children:[v.jsx(De,{label:"high"===e.priority?"高":"medium"===e.priority?"中":"低",size:"small",sx:{background:`linear-gradient(135deg, ${$(e.priority)} 0%, ${je($(e.priority),.8)} 100%)`,color:"white",fontSize:"0.625rem",height:20,mr:1,fontWeight:600,"& .MuiChip-label":{px:1}}}),v.jsx(T,{variant:"caption",color:"text.secondary",sx:{fontWeight:500},children:Jt(new Date(e.createdAt),"M/d")})]})}),v.jsx(S,{size:"small",sx:{color:"text.secondary","&:hover":{color:"primary.main",backgroundColor:"rgba(99, 102, 241, 0.1)"}},children:v.jsx(it,{sx:{fontSize:18}})})]}),t<B.length-1&&v.jsx(z,{sx:{my:1,opacity:.3}})]},e.id))})})})]})})})]}),v.jsx(I,{color:"primary","aria-label":"新しいタスク",onClick:()=>D(!0),sx:{position:"fixed",bottom:32,right:32,background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",boxShadow:"0 8px 32px rgba(99, 102, 241, 0.4)",width:64,height:64,"&:hover":{background:"linear-gradient(135deg, #4f46e5 0%, #3730a3 100%)",boxShadow:"0 12px 40px rgba(99, 102, 241, 0.6)",transform:"scale(1.05)"},transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:v.jsx(_,{sx:{fontSize:28}})}),v.jsxs(de,{open:g,onClose:()=>y(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:3}},children:[v.jsx(Ve,{children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[v.jsx(T,{variant:"h6",sx:{fontWeight:600},children:"タスクを編集"}),v.jsx(Ee,{color:"error",onClick:()=>p(e,null,function*(){if(f&&(null==i?void 0:i.id))try{yield Ry(i.id,f.id),zt.success("タスクを削除しました"),y(!1),m(null)}catch(e){console.error("タスクの削除に失敗しました:",e),zt.error("タスクの削除に失敗しました")}}),sx:{color:"error.main"},children:"削除"})]})}),v.jsx(pe,{children:v.jsxs(E,{sx:{mt:2},children:[v.jsx(Oe,{fullWidth:!0,label:"タイトル",value:(null==f?void 0:f.title)||"",onChange:e=>m(t=>t?h(u({},t),{title:e.target.value}):null),sx:{mb:2},placeholder:"タスクのタイトルを入力..."}),v.jsx(Oe,{fullWidth:!0,label:"説明",multiline:!0,rows:3,value:(null==f?void 0:f.description)||"",onChange:e=>m(t=>t?h(u({},t),{description:e.target.value}):null),sx:{mb:2},placeholder:"タスクの詳細を入力..."}),v.jsxs(E,{sx:{display:"flex",gap:2,mb:2},children:[v.jsxs(We,{fullWidth:!0,children:[v.jsx(Be,{children:"ステータス"}),v.jsxs(qe,{value:(null==f?void 0:f.status)||"todo",onChange:e=>m(t=>t?h(u({},t),{status:e.target.value}):null),label:"ステータス",children:[v.jsx(N,{value:"todo",children:"To Do"}),v.jsx(N,{value:"inProgress",children:"In Progress"}),v.jsx(N,{value:"done",children:"Done"})]})]}),v.jsxs(We,{fullWidth:!0,children:[v.jsx(Be,{children:"優先度"}),v.jsxs(qe,{value:(null==f?void 0:f.priority)||"medium",onChange:e=>m(t=>t?h(u({},t),{priority:e.target.value}):null),label:"優先度",children:[v.jsx(N,{value:"low",children:"低"}),v.jsx(N,{value:"medium",children:"中"}),v.jsx(N,{value:"high",children:"高"})]})]})]}),v.jsx(Oe,{fullWidth:!0,label:"期限",type:"date",value:(null==f?void 0:f.dueDate)||"",onChange:e=>m(t=>t?h(u({},t),{dueDate:e.target.value}):null),InputLabelProps:{shrink:!0},sx:{mb:2}}),v.jsx(Oe,{fullWidth:!0,label:"担当者",value:(null==f?void 0:f.assignee)||"",onChange:e=>m(t=>t?h(u({},t),{assignee:e.target.value}):null),placeholder:"担当者の名前を入力..."})]})}),v.jsxs(ke,{children:[v.jsx(Ee,{onClick:()=>y(!1),children:"キャンセル"}),v.jsx(Ee,{variant:"contained",onClick:()=>p(e,null,function*(){if(f&&(null==i?void 0:i.id))try{const e=f,{id:t}=e,n=d(e,["id"]);yield Ay(i.id,t,n),zt.success("タスクを更新しました"),y(!1),m(null)}catch(e){console.error("タスクの更新に失敗しました:",e),zt.error("タスクの更新に失敗しました")}}),disabled:!(null==f?void 0:f.title),sx:{backgroundColor:"#007bff","&:hover":{backgroundColor:"#0056b3"}},children:"保存"})]})]}),v.jsx(OS,{open:k,onClose:()=>{D(!1),P(null)},editingTask:j})]})})},LS=()=>{const{user:t}=Ds(),[n,i]=Rt.useState([]),[r,s]=Rt.useState([]),[o,a]=Rt.useState(!1),[l,c]=Rt.useState(null);Rt.useEffect(()=>{if(!(null==t?void 0:t.id))return;const e=Py(t.id,e=>{i(e)});return()=>e()},[null==t?void 0:t.id]),Rt.useEffect(()=>{const e=e=>{const{type:t,value:n,filteredTasks:r}=e.detail;console.log("KanbanBoard: フィルタ変更を検知:",t,n,r),r&&i(r)};return window.addEventListener("filterChanged",e),()=>{window.removeEventListener("filterChanged",e)}},[]),Rt.useEffect(()=>{d()},[n]);const d=()=>{const e=n.filter(e=>"todo"===e.status),t=n.filter(e=>"inProgress"===e.status),i=n.filter(e=>"done"===e.status);s([{id:"todo",title:"未着手",color:"#64748b",tasks:e},{id:"inProgress",title:"進行中",color:"#6366f1",tasks:t},{id:"done",title:"完了",color:"#10b981",tasks:i}])},f=e=>{switch(e){case"high":return"#ef4444";case"medium":return"#f59e0b";case"low":return"#10b981";default:return"#64748b"}},m=e=>{switch(e){case"high":return v.jsx($e,{sx:{fontSize:16,color:"#ef4444"}});case"medium":return v.jsx($e,{sx:{fontSize:16,color:"#f59e0b"}});case"low":return v.jsx($e,{sx:{fontSize:16,color:"#10b981"}});default:return v.jsx($e,{sx:{fontSize:16,color:"#64748b"}})}},g=e=>new Date(e)<new Date&&new Date(e).getTime()!==(new Date).setHours(0,0,0,0);return v.jsxs(E,{sx:{p:3,height:"calc(100vh - 120px)",overflow:"hidden"},children:[v.jsxs(E,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[v.jsx(T,{variant:"h4",sx:{fontWeight:700,color:"text.primary"},children:"カンバンボード"}),v.jsx(Ee,{variant:"contained",startIcon:v.jsx(_,{}),onClick:()=>a(!0),sx:{background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)","&:hover":{background:"linear-gradient(135deg, #4f46e5 0%, #3730a3 100%)"}},children:"新しいタスク"})]}),v.jsx(Jn,{onDragEnd:i=>p(e,null,function*(){if(!i.destination)return;const{source:e,destination:o,draggableId:a}=i,l=a;if(e.droppableId===o.droppableId){const t=r.find(t=>t.id===e.droppableId);if(!t)return;const n=Array.from(t.tasks),[i]=n.splice(e.index,1);n.splice(o.index,0,i);const a=r.map(t=>t.id===e.droppableId?h(u({},t),{tasks:n}):t);s(a)}else{const i=r.find(t=>t.id===e.droppableId),a=r.find(e=>e.id===o.droppableId);if(!i||!a)return;const d=Array.from(i.tasks),f=Array.from(a.tasks),[p]=d.splice(e.index,1);f.splice(o.index,0,p);const m=r.map(t=>t.id===e.droppableId?h(u({},t),{tasks:d}):t.id===o.droppableId?h(u({},t),{tasks:f}):t);s(m);const g=o.droppableId,v=n.find(e=>e.id===l);if(v&&(null==t?void 0:t.id))try{yield Ay(t.id,l,h(u({},v),{status:g}))}catch(c){console.error("タスクの更新に失敗しました:",c)}}}),children:v.jsx(E,{sx:{display:"flex",gap:2,height:"calc(100% - 80px)",overflow:"auto"},children:r.map(e=>v.jsxs(we,{sx:{flex:1,minWidth:300,maxWidth:350,height:"100%",borderRadius:3,background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",border:"1px solid rgba(226, 232, 240, 0.8)",overflow:"hidden"},children:[v.jsxs(E,{sx:{p:2,background:`linear-gradient(135deg, ${e.color} 0%, ${e.color}dd 100%)`,color:"white",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[v.jsx(T,{variant:"h6",sx:{fontWeight:600},children:e.title}),v.jsx(j,{badgeContent:e.tasks.length,color:"primary",sx:{"& .MuiBadge-badge":{backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white",fontWeight:600}}})]}),v.jsx(Zn,{droppableId:e.id,children:(t,n)=>v.jsxs(E,h(u({ref:t.innerRef},t.droppableProps),{sx:{p:2,height:"calc(100% - 80px)",overflow:"auto",backgroundColor:n.isDraggingOver?"rgba(99, 102, 241, 0.05)":"transparent"},children:[v.jsx(Qn,{children:e.tasks.map((e,t)=>v.jsx(ei,{draggableId:e.id,index:t,children:(t,n)=>v.jsx(Yn.div,h(u({ref:t.innerRef},t.draggableProps),{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},children:v.jsx(rt,h(u({},t.dragHandleProps),{sx:{mb:2,borderRadius:2,boxShadow:n.isDragging?"0 8px 32px rgba(0, 0, 0, 0.2)":"0 2px 8px rgba(0, 0, 0, 0.1)",transform:n.isDragging?"rotate(5deg)":"none",cursor:"grab","&:hover":{boxShadow:"0 4px 16px rgba(0, 0, 0, 0.15)"}},children:v.jsxs(Je,{sx:{p:2},children:[v.jsxs(E,{sx:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",mb:1},children:[v.jsx(T,{variant:"body2",sx:{fontWeight:600,lineHeight:1.4,flex:1,mr:1},children:e.title}),v.jsx(S,{size:"small",onClick:()=>{c(e),a(!0)},sx:{color:"text.secondary"},children:v.jsx(st,{sx:{fontSize:16}})})]}),e.description&&v.jsx(T,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:1,lineHeight:1.4},children:e.description}),v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[m(e.priority),v.jsx(De,{label:"high"===e.priority?"高":"medium"===e.priority?"中":"低",size:"small",sx:{backgroundColor:f(e.priority),color:"white",fontSize:"0.625rem",height:20,fontWeight:600}})]}),v.jsxs(E,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:1},children:[v.jsx(Y,{sx:{fontSize:14,color:"text.secondary"}}),v.jsx(T,{variant:"caption",color:g(e.dueDate)?"error.main":"text.secondary",sx:{fontWeight:g(e.dueDate)?600:400},children:Jt(new Date(e.dueDate),"M/d")})]}),v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:.5},children:[v.jsx(R,{sx:{width:20,height:20,fontSize:"0.625rem"},children:e.assignee.charAt(0)}),v.jsx(T,{variant:"caption",color:"text.secondary",children:e.assignee})]})]})]})}))}))},e.id))}),t.placeholder]}))})]},e.id))})}),v.jsx(OS,{open:o,onClose:()=>{a(!1),c(null)},editingTask:l})]})};class VS extends bi{getKeyInfo(){return{allDay:{},timed:{}}}getKeysForDateSpan(e){return e.allDay?["allDay"]:["timed"]}getKeysForEventDef(e){return e.allDay?xi(e)?["timed","allDay"]:["allDay"]:["timed"]}}const FS=ci({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"short"});function US(e){let t=["fc-timegrid-slot","fc-timegrid-slot-label",e.isLabeled?"fc-scrollgrid-shrink":"fc-timegrid-slot-minor"];return ni(_i.Consumer,null,n=>{if(!e.isLabeled)return ni("td",{className:t.join(" "),"data-time":e.isoTimeStr});let{dateEnv:i,options:r,viewApi:s}=n,o=null==r.slotLabelFormat?FS:Array.isArray(r.slotLabelFormat)?ci(r.slotLabelFormat[0]):ci(r.slotLabelFormat),a={level:0,time:e.time,date:i.toDate(e.date),view:s,text:i.format(e.date,o)};return ni(hi,{elTag:"td",elClasses:t,elAttrs:{"data-time":e.isoTimeStr},renderProps:a,generatorName:"slotLabelContent",customGenerator:r.slotLabelContent,defaultGenerator:zS,classNameGenerator:r.slotLabelClassNames,didMount:r.slotLabelDidMount,willUnmount:r.slotLabelWillUnmount},e=>ni("div",{className:"fc-timegrid-slot-label-frame fc-scrollgrid-shrink-frame"},ni(e,{elTag:"div",elClasses:["fc-timegrid-slot-label-cushion","fc-scrollgrid-shrink-cushion"]})))})}function zS(e){return e.text}class WS extends wi{render(){return this.props.slatMetas.map(e=>ni("tr",{key:e.key},ni(US,Object.assign({},e))))}}const BS=ci({week:"short"});class qS extends si{constructor(){super(...arguments),this.allDaySplitter=new VS,this.headerElRef=oi(),this.rootElRef=oi(),this.scrollerElRef=oi(),this.state={slatCoords:null},this.handleScrollTopRequest=e=>{let t=this.scrollerElRef.current;t&&(t.scrollTop=e)},this.renderHeadAxis=(e,t="")=>{let{options:n}=this.context,{dateProfile:i}=this.props,r=i.renderRange,s=1===ai(r.start,r.end)?li(this.context,r.start,"week"):{};return n.weekNumbers&&"day"===e?ni(ui,{elTag:"th",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},date:r.start,defaultFormat:BS},e=>ni("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame","fc-timegrid-axis-frame-liquid"].join(" "),style:{height:t}},ni(e,{elTag:"a",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"],elAttrs:s}))):ni("th",{"aria-hidden":!0,className:"fc-timegrid-axis"},ni("div",{className:"fc-timegrid-axis-frame",style:{height:t}}))},this.renderTableRowAxis=e=>{let{options:t,viewApi:n}=this.context,i={text:t.allDayText,view:n};return ni(hi,{elTag:"td",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},renderProps:i,generatorName:"allDayContent",customGenerator:t.allDayContent,defaultGenerator:HS,classNameGenerator:t.allDayClassNames,didMount:t.allDayDidMount,willUnmount:t.allDayWillUnmount},t=>ni("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame",null==e?" fc-timegrid-axis-frame-liquid":""].join(" "),style:{height:e}},ni(t,{elTag:"span",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"]})))},this.handleSlatCoords=e=>{this.setState({slatCoords:e})}}renderSimpleLayout(e,t,n){let{context:i,props:r}=this,s=[],o=di(i.options);return e&&s.push({type:"header",key:"header",isSticky:o,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),t&&(s.push({type:"body",key:"all-day",chunk:{content:t}}),s.push({type:"body",key:"all-day-divider",outerContent:ni("tr",{role:"presentation",className:"fc-scrollgrid-section"},ni("td",{className:"fc-timegrid-divider "+i.theme.getClass("tableCellShaded")}))})),s.push({type:"body",key:"body",liquid:!0,expandRows:Boolean(i.options.expandRows),chunk:{scrollerElRef:this.scrollerElRef,content:n}}),ni(pi,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:i.viewSpec},ni(fi,{liquid:!r.isHeightAuto&&!r.forPrint,collapsibleWidth:r.forPrint,cols:[{width:"shrink"}],sections:s}))}renderHScrollLayout(e,t,n,i,r,s,o){let a=this.context.pluginHooks.scrollGridImpl;if(!a)throw new Error("No ScrollGrid implementation");let{context:l,props:c}=this,u=!c.forPrint&&di(l.options),h=!c.forPrint&&mi(l.options),d=[];e&&d.push({type:"header",key:"header",isSticky:u,syncRowHeights:!0,chunks:[{key:"axis",rowContent:e=>ni("tr",{role:"presentation"},this.renderHeadAxis("day",e.rowSyncHeights[0]))},{key:"cols",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),t&&(d.push({type:"body",key:"all-day",syncRowHeights:!0,chunks:[{key:"axis",rowContent:e=>ni("tr",{role:"presentation"},this.renderTableRowAxis(e.rowSyncHeights[0]))},{key:"cols",content:t}]}),d.push({key:"all-day-divider",type:"body",outerContent:ni("tr",{role:"presentation",className:"fc-scrollgrid-section"},ni("td",{colSpan:2,className:"fc-timegrid-divider "+l.theme.getClass("tableCellShaded")}))}));let f=l.options.nowIndicator;return d.push({type:"body",key:"body",liquid:!0,expandRows:Boolean(l.options.expandRows),chunks:[{key:"axis",content:e=>ni("div",{className:"fc-timegrid-axis-chunk"},ni("table",{"aria-hidden":!0,style:{height:e.expandRows?e.clientHeight:""}},e.tableColGroupNode,ni("tbody",null,ni(WS,{slatMetas:s}))),ni("div",{className:"fc-timegrid-now-indicator-container"},ni(gi,{unit:f?"minute":"day"},e=>{let t=f&&o&&o.safeComputeTop(e);return"number"==typeof t?ni(vi,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:t},isAxis:!0,date:e}):null})))},{key:"cols",scrollerElRef:this.scrollerElRef,content:n}]}),h&&d.push({key:"footer",type:"footer",isSticky:!0,chunks:[{key:"axis",content:yi},{key:"cols",content:yi}]}),ni(pi,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:l.viewSpec},ni(a,{liquid:!c.isHeightAuto&&!c.forPrint,forPrint:c.forPrint,collapsibleWidth:!1,colGroups:[{width:"shrink",cols:[{width:"shrink"}]},{cols:[{span:i,minWidth:r}]}],sections:d}))}getAllDayMaxEventProps(){let{dayMaxEvents:e,dayMaxEventRows:t}=this.context.options;return!0!==e&&!0!==t||(e=void 0,t=5),{dayMaxEvents:e,dayMaxEventRows:t}}}function HS(e){return e.text}class $S{constructor(e,t,n){this.positions=e,this.dateProfile=t,this.slotDuration=n}safeComputeTop(e){let{dateProfile:t}=this;if(Hi(t.currentRange,e)){let n=$i(e),i=e.valueOf()-n.valueOf();if(i>=Ei(t.slotMinTime)&&i<Ei(t.slotMaxTime))return this.computeTimeTop(Ti(i))}return null}computeDateTop(e,t){return t||(t=$i(e)),this.computeTimeTop(Ti(e.valueOf()-t.valueOf()))}computeTimeTop(e){let t,n,{positions:i,dateProfile:r}=this,s=i.els.length,o=(e.milliseconds-Ei(r.slotMinTime))/Ei(this.slotDuration);return o=Math.max(0,o),o=Math.min(s,o),t=Math.floor(o),t=Math.min(t,s-1),n=o-t,i.tops[t]+i.getHeight(t)*n}}class XS extends wi{render(){let{props:e,context:t}=this,{options:n}=t,{slatElRefs:i}=e;return ni("tbody",null,e.slatMetas.map((r,s)=>{let o={time:r.time,date:t.dateEnv.toDate(r.date),view:t.viewApi};return ni("tr",{key:r.key,ref:i.createRef(r.key)},e.axis&&ni(US,Object.assign({},r)),ni(hi,{elTag:"td",elClasses:["fc-timegrid-slot","fc-timegrid-slot-lane",!r.isLabeled&&"fc-timegrid-slot-minor"],elAttrs:{"data-time":r.isoTimeStr},renderProps:o,generatorName:"slotLaneContent",customGenerator:n.slotLaneContent,classNameGenerator:n.slotLaneClassNames,didMount:n.slotLaneDidMount,willUnmount:n.slotLaneWillUnmount}))}))}}class KS extends wi{constructor(){super(...arguments),this.rootElRef=oi(),this.slatElRefs=new Ai}render(){let{props:e,context:t}=this;return ni("div",{ref:this.rootElRef,className:"fc-timegrid-slots"},ni("table",{"aria-hidden":!0,className:t.theme.getClass("table"),style:{minWidth:e.tableMinWidth,width:e.clientWidth,height:e.minHeight}},e.tableColGroupNode,ni(XS,{slatElRefs:this.slatElRefs,axis:e.axis,slatMetas:e.slatMetas})))}componentDidMount(){this.updateSizing()}componentDidUpdate(){this.updateSizing()}componentWillUnmount(){this.props.onCoords&&this.props.onCoords(null)}updateSizing(){let{context:e,props:t}=this;var n;t.onCoords&&null!==t.clientWidth&&this.rootElRef.current.offsetHeight&&t.onCoords(new $S(new Ri(this.rootElRef.current,(n=this.slatElRefs.currentMap,t.slatMetas.map(e=>n[e.key])),!1,!0),this.props.dateProfile,e.options.slotDuration))}}function GS(e,t){let n,i=[];for(n=0;n<t;n+=1)i.push([]);if(e)for(n=0;n<e.length;n+=1)i[e[n].col].push(e[n]);return i}function YS(e,t){let n=[];if(e){for(let i=0;i<t;i+=1)n[i]={affectedInstances:e.affectedInstances,isEvent:e.isEvent,segs:[]};for(let t of e.segs)n[t.col].segs.push(t)}else for(let i=0;i<t;i+=1)n[i]=null;return n}class QS extends wi{render(){let{props:e}=this;return ni(Ki,{elClasses:["fc-timegrid-more-link"],elStyle:{top:e.top,bottom:e.bottom},allDayDate:null,moreCnt:e.hiddenSegs.length,allSegs:e.hiddenSegs,hiddenSegs:e.hiddenSegs,extraDateSpan:e.extraDateSpan,dateProfile:e.dateProfile,todayRange:e.todayRange,popoverContent:()=>lC(e.hiddenSegs,e),defaultGenerator:JS,forceTimed:!0},e=>ni(e,{elTag:"div",elClasses:["fc-timegrid-more-link-inner","fc-sticky"]}))}}function JS(e){return e.shortText}function ZS(e,t,n){let i=new Gi;null!=t&&(i.strictOrder=t),null!=n&&(i.maxStackCnt=n);let r=i.addSegs(e),s=Yi(r),o=function(e){const{entriesByLevel:t}=e,n=iC((e,t)=>e+":"+t,(i,r)=>{let s=function(e,t,n){let{levelCoords:i,entriesByLevel:r}=e,s=r[t][n],o=i[t]+s.thickness,a=i.length,l=t;for(;l<a&&i[l]<o;l+=1);for(;l<a;l+=1){let e,t=r[l],n=Zi(t,s.span.start,er),i=n[0]+n[1],o=i;for(;(e=t[o])&&e.span.start<s.span.end;)o+=1;if(i<o)return{level:l,lateralStart:i,lateralEnd:o}}return null}(e,i,r),o=eC(s,n),a=t[i][r];return[Object.assign(Object.assign({},a),{nextLevelNodes:o[0]}),a.thickness+o[1]]});return eC(t.length?{level:0,lateralStart:0,lateralEnd:t[0].length}:null,n)[0]}(i);return o=function(e,t){const n=iC((e,t,n)=>Qi(e),(e,i,r)=>{let s,{nextLevelNodes:o,thickness:a}=e,l=a+r,c=a/l,u=[];if(o.length)for(let t of o)if(void 0===s){let e=n(t,i,l);s=e[0],u.push(e[1])}else{let e=n(t,s,0);u.push(e[1])}else s=t;let h=(s-i)*c;return[s-h,Object.assign(Object.assign({},e),{thickness:h,nextLevelNodes:u})]});return e.map(e=>n(e,0,0)[1])}(o,1),{segRects:function(e){let t=[];const n=iC((e,t,n)=>Qi(e),(e,n,r)=>{let s=Object.assign(Object.assign({},e),{levelCoord:n,stackDepth:r,stackForward:0});return t.push(s),s.stackForward=i(e.nextLevelNodes,n+e.thickness,r+1)+1});function i(e,t,i){let r=0;for(let s of e)r=Math.max(n(s,t,i),r);return r}return i(e,0,0),t}(o),hiddenGroups:s}}function eC(e,t){if(!e)return[[],0];let{level:n,lateralStart:i,lateralEnd:r}=e,s=i,o=[];for(;s<r;)o.push(t(n,s)),s+=1;return o.sort(tC),[o.map(nC),o[0][1]]}function tC(e,t){return t[1]-e[1]}function nC(e){return e[0]}function iC(e,t){const n={};return(...i)=>{let r=e(...i);return r in n?n[r]:n[r]=t(...i)}}function rC(e,t,n=null,i=0){let r=[];if(n)for(let s=0;s<e.length;s+=1){let o=e[s],a=n.computeDateTop(o.start,t),l=Math.max(a+(i||0),n.computeDateTop(o.end,t));r.push({start:Math.round(a),end:Math.round(l)})}return r}const sC=ci({hour:"numeric",minute:"2-digit",meridiem:!1});class oC extends wi{render(){return ni(Xi,Object.assign({},this.props,{elClasses:["fc-timegrid-event","fc-v-event",this.props.isShort&&"fc-timegrid-event-short"],defaultTimeFormat:sC}))}}class aC extends wi{constructor(){super(...arguments),this.sortEventSegs=ti(Oi)}render(){let{props:e,context:t}=this,{options:n}=t,i=n.selectMirror,r=e.eventDrag&&e.eventDrag.segs||e.eventResize&&e.eventResize.segs||i&&e.dateSelectionSegs||[],s=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{},o=this.sortEventSegs(e.fgEventSegs,n.eventOrder);return ni(Li,{elTag:"td",elRef:e.elRef,elClasses:["fc-timegrid-col",...e.extraClassNames||[]],elAttrs:Object.assign({role:"gridcell"},e.extraDataAttrs),date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,extraRenderProps:e.extraRenderProps},t=>ni("div",{className:"fc-timegrid-col-frame"},ni("div",{className:"fc-timegrid-col-bg"},this.renderFillSegs(e.businessHourSegs,"non-business"),this.renderFillSegs(e.bgEventSegs,"bg-event"),this.renderFillSegs(e.dateSelectionSegs,"highlight")),ni("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(o,s,!1,!1,!1)),ni("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(r,{},Boolean(e.eventDrag),Boolean(e.eventResize),Boolean(i),"mirror")),ni("div",{className:"fc-timegrid-now-indicator-container"},this.renderNowIndicator(e.nowIndicatorSegs)),Ni(n)&&ni(t,{elTag:"div",elClasses:["fc-timegrid-col-misc"]})))}renderFgSegs(e,t,n,i,r,s){let{props:o}=this;return o.forPrint?lC(e,o):this.renderPositionedFgSegs(e,t,n,i,r,s)}renderPositionedFgSegs(e,t,n,i,r,s){let{eventMaxStack:o,eventShortHeight:a,eventOrderStrict:l,eventMinHeight:c}=this.context.options,{date:u,slatCoords:h,eventSelection:d,todayRange:f,nowDate:p}=this.props,m=n||i||r,g=rC(e,u,h,c),{segPlacements:v,hiddenGroups:y}=function(e,t,n,i){let r=[],s=[];for(let c=0;c<e.length;c+=1){let n=t[c];n?r.push({index:c,thickness:1,span:n}):s.push(e[c])}let{segRects:o,hiddenGroups:a}=ZS(r,n,i),l=[];for(let c of o)l.push({seg:e[c.index],rect:c});for(let c of s)l.push({seg:c,rect:null});return{segPlacements:l,hiddenGroups:a}}(e,g,l,o);return ni(Fi,null,this.renderHiddenGroups(y,e),v.map(e=>{let{seg:o,rect:l}=e,c=o.eventRange.instance.instanceId,u=m||Boolean(!t[c]&&l),h=cC(l&&l.span),g=!m&&l?this.computeSegHStyle(l):{left:0,right:0},v=Boolean(l)&&l.stackForward>0,y=Boolean(l)&&l.span.end-l.span.start<a;return ni("div",{className:"fc-timegrid-event-harness"+(v?" fc-timegrid-event-harness-inset":""),key:s||c,style:Object.assign(Object.assign({visibility:u?"":"hidden"},h),g)},ni(oC,Object.assign({seg:o,isDragging:n,isResizing:i,isDateSelecting:r,isSelected:c===d,isShort:y},Vi(o,f,p))))}))}renderHiddenGroups(e,t){let{extraDateSpan:n,dateProfile:i,todayRange:r,nowDate:s,eventSelection:o,eventDrag:a,eventResize:l}=this.props;return ni(Fi,null,e.map(e=>{let c=cC(e.span),u=(h=e.entries,d=t,h.map(e=>d[e.index]));var h,d;return ni(QS,{key:Ui(zi(u)),hiddenSegs:u,top:c.top,bottom:c.bottom,extraDateSpan:n,dateProfile:i,todayRange:r,nowDate:s,eventSelection:o,eventDrag:a,eventResize:l})}))}renderFillSegs(e,t){let{props:n,context:i}=this,r=rC(e,n.date,n.slatCoords,i.options.eventMinHeight).map((i,r)=>{let s=e[r];return ni("div",{key:qi(s.eventRange),className:"fc-timegrid-bg-harness",style:cC(i)},"bg-event"===t?ni(Bi,Object.assign({seg:s},Vi(s,n.todayRange,n.nowDate))):Wi(t))});return ni(Fi,null,r)}renderNowIndicator(e){let{slatCoords:t,date:n}=this.props;return t?e.map((e,i)=>ni(vi,{key:i,elClasses:["fc-timegrid-now-indicator-line"],elStyle:{top:t.computeDateTop(e.start,n)},isAxis:!1,date:n})):null}computeSegHStyle(e){let t,n,{isRtl:i,options:r}=this.context,s=r.slotEventOverlap,o=e.levelCoord,a=e.levelCoord+e.thickness;s&&(a=Math.min(1,o+2*(a-o))),i?(t=1-a,n=o):(t=o,n=1-a);let l={zIndex:e.stackDepth+1,left:100*t+"%",right:100*n+"%"};return s&&!e.stackForward&&(l[i?"marginLeft":"marginRight"]=20),l}}function lC(e,{todayRange:t,nowDate:n,eventSelection:i,eventDrag:r,eventResize:s}){let o=(r?r.affectedInstances:null)||(s?s.affectedInstances:null)||{};return ni(Fi,null,e.map(e=>{let r=e.eventRange.instance.instanceId;return ni("div",{key:r,style:{visibility:o[r]?"hidden":""}},ni(oC,Object.assign({seg:e,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:r===i,isShort:!1},Vi(e,t,n))))}))}function cC(e){return e?{top:e.start,bottom:-e.end}:{top:"",bottom:""}}class uC extends wi{constructor(){super(...arguments),this.splitFgEventSegs=ti(GS),this.splitBgEventSegs=ti(GS),this.splitBusinessHourSegs=ti(GS),this.splitNowIndicatorSegs=ti(GS),this.splitDateSelectionSegs=ti(GS),this.splitEventDrag=ti(YS),this.splitEventResize=ti(YS),this.rootElRef=oi(),this.cellElRefs=new Ai}render(){let{props:e,context:t}=this,n=t.options.nowIndicator&&e.slatCoords&&e.slatCoords.safeComputeTop(e.nowDate),i=e.cells.length,r=this.splitFgEventSegs(e.fgEventSegs,i),s=this.splitBgEventSegs(e.bgEventSegs,i),o=this.splitBusinessHourSegs(e.businessHourSegs,i),a=this.splitNowIndicatorSegs(e.nowIndicatorSegs,i),l=this.splitDateSelectionSegs(e.dateSelectionSegs,i),c=this.splitEventDrag(e.eventDrag,i),u=this.splitEventResize(e.eventResize,i);return ni("div",{className:"fc-timegrid-cols",ref:this.rootElRef},ni("table",{role:"presentation",style:{minWidth:e.tableMinWidth,width:e.clientWidth}},e.tableColGroupNode,ni("tbody",{role:"presentation"},ni("tr",{role:"row"},e.axis&&ni("td",{"aria-hidden":!0,className:"fc-timegrid-col fc-timegrid-axis"},ni("div",{className:"fc-timegrid-col-frame"},ni("div",{className:"fc-timegrid-now-indicator-container"},"number"==typeof n&&ni(vi,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:n},isAxis:!0,date:e.nowDate})))),e.cells.map((t,n)=>ni(aC,{key:t.key,elRef:this.cellElRefs.createRef(t.key),dateProfile:e.dateProfile,date:t.date,nowDate:e.nowDate,todayRange:e.todayRange,extraRenderProps:t.extraRenderProps,extraDataAttrs:t.extraDataAttrs,extraClassNames:t.extraClassNames,extraDateSpan:t.extraDateSpan,fgEventSegs:r[n],bgEventSegs:s[n],businessHourSegs:o[n],nowIndicatorSegs:a[n],dateSelectionSegs:l[n],eventDrag:c[n],eventResize:u[n],slatCoords:e.slatCoords,eventSelection:e.eventSelection,forPrint:e.forPrint}))))))}componentDidMount(){this.updateCoords()}componentDidUpdate(){this.updateCoords()}updateCoords(){let{props:e}=this;var t;e.onColCoords&&null!==e.clientWidth&&e.onColCoords(new Ri(this.rootElRef.current,(t=this.cellElRefs.currentMap,e.cells.map(e=>t[e.key])),!0,!1))}}class hC extends si{constructor(){super(...arguments),this.processSlotOptions=ti(dC),this.state={slatCoords:null},this.handleRootEl=e=>{e?this.context.registerInteractiveComponent(this,{el:e,isHitComboAllowed:this.props.isHitComboAllowed}):this.context.unregisterInteractiveComponent(this)},this.handleScrollRequest=e=>{let{onScrollTopRequest:t}=this.props,{slatCoords:n}=this.state;if(t&&n){if(e.time){let i=n.computeTimeTop(e.time);i=Math.ceil(i),i&&(i+=1),t(i)}return!0}return!1},this.handleColCoords=e=>{this.colCoords=e},this.handleSlatCoords=e=>{this.setState({slatCoords:e}),this.props.onSlatCoords&&this.props.onSlatCoords(e)}}render(){let{props:e,state:t}=this;return ni("div",{className:"fc-timegrid-body",ref:this.handleRootEl,style:{width:e.clientWidth,minWidth:e.tableMinWidth}},ni(KS,{axis:e.axis,dateProfile:e.dateProfile,slatMetas:e.slatMetas,clientWidth:e.clientWidth,minHeight:e.expandRows?e.clientHeight:"",tableMinWidth:e.tableMinWidth,tableColGroupNode:e.axis?e.tableColGroupNode:null,onCoords:this.handleSlatCoords}),ni(uC,{cells:e.cells,axis:e.axis,dateProfile:e.dateProfile,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,todayRange:e.todayRange,nowDate:e.nowDate,nowIndicatorSegs:e.nowIndicatorSegs,clientWidth:e.clientWidth,tableMinWidth:e.tableMinWidth,tableColGroupNode:e.tableColGroupNode,slatCoords:t.slatCoords,onColCoords:this.handleColCoords,forPrint:e.forPrint}))}componentDidMount(){this.scrollResponder=this.context.createScrollResponder(this.handleScrollRequest)}componentDidUpdate(e){this.scrollResponder.update(e.dateProfile!==this.props.dateProfile)}componentWillUnmount(){this.scrollResponder.detach()}queryHit(e,t){let{dateEnv:n,options:i}=this.context,{colCoords:r}=this,{dateProfile:s}=this.props,{slatCoords:o}=this.state,{snapDuration:a,snapsPerSlot:l}=this.processSlotOptions(this.props.slotDuration,i.snapDuration),c=r.leftToIndex(e),u=o.positions.topToIndex(t);if(null!=c&&null!=u){let e=this.props.cells[c],i=o.positions.tops[u],h=o.positions.getHeight(u),d=(t-i)/h,f=u*l+Math.floor(d*l),p=this.props.cells[c].date,m=Ii(s.slotMinTime,Mi(a,f)),g=n.add(p,m),v=n.add(g,a);return{dateProfile:s,dateSpan:Object.assign({range:{start:g,end:v},allDay:!1},e.extraDateSpan),dayEl:r.els[c],rect:{left:r.lefts[c],right:r.rights[c],top:i,bottom:i+h},layer:0}}return null}}function dC(e,t){let n=t||e,i=ki(e,n);return null===i&&(n=e,i=1),{snapDuration:n,snapsPerSlot:i}}class fC extends ji{sliceRange(e,t){let n=[];for(let i=0;i<t.length;i+=1){let r=Pi(e,t[i]);r&&n.push({start:r.start,end:r.end,isStart:r.start.valueOf()===e.start.valueOf(),isEnd:r.end.valueOf()===e.end.valueOf(),col:i})}return n}}class pC extends si{constructor(){super(...arguments),this.buildDayRanges=ti(mC),this.slicer=new fC,this.timeColsRef=oi()}render(){let{props:e,context:t}=this,{dateProfile:n,dayTableModel:i}=e,{nowIndicator:r,nextDayThreshold:s}=t.options,o=this.buildDayRanges(i,n,t.dateEnv);return ni(gi,{unit:r?"minute":"day"},(a,l)=>ni(hC,Object.assign({ref:this.timeColsRef},this.slicer.sliceProps(e,n,null,t,o),{forPrint:e.forPrint,axis:e.axis,dateProfile:n,slatMetas:e.slatMetas,slotDuration:e.slotDuration,cells:i.cells[0],tableColGroupNode:e.tableColGroupNode,tableMinWidth:e.tableMinWidth,clientWidth:e.clientWidth,clientHeight:e.clientHeight,expandRows:e.expandRows,nowDate:a,nowIndicatorSegs:r&&this.slicer.sliceNowDate(a,n,s,t,o),todayRange:l,onScrollTopRequest:e.onScrollTopRequest,onSlatCoords:e.onSlatCoords})))}}function mC(e,t,n){let i=[];for(let r of e.headerDates)i.push({start:n.add(r,t.slotMinTime),end:n.add(r,t.slotMaxTime)});return i}const gC=[{hours:1},{minutes:30},{minutes:15},{seconds:30},{seconds:15}];function vC(e,t,n,i,r){let s=new Date(0),o=e,a=Ti(0),l=n||function(e){let t,n,i;for(t=gC.length-1;t>=0;t-=1)if(n=Ti(gC[t]),i=ki(n,e),null!==i&&i>1)return n;return e}(i),c=[];for(;Ei(o)<Ei(t);){let e=r.add(s,o),t=null!==ki(a,l);c.push({date:e,time:o,key:e.toISOString(),isoTimeStr:Di(e),isLabeled:t}),o=Ii(o,i),a=Ii(a,i)}return c}function yC(e,t){let n=new Si(e.renderRange,t);return new Ci(n,!1)}Ji('.fc-v-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-v-event .fc-event-main{color:var(--fc-event-text-color);height:100%}.fc-v-event .fc-event-main-frame{display:flex;flex-direction:column;height:100%}.fc-v-event .fc-event-time{flex-grow:0;flex-shrink:0;max-height:100%;overflow:hidden}.fc-v-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-height:0}.fc-v-event .fc-event-title{bottom:0;max-height:100%;overflow:hidden;top:0}.fc-v-event:not(.fc-event-start){border-top-left-radius:0;border-top-right-radius:0;border-top-width:0}.fc-v-event:not(.fc-event-end){border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom-width:0}.fc-v-event.fc-event-selected:before{left:-10px;right:-10px}.fc-v-event .fc-event-resizer-start{cursor:n-resize}.fc-v-event .fc-event-resizer-end{cursor:s-resize}.fc-v-event:not(.fc-event-selected) .fc-event-resizer{height:var(--fc-event-resizer-thickness);left:0;right:0}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-start{top:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer{left:50%;margin-left:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-start{top:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc .fc-timegrid .fc-daygrid-body{z-index:2}.fc .fc-timegrid-divider{padding:0 0 2px}.fc .fc-timegrid-body{min-height:100%;position:relative;z-index:1}.fc .fc-timegrid-axis-chunk{position:relative}.fc .fc-timegrid-axis-chunk>table,.fc .fc-timegrid-slots{position:relative;z-index:1}.fc .fc-timegrid-slot{border-bottom:0;height:1.5em}.fc .fc-timegrid-slot:empty:before{content:"\\00a0"}.fc .fc-timegrid-slot-minor{border-top-style:dotted}.fc .fc-timegrid-slot-label-cushion{display:inline-block;white-space:nowrap}.fc .fc-timegrid-slot-label{vertical-align:middle}.fc .fc-timegrid-axis-cushion,.fc .fc-timegrid-slot-label-cushion{padding:0 4px}.fc .fc-timegrid-axis-frame-liquid{height:100%}.fc .fc-timegrid-axis-frame{align-items:center;display:flex;justify-content:flex-end;overflow:hidden}.fc .fc-timegrid-axis-cushion{flex-shrink:0;max-width:60px}.fc-direction-ltr .fc-timegrid-slot-label-frame{text-align:right}.fc-direction-rtl .fc-timegrid-slot-label-frame{text-align:left}.fc-liquid-hack .fc-timegrid-axis-frame-liquid{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-timegrid-col-frame{min-height:100%;position:relative}.fc-media-screen.fc-liquid-hack .fc-timegrid-col-frame{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols{bottom:0;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols>table{height:100%}.fc-media-screen .fc-timegrid-col-bg,.fc-media-screen .fc-timegrid-col-events,.fc-media-screen .fc-timegrid-now-indicator-container{left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col-bg{z-index:2}.fc .fc-timegrid-col-bg .fc-non-business{z-index:1}.fc .fc-timegrid-col-bg .fc-bg-event{z-index:2}.fc .fc-timegrid-col-bg .fc-highlight{z-index:3}.fc .fc-timegrid-bg-harness{left:0;position:absolute;right:0}.fc .fc-timegrid-col-events{z-index:3}.fc .fc-timegrid-now-indicator-container{bottom:0;overflow:hidden}.fc-direction-ltr .fc-timegrid-col-events{margin:0 2.5% 0 2px}.fc-direction-rtl .fc-timegrid-col-events{margin:0 2px 0 2.5%}.fc-timegrid-event-harness{position:absolute}.fc-timegrid-event-harness>.fc-timegrid-event{bottom:0;left:0;position:absolute;right:0;top:0}.fc-timegrid-event-harness-inset .fc-timegrid-event,.fc-timegrid-event.fc-event-mirror,.fc-timegrid-more-link{box-shadow:0 0 0 1px var(--fc-page-bg-color)}.fc-timegrid-event,.fc-timegrid-more-link{border-radius:3px;font-size:var(--fc-small-font-size)}.fc-timegrid-event{margin-bottom:1px}.fc-timegrid-event .fc-event-main{padding:1px 1px 0}.fc-timegrid-event .fc-event-time{font-size:var(--fc-small-font-size);margin-bottom:1px;white-space:nowrap}.fc-timegrid-event-short .fc-event-main-frame{flex-direction:row;overflow:hidden}.fc-timegrid-event-short .fc-event-time:after{content:"\\00a0-\\00a0"}.fc-timegrid-event-short .fc-event-title{font-size:var(--fc-small-font-size)}.fc-timegrid-more-link{background:var(--fc-more-link-bg-color);color:var(--fc-more-link-text-color);cursor:pointer;margin-bottom:1px;position:absolute;z-index:9999}.fc-timegrid-more-link-inner{padding:3px 2px;top:0}.fc-direction-ltr .fc-timegrid-more-link{right:0}.fc-direction-rtl .fc-timegrid-more-link{left:0}.fc .fc-timegrid-now-indicator-arrow,.fc .fc-timegrid-now-indicator-line{pointer-events:none}.fc .fc-timegrid-now-indicator-line{border-color:var(--fc-now-indicator-color);border-style:solid;border-width:1px 0 0;left:0;position:absolute;right:0;z-index:4}.fc .fc-timegrid-now-indicator-arrow{border-color:var(--fc-now-indicator-color);border-style:solid;margin-top:-5px;position:absolute;z-index:4}.fc-direction-ltr .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 0 5px 6px;left:0}.fc-direction-rtl .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 6px 5px 0;right:0}');const bC={allDaySlot:Boolean};var xC=tr({name:"@fullcalendar/timegrid",initialView:"timeGridWeek",optionRefiners:bC,views:{timeGrid:{component:class extends qS{constructor(){super(...arguments),this.buildTimeColsModel=ti(yC),this.buildSlatMetas=ti(vC)}render(){let{options:e,dateEnv:t,dateProfileGenerator:n}=this.context,{props:i}=this,{dateProfile:r}=i,s=this.buildTimeColsModel(r,n),o=this.allDaySplitter.splitProps(i),a=this.buildSlatMetas(r.slotMinTime,r.slotMaxTime,e.slotLabelInterval,e.slotDuration,t),{dayMinWidth:l}=e,c=!l,u=l,h=e.dayHeaders&&ni(ii,{dates:s.headerDates,dateProfile:r,datesRepDistinctDays:!0,renderIntro:c?this.renderHeadAxis:null}),d=!1!==e.allDaySlot&&(t=>ni(ri,Object.assign({},o.allDay,{dateProfile:r,dayTableModel:s,nextDayThreshold:e.nextDayThreshold,tableMinWidth:t.tableMinWidth,colGroupNode:t.tableColGroupNode,renderRowIntro:c?this.renderTableRowAxis:null,showWeekNumbers:!1,expandRows:!1,headerAlignElRef:this.headerElRef,clientWidth:t.clientWidth,clientHeight:t.clientHeight,forPrint:i.forPrint},this.getAllDayMaxEventProps()))),f=t=>ni(pC,Object.assign({},o.timed,{dayTableModel:s,dateProfile:r,axis:c,slotDuration:e.slotDuration,slatMetas:a,forPrint:i.forPrint,tableColGroupNode:t.tableColGroupNode,tableMinWidth:t.tableMinWidth,clientWidth:t.clientWidth,clientHeight:t.clientHeight,onSlatCoords:this.handleSlatCoords,expandRows:t.expandRows,onScrollTopRequest:this.handleScrollTopRequest}));return u?this.renderHScrollLayout(h,d,f,s.colCnt,l,a,this.state.slatCoords):this.renderSimpleLayout(h,d,f)}},usesMinMaxTime:!0,allDaySlot:!0,slotDuration:"00:30:00",slotEventOverlap:!0},timeGridDay:{type:"timeGrid",duration:{days:1}},timeGridWeek:{type:"timeGrid",duration:{weeks:1}}}});Lr.touchMouseIgnoreWait=500;let wC=0,SC=0,CC=!1;class TC{constructor(e){this.subjectEl=null,this.selector="",this.handleSelector="",this.shouldIgnoreMove=!1,this.shouldWatchScroll=!0,this.isDragging=!1,this.isTouchDragging=!1,this.wasTouchScroll=!1,this.handleMouseDown=e=>{if(!this.shouldIgnoreMouse()&&function(e){return 0===e.button&&!e.ctrlKey}(e)&&this.tryStart(e)){let t=this.createEventFromMouse(e,!0);this.emitter.trigger("pointerdown",t),this.initScrollWatch(t),this.shouldIgnoreMove||document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}},this.handleMouseMove=e=>{let t=this.createEventFromMouse(e);this.recordCoords(t),this.emitter.trigger("pointermove",t)},this.handleMouseUp=e=>{document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.emitter.trigger("pointerup",this.createEventFromMouse(e)),this.cleanup()},this.handleTouchStart=e=>{if(this.tryStart(e)){this.isTouchDragging=!0;let t=this.createEventFromTouch(e,!0);this.emitter.trigger("pointerdown",t),this.initScrollWatch(t);let n=e.target;this.shouldIgnoreMove||n.addEventListener("touchmove",this.handleTouchMove),n.addEventListener("touchend",this.handleTouchEnd),n.addEventListener("touchcancel",this.handleTouchEnd),window.addEventListener("scroll",this.handleTouchScroll,!0)}},this.handleTouchMove=e=>{let t=this.createEventFromTouch(e);this.recordCoords(t),this.emitter.trigger("pointermove",t)},this.handleTouchEnd=e=>{if(this.isDragging){let t=e.target;t.removeEventListener("touchmove",this.handleTouchMove),t.removeEventListener("touchend",this.handleTouchEnd),t.removeEventListener("touchcancel",this.handleTouchEnd),window.removeEventListener("scroll",this.handleTouchScroll,!0),this.emitter.trigger("pointerup",this.createEventFromTouch(e)),this.cleanup(),this.isTouchDragging=!1,wC+=1,setTimeout(()=>{wC-=1},Lr.touchMouseIgnoreWait)}},this.handleTouchScroll=()=>{this.wasTouchScroll=!0},this.handleScroll=e=>{if(!this.shouldIgnoreMove){let t=window.scrollX-this.prevScrollX+this.prevPageX,n=window.scrollY-this.prevScrollY+this.prevPageY;this.emitter.trigger("pointermove",{origEvent:e,isTouch:this.isTouchDragging,subjectEl:this.subjectEl,pageX:t,pageY:n,deltaX:t-this.origPageX,deltaY:n-this.origPageY})}},this.containerEl=e,this.emitter=new Tr,e.addEventListener("mousedown",this.handleMouseDown),e.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),SC+=1,1===SC&&window.addEventListener("touchmove",EC,{passive:!1})}destroy(){this.containerEl.removeEventListener("mousedown",this.handleMouseDown),this.containerEl.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),SC-=1,SC||window.removeEventListener("touchmove",EC,{passive:!1})}tryStart(e){let t=this.querySubjectEl(e),n=e.target;return!(!t||this.handleSelector&&!cr(n,this.handleSelector)||(this.subjectEl=t,this.isDragging=!0,this.wasTouchScroll=!1,0))}cleanup(){CC=!1,this.isDragging=!1,this.subjectEl=null,this.destroyScrollWatch()}querySubjectEl(e){return this.selector?cr(e.target,this.selector):this.containerEl}shouldIgnoreMouse(){return wC||this.isTouchDragging}cancelTouchScroll(){this.isDragging&&(CC=!0)}initScrollWatch(e){this.shouldWatchScroll&&(this.recordCoords(e),window.addEventListener("scroll",this.handleScroll,!0))}recordCoords(e){this.shouldWatchScroll&&(this.prevPageX=e.pageX,this.prevPageY=e.pageY,this.prevScrollX=window.scrollX,this.prevScrollY=window.scrollY)}destroyScrollWatch(){this.shouldWatchScroll&&window.removeEventListener("scroll",this.handleScroll,!0)}createEventFromMouse(e,t){let n=0,i=0;return t?(this.origPageX=e.pageX,this.origPageY=e.pageY):(n=e.pageX-this.origPageX,i=e.pageY-this.origPageY),{origEvent:e,isTouch:!1,subjectEl:this.subjectEl,pageX:e.pageX,pageY:e.pageY,deltaX:n,deltaY:i}}createEventFromTouch(e,t){let n,i,r=e.touches,s=0,o=0;return r&&r.length?(n=r[0].pageX,i=r[0].pageY):(n=e.pageX,i=e.pageY),t?(this.origPageX=n,this.origPageY=i):(s=n-this.origPageX,o=i-this.origPageY),{origEvent:e,isTouch:!0,subjectEl:this.subjectEl,pageX:n,pageY:i,deltaX:s,deltaY:o}}}function EC(e){CC&&e.preventDefault()}class kC{constructor(){this.isVisible=!1,this.sourceEl=null,this.mirrorEl=null,this.sourceElRect=null,this.parentNode=document.body,this.zIndex=9999,this.revertDuration=0}start(e,t,n){this.sourceEl=e,this.sourceElRect=this.sourceEl.getBoundingClientRect(),this.origScreenX=t-window.scrollX,this.origScreenY=n-window.scrollY,this.deltaX=0,this.deltaY=0,this.updateElPosition()}handleMove(e,t){this.deltaX=e-window.scrollX-this.origScreenX,this.deltaY=t-window.scrollY-this.origScreenY,this.updateElPosition()}setIsVisible(e){e?this.isVisible||(this.mirrorEl&&(this.mirrorEl.style.display=""),this.isVisible=e,this.updateElPosition()):this.isVisible&&(this.mirrorEl&&(this.mirrorEl.style.display="none"),this.isVisible=e)}stop(e,t){let n=()=>{this.cleanup(),t()};e&&this.mirrorEl&&this.isVisible&&this.revertDuration&&(this.deltaX||this.deltaY)?this.doRevertAnimation(n,this.revertDuration):setTimeout(n,0)}doRevertAnimation(e,t){let n=this.mirrorEl,i=this.sourceEl.getBoundingClientRect();n.style.transition="top "+t+"ms,left "+t+"ms",Er(n,{left:i.left,top:i.top}),kr(n,()=>{n.style.transition="",e()})}cleanup(){this.mirrorEl&&(Dr(this.mirrorEl),this.mirrorEl=null),this.sourceEl=null}updateElPosition(){this.sourceEl&&this.isVisible&&Er(this.getMirrorEl(),{left:this.sourceElRect.left+this.deltaX,top:this.sourceElRect.top+this.deltaY})}getMirrorEl(){let e=this.sourceElRect,t=this.mirrorEl;return t||(t=this.mirrorEl=this.sourceEl.cloneNode(!0),t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.pointerEvents="none",t.classList.add("fc-event-dragging"),Er(t,{position:"fixed",zIndex:this.zIndex,visibility:"",boxSizing:"border-box",width:e.right-e.left,height:e.bottom-e.top,right:"auto",bottom:"auto",margin:0}),this.parentNode.appendChild(t)),t}}class DC extends zr{constructor(e,t){super(),this.handleScroll=()=>{this.scrollTop=this.scrollController.getScrollTop(),this.scrollLeft=this.scrollController.getScrollLeft(),this.handleScrollChange()},this.scrollController=e,this.doesListening=t,this.scrollTop=this.origScrollTop=e.getScrollTop(),this.scrollLeft=this.origScrollLeft=e.getScrollLeft(),this.scrollWidth=e.getScrollWidth(),this.scrollHeight=e.getScrollHeight(),this.clientWidth=e.getClientWidth(),this.clientHeight=e.getClientHeight(),this.clientRect=this.computeClientRect(),this.doesListening&&this.getEventTarget().addEventListener("scroll",this.handleScroll)}destroy(){this.doesListening&&this.getEventTarget().removeEventListener("scroll",this.handleScroll)}getScrollTop(){return this.scrollTop}getScrollLeft(){return this.scrollLeft}setScrollTop(e){this.scrollController.setScrollTop(e),this.doesListening||(this.scrollTop=Math.max(Math.min(e,this.getMaxScrollTop()),0),this.handleScrollChange())}setScrollLeft(e){this.scrollController.setScrollLeft(e),this.doesListening||(this.scrollLeft=Math.max(Math.min(e,this.getMaxScrollLeft()),0),this.handleScrollChange())}getClientWidth(){return this.clientWidth}getClientHeight(){return this.clientHeight}getScrollWidth(){return this.scrollWidth}getScrollHeight(){return this.scrollHeight}handleScrollChange(){}}class IC extends DC{constructor(e,t){super(new Fr(e),t)}getEventTarget(){return this.scrollController.el}computeClientRect(){return Ur(this.scrollController.el)}}class _C extends DC{constructor(e){super(new Vr,e)}getEventTarget(){return window}computeClientRect(){return{left:this.scrollLeft,right:this.scrollLeft+this.clientWidth,top:this.scrollTop,bottom:this.scrollTop+this.clientHeight}}handleScrollChange(){this.clientRect=this.computeClientRect()}}const jC="function"==typeof performance?performance.now:Date.now;class PC{constructor(){this.isEnabled=!0,this.scrollQuery=[window,".fc-scroller"],this.edgeThreshold=50,this.maxVelocity=300,this.pointerScreenX=null,this.pointerScreenY=null,this.isAnimating=!1,this.scrollCaches=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.animate=()=>{if(this.isAnimating){let e=this.computeBestEdge(this.pointerScreenX+window.scrollX,this.pointerScreenY+window.scrollY);if(e){let t=jC();this.handleSide(e,(t-this.msSinceRequest)/1e3),this.requestAnimation(t)}else this.isAnimating=!1}}}start(e,t,n){this.isEnabled&&(this.scrollCaches=this.buildCaches(n),this.pointerScreenX=null,this.pointerScreenY=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.handleMove(e,t))}handleMove(e,t){if(this.isEnabled){let n=e-window.scrollX,i=t-window.scrollY,r=null===this.pointerScreenY?0:i-this.pointerScreenY,s=null===this.pointerScreenX?0:n-this.pointerScreenX;r<0?this.everMovedUp=!0:r>0&&(this.everMovedDown=!0),s<0?this.everMovedLeft=!0:s>0&&(this.everMovedRight=!0),this.pointerScreenX=n,this.pointerScreenY=i,this.isAnimating||(this.isAnimating=!0,this.requestAnimation(jC()))}}stop(){if(this.isEnabled){this.isAnimating=!1;for(let e of this.scrollCaches)e.destroy();this.scrollCaches=null}}requestAnimation(e){this.msSinceRequest=e,requestAnimationFrame(this.animate)}handleSide(e,t){let{scrollCache:n}=e,{edgeThreshold:i}=this,r=i-e.distance,s=r*r/(i*i)*this.maxVelocity*t,o=1;switch(e.name){case"left":o=-1;case"right":n.setScrollLeft(n.getScrollLeft()+s*o);break;case"top":o=-1;case"bottom":n.setScrollTop(n.getScrollTop()+s*o)}}computeBestEdge(e,t){let{edgeThreshold:n}=this,i=null,r=this.scrollCaches||[];for(let s of r){let r=s.clientRect,o=e-r.left,a=r.right-e,l=t-r.top,c=r.bottom-t;o>=0&&a>=0&&l>=0&&c>=0&&(l<=n&&this.everMovedUp&&s.canScrollUp()&&(!i||i.distance>l)&&(i={scrollCache:s,name:"top",distance:l}),c<=n&&this.everMovedDown&&s.canScrollDown()&&(!i||i.distance>c)&&(i={scrollCache:s,name:"bottom",distance:c}),o<=n&&this.everMovedLeft&&s.canScrollLeft()&&(!i||i.distance>o)&&(i={scrollCache:s,name:"left",distance:o}),a<=n&&this.everMovedRight&&s.canScrollRight()&&(!i||i.distance>a)&&(i={scrollCache:s,name:"right",distance:a}))}return i}buildCaches(e){return this.queryScrollEls(e).map(e=>e===window?new _C(!1):new IC(e,!1))}queryScrollEls(e){let t=[];for(let n of this.scrollQuery)"object"==typeof n?t.push(n):t.push(...Array.prototype.slice.call(e.getRootNode().querySelectorAll(n)));return t}}class MC extends ir{constructor(e,t){super(e),this.containerEl=e,this.delay=null,this.minDistance=0,this.touchScrollAllowed=!0,this.mirrorNeedsRevert=!1,this.isInteracting=!1,this.isDragging=!1,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,this.delayTimeoutId=null,this.onPointerDown=e=>{this.isDragging||(this.isInteracting=!0,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,rr(document.body),sr(document.body),e.isTouch||e.origEvent.preventDefault(),this.emitter.trigger("pointerdown",e),this.isInteracting&&!this.pointer.shouldIgnoreMove&&(this.mirror.setIsVisible(!1),this.mirror.start(e.subjectEl,e.pageX,e.pageY),this.startDelay(e),this.minDistance||this.handleDistanceSurpassed(e)))},this.onPointerMove=e=>{if(this.isInteracting){if(this.emitter.trigger("pointermove",e),!this.isDistanceSurpassed){let t,n=this.minDistance,{deltaX:i,deltaY:r}=e;t=i*i+r*r,t>=n*n&&this.handleDistanceSurpassed(e)}this.isDragging&&("scroll"!==e.origEvent.type&&(this.mirror.handleMove(e.pageX,e.pageY),this.autoScroller.handleMove(e.pageX,e.pageY)),this.emitter.trigger("dragmove",e))}},this.onPointerUp=e=>{this.isInteracting&&(this.isInteracting=!1,or(document.body),ar(document.body),this.emitter.trigger("pointerup",e),this.isDragging&&(this.autoScroller.stop(),this.tryStopDrag(e)),this.delayTimeoutId&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=null))};let n=this.pointer=new TC(e);n.emitter.on("pointerdown",this.onPointerDown),n.emitter.on("pointermove",this.onPointerMove),n.emitter.on("pointerup",this.onPointerUp),t&&(n.selector=t),this.mirror=new kC,this.autoScroller=new PC}destroy(){this.pointer.destroy(),this.onPointerUp({})}startDelay(e){"number"==typeof this.delay?this.delayTimeoutId=setTimeout(()=>{this.delayTimeoutId=null,this.handleDelayEnd(e)},this.delay):this.handleDelayEnd(e)}handleDelayEnd(e){this.isDelayEnded=!0,this.tryStartDrag(e)}handleDistanceSurpassed(e){this.isDistanceSurpassed=!0,this.tryStartDrag(e)}tryStartDrag(e){this.isDelayEnded&&this.isDistanceSurpassed&&(this.pointer.wasTouchScroll&&!this.touchScrollAllowed||(this.isDragging=!0,this.mirrorNeedsRevert=!1,this.autoScroller.start(e.pageX,e.pageY,this.containerEl),this.emitter.trigger("dragstart",e),!1===this.touchScrollAllowed&&this.pointer.cancelTouchScroll()))}tryStopDrag(e){this.mirror.stop(this.mirrorNeedsRevert,this.stopDrag.bind(this,e))}stopDrag(e){this.isDragging=!1,this.emitter.trigger("dragend",e)}setIgnoreMove(e){this.pointer.shouldIgnoreMove=e}setMirrorIsVisible(e){this.mirror.setIsVisible(e)}setMirrorNeedsRevert(e){this.mirrorNeedsRevert=e}setAutoScrollEnabled(e){this.autoScroller.isEnabled=e}}class AC{constructor(e){this.el=e,this.origRect=_r(e),this.scrollCaches=Wr(e).map(e=>new IC(e,!0))}destroy(){for(let e of this.scrollCaches)e.destroy()}computeLeft(){let e=this.origRect.left;for(let t of this.scrollCaches)e+=t.origScrollLeft-t.getScrollLeft();return e}computeTop(){let e=this.origRect.top;for(let t of this.scrollCaches)e+=t.origScrollTop-t.getScrollTop();return e}isWithinClipping(e,t){let n={left:e,top:t};for(let i of this.scrollCaches)if(!RC(i.getEventTarget())&&!Br(n,i.clientRect))return!1;return!0}}function RC(e){let t=e.tagName;return"HTML"===t||"BODY"===t}class OC{constructor(e,t){this.useSubjectCenter=!1,this.requireInitial=!0,this.disablePointCheck=!1,this.initialHit=null,this.movingHit=null,this.finalHit=null,this.handlePointerDown=e=>{let{dragging:t}=this;this.initialHit=null,this.movingHit=null,this.finalHit=null,this.prepareHits(),this.processFirstCoord(e),this.initialHit||!this.requireInitial?(t.setIgnoreMove(!1),this.emitter.trigger("pointerdown",e)):t.setIgnoreMove(!0)},this.handleDragStart=e=>{this.emitter.trigger("dragstart",e),this.handleMove(e,!0)},this.handleDragMove=e=>{this.emitter.trigger("dragmove",e),this.handleMove(e)},this.handlePointerUp=e=>{this.releaseHits(),this.emitter.trigger("pointerup",e)},this.handleDragEnd=e=>{this.movingHit&&this.emitter.trigger("hitupdate",null,!0,e),this.finalHit=this.movingHit,this.movingHit=null,this.emitter.trigger("dragend",e)},this.droppableStore=t,e.emitter.on("pointerdown",this.handlePointerDown),e.emitter.on("dragstart",this.handleDragStart),e.emitter.on("dragmove",this.handleDragMove),e.emitter.on("pointerup",this.handlePointerUp),e.emitter.on("dragend",this.handleDragEnd),this.dragging=e,this.emitter=new Tr}processFirstCoord(e){let t,n={left:e.pageX,top:e.pageY},i=n,r=e.subjectEl;r instanceof HTMLElement&&(t=_r(r),i=jr(i,t));let s=this.initialHit=this.queryHitForOffset(i.left,i.top);if(s){if(this.useSubjectCenter&&t){let e=Pr(t,s.rect);e&&(i=Mr(e))}this.coordAdjust=Ar(i,n)}else this.coordAdjust={left:0,top:0}}handleMove(e,t){let n=this.queryHitForOffset(e.pageX+this.coordAdjust.left,e.pageY+this.coordAdjust.top);!t&&NC(this.movingHit,n)||(this.movingHit=n,this.emitter.trigger("hitupdate",n,!1,e))}prepareHits(){this.offsetTrackers=Rr(this.droppableStore,e=>(e.component.prepareHits(),new AC(e.el)))}releaseHits(){let{offsetTrackers:e}=this;for(let t in e)e[t].destroy();this.offsetTrackers={}}queryHitForOffset(e,t){let{droppableStore:n,offsetTrackers:i}=this,r=null;for(let s in n){let o=n[s].component,a=i[s];if(a&&a.isWithinClipping(e,t)){let n=a.computeLeft(),i=a.computeTop(),l=e-n,c=t-i,{origRect:u}=a,h=u.right-u.left,d=u.bottom-u.top;if(l>=0&&l<h&&c>=0&&c<d){let e=o.queryHit(l,c,h,d);e&&Or(e.dateProfile.activeRange,e.dateSpan.range)&&(this.disablePointCheck||a.el.contains(a.el.getRootNode().elementFromPoint(l+n-window.scrollX,c+i-window.scrollY)))&&(!r||e.layer>r.layer)&&(e.componentId=s,e.context=o.context,e.rect.left+=n,e.rect.right+=n,e.rect.top+=i,e.rect.bottom+=i,r=e)}}}return r}}function NC(e,t){return!e&&!t||Boolean(e)===Boolean(t)&&Ir(e.dateSpan,t.dateSpan)}function LC(e,t){let n={};for(let s of t.pluginHooks.datePointTransforms)Object.assign(n,s(e,t));var i,r;return Object.assign(n,(i=e,{date:(r=t.dateEnv).toDate(i.range.start),dateStr:r.formatIso(i.range.start,{omitTime:i.allDay}),allDay:i.allDay})),n}class VC extends ur{constructor(e){super(e),this.subjectEl=null,this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=e=>{let t=e.origEvent.target,{component:n,dragging:i}=this,{mirror:r}=i,{options:s}=n.context,o=n.context;this.subjectEl=e.subjectEl;let a=this.subjectSeg=gr(e.subjectEl),l=(this.eventRange=a.eventRange).instance.instanceId;this.relevantEvents=vr(o.getCurrentData().eventStore,l),i.minDistance=e.isTouch?0:s.eventDragMinDistance,i.delay=e.isTouch&&l!==n.props.eventSelection?function(e){let{options:t}=e.context,n=t.eventLongPressDelay;return null==n&&(n=t.longPressDelay),n}(n):null,s.fixedMirrorParent?r.parentNode=s.fixedMirrorParent:r.parentNode=cr(t,".fc"),r.revertDuration=s.dragRevertDuration;let c=n.isValidSegDownEl(t)&&!cr(t,".fc-event-resizer");i.setIgnoreMove(!c),this.isDragging=c&&e.subjectEl.classList.contains("fc-event-draggable")},this.handleDragStart=e=>{let t=this.component.context,n=this.eventRange,i=n.instance.instanceId;e.isTouch?i!==this.component.props.eventSelection&&t.dispatch({type:"SELECT_EVENT",eventInstanceId:i}):t.dispatch({type:"UNSELECT_EVENT"}),this.isDragging&&(t.calendarApi.unselect(e),t.emitter.trigger("eventDragStart",{el:this.subjectEl,event:new yr(t,n.def,n.instance),jsEvent:e.origEvent,view:t.viewApi}))},this.handleHitUpdate=(e,t)=>{if(!this.isDragging)return;let n=this.relevantEvents,i=this.hitDragging.initialHit,r=this.component.context,s=null,o=null,a=null,l=!1,c={affectedEvents:n,mutatedEvents:wr(),isEvent:!0};if(e){s=e.context;let t=s.options;r===s||t.editable&&t.droppable?(o=function(e,t,n,i){let r=e.dateSpan,s=t.dateSpan,o=r.range.start,a=s.range.start,l={};r.allDay!==s.allDay&&(l.allDay=s.allDay,l.hasEnd=t.context.options.allDayMaintainDuration,o=s.allDay?$i(n):n);let c=Nr(o,a,e.context.dateEnv,e.componentId===t.componentId?e.largeUnit:null);c.milliseconds&&(l.allDay=!1);let u={datesDelta:c,standardProps:l};for(let h of i)h(u,e,t);return u}(i,e,this.eventRange.instance.range.start,s.getCurrentData().pluginHooks.eventDragMutationMassagers),o&&(a=br(n,s.getCurrentData().eventUiBases,o,s),c.mutatedEvents=a,xr(c,e.dateProfile,s)||(l=!0,o=null,a=null,c.mutatedEvents=wr()))):s=null}this.displayDrag(s,c),l?pr():fr(),t||(r===s&&NC(i,e)&&(o=null),this.dragging.setMirrorNeedsRevert(!o),this.dragging.setMirrorIsVisible(!e||!this.subjectEl.getRootNode().querySelector(".fc-event-mirror")),this.receivingContext=s,this.validMutation=o,this.mutatedRelevantEvents=a)},this.handlePointerUp=()=>{this.isDragging||this.cleanup()},this.handleDragEnd=e=>{if(this.isDragging){let t=this.component.context,n=t.viewApi,{receivingContext:i,validMutation:r}=this,s=this.eventRange.def,o=this.eventRange.instance,a=new yr(t,s,o),l=this.relevantEvents,c=this.mutatedRelevantEvents,{finalHit:u}=this.hitDragging;if(this.clearDrag(),t.emitter.trigger("eventDragStop",{el:this.subjectEl,event:a,jsEvent:e.origEvent,view:n}),r){if(i===t){let i=new yr(t,c.defs[s.defId],o?c.instances[o.instanceId]:null);t.dispatch({type:"MERGE_EVENTS",eventStore:c});let u={oldEvent:a,event:i,relatedEvents:Sr(c,t,o),revert(){t.dispatch({type:"MERGE_EVENTS",eventStore:l})}},h={};for(let e of t.getCurrentData().pluginHooks.eventDropTransformers)Object.assign(h,e(r,t));t.emitter.trigger("eventDrop",Object.assign(Object.assign(Object.assign({},u),h),{el:e.subjectEl,delta:r.datesDelta,jsEvent:e.origEvent,view:n})),t.emitter.trigger("eventChange",u)}else if(i){let r={event:a,relatedEvents:Sr(l,t,o),revert(){t.dispatch({type:"MERGE_EVENTS",eventStore:l})}};t.emitter.trigger("eventLeave",Object.assign(Object.assign({},r),{draggedEl:e.subjectEl,view:n})),t.dispatch({type:"REMOVE_EVENTS",eventStore:l}),t.emitter.trigger("eventRemove",r);let h=c.defs[s.defId],d=c.instances[o.instanceId],f=new yr(i,h,d);i.dispatch({type:"MERGE_EVENTS",eventStore:c});let p={event:f,relatedEvents:Sr(c,i,d),revert(){i.dispatch({type:"REMOVE_EVENTS",eventStore:c})}};i.emitter.trigger("eventAdd",p),e.isTouch&&i.dispatch({type:"SELECT_EVENT",eventInstanceId:o.instanceId}),i.emitter.trigger("drop",Object.assign(Object.assign({},LC(u.dateSpan,i)),{draggedEl:e.subjectEl,jsEvent:e.origEvent,view:u.context.viewApi})),i.emitter.trigger("eventReceive",Object.assign(Object.assign({},p),{draggedEl:e.subjectEl,view:u.context.viewApi}))}}else t.emitter.trigger("_noEventDrop")}this.cleanup()};let{component:t}=this,{options:n}=t.context,i=this.dragging=new MC(e.el);i.pointer.selector=VC.SELECTOR,i.touchScrollAllowed=!1,i.autoScroller.isEnabled=n.dragScroll;let r=this.hitDragging=new OC(this.dragging,Cr);r.useSubjectCenter=e.useEventCenter,r.emitter.on("pointerdown",this.handlePointerDown),r.emitter.on("dragstart",this.handleDragStart),r.emitter.on("hitupdate",this.handleHitUpdate),r.emitter.on("pointerup",this.handlePointerUp),r.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}displayDrag(e,t){let n=this.component.context,i=this.receivingContext;i&&i!==e&&(i===n?i.dispatch({type:"SET_EVENT_DRAG",state:{affectedEvents:t.affectedEvents,mutatedEvents:wr(),isEvent:!0}}):i.dispatch({type:"UNSET_EVENT_DRAG"})),e&&e.dispatch({type:"SET_EVENT_DRAG",state:t})}clearDrag(){let e=this.component.context,{receivingContext:t}=this;t&&t.dispatch({type:"UNSET_EVENT_DRAG"}),e!==t&&e.dispatch({type:"UNSET_EVENT_DRAG"})}cleanup(){this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null}}VC.SELECTOR=".fc-event-draggable, .fc-event-resizable";const FC={fixedMirrorParent:nr},UC={dateClick:nr,eventDragStart:nr,eventDragStop:nr,eventDrop:nr,eventResizeStart:nr,eventResizeStop:nr,eventResize:nr,drop:nr,eventReceive:nr,eventLeave:nr};Lr.dataAttrPrefix="";var zC=tr({name:"@fullcalendar/interaction",componentInteractions:[class extends ur{constructor(e){super(e),this.handlePointerDown=e=>{let{dragging:t}=this,n=e.origEvent.target;t.setIgnoreMove(!this.component.isValidDateDownEl(n))},this.handleDragEnd=e=>{let{component:t}=this,{pointer:n}=this.dragging;if(!n.wasTouchScroll){let{initialHit:n,finalHit:i}=this.hitDragging;if(n&&i&&NC(n,i)){let{context:i}=t,r=Object.assign(Object.assign({},LC(n.dateSpan,i)),{dayEl:n.dayEl,jsEvent:e.origEvent,view:i.viewApi||i.calendarApi.view});i.emitter.trigger("dateClick",r)}}},this.dragging=new MC(e.el),this.dragging.autoScroller.isEnabled=!1;let t=this.hitDragging=new OC(this.dragging,hr(e));t.emitter.on("pointerdown",this.handlePointerDown),t.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}},class extends ur{constructor(e){super(e),this.dragSelection=null,this.handlePointerDown=e=>{let{component:t,dragging:n}=this,{options:i}=t.context,r=i.selectable&&t.isValidDateDownEl(e.origEvent.target);n.setIgnoreMove(!r),n.delay=e.isTouch?function(e){let{options:t}=e.context,n=t.selectLongPressDelay;return null==n&&(n=t.longPressDelay),n}(t):null},this.handleDragStart=e=>{this.component.context.calendarApi.unselect(e)},this.handleHitUpdate=(e,t)=>{let{context:n}=this.component,i=null,r=!1;if(e){let t=this.hitDragging.initialHit;e.componentId===t.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(t,e)||(i=function(e,t,n){let i=e.dateSpan,r=t.dateSpan,s=[i.range.start,i.range.end,r.range.start,r.range.end];s.sort(qr);let o={};for(let a of n){let n=a(e,t);if(!1===n)return null;n&&Object.assign(o,n)}return o.range={start:s[0],end:s[3]},o.allDay=i.allDay,o}(t,e,n.pluginHooks.dateSelectionTransformers)),i&&dr(i,e.dateProfile,n)||(r=!0,i=null)}i?n.dispatch({type:"SELECT_DATES",selection:i}):t||n.dispatch({type:"UNSELECT_DATES"}),r?pr():fr(),t||(this.dragSelection=i)},this.handlePointerUp=e=>{this.dragSelection&&(mr(this.dragSelection,e,this.component.context),this.dragSelection=null)};let{component:t}=e,{options:n}=t.context,i=this.dragging=new MC(e.el);i.touchScrollAllowed=!1,i.minDistance=n.selectMinDistance||0,i.autoScroller.isEnabled=n.dragScroll;let r=this.hitDragging=new OC(this.dragging,hr(e));r.emitter.on("pointerdown",this.handlePointerDown),r.emitter.on("dragstart",this.handleDragStart),r.emitter.on("hitupdate",this.handleHitUpdate),r.emitter.on("pointerup",this.handlePointerUp)}destroy(){this.dragging.destroy()}},VC,class extends ur{constructor(e){super(e),this.draggingSegEl=null,this.draggingSeg=null,this.eventRange=null,this.relevantEvents=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=e=>{let{component:t}=this,n=this.querySegEl(e),i=gr(n),r=this.eventRange=i.eventRange;this.dragging.minDistance=t.context.options.eventDragMinDistance,this.dragging.setIgnoreMove(!this.component.isValidSegDownEl(e.origEvent.target)||e.isTouch&&this.component.props.eventSelection!==r.instance.instanceId)},this.handleDragStart=e=>{let{context:t}=this.component,n=this.eventRange;this.relevantEvents=vr(t.getCurrentData().eventStore,this.eventRange.instance.instanceId);let i=this.querySegEl(e);this.draggingSegEl=i,this.draggingSeg=gr(i),t.calendarApi.unselect(),t.emitter.trigger("eventResizeStart",{el:i,event:new yr(t,n.def,n.instance),jsEvent:e.origEvent,view:t.viewApi})},this.handleHitUpdate=(e,t,n)=>{let{context:i}=this.component,r=this.relevantEvents,s=this.hitDragging.initialHit,o=this.eventRange.instance,a=null,l=null,c=!1,u={affectedEvents:r,mutatedEvents:wr(),isEvent:!0};e&&(e.componentId===s.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(s,e)||(a=function(e,t,n,i){let r=e.context.dateEnv,s=e.dateSpan.range.start,o=t.dateSpan.range.start,a=Nr(s,o,r,e.largeUnit);if(n){if(r.add(i.start,a)<i.end)return{startDelta:a}}else if(r.add(i.end,a)>i.start)return{endDelta:a};return null}(s,e,n.subjectEl.classList.contains("fc-event-resizer-start"),o.range))),a&&(l=br(r,i.getCurrentData().eventUiBases,a,i),u.mutatedEvents=l,xr(u,e.dateProfile,i)||(c=!0,a=null,l=null,u.mutatedEvents=null)),l?i.dispatch({type:"SET_EVENT_RESIZE",state:u}):i.dispatch({type:"UNSET_EVENT_RESIZE"}),c?pr():fr(),t||(a&&NC(s,e)&&(a=null),this.validMutation=a,this.mutatedRelevantEvents=l)},this.handleDragEnd=e=>{let{context:t}=this.component,n=this.eventRange.def,i=this.eventRange.instance,r=new yr(t,n,i),s=this.relevantEvents,o=this.mutatedRelevantEvents;if(t.emitter.trigger("eventResizeStop",{el:this.draggingSegEl,event:r,jsEvent:e.origEvent,view:t.viewApi}),this.validMutation){let a=new yr(t,o.defs[n.defId],i?o.instances[i.instanceId]:null);t.dispatch({type:"MERGE_EVENTS",eventStore:o});let l={oldEvent:r,event:a,relatedEvents:Sr(o,t,i),revert(){t.dispatch({type:"MERGE_EVENTS",eventStore:s})}};t.emitter.trigger("eventResize",Object.assign(Object.assign({},l),{el:this.draggingSegEl,startDelta:this.validMutation.startDelta||Ti(0),endDelta:this.validMutation.endDelta||Ti(0),jsEvent:e.origEvent,view:t.viewApi})),t.emitter.trigger("eventChange",l)}else t.emitter.trigger("_noEventResize");this.draggingSeg=null,this.relevantEvents=null,this.validMutation=null};let{component:t}=e,n=this.dragging=new MC(e.el);n.pointer.selector=".fc-event-resizer",n.touchScrollAllowed=!1,n.autoScroller.isEnabled=t.context.options.dragScroll;let i=this.hitDragging=new OC(this.dragging,hr(e));i.emitter.on("pointerdown",this.handlePointerDown),i.emitter.on("dragstart",this.handleDragStart),i.emitter.on("hitupdate",this.handleHitUpdate),i.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}querySegEl(e){return cr(e.subjectEl,".fc-event")}}],calendarInteractions:[class{constructor(e){this.context=e,this.isRecentPointerDateSelect=!1,this.matchesCancel=!1,this.matchesEvent=!1,this.onSelect=e=>{e.jsEvent&&(this.isRecentPointerDateSelect=!0)},this.onDocumentPointerDown=e=>{let t=this.context.options.unselectCancel,n=lr(e.origEvent);this.matchesCancel=!!cr(n,t),this.matchesEvent=!!cr(n,VC.SELECTOR)},this.onDocumentPointerUp=e=>{let{context:t}=this,{documentPointer:n}=this,i=t.getCurrentData();if(!n.wasTouchScroll){if(i.dateSelection&&!this.isRecentPointerDateSelect){let n=t.options.unselectAuto;!n||n&&this.matchesCancel||t.calendarApi.unselect(e)}i.eventSelection&&!this.matchesEvent&&t.dispatch({type:"UNSELECT_EVENT"})}this.isRecentPointerDateSelect=!1};let t=this.documentPointer=new TC(document);t.shouldIgnoreMove=!0,t.shouldWatchScroll=!1,t.emitter.on("pointerdown",this.onDocumentPointerDown),t.emitter.on("pointerup",this.onDocumentPointerUp),e.emitter.on("select",this.onSelect)}destroy(){this.context.emitter.off("select",this.onSelect),this.documentPointer.destroy()}}],elementDraggingImpl:MC,optionRefiners:FC,listenerRefiners:UC});const WC=()=>{const{user:t}=Ds(),[n,i]=Rt.useState([]),[r,s]=Rt.useState([]),[o,a]=Rt.useState(null),[l,c]=Rt.useState(!1),[d,f]=Rt.useState(null);Rt.useEffect(()=>{if(!(null==t?void 0:t.id))return;const e=Py(t.id,e=>{i(e)});return()=>e()},[null==t?void 0:t.id]),Rt.useEffect(()=>{const e=e=>{const{type:t,value:n,filteredTasks:r}=e.detail;console.log("CalendarView: フィルタ変更を検知:",t,n,r),r&&i(r)};return window.addEventListener("filterChanged",e),()=>{window.removeEventListener("filterChanged",e)}},[]),Rt.useEffect(()=>{m()},[n]);const m=()=>{const e=n.map(e=>{e.priority;const t={todo:{bg:"#6b7280",border:"#4b5563",text:"#ffffff"},inProgress:{bg:"#3b82f6",border:"#2563eb",text:"#ffffff"},done:{bg:"#10b981",border:"#059669",text:"#ffffff"}}[e.status];return{id:e.id,title:e.title,start:e.dueDate,backgroundColor:t.bg,borderColor:t.border,textColor:t.text,extendedProps:{task:e}}});s(e)};return v.jsx(E,{sx:{p:3},children:v.jsxs(Yn.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[v.jsxs(E,{sx:{mb:3,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[v.jsx(T,{variant:"h4",sx:{fontWeight:700},children:"カレンダー"}),v.jsx(Ee,{variant:"contained",startIcon:v.jsx(_,{}),onClick:()=>{const e={id:Date.now().toString(),title:"",description:"",status:"todo",priority:"medium",dueDate:Jt(new Date,"yyyy-MM-dd"),assignee:"",createdAt:(new Date).toISOString()};f(e),c(!0)},children:"新しいタスク"})]}),v.jsx(rt,{children:v.jsxs(Je,{sx:{p:0},children:[v.jsxs(E,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:[v.jsx(T,{variant:"h6",sx:{fontWeight:600,mb:1},children:"タスクカレンダー"}),v.jsxs(E,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[v.jsx(De,{icon:v.jsx(ot,{}),label:"未着手",size:"small",sx:{bgcolor:"#6b7280",color:"white"}}),v.jsx(De,{icon:v.jsx(He,{}),label:"進行中",size:"small",sx:{bgcolor:"#3b82f6",color:"white"}}),v.jsx(De,{icon:v.jsx(ot,{}),label:"完了",size:"small",sx:{bgcolor:"#10b981",color:"white"}})]})]}),v.jsx(E,{sx:{height:600},children:v.jsx(Hr,{plugins:[$r,xC,zC],initialView:"dayGridMonth",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},locale:"ja",editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,weekends:!0,events:r,dateClick:e=>{const t={id:Date.now().toString(),title:"",description:"",status:"todo",priority:"medium",dueDate:e.dateStr,assignee:"",createdAt:(new Date).toISOString()};f(t),c(!0)},eventClick:e=>{a(e.event),f(e.event.extendedProps.task),c(!0)},height:"100%",eventDisplay:"block",eventTimeFormat:{hour:"2-digit",minute:"2-digit",meridiem:!1}})})]})}),v.jsxs(de,{open:l,onClose:()=>c(!1),maxWidth:"sm",fullWidth:!0,children:[v.jsx(Ve,{children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[v.jsx(T,{variant:"h6",sx:{fontWeight:600},children:(null==d?void 0:d.id)?"タスクを編集":"新しいタスク"}),(null==d?void 0:d.id)&&v.jsx(k,{title:"削除",children:v.jsx(S,{color:"error",onClick:()=>p(e,null,function*(){if(d&&(null==t?void 0:t.id))try{yield Ry(t.id,d.id),c(!1),f(null)}catch(e){console.error("タスクの削除に失敗しました:",e)}}),sx:{color:"error.main"},children:v.jsx(X,{})})})]})}),v.jsx(pe,{children:v.jsxs(E,{sx:{mt:2},children:[v.jsx(Oe,{fullWidth:!0,label:"タイトル",value:(null==d?void 0:d.title)||"",onChange:e=>f(t=>t?h(u({},t),{title:e.target.value}):null),sx:{mb:2}}),v.jsx(Oe,{fullWidth:!0,label:"説明",multiline:!0,rows:3,value:(null==d?void 0:d.description)||"",onChange:e=>f(t=>t?h(u({},t),{description:e.target.value}):null),sx:{mb:2}}),v.jsxs(E,{sx:{display:"flex",gap:2,mb:2},children:[v.jsxs(We,{fullWidth:!0,children:[v.jsx(Be,{children:"ステータス"}),v.jsxs(qe,{value:(null==d?void 0:d.status)||"todo",onChange:e=>f(t=>t?h(u({},t),{status:e.target.value}):null),label:"ステータス",children:[v.jsx(N,{value:"todo",children:"未着手"}),v.jsx(N,{value:"inProgress",children:"進行中"}),v.jsx(N,{value:"done",children:"完了"})]})]}),v.jsxs(We,{fullWidth:!0,children:[v.jsx(Be,{children:"優先度"}),v.jsxs(qe,{value:(null==d?void 0:d.priority)||"medium",onChange:e=>f(t=>t?h(u({},t),{priority:e.target.value}):null),label:"優先度",children:[v.jsx(N,{value:"low",children:"低"}),v.jsx(N,{value:"medium",children:"中"}),v.jsx(N,{value:"high",children:"高"})]})]})]}),v.jsx(Oe,{fullWidth:!0,label:"期限",type:"date",value:(null==d?void 0:d.dueDate)||"",onChange:e=>f(t=>t?h(u({},t),{dueDate:e.target.value}):null),InputLabelProps:{shrink:!0},sx:{mb:2}}),v.jsx(Oe,{fullWidth:!0,label:"担当者",value:(null==d?void 0:d.assignee)||"",onChange:e=>f(t=>t?h(u({},t),{assignee:e.target.value}):null)})]})}),v.jsxs(ke,{children:[v.jsx(Ee,{onClick:()=>c(!1),children:"キャンセル"}),v.jsx(Ee,{variant:"contained",onClick:()=>p(e,null,function*(){if(d&&(null==t?void 0:t.id))try{if(d.id&&d.title)if(d.id.includes("temp")){const e=h(u({},d),{id:Date.now().toString(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()});yield My(t.id,e)}else yield Ay(t.id,d.id,d);c(!1),f(null)}catch(e){console.error("タスクの保存に失敗しました:",e)}}),disabled:!(null==d?void 0:d.title),children:"保存"})]})]})]})})},BC=()=>{const{user:t}=Ds(),[n,i]=Rt.useState([]),[r,s]=Rt.useState(null),[o,a]=Rt.useState(!1),[l,c]=Rt.useState(null),[d,f]=Rt.useState("week");Rt.useEffect(()=>{if(!(null==t?void 0:t.id))return;const e=Py(t.id,e=>{const t=e.map((e,t)=>h(u({},e),{startDate:e.startDate||Jt($t(new Date,2*t),"yyyy-MM-dd"),endDate:e.endDate||Jt($t(new Date,2*t+1),"yyyy-MM-dd")}));i(t)});return()=>e()},[null==t?void 0:t.id]),Rt.useEffect(()=>{const e=e=>{const{type:t,value:n,filteredTasks:r}=e.detail;if(console.log("TimelineView: フィルタ変更を検知:",t,n,r),r){const e=r.map((e,t)=>h(u({},e),{startDate:e.startDate||Jt($t(new Date,2*t),"yyyy-MM-dd"),endDate:e.endDate||Jt($t(new Date,2*t+1),"yyyy-MM-dd")}));i(e)}};return window.addEventListener("filterChanged",e),()=>{window.removeEventListener("filterChanged",e)}},[]);const m=()=>{const e=new Date;return{startDate:bn("week"===d?e:new Date(e.getFullYear(),e.getMonth(),1)),endDate:"week"===d?$t(e,7):new Date(e.getFullYear(),e.getMonth()+1,0)}},g=()=>{const{startDate:e,endDate:t}=m(),n=[];let i=e;for(;vn(i,t)||i.getTime()===t.getTime();)n.push(i),i=$t(i,1);return n},y=e=>{switch(e){case"high":return"#ef4444";case"medium":return"#f59e0b";case"low":return"#10b981";default:return"#6b7280"}},b=e=>{switch(e){case"todo":default:return"#6b7280";case"inProgress":return"#3b82f6";case"done":return"#10b981"}},x=g();return v.jsx(E,{sx:{p:3},children:v.jsxs(Yn.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[v.jsxs(E,{sx:{mb:3,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[v.jsx(T,{variant:"h4",sx:{fontWeight:700},children:"タイムライン"}),v.jsxs(E,{sx:{display:"flex",gap:2},children:[v.jsx(Ee,{variant:"week"===d?"contained":"outlined",onClick:()=>f("week"),children:"週表示"}),v.jsx(Ee,{variant:"month"===d?"contained":"outlined",onClick:()=>f("month"),children:"月表示"}),v.jsx(Ee,{variant:"contained",startIcon:v.jsx(_,{}),onClick:()=>{const e={id:Date.now().toString(),title:"",description:"",status:"todo",priority:"medium",dueDate:Jt(new Date,"yyyy-MM-dd"),assignee:"",createdAt:(new Date).toISOString(),startDate:Jt(new Date,"yyyy-MM-dd"),endDate:Jt($t(new Date,1),"yyyy-MM-dd")};c(e),a(!0)},children:"新しいタスク"})]})]}),v.jsx(rt,{children:v.jsxs(Je,{sx:{p:0},children:[v.jsxs(E,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:[v.jsx(T,{variant:"h6",sx:{fontWeight:600,mb:1},children:"プロジェクトタイムライン"}),v.jsxs(E,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[v.jsx(De,{icon:v.jsx(Q,{}),label:"未着手",size:"small",sx:{bgcolor:"#6b7280",color:"white"}}),v.jsx(De,{icon:v.jsx(He,{}),label:"進行中",size:"small",sx:{bgcolor:"#3b82f6",color:"white"}}),v.jsx(De,{icon:v.jsx(Ke,{}),label:"完了",size:"small",sx:{bgcolor:"#10b981",color:"white"}})]})]}),v.jsxs(E,{sx:{p:2},children:[v.jsxs(E,{sx:{display:"flex",mb:2},children:[v.jsx(E,{sx:{width:200,flexShrink:0}}),x.map((e,t)=>v.jsxs(E,{sx:{flex:1,textAlign:"center",borderRight:t<x.length-1?1:0,borderColor:"divider",py:1},children:[v.jsx(T,{variant:"caption",color:"text.secondary",children:Jt(e,"M/d",{locale:Uy})}),v.jsx(T,{variant:"caption",display:"block",children:Jt(e,"EEE",{locale:Uy})})]},t))]}),v.jsx(E,{sx:{position:"relative"},children:n.map((e,t)=>{const n=(e=>{const{startDate:t}=m(),n=new Date(e.startDate||e.dueDate),i=rn(n,t),r=rn(new Date(e.endDate||e.dueDate),new Date(e.startDate||e.dueDate))+1;return{left:i/g().length*100+"%",width:r/g().length*100+"%"}})(e);return v.jsx(Yn.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1*t},style:{position:"absolute",left:n.left,width:n.width,top:60*t+"px",height:"40px"},children:v.jsx(rt,{sx:{height:"100%",backgroundColor:b(e.status),color:"white",cursor:"pointer","&:hover":{transform:"scale(1.02)",boxShadow:2}},onClick:()=>{s(e),c(e),a(!0)},children:v.jsx(Je,{sx:{p:1,height:"100%"},children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",height:"100%"},children:[v.jsx(R,{sx:{width:24,height:24,bgcolor:y(e.priority),mr:1},children:v.jsx($e,{sx:{fontSize:12}})}),v.jsx(T,{variant:"body2",sx:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.title})]})})})},e.id)})}),v.jsx(E,{sx:{height:60*n.length+"px",mt:2}})]})]})}),v.jsx(rt,{sx:{mt:3},children:v.jsxs(Je,{children:[v.jsx(T,{variant:"h6",sx:{fontWeight:600,mb:2},children:"タスク一覧"}),v.jsx(q,{children:n.map((e,t)=>v.jsxs(At.Fragment,{children:[v.jsxs(H,{sx:{px:0},secondaryAction:v.jsxs(E,{sx:{display:"flex",gap:1},children:[v.jsx(k,{title:"編集",children:v.jsx(S,{size:"small",onClick:()=>{c(e),a(!0)},children:v.jsx(st,{})})}),v.jsx(k,{title:"削除",children:v.jsx(S,{size:"small",color:"error",onClick:()=>{const t=n.filter(t=>t.id!==e.id);localStorage.setItem("tasks",JSON.stringify(t)),i(t)},children:v.jsx(X,{})})})]}),children:[v.jsx(nt,{children:v.jsx(R,{sx:{bgcolor:b(e.status)},children:v.jsx(Fe,{})})}),v.jsx(F,{primary:v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:1},children:[v.jsx(T,{variant:"body1",sx:{fontWeight:500},children:e.title}),v.jsx(De,{label:e.priority,size:"small",sx:{backgroundColor:y(e.priority),color:"white",fontSize:"0.75rem"}})]}),secondary:v.jsxs(E,{sx:{mt:.5},children:[v.jsx(T,{variant:"body2",color:"text.secondary",children:e.description}),v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:2,mt:.5},children:[v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:.5},children:[v.jsx(Y,{sx:{fontSize:16}}),v.jsxs(T,{variant:"caption",color:"text.secondary",children:[Jt(new Date(e.startDate||e.dueDate),"M/d")," - ",Jt(new Date(e.endDate||e.dueDate),"M/d")]})]}),e.assignee&&v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:.5},children:[v.jsx(V,{sx:{fontSize:16}}),v.jsx(T,{variant:"caption",color:"text.secondary",children:e.assignee})]})]})]})})]}),t<n.length-1&&v.jsx(z,{})]},e.id))})]})}),v.jsxs(de,{open:o,onClose:()=>a(!1),maxWidth:"sm",fullWidth:!0,children:[v.jsx(Ve,{children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[v.jsx(T,{variant:"h6",sx:{fontWeight:600},children:(null==l?void 0:l.id)?"タスクを編集":"新しいタスク"}),(null==l?void 0:l.id)&&v.jsx(k,{title:"削除",children:v.jsx(S,{color:"error",onClick:()=>p(e,null,function*(){if(l&&(null==t?void 0:t.id))try{yield Ry(t.id,l.id),a(!1),c(null)}catch(e){console.error("タスクの削除に失敗しました:",e)}}),sx:{color:"error.main"},children:v.jsx(X,{})})})]})}),v.jsx(pe,{children:v.jsxs(E,{sx:{mt:2},children:[v.jsx(Oe,{fullWidth:!0,label:"タイトル",value:(null==l?void 0:l.title)||"",onChange:e=>c(t=>t?h(u({},t),{title:e.target.value}):null),sx:{mb:2}}),v.jsx(Oe,{fullWidth:!0,label:"説明",multiline:!0,rows:3,value:(null==l?void 0:l.description)||"",onChange:e=>c(t=>t?h(u({},t),{description:e.target.value}):null),sx:{mb:2}}),v.jsxs(E,{sx:{display:"flex",gap:2,mb:2},children:[v.jsxs(We,{fullWidth:!0,children:[v.jsx(Be,{children:"ステータス"}),v.jsxs(qe,{value:(null==l?void 0:l.status)||"todo",onChange:e=>c(t=>t?h(u({},t),{status:e.target.value}):null),label:"ステータス",children:[v.jsx(N,{value:"todo",children:"未着手"}),v.jsx(N,{value:"inProgress",children:"進行中"}),v.jsx(N,{value:"done",children:"完了"})]})]}),v.jsxs(We,{fullWidth:!0,children:[v.jsx(Be,{children:"優先度"}),v.jsxs(qe,{value:(null==l?void 0:l.priority)||"medium",onChange:e=>c(t=>t?h(u({},t),{priority:e.target.value}):null),label:"優先度",children:[v.jsx(N,{value:"low",children:"低"}),v.jsx(N,{value:"medium",children:"中"}),v.jsx(N,{value:"high",children:"高"})]})]})]}),v.jsxs(E,{sx:{display:"flex",gap:2,mb:2},children:[v.jsx(Oe,{fullWidth:!0,label:"開始日",type:"date",value:(null==l?void 0:l.startDate)||"",onChange:e=>c(t=>t?h(u({},t),{startDate:e.target.value}):null),InputLabelProps:{shrink:!0}}),v.jsx(Oe,{fullWidth:!0,label:"終了日",type:"date",value:(null==l?void 0:l.endDate)||"",onChange:e=>c(t=>t?h(u({},t),{endDate:e.target.value}):null),InputLabelProps:{shrink:!0}})]}),v.jsx(Oe,{fullWidth:!0,label:"担当者",value:(null==l?void 0:l.assignee)||"",onChange:e=>c(t=>t?h(u({},t),{assignee:e.target.value}):null)})]})}),v.jsxs(ke,{children:[v.jsx(Ee,{onClick:()=>a(!1),children:"キャンセル"}),v.jsx(Ee,{variant:"contained",onClick:()=>p(e,null,function*(){if(l&&(null==t?void 0:t.id))try{if(l.id&&l.title)if(l.id.includes("temp")){const e=h(u({},l),{id:Date.now().toString(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()});yield My(t.id,e)}else yield Ay(t.id,l.id,l);a(!1),c(null)}catch(e){console.error("タスクの保存に失敗しました:",e)}}),disabled:!(null==l?void 0:l.title),children:"保存"})]})]})]})})},qC=()=>{const{user:t}=Ds(),[n,i]=Rt.useState([]),[r,s]=Rt.useState([]),[o,a]=Rt.useState([]),[l,c]=Rt.useState(!1),[d,f]=Rt.useState(null),[m,g]=Rt.useState(""),[y,b]=Rt.useState("all"),[x,w]=Rt.useState("all"),[C,I]=Rt.useState("asc"),[j,P]=Rt.useState("createdAt"),[M,A]=Rt.useState(0),[O,L]=Rt.useState(10);Rt.useEffect(()=>{if(!(null==t?void 0:t.id))return;const e=Py(t.id,e=>{i(e)});return()=>e()},[null==t?void 0:t.id]),Rt.useEffect(()=>{const e=e=>{const{type:t,value:n,filteredTasks:r}=e.detail;console.log("ListView: フィルタ変更を検知:",t,n,r),r&&i(r)};return window.addEventListener("filterChanged",e),()=>{window.removeEventListener("filterChanged",e)}},[]),Rt.useEffect(()=>{F()},[n,m,y,x,C,j]);const F=()=>{let e=n.filter(e=>{const t=e.title.toLowerCase().includes(m.toLowerCase())||e.description.toLowerCase().includes(m.toLowerCase())||e.assignee.toLowerCase().includes(m.toLowerCase()),n="all"===y||e.status===y,i="all"===x||e.priority===x;return t&&n&&i});e.sort((e,t)=>{let n=e[j],i=t[j];return"dueDate"!==j&&"createdAt"!==j||(n=new Date(n).getTime(),i=new Date(i).getTime()),"desc"===C?i>n?1:-1:n>i?1:-1}),s(e)},U=e=>{I(j===e&&"asc"===C?"desc":"asc"),P(e)},z=e=>{switch(e){case"high":return"#ef4444";case"medium":return"#f59e0b";case"low":return"#10b981";default:return"#6b7280"}},W=e=>{switch(e){case"todo":default:return"#6b7280";case"inProgress":return"#3b82f6";case"done":return"#10b981"}},B=e=>{switch(e){case"todo":default:return v.jsx(Fe,{});case"inProgress":return v.jsx(He,{});case"done":return v.jsx(Ke,{})}},q=e=>{switch(e){case"high":return v.jsx(Ge,{});case"medium":default:return v.jsx($e,{});case"low":return v.jsx(Ke,{})}};return v.jsx(E,{sx:{p:3},children:v.jsxs(Yn.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[v.jsxs(E,{sx:{mb:3,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[v.jsx(T,{variant:"h4",sx:{fontWeight:700},children:"リストビュー"}),v.jsxs(E,{sx:{display:"flex",gap:2},children:[o.length>0&&v.jsxs(Ee,{variant:"outlined",color:"error",startIcon:v.jsx(X,{}),onClick:()=>p(e,null,function*(){if(null==t?void 0:t.id)try{for(const e of o)yield Ry(t.id,e);a([])}catch(e){console.error("選択されたタスクの削除に失敗しました:",e)}}),children:["選択削除 (",o.length,")"]}),v.jsx(Ee,{variant:"contained",startIcon:v.jsx(_,{}),onClick:()=>{const e={id:Date.now().toString(),title:"",description:"",status:"todo",priority:"medium",dueDate:Jt(new Date,"yyyy-MM-dd"),assignee:"",createdAt:(new Date).toISOString()};f(e),c(!0)},children:"新しいタスク"})]})]}),v.jsx(rt,{sx:{mb:3},children:v.jsx(Je,{children:v.jsxs(E,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap"},children:[v.jsx(Oe,{placeholder:"タスクを検索...",value:m,onChange:e=>g(e.target.value),InputProps:{startAdornment:v.jsx(Re,{position:"start",children:v.jsx(D,{})})},sx:{minWidth:250}}),v.jsxs(We,{sx:{minWidth:120},children:[v.jsx(Be,{children:"ステータス"}),v.jsxs(qe,{value:y,onChange:e=>b(e.target.value),label:"ステータス",children:[v.jsx(N,{value:"all",children:"すべて"}),v.jsx(N,{value:"todo",children:"未着手"}),v.jsx(N,{value:"inProgress",children:"進行中"}),v.jsx(N,{value:"done",children:"完了"})]})]}),v.jsxs(We,{sx:{minWidth:120},children:[v.jsx(Be,{children:"優先度"}),v.jsxs(qe,{value:x,onChange:e=>w(e.target.value),label:"優先度",children:[v.jsx(N,{value:"all",children:"すべて"}),v.jsx(N,{value:"low",children:"低"}),v.jsx(N,{value:"medium",children:"中"}),v.jsx(N,{value:"high",children:"高"})]})]})]})})}),v.jsx(rt,{children:v.jsxs(Je,{sx:{p:0},children:[v.jsx(at,{component:we,sx:{boxShadow:"none"},children:v.jsxs(lt,{children:[v.jsx(ct,{children:v.jsxs(ut,{children:[v.jsx(ht,{padding:"checkbox",children:v.jsx(dt,{indeterminate:o.length>0&&o.length<r.length,checked:r.length>0&&o.length===r.length,onChange:e=>{if(e.target.checked){const e=r.map(e=>e.id);return void a(e)}a([])}})}),v.jsx(ht,{children:v.jsx(ft,{active:"title"===j,direction:"title"===j?C:"asc",onClick:()=>U("title"),children:"タイトル"})}),v.jsx(ht,{children:v.jsx(ft,{active:"status"===j,direction:"status"===j?C:"asc",onClick:()=>U("status"),children:"ステータス"})}),v.jsx(ht,{children:v.jsx(ft,{active:"priority"===j,direction:"priority"===j?C:"asc",onClick:()=>U("priority"),children:"優先度"})}),v.jsx(ht,{children:v.jsx(ft,{active:"dueDate"===j,direction:"dueDate"===j?C:"asc",onClick:()=>U("dueDate"),children:"期限"})}),v.jsx(ht,{children:v.jsx(ft,{active:"assignee"===j,direction:"assignee"===j?C:"asc",onClick:()=>U("assignee"),children:"担当者"})}),v.jsx(ht,{children:v.jsx(ft,{active:"createdAt"===j,direction:"createdAt"===j?C:"asc",onClick:()=>U("createdAt"),children:"作成日"})}),v.jsx(ht,{align:"right",children:"アクション"})]})}),v.jsx(pt,{children:r.slice(M*O,M*O+O).map(e=>{const t=(r=e.id,-1!==o.indexOf(r));var r;return v.jsxs(ut,{hover:!0,selected:t,onClick:()=>(e=>{const t=o.indexOf(e);let n=[];-1===t?n=n.concat(o,e):0===t?n=n.concat(o.slice(1)):t===o.length-1?n=n.concat(o.slice(0,-1)):t>0&&(n=n.concat(o.slice(0,t),o.slice(t+1))),a(n)})(e.id),sx:{cursor:"pointer"},children:[v.jsx(ht,{padding:"checkbox",children:v.jsx(dt,{checked:t})}),v.jsx(ht,{children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:1},children:[v.jsx(R,{sx:{bgcolor:W(e.status),width:32,height:32},children:B(e.status)}),v.jsxs(E,{children:[v.jsx(T,{variant:"body2",sx:{fontWeight:500},children:e.title}),v.jsx(T,{variant:"caption",color:"text.secondary",children:e.description})]})]})}),v.jsx(ht,{children:v.jsx(De,{label:"todo"===e.status?"未着手":"inProgress"===e.status?"進行中":"完了",size:"small",sx:{backgroundColor:W(e.status),color:"white"}})}),v.jsx(ht,{children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:1},children:[v.jsx(R,{sx:{width:24,height:24,bgcolor:z(e.priority)},children:q(e.priority)}),v.jsx(T,{variant:"body2",children:"high"===e.priority?"高":"medium"===e.priority?"中":"低"})]})}),v.jsx(ht,{children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:.5},children:[v.jsx(Y,{sx:{fontSize:16,color:"text.secondary"}}),v.jsx(T,{variant:"body2",children:Jt(new Date(e.dueDate),"M/d",{locale:Uy})})]})}),v.jsx(ht,{children:e.assignee?v.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:.5},children:[v.jsx(V,{sx:{fontSize:16,color:"text.secondary"}}),v.jsx(T,{variant:"body2",children:e.assignee})]}):v.jsx(T,{variant:"body2",color:"text.secondary",children:"未割り当て"})}),v.jsx(ht,{children:v.jsx(T,{variant:"body2",children:Jt(new Date(e.createdAt),"M/d",{locale:Uy})})}),v.jsx(ht,{align:"right",children:v.jsxs(E,{sx:{display:"flex",gap:1},children:[v.jsx(k,{title:"編集",children:v.jsx(S,{size:"small",onClick:t=>{t.stopPropagation(),f(e),c(!0)},children:v.jsx(st,{})})}),v.jsx(k,{title:"削除",children:v.jsx(S,{size:"small",color:"error",onClick:t=>{t.stopPropagation();const r=n.filter(t=>t.id!==e.id);localStorage.setItem("tasks",JSON.stringify(r)),i(r)},children:v.jsx(X,{})})})]})})]},e.id)})})]})}),v.jsx(mt,{rowsPerPageOptions:[5,10,25],component:"div",count:r.length,rowsPerPage:O,page:M,onPageChange:(e,t)=>A(t),onRowsPerPageChange:e=>{L(parseInt(e.target.value,10)),A(0)},labelRowsPerPage:"行数:",labelDisplayedRows:({from:e,to:t,count:n})=>`${e}-${t} / ${n}`})]})}),v.jsxs(de,{open:l,onClose:()=>c(!1),maxWidth:"sm",fullWidth:!0,children:[v.jsx(Ve,{children:v.jsxs(E,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[v.jsx(T,{variant:"h6",sx:{fontWeight:600},children:(null==d?void 0:d.id)?"タスクを編集":"新しいタスク"}),(null==d?void 0:d.id)&&v.jsx(k,{title:"削除",children:v.jsx(S,{color:"error",onClick:()=>p(e,null,function*(){if(d&&(null==t?void 0:t.id))try{yield Ry(t.id,d.id),c(!1),f(null)}catch(e){console.error("タスクの削除に失敗しました:",e)}}),sx:{color:"error.main"},children:v.jsx(X,{})})})]})}),v.jsx(pe,{children:v.jsxs(E,{sx:{mt:2},children:[v.jsx(Oe,{fullWidth:!0,label:"タイトル",value:(null==d?void 0:d.title)||"",onChange:e=>f(t=>t?h(u({},t),{title:e.target.value}):null),sx:{mb:2}}),v.jsx(Oe,{fullWidth:!0,label:"説明",multiline:!0,rows:3,value:(null==d?void 0:d.description)||"",onChange:e=>f(t=>t?h(u({},t),{description:e.target.value}):null),sx:{mb:2}}),v.jsxs(E,{sx:{display:"flex",gap:2,mb:2},children:[v.jsxs(We,{fullWidth:!0,children:[v.jsx(Be,{children:"ステータス"}),v.jsxs(qe,{value:(null==d?void 0:d.status)||"todo",onChange:e=>f(t=>t?h(u({},t),{status:e.target.value}):null),label:"ステータス",children:[v.jsx(N,{value:"todo",children:"未着手"}),v.jsx(N,{value:"inProgress",children:"進行中"}),v.jsx(N,{value:"done",children:"完了"})]})]}),v.jsxs(We,{fullWidth:!0,children:[v.jsx(Be,{children:"優先度"}),v.jsxs(qe,{value:(null==d?void 0:d.priority)||"medium",onChange:e=>f(t=>t?h(u({},t),{priority:e.target.value}):null),label:"優先度",children:[v.jsx(N,{value:"low",children:"低"}),v.jsx(N,{value:"medium",children:"中"}),v.jsx(N,{value:"high",children:"高"})]})]})]}),v.jsx(Oe,{fullWidth:!0,label:"期限",type:"date",value:(null==d?void 0:d.dueDate)||"",onChange:e=>f(t=>t?h(u({},t),{dueDate:e.target.value}):null),InputLabelProps:{shrink:!0},sx:{mb:2}}),v.jsx(Oe,{fullWidth:!0,label:"担当者",value:(null==d?void 0:d.assignee)||"",onChange:e=>f(t=>t?h(u({},t),{assignee:e.target.value}):null)})]})}),v.jsxs(ke,{children:[v.jsx(Ee,{onClick:()=>c(!1),children:"キャンセル"}),v.jsx(Ee,{variant:"contained",onClick:()=>p(e,null,function*(){if(d&&(null==t?void 0:t.id))try{if(d.id&&d.title)if(d.id.includes("temp")){const e=h(u({},d),{id:Date.now().toString(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()});yield My(t.id,e)}else yield Ay(t.id,d.id,d);c(!1),f(null)}catch(e){console.error("タスクの保存に失敗しました:",e)}}),disabled:!(null==d?void 0:d.title),children:"保存"})]})]})]})})},HC=()=>{const{isDarkMode:e,toggleTheme:t}=Ms(),{user:n}=Ds(),[i,r]=Rt.useState(!1),[s,o]=Rt.useState(!1),[a,l]=Rt.useState({notifications:{email:!0,push:!0,sms:!1,taskReminders:!0,deadlineAlerts:!0,teamUpdates:!0},appearance:{theme:"auto",language:"ja",timezone:"Asia/Tokyo",dateFormat:"YYYY/MM/DD",timeFormat:"24h"},privacy:{profileVisible:!0,showEmail:!1,showPhone:!1,allowAnalytics:!0},data:{autoBackup:!0,backupFrequency:"daily",retentionPeriod:"30days"}}),c=(()=>{const e=JSON.parse(localStorage.getItem("tasks")||"[]"),t=localStorage.getItem("userProfile"),n=localStorage.getItem("userSettings"),i=new Blob([JSON.stringify(e)]).size,r=t?new Blob([t]).size:0,s=n?new Blob([n]).size:0;return{tasks:i,profile:r,settings:s,total:i+r+s}})();return v.jsxs(E,{sx:{p:3,maxWidth:1200,mx:"auto"},children:[v.jsx(T,{variant:"h4",gutterBottom:!0,sx:{fontWeight:700,mb:4},children:"設定"}),v.jsxs(Qe,{container:!0,spacing:3,children:[v.jsx(Qe,{item:!0,xs:12,md:6,children:v.jsxs(we,{sx:{p:3,mb:3},children:[v.jsxs(E,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[v.jsx(T,{variant:"h6",sx:{fontWeight:600},children:"通知設定"}),v.jsx(P,{color:"primary"})]}),v.jsxs(q,{children:[v.jsxs(H,{children:[v.jsx(L,{children:v.jsx(gt,{color:"primary"})}),v.jsx(F,{primary:"メール通知",secondary:"重要な更新をメールで受け取る"}),v.jsx(vt,{children:v.jsx(yt,{checked:a.notifications.email,onChange:e=>l(h(u({},a),{notifications:h(u({},a.notifications),{email:e.target.checked})})),disabled:!i})})]}),v.jsxs(H,{children:[v.jsx(L,{children:v.jsx(Ke,{color:"primary"})}),v.jsx(F,{primary:"プッシュ通知",secondary:"ブラウザでプッシュ通知を受け取る"}),v.jsx(vt,{children:v.jsx(yt,{checked:a.notifications.push,onChange:e=>l(h(u({},a),{notifications:h(u({},a.notifications),{push:e.target.checked})})),disabled:!i})})]}),v.jsxs(H,{children:[v.jsx(L,{children:v.jsx(Ge,{color:"primary"})}),v.jsx(F,{primary:"タスクリマインダー",secondary:"期限が近づいたタスクの通知"}),v.jsx(vt,{children:v.jsx(yt,{checked:a.notifications.taskReminders,onChange:e=>l(h(u({},a),{notifications:h(u({},a.notifications),{taskReminders:e.target.checked})})),disabled:!i})})]}),v.jsxs(H,{children:[v.jsx(L,{children:v.jsx(bt,{color:"primary"})}),v.jsx(F,{primary:"期限アラート",secondary:"期限切れタスクの警告"}),v.jsx(vt,{children:v.jsx(yt,{checked:a.notifications.deadlineAlerts,onChange:e=>l(h(u({},a),{notifications:h(u({},a.notifications),{deadlineAlerts:e.target.checked})})),disabled:!i})})]})]})]})}),v.jsx(Qe,{item:!0,xs:12,md:6,children:v.jsxs(we,{sx:{p:3,mb:3},children:[v.jsxs(E,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[v.jsx(T,{variant:"h6",sx:{fontWeight:600},children:"表示設定"}),v.jsx(xt,{color:"primary"})]}),v.jsxs(q,{children:[v.jsxs(H,{children:[v.jsx(L,{children:v.jsx(xt,{color:"primary"})}),v.jsx(F,{primary:"ダークモード",secondary:"ダークテーマを使用"}),v.jsx(vt,{children:v.jsx(yt,{checked:e,onChange:t})})]}),v.jsxs(H,{children:[v.jsx(L,{children:v.jsx(wt,{color:"primary"})}),v.jsx(F,{primary:"言語",secondary:"日本語"}),v.jsx(vt,{children:v.jsx(De,{label:"日本語",size:"small"})})]}),v.jsxs(H,{children:[v.jsx(L,{children:v.jsx(gt,{color:"primary"})}),v.jsx(F,{primary:"タイムゾーン",secondary:"Asia/Tokyo"}),v.jsx(vt,{children:v.jsx(De,{label:"JST",size:"small"})})]})]})]})}),v.jsx(Qe,{item:!0,xs:12,md:6,children:v.jsxs(we,{sx:{p:3,mb:3},children:[v.jsxs(E,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[v.jsx(T,{variant:"h6",sx:{fontWeight:600},children:"プライバシー設定"}),v.jsx(St,{color:"primary"})]}),v.jsxs(q,{children:[v.jsxs(H,{children:[v.jsx(L,{children:v.jsx(gt,{color:"primary"})}),v.jsx(F,{primary:"プロフィール公開",secondary:"他のユーザーにプロフィールを表示"}),v.jsx(vt,{children:v.jsx(yt,{checked:a.privacy.profileVisible,onChange:e=>l(h(u({},a),{privacy:h(u({},a.privacy),{profileVisible:e.target.checked})})),disabled:!i})})]}),v.jsxs(H,{children:[v.jsx(L,{children:v.jsx(gt,{color:"primary"})}),v.jsx(F,{primary:"メールアドレス表示",secondary:"プロフィールでメールアドレスを表示"}),v.jsx(vt,{children:v.jsx(yt,{checked:a.privacy.showEmail,onChange:e=>l(h(u({},a),{privacy:h(u({},a.privacy),{showEmail:e.target.checked})})),disabled:!i})})]}),v.jsxs(H,{children:[v.jsx(L,{children:v.jsx(gt,{color:"primary"})}),v.jsx(F,{primary:"分析データ送信",secondary:"使用状況の分析データを送信"}),v.jsx(vt,{children:v.jsx(yt,{checked:a.privacy.allowAnalytics,onChange:e=>l(h(u({},a),{privacy:h(u({},a.privacy),{allowAnalytics:e.target.checked})})),disabled:!i})})]})]})]})}),v.jsx(Qe,{item:!0,xs:12,md:6,children:v.jsxs(we,{sx:{p:3,mb:3},children:[v.jsxs(E,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[v.jsx(T,{variant:"h6",sx:{fontWeight:600},children:"データ管理"}),v.jsx(Ct,{color:"primary"})]}),v.jsxs(E,{sx:{mb:3},children:[v.jsx(T,{variant:"subtitle2",sx:{mb:2},children:"ストレージ使用量"}),v.jsxs(E,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[v.jsx(T,{variant:"body2",children:"タスクデータ"}),v.jsxs(T,{variant:"body2",children:[(c.tasks/1024).toFixed(2)," KB"]})]}),v.jsxs(E,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[v.jsx(T,{variant:"body2",children:"プロフィール"}),v.jsxs(T,{variant:"body2",children:[(c.profile/1024).toFixed(2)," KB"]})]}),v.jsxs(E,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[v.jsx(T,{variant:"body2",children:"設定"}),v.jsxs(T,{variant:"body2",children:[(c.settings/1024).toFixed(2)," KB"]})]}),v.jsx(z,{}),v.jsxs(E,{sx:{display:"flex",justifyContent:"space-between",mt:2},children:[v.jsx(T,{variant:"subtitle2",children:"合計"}),v.jsxs(T,{variant:"subtitle2",children:[(c.total/1024).toFixed(2)," KB"]})]})]}),v.jsx(E,{sx:{display:"flex",gap:2},children:v.jsx(Ee,{variant:"outlined",color:"error",startIcon:v.jsx(X,{}),onClick:()=>o(!0),fullWidth:!0,children:"データを削除"})})]})})]}),v.jsx(E,{sx:{display:"flex",justifyContent:"flex-end",mt:3},children:i?v.jsxs(E,{sx:{display:"flex",gap:2},children:[v.jsx(Ee,{variant:"outlined",onClick:()=>{const e=localStorage.getItem("userSettings");e&&l(JSON.parse(e)),r(!1)},startIcon:v.jsx(Tt,{}),children:"キャンセル"}),v.jsx(Ee,{variant:"contained",onClick:()=>{localStorage.setItem("userSettings",JSON.stringify(a)),r(!1),zt.success("設定を保存しました")},startIcon:v.jsx(Et,{}),children:"保存"})]}):v.jsx(Ee,{variant:"contained",onClick:()=>r(!0),startIcon:v.jsx(st,{}),children:"編集"})}),v.jsxs(de,{open:s,onClose:()=>o(!1),maxWidth:"sm",fullWidth:!0,children:[v.jsx(Ve,{children:"データ削除の確認"}),v.jsxs(pe,{children:[v.jsx(ze,{severity:"warning",sx:{mb:2},children:"この操作は元に戻すことができません。すべてのデータが削除されます。"}),v.jsx(T,{variant:"body2",color:"text.secondary",children:"削除されるデータ："}),v.jsxs("ul",{children:[v.jsx("li",{children:"すべてのタスク"}),v.jsx("li",{children:"プロフィール情報"}),v.jsx("li",{children:"設定"}),v.jsx("li",{children:"その他のアプリデータ"})]})]}),v.jsxs(ke,{children:[v.jsx(Ee,{onClick:()=>o(!1),children:"キャンセル"}),v.jsx(Ee,{variant:"contained",color:"error",onClick:()=>{localStorage.clear(),zt.success("すべてのデータを削除しました"),o(!1),window.location.reload()},children:"削除"})]})]})]})};function $C(e){const t=e,{children:n,value:i,index:r}=t,s=d(t,["children","value","index"]);return v.jsx("div",h(u({role:"tabpanel",hidden:i!==r,id:`auth-tabpanel-${r}`,"aria-labelledby":`auth-tab-${r}`},s),{children:i===r&&v.jsx(E,{sx:{p:3},children:n})}))}const XC=()=>{const[t,n]=Rt.useState(0),[i,r]=Rt.useState(!1),[s,o]=Rt.useState(""),a=Nt(),{login:l,register:c}=Ds(),[d,f]=Rt.useState({email:"demo@example.com",password:"password"}),[m,g]=Rt.useState({name:"",email:"",password:"",confirmPassword:""});return v.jsx(kt,{maxWidth:"sm",sx:{mt:4},children:v.jsxs(we,{elevation:3,sx:{borderRadius:2},children:[v.jsx(E,{sx:{borderBottom:1,borderColor:"divider"},children:v.jsxs(Dt,{value:t,onChange:(e,t)=>{n(t),o("")},"aria-label":"認証タブ",children:[v.jsx(It,{label:"ログイン"}),v.jsx(It,{label:"新規登録"})]})}),v.jsxs($C,{value:t,index:0,children:[v.jsx(T,{variant:"h5",component:"h1",gutterBottom:!0,align:"center",children:"ログイン"}),s&&v.jsx(ze,{severity:"error",sx:{mb:2},children:s}),v.jsxs(E,{component:"form",onSubmit:t=>p(e,null,function*(){t.preventDefault(),r(!0),o("");try{yield l(d.email,d.password),zt.success("ログインしました"),a("/")}catch(e){o(e instanceof Error?e.message:"ログインに失敗しました"),zt.error("ログインに失敗しました")}finally{r(!1)}}),sx:{mt:2},children:[v.jsx(Oe,{fullWidth:!0,label:"メールアドレス",type:"email",value:d.email,onChange:e=>f(h(u({},d),{email:e.target.value})),margin:"normal",required:!0,disabled:i}),v.jsx(Oe,{fullWidth:!0,label:"パスワード",type:"password",value:d.password,onChange:e=>f(h(u({},d),{password:e.target.value})),margin:"normal",required:!0,disabled:i}),v.jsx(Ee,{type:"submit",fullWidth:!0,variant:"contained",size:"large",sx:{mt:3,mb:2},disabled:i,children:i?v.jsx(Xe,{size:24}):"ログイン"})]}),v.jsx(E,{sx:{mt:2,textAlign:"center"},children:v.jsx(T,{variant:"body2",color:"text.secondary",children:"デモアカウント: demo@example.com / password"})})]}),v.jsxs($C,{value:t,index:1,children:[v.jsx(T,{variant:"h5",component:"h1",gutterBottom:!0,align:"center",children:"新規登録"}),s&&v.jsx(ze,{severity:"error",sx:{mb:2},children:s}),v.jsxs(E,{component:"form",onSubmit:t=>p(e,null,function*(){if(t.preventDefault(),r(!0),o(""),m.password!==m.confirmPassword)return o("パスワードが一致しません"),void r(!1);try{yield c(m.name,m.email,m.password),zt.success("アカウントを作成しました"),a("/")}catch(e){o(e instanceof Error?e.message:"登録に失敗しました"),zt.error("登録に失敗しました")}finally{r(!1)}}),sx:{mt:2},children:[v.jsx(Oe,{fullWidth:!0,label:"お名前",value:m.name,onChange:e=>g(h(u({},m),{name:e.target.value})),margin:"normal",required:!0,disabled:i}),v.jsx(Oe,{fullWidth:!0,label:"メールアドレス",type:"email",value:m.email,onChange:e=>g(h(u({},m),{email:e.target.value})),margin:"normal",required:!0,disabled:i}),v.jsx(Oe,{fullWidth:!0,label:"パスワード",type:"password",value:m.password,onChange:e=>g(h(u({},m),{password:e.target.value})),margin:"normal",required:!0,disabled:i}),v.jsx(Oe,{fullWidth:!0,label:"パスワード（確認）",type:"password",value:m.confirmPassword,onChange:e=>g(h(u({},m),{confirmPassword:e.target.value})),margin:"normal",required:!0,disabled:i}),v.jsx(Ee,{type:"submit",fullWidth:!0,variant:"contained",size:"large",sx:{mt:3,mb:2},disabled:i,children:i?v.jsx(Xe,{size:24}):"登録"})]})]})]})})},KC=()=>{const{user:e}=Ds(),{isDarkMode:t,toggleTheme:n}=Ms(),[i,r]=Rt.useState(!1),[s,o]=Rt.useState(!1),[a,l]=Rt.useState({name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.email)||"",phone:"",location:"",bio:"",website:"",github:"",linkedin:"",twitter:"",notifications:{email:!0,push:!0,sms:!1},preferences:{language:"ja",timezone:"Asia/Tokyo",dateFormat:"YYYY/MM/DD"}}),[c,d]=Rt.useState({currentPassword:"",newPassword:"",confirmPassword:""});return v.jsxs(E,{sx:{p:3,maxWidth:1200,mx:"auto"},children:[v.jsx(T,{variant:"h4",gutterBottom:!0,sx:{fontWeight:700,mb:4},children:"プロフィール設定"}),v.jsxs(Qe,{container:!0,spacing:3,children:[v.jsxs(Qe,{item:!0,xs:12,md:8,children:[v.jsxs(we,{sx:{p:3,mb:3},children:[v.jsxs(E,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[v.jsx(T,{variant:"h6",sx:{fontWeight:600},children:"基本情報"}),v.jsx(Ee,{variant:i?"outlined":"contained",startIcon:i?v.jsx(Tt,{}):v.jsx(st,{}),onClick:()=>r(!i),children:i?"キャンセル":"編集"})]}),v.jsxs(Qe,{container:!0,spacing:2,children:[v.jsx(Qe,{item:!0,xs:12,sm:6,children:v.jsx(Oe,{fullWidth:!0,label:"名前",value:a.name,onChange:e=>l(h(u({},a),{name:e.target.value})),disabled:!i,sx:{mb:2}})}),v.jsx(Qe,{item:!0,xs:12,sm:6,children:v.jsx(Oe,{fullWidth:!0,label:"メールアドレス",value:a.email,onChange:e=>l(h(u({},a),{email:e.target.value})),disabled:!i,sx:{mb:2}})}),v.jsx(Qe,{item:!0,xs:12,sm:6,children:v.jsx(Oe,{fullWidth:!0,label:"電話番号",value:a.phone,onChange:e=>l(h(u({},a),{phone:e.target.value})),disabled:!i,sx:{mb:2}})}),v.jsx(Qe,{item:!0,xs:12,sm:6,children:v.jsx(Oe,{fullWidth:!0,label:"所在地",value:a.location,onChange:e=>l(h(u({},a),{location:e.target.value})),disabled:!i,sx:{mb:2}})}),v.jsx(Qe,{item:!0,xs:12,children:v.jsx(Oe,{fullWidth:!0,label:"自己紹介",multiline:!0,rows:4,value:a.bio,onChange:e=>l(h(u({},a),{bio:e.target.value})),disabled:!i,sx:{mb:2}})})]}),i&&v.jsxs(E,{sx:{display:"flex",gap:2,mt:2},children:[v.jsx(Ee,{variant:"contained",onClick:()=>{localStorage.setItem("userProfile",JSON.stringify(a)),r(!1),zt.success("プロフィールを更新しました")},startIcon:v.jsx(Et,{}),children:"保存"}),v.jsx(Ee,{variant:"outlined",onClick:()=>{const e=localStorage.getItem("userProfile");e&&l(JSON.parse(e)),r(!1)},children:"キャンセル"})]})]}),v.jsxs(we,{sx:{p:3,mb:3},children:[v.jsx(T,{variant:"h6",sx:{fontWeight:600,mb:3},children:"ソーシャルリンク"}),v.jsxs(Qe,{container:!0,spacing:2,children:[v.jsx(Qe,{item:!0,xs:12,sm:6,children:v.jsx(Oe,{fullWidth:!0,label:"ウェブサイト",value:a.website,onChange:e=>l(h(u({},a),{website:e.target.value})),disabled:!i,sx:{mb:2}})}),v.jsx(Qe,{item:!0,xs:12,sm:6,children:v.jsx(Oe,{fullWidth:!0,label:"GitHub",value:a.github,onChange:e=>l(h(u({},a),{github:e.target.value})),disabled:!i,sx:{mb:2}})}),v.jsx(Qe,{item:!0,xs:12,sm:6,children:v.jsx(Oe,{fullWidth:!0,label:"LinkedIn",value:a.linkedin,onChange:e=>l(h(u({},a),{linkedin:e.target.value})),disabled:!i,sx:{mb:2}})}),v.jsx(Qe,{item:!0,xs:12,sm:6,children:v.jsx(Oe,{fullWidth:!0,label:"Twitter",value:a.twitter,onChange:e=>l(h(u({},a),{twitter:e.target.value})),disabled:!i,sx:{mb:2}})})]})]})]}),v.jsxs(Qe,{item:!0,xs:12,md:4,children:[v.jsxs(we,{sx:{p:3,mb:3,textAlign:"center"},children:[v.jsx(R,{sx:{width:100,height:100,mx:"auto",mb:2,bgcolor:"primary.main",fontSize:"2rem"},children:a.name.charAt(0)}),v.jsx(T,{variant:"h6",sx:{fontWeight:600,mb:1},children:a.name}),v.jsx(T,{variant:"body2",color:"text.secondary",sx:{mb:2},children:a.email}),a.location&&v.jsx(De,{icon:v.jsx(_t,{}),label:a.location,size:"small",sx:{mb:1}})]}),v.jsxs(we,{sx:{p:3,mb:3},children:[v.jsx(T,{variant:"h6",sx:{fontWeight:600,mb:3},children:"設定"}),v.jsxs(E,{sx:{mb:3},children:[v.jsx(T,{variant:"subtitle2",sx:{mb:2},children:"通知設定"}),v.jsx(jt,{control:v.jsx(yt,{checked:a.notifications.email,onChange:e=>l(h(u({},a),{notifications:h(u({},a.notifications),{email:e.target.checked})}))}),label:"メール通知"}),v.jsx(jt,{control:v.jsx(yt,{checked:a.notifications.push,onChange:e=>l(h(u({},a),{notifications:h(u({},a.notifications),{push:e.target.checked})}))}),label:"プッシュ通知"}),v.jsx(jt,{control:v.jsx(yt,{checked:a.notifications.sms,onChange:e=>l(h(u({},a),{notifications:h(u({},a.notifications),{sms:e.target.checked})}))}),label:"SMS通知"})]}),v.jsx(z,{sx:{my:2}}),v.jsxs(E,{sx:{mb:3},children:[v.jsx(T,{variant:"subtitle2",sx:{mb:2},children:"表示設定"}),v.jsx(jt,{control:v.jsx(yt,{checked:t,onChange:n}),label:"ダークモード"})]}),v.jsx(z,{sx:{my:2}}),v.jsx(Ee,{fullWidth:!0,variant:"outlined",startIcon:v.jsx(St,{}),onClick:()=>o(!0),sx:{mb:2},children:"パスワード変更"}),v.jsx(Ee,{fullWidth:!0,variant:"outlined",startIcon:v.jsx(wt,{}),sx:{mb:2},children:"言語設定"})]})]})]}),v.jsxs(de,{open:s,onClose:()=>o(!1),maxWidth:"sm",fullWidth:!0,children:[v.jsx(Ve,{children:"パスワード変更"}),v.jsxs(pe,{children:[v.jsx(Oe,{fullWidth:!0,type:"password",label:"現在のパスワード",value:c.currentPassword,onChange:e=>d(h(u({},c),{currentPassword:e.target.value})),sx:{mb:2,mt:1}}),v.jsx(Oe,{fullWidth:!0,type:"password",label:"新しいパスワード",value:c.newPassword,onChange:e=>d(h(u({},c),{newPassword:e.target.value})),sx:{mb:2}}),v.jsx(Oe,{fullWidth:!0,type:"password",label:"新しいパスワード（確認）",value:c.confirmPassword,onChange:e=>d(h(u({},c),{confirmPassword:e.target.value})),sx:{mb:2}}),c.newPassword!==c.confirmPassword&&c.confirmPassword&&v.jsx(ze,{severity:"error",sx:{mb:2},children:"パスワードが一致しません"})]}),v.jsxs(ke,{children:[v.jsx(Ee,{onClick:()=>o(!1),children:"キャンセル"}),v.jsx(Ee,{variant:"contained",onClick:()=>{c.newPassword===c.confirmPassword?(zt.success("パスワードを変更しました"),o(!1),d({currentPassword:"",newPassword:"",confirmPassword:""})):zt.error("新しいパスワードが一致しません")},disabled:!c.currentPassword||!c.newPassword||c.newPassword!==c.confirmPassword,children:"変更"})]})]})]})},GC=new xs({defaultOptions:{queries:{refetchOnWindowFocus:!1,staleTime:1/0}}});function YC(){const[e,t]=Rt.useState(!0),{isDarkMode:n}=Ms(),{user:i,isLoading:r}=Ds();return console.log("AppContent rendered",{sidebarOpen:e,isDarkMode:n,user:i,isLoading:r}),Rt.useEffect(()=>{Gn.dismiss()},[]),r?v.jsx(E,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:v.jsx(T,{variant:"h6",children:"読み込み中..."})}):i?v.jsxs(v.Fragment,{children:[v.jsx(Vt,{children:v.jsxs(E,{sx:{display:"flex",minHeight:"100vh"},children:[v.jsx(Ny,{open:e,onToggle:()=>t(!e)}),v.jsxs(E,{sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[v.jsx(Oy,{onMenuClick:()=>t(!e)}),v.jsx(E,{component:Yn.main,sx:{flexGrow:1,pt:"80px",backgroundColor:"background.default",transition:"margin-left 0.3s ease-in-out",marginLeft:e?"240px":"64px",minHeight:"calc(100vh - 80px)",overflow:"auto",paddingLeft:"24px",paddingRight:"24px"},children:v.jsx(Qn,{mode:"wait",children:v.jsxs(Ft,{children:[v.jsx(Ut,{path:"/",element:v.jsx(NS,{})}),v.jsx(Ut,{path:"/kanban",element:v.jsx(LS,{})}),v.jsx(Ut,{path:"/calendar",element:v.jsx(WC,{})}),v.jsx(Ut,{path:"/timeline",element:v.jsx(BC,{})}),v.jsx(Ut,{path:"/list",element:v.jsx(qC,{})}),v.jsx(Ut,{path:"/task/new",element:v.jsx(OS,{})}),v.jsx(Ut,{path:"/task/edit/:id",element:v.jsx(OS,{})}),v.jsx(Ut,{path:"/settings",element:v.jsx(HC,{})}),v.jsx(Ut,{path:"/profile",element:v.jsx(KC,{})}),v.jsx(Ut,{path:"/login",element:v.jsx(XC,{})})]})})})]})]})}),v.jsx(Kn,{position:"top-right",toastOptions:{duration:2e3,style:{background:"#363636",color:"#fff",borderRadius:"8px",maxWidth:"400px",zIndex:9999}},containerStyle:{top:20,right:20,zIndex:9999},gutter:8,reverseOrder:!1})]}):v.jsxs(v.Fragment,{children:[v.jsx(Vt,{children:v.jsx(Ft,{children:v.jsx(Ut,{path:"*",element:v.jsx(XC,{})})})}),v.jsx(Kn,{position:"top-right",toastOptions:{duration:2e3,style:{background:"#363636",color:"#fff",borderRadius:"8px",maxWidth:"400px",zIndex:9999}},containerStyle:{top:20,right:20,zIndex:9999},gutter:8,reverseOrder:!1})]})}function QC(){return console.log("App component rendered"),v.jsx(Es,{client:GC,children:v.jsx(As,{children:v.jsx(Is,{children:v.jsx(YC,{})})})})}t.createRoot(document.getElementById("root")).render(v.jsx(At.StrictMode,{children:v.jsx(QC,{})}))}},function(){return Kr||(0,Xr[i(Xr)[0]])((Kr={exports:{}}).exports,Kr),Kr.exports});export default Gr();
