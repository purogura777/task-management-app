var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertyNames,i=Object.getOwnPropertySymbols,s=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,l=Reflect.get,c=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,u=(e,t)=>{for(var n in t||(t={}))o.call(t,n)&&c(e,n,t[n]);if(i)for(var n of i(t))a.call(t,n)&&c(e,n,t[n]);return e},h=(e,r)=>t(e,n(r)),d=(e,t)=>{var n={};for(var r in e)o.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&i)for(var r of i(e))t.indexOf(r)<0&&a.call(e,r)&&(n[r]=e[r]);return n},f=(e,t,n)=>c(e,"symbol"!=typeof t?t+"":t,n),p=(e,t,n)=>l(s(e),n,t),g=(e,t,n)=>new Promise((r,i)=>{var s=e=>{try{a(n.next(e))}catch(t){i(t)}},o=e=>{try{a(n.throw(e))}catch(t){i(t)}},a=e=>e.done?r(e.value):Promise.resolve(e.value).then(s,o);a((n=n.apply(e,t)).next())});import{a as m,b as v,j as y,f as x,T as b,A as w,g as S,I as k,M as C,i as E,B as I,k as D,S as T,F as j,l as _,m as M,N as P,L as A,D as R,n as O,o as N,p as L,q as F,P as V,r as B,s as z,u as W,v as U,W as H,w as $,x as q,y as X,z as K,C as G,E as Y,G as Q,H as J,K as Z,J as ee,O as te,Q as ne,R as re,U as ie,V as se,_ as oe,X as ae,Y as le,Z as ce,$ as ue,a0 as he,a1 as de,a2 as fe,a3 as pe,a4 as ge,a5 as me,a6 as ve,a7 as ye,a8 as xe,a9 as be,aa as we,ab as Se,ac as ke,ad as Ce,ae as Ee,af as Ie,ag as De,ah as Te,ai as je,aj as _e,ak as Me,al as Pe,am as Ae,an as Re,ao as Oe,ap as Ne,aq as Le,ar as Fe,as as Ve,at as Be,au as ze,av as We,aw as Ue,ax as He,ay as $e,az as qe,aA as Xe,aB as Ke,aC as Ge,aD as Ye,aE as Qe,aF as Je,aG as Ze,aH as et,aI as tt,aJ as nt,aK as rt,aL as it,aM as st,aN as ot,aO as at,aP as lt,aQ as ct,aR as ut,aS as ht,aT as dt,aU as ft,aV as pt,aW as gt,aX as mt,aY as vt,aZ as yt,a_ as xt,a$ as bt,b0 as wt,b1 as St,b2 as kt,b3 as Ct,b4 as Et,b5 as It,b6 as Dt,b7 as Tt,b8 as jt,b9 as _t,ba as Mt,bb as Pt,bc as At,bd as Rt,be as Ot,bf as Nt,bg as Lt,bh as Ft,bi as Vt,bj as Bt,bk as zt,bl as Wt,bm as Ut,bn as Ht,bo as $t,bp as qt,bq as Xt,br as Kt,bs as Gt,bt as Yt,bu as Qt,bv as Jt,bw as Zt,bx as en,by as tn}from"./mui-h1qZviK7.js";import{d as nn,c as rn,b as sn,r as on,a as an,e as ln,g as cn}from"./vendor-BP-GjyB3.js";import{u as un,a as hn,b as dn,B as fn,R as pn,c as gn}from"./router-BcQYtO1S.js";import{V as mn,b as vn,a as yn,c as xn,d as bn,e as wn,l as Sn,p as kn,f as Cn,g as En,i as In,h as Dn,j as Tn,k as jn,m as _n,n as Mn,o as Pn,q as An,r as Rn,s as On,t as Nn,u as Ln,v as Fn,w as Vn,x as Bn,y as zn,z as Wn,A as Un,B as Hn,C as $n,D as qn,E as Xn,F as Kn,G as Gn,H as Yn,I as Qn,J as Jn,K as Zn,L as er,M as tr,N as nr,O as rr,P as ir,Q as sr,R as or,S as ar,T as lr,U as cr,W as ur,X as hr,Y as dr,Z as fr,_ as pr,$ as gr,a0 as mr,a1 as vr,a2 as yr,a3 as xr,a4 as br,a5 as wr,a6 as Sr,a7 as kr}from"./utils-DVWeznNS.js";import{m as Cr,A as Er,D as Ir,C as Dr,P as Tr}from"./animation-Vh6rqd68.js";import{m as jr,y as _r,D as Mr,a as Pr,b as Ar,d as Rr,c as Or,e as Nr,f as Lr,W as Fr,C as Vr,g as Br,S as zr,V as Wr,h as Ur,N as Hr,i as $r,r as qr,j as Xr,k as Kr,B as Gr,l as Yr,n as Qr,o as Jr,p as Zr,w as ei,q as ti,s as ni,t as ri,u as ii,v as si,x as oi,R as ai,P as li,z as ci,A as ui,E as hi,F as di,_ as fi,G as pi,H as gi,I as mi,J as vi,K as yi,L as xi,M as bi,O as wi,Q as Si,T as ki,U as Ci,X as Ei,Y as Ii,Z as Di,$ as Ti,a0 as ji,a1 as _i,a2 as Mi,a3 as Pi,a4 as Ai,a5 as Ri,a6 as Oi,a7 as Ni,a8 as Li,a9 as Fi,aa as Vi,ab as Bi,ac as zi,ad as Wi,ae as Ui,af as Hi,ag as $i,ah as qi,ai as Xi,aj as Ki,ak as Gi,al as Yi,am as Qi,an as Ji,ao as Zi,ap as es,aq as ts,ar as ns,as as rs,at as is,au as ss,av as os,aw as as,ax as ls,ay as cs,az as us,aA as hs,aB as ds,aC as fs,aD as ps,aE as gs,aF as ms,aG as vs,aH as ys,aI as xs,aJ as bs}from"./calendar-2XhzSSxM.js";var ws,Ss,ks=(ws={"assets/main-BmYQ-c40.js"(e){!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var t={},n=nn;t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot;var r=function(){function e(){this.listeners=[]}var t=e.prototype;return t.subscribe=function(e){var t=this,n=e||function(){};return this.listeners.push(n),this.onSubscribe(),function(){t.listeners=t.listeners.filter(function(e){return e!==n}),t.onUnsubscribe()}},t.hasListeners=function(){return this.listeners.length>0},t.onSubscribe=function(){},t.onUnsubscribe=function(){},e}(),i="undefined"==typeof window;function s(){}function o(e){return Array.isArray(e)?e:[e]}function a(e,t,n){return js(e)?"function"==typeof t?m({},n,{queryKey:e,queryFn:t}):m({},t,{queryKey:e}):e}function l(e,t,n){return js(e)?[m({},t,{queryKey:e}),n]:[e||{},t]}function c(e,t){var n=e.active,r=e.exact,i=e.fetching,s=e.inactive,o=e.predicate,a=e.queryKey,l=e.stale;if(js(a))if(r){if(t.queryHash!==Ss(a,t.options))return!1}else if(!Cs(t.queryKey,a))return!1;var c=function(e,t){return!0===e&&!0===t||null==e&&null==t?"all":!1===e&&!1===t?"none":(null!=e?e:!t)?"active":"inactive"}(n,s);if("none"===c)return!1;if("all"!==c){var u=t.isActive();if("active"===c&&!u)return!1;if("inactive"===c&&u)return!1}return!("boolean"==typeof l&&t.isStale()!==l||"boolean"==typeof i&&t.isFetching()!==i||o&&!o(t))}function ws(e,t){var n=e.exact,r=e.fetching,i=e.predicate,s=e.mutationKey;if(js(s)){if(!t.options.mutationKey)return!1;if(n){if(ks(t.options.mutationKey)!==ks(s))return!1}else if(!Cs(t.options.mutationKey,s))return!1}return!("boolean"==typeof r&&"loading"===t.state.status!==r||i&&!i(t))}function Ss(e,t){return((null==t?void 0:t.queryKeyHashFn)||ks)(e)}function ks(e){var t,n=o(e);return t=n,JSON.stringify(t,function(e,t){return Ds(t)?Object.keys(t).sort().reduce(function(e,n){return e[n]=t[n],e},{}):t})}function Cs(e,t){return Es(o(e),o(t))}function Es(e,t){return e===t||typeof e==typeof t&&!(!e||!t||"object"!=typeof e||"object"!=typeof t)&&!Object.keys(t).some(function(n){return!Es(e[n],t[n])})}function Is(e,t){if(e===t)return e;var n=Array.isArray(e)&&Array.isArray(t);if(n||Ds(e)&&Ds(t)){for(var r=n?e.length:Object.keys(e).length,i=n?t:Object.keys(t),s=i.length,o=n?[]:{},a=0,l=0;l<s;l++){var c=n?l:i[l];o[c]=Is(e[c],t[c]),o[c]===e[c]&&a++}return r===s&&a===r?e:o}return t}function Ds(e){if(!Ts(e))return!1;var t=e.constructor;if(void 0===t)return!0;var n=t.prototype;return!!Ts(n)&&!!n.hasOwnProperty("isPrototypeOf")}function Ts(e){return"[object Object]"===Object.prototype.toString.call(e)}function js(e){return"string"==typeof e||Array.isArray(e)}function _s(e){Promise.resolve().then(e).catch(function(e){return setTimeout(function(){throw e})})}function Ms(){if("function"==typeof AbortController)return new AbortController}var Ps=new(function(e){function t(){var t;return(t=e.call(this)||this).setup=function(e){var t;if(!i&&(null==(t=window)?void 0:t.addEventListener)){var n=function(){return e()};return window.addEventListener("visibilitychange",n,!1),window.addEventListener("focus",n,!1),function(){window.removeEventListener("visibilitychange",n),window.removeEventListener("focus",n)}}},t}v(t,e);var n=t.prototype;return n.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},n.onUnsubscribe=function(){var e;this.hasListeners()||(null==(e=this.cleanup)||e.call(this),this.cleanup=void 0)},n.setEventListener=function(e){var t,n=this;this.setup=e,null==(t=this.cleanup)||t.call(this),this.cleanup=e(function(e){"boolean"==typeof e?n.setFocused(e):n.onFocus()})},n.setFocused=function(e){this.focused=e,e&&this.onFocus()},n.onFocus=function(){this.listeners.forEach(function(e){e()})},n.isFocused=function(){return"boolean"==typeof this.focused?this.focused:"undefined"==typeof document||[void 0,"visible","prerender"].includes(document.visibilityState)},t}(r)),As=new(function(e){function t(){var t;return(t=e.call(this)||this).setup=function(e){var t;if(!i&&(null==(t=window)?void 0:t.addEventListener)){var n=function(){return e()};return window.addEventListener("online",n,!1),window.addEventListener("offline",n,!1),function(){window.removeEventListener("online",n),window.removeEventListener("offline",n)}}},t}v(t,e);var n=t.prototype;return n.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},n.onUnsubscribe=function(){var e;this.hasListeners()||(null==(e=this.cleanup)||e.call(this),this.cleanup=void 0)},n.setEventListener=function(e){var t,n=this;this.setup=e,null==(t=this.cleanup)||t.call(this),this.cleanup=e(function(e){"boolean"==typeof e?n.setOnline(e):n.onOnline()})},n.setOnline=function(e){this.online=e,e&&this.onOnline()},n.onOnline=function(){this.listeners.forEach(function(e){e()})},n.isOnline=function(){return"boolean"==typeof this.online?this.online:"undefined"==typeof navigator||void 0===navigator.onLine||navigator.onLine},t}(r));function Rs(e){return Math.min(1e3*Math.pow(2,e),3e4)}function Os(e){return"function"==typeof(null==e?void 0:e.cancel)}var Ns=function(e){this.revert=null==e?void 0:e.revert,this.silent=null==e?void 0:e.silent};function Ls(e){return e instanceof Ns}var Fs=function(e){var t,n,r,i,s=this,o=!1;this.abort=e.abort,this.cancel=function(e){return null==t?void 0:t(e)},this.cancelRetry=function(){o=!0},this.continueRetry=function(){o=!1},this.continue=function(){return null==n?void 0:n()},this.failureCount=0,this.isPaused=!1,this.isResolved=!1,this.isTransportCancelable=!1,this.promise=new Promise(function(e,t){r=e,i=t});var a=function(t){s.isResolved||(s.isResolved=!0,null==e.onSuccess||e.onSuccess(t),null==n||n(),r(t))},l=function(t){s.isResolved||(s.isResolved=!0,null==e.onError||e.onError(t),null==n||n(),i(t))};!function r(){if(!s.isResolved){var i;try{i=e.fn()}catch(c){i=Promise.reject(c)}t=function(e){if(!s.isResolved&&(l(new Ns(e)),null==s.abort||s.abort(),Os(i)))try{i.cancel()}catch(t){}},s.isTransportCancelable=Os(i),Promise.resolve(i).then(a).catch(function(t){var i,a;if(!s.isResolved){var c,u=null!=(i=e.retry)?i:3,h=null!=(a=e.retryDelay)?a:Rs,d="function"==typeof h?h(s.failureCount,t):h,f=!0===u||"number"==typeof u&&s.failureCount<u||"function"==typeof u&&u(s.failureCount,t);!o&&f?(s.failureCount++,null==e.onFail||e.onFail(s.failureCount,t),(c=d,new Promise(function(e){setTimeout(e,c)})).then(function(){if(!Ps.isFocused()||!As.isOnline())return new Promise(function(t){n=t,s.isPaused=!0,null==e.onPause||e.onPause()}).then(function(){n=void 0,s.isPaused=!1,null==e.onContinue||e.onContinue()})}).then(function(){o?l(t):r()})):l(t)}})}}()},Vs=function(){function e(){this.queue=[],this.transactions=0,this.notifyFn=function(e){e()},this.batchNotifyFn=function(e){e()}}var t=e.prototype;return t.batch=function(e){var t;this.transactions++;try{t=e()}finally{this.transactions--,this.transactions||this.flush()}return t},t.schedule=function(e){var t=this;this.transactions?this.queue.push(e):_s(function(){t.notifyFn(e)})},t.batchCalls=function(e){var t=this;return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t.schedule(function(){e.apply(void 0,r)})}},t.flush=function(){var e=this,t=this.queue;this.queue=[],t.length&&_s(function(){e.batchNotifyFn(function(){t.forEach(function(t){e.notifyFn(t)})})})},t.setNotifyFunction=function(e){this.notifyFn=e},t.setBatchNotifyFunction=function(e){this.batchNotifyFn=e},e}(),Bs=new Vs,zs=console;function Ws(){return zs}var Us=function(){function e(e){this.abortSignalConsumed=!1,this.hadObservers=!1,this.defaultOptions=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.cache=e.cache,this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.initialState=e.state||this.getDefaultState(this.options),this.state=this.initialState,this.meta=e.meta,this.scheduleGc()}var t=e.prototype;return t.setOptions=function(e){var t;this.options=m({},this.defaultOptions,e),this.meta=null==e?void 0:e.meta,this.cacheTime=Math.max(this.cacheTime||0,null!=(t=this.options.cacheTime)?t:3e5)},t.setDefaultOptions=function(e){this.defaultOptions=e},t.scheduleGc=function(){var e,t=this;this.clearGcTimeout(),"number"==typeof(e=this.cacheTime)&&e>=0&&e!==1/0&&(this.gcTimeout=setTimeout(function(){t.optionalRemove()},this.cacheTime))},t.clearGcTimeout=function(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)},t.optionalRemove=function(){this.observers.length||(this.state.isFetching?this.hadObservers&&this.scheduleGc():this.cache.remove(this))},t.setData=function(e,t){var n,r,i=this.state.data,s=function(e,t){return"function"==typeof e?e(t):e}(e,i);return(null==(n=(r=this.options).isDataEqual)?void 0:n.call(r,i,s))?s=i:!1!==this.options.structuralSharing&&(s=Is(i,s)),this.dispatch({data:s,type:"success",dataUpdatedAt:null==t?void 0:t.updatedAt}),s},t.setState=function(e,t){this.dispatch({type:"setState",state:e,setStateOptions:t})},t.cancel=function(e){var t,n=this.promise;return null==(t=this.retryer)||t.cancel(e),n?n.then(s).catch(s):Promise.resolve()},t.destroy=function(){this.clearGcTimeout(),this.cancel({silent:!0})},t.reset=function(){this.destroy(),this.setState(this.initialState)},t.isActive=function(){return this.observers.some(function(e){return!1!==e.options.enabled})},t.isFetching=function(){return this.state.isFetching},t.isStale=function(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(function(e){return e.getCurrentResult().isStale})},t.isStaleByTime=function(e){return void 0===e&&(e=0),this.state.isInvalidated||!this.state.dataUpdatedAt||!function(e,t){return Math.max(e+(t||0)-Date.now(),0)}(this.state.dataUpdatedAt,e)},t.onFocus=function(){var e,t=this.observers.find(function(e){return e.shouldFetchOnWindowFocus()});t&&t.refetch(),null==(e=this.retryer)||e.continue()},t.onOnline=function(){var e,t=this.observers.find(function(e){return e.shouldFetchOnReconnect()});t&&t.refetch(),null==(e=this.retryer)||e.continue()},t.addObserver=function(e){-1===this.observers.indexOf(e)&&(this.observers.push(e),this.hadObservers=!0,this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:e}))},t.removeObserver=function(e){-1!==this.observers.indexOf(e)&&(this.observers=this.observers.filter(function(t){return t!==e}),this.observers.length||(this.retryer&&(this.retryer.isTransportCancelable||this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.cacheTime?this.scheduleGc():this.cache.remove(this)),this.cache.notify({type:"observerRemoved",query:this,observer:e}))},t.getObserversCount=function(){return this.observers.length},t.invalidate=function(){this.state.isInvalidated||this.dispatch({type:"invalidate"})},t.fetch=function(e,t){var n,r,i,s=this;if(this.state.isFetching)if(this.state.dataUpdatedAt&&(null==t?void 0:t.cancelRefetch))this.cancel({silent:!0});else if(this.promise){var a;return null==(a=this.retryer)||a.continueRetry(),this.promise}if(e&&this.setOptions(e),!this.options.queryFn){var l=this.observers.find(function(e){return e.options.queryFn});l&&this.setOptions(l.options)}var c=o(this.queryKey),u=Ms(),h={queryKey:c,pageParam:void 0,meta:this.meta};Object.defineProperty(h,"signal",{enumerable:!0,get:function(){if(u)return s.abortSignalConsumed=!0,u.signal}});var d,f,p={fetchOptions:t,options:this.options,queryKey:c,state:this.state,fetchFn:function(){return s.options.queryFn?(s.abortSignalConsumed=!1,s.options.queryFn(h)):Promise.reject("Missing queryFn")},meta:this.meta};return(null==(n=this.options.behavior)?void 0:n.onFetch)&&(null==(d=this.options.behavior)||d.onFetch(p)),this.revertState=this.state,this.state.isFetching&&this.state.fetchMeta===(null==(r=p.fetchOptions)?void 0:r.meta)||this.dispatch({type:"fetch",meta:null==(f=p.fetchOptions)?void 0:f.meta}),this.retryer=new Fs({fn:p.fetchFn,abort:null==u||null==(i=u.abort)?void 0:i.bind(u),onSuccess:function(e){s.setData(e),null==s.cache.config.onSuccess||s.cache.config.onSuccess(e,s),0===s.cacheTime&&s.optionalRemove()},onError:function(e){Ls(e)&&e.silent||s.dispatch({type:"error",error:e}),Ls(e)||(null==s.cache.config.onError||s.cache.config.onError(e,s),Ws().error(e)),0===s.cacheTime&&s.optionalRemove()},onFail:function(){s.dispatch({type:"failed"})},onPause:function(){s.dispatch({type:"pause"})},onContinue:function(){s.dispatch({type:"continue"})},retry:p.options.retry,retryDelay:p.options.retryDelay}),this.promise=this.retryer.promise,this.promise},t.dispatch=function(e){var t=this;this.state=this.reducer(this.state,e),Bs.batch(function(){t.observers.forEach(function(t){t.onQueryUpdate(e)}),t.cache.notify({query:t,type:"queryUpdated",action:e})})},t.getDefaultState=function(e){var t="function"==typeof e.initialData?e.initialData():e.initialData,n=void 0!==e.initialData?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0,r=void 0!==t;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?null!=n?n:Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchMeta:null,isFetching:!1,isInvalidated:!1,isPaused:!1,status:r?"success":"idle"}},t.reducer=function(e,t){var n,r;switch(t.type){case"failed":return m({},e,{fetchFailureCount:e.fetchFailureCount+1});case"pause":return m({},e,{isPaused:!0});case"continue":return m({},e,{isPaused:!1});case"fetch":return m({},e,{fetchFailureCount:0,fetchMeta:null!=(n=t.meta)?n:null,isFetching:!0,isPaused:!1},!e.dataUpdatedAt&&{error:null,status:"loading"});case"success":return m({},e,{data:t.data,dataUpdateCount:e.dataUpdateCount+1,dataUpdatedAt:null!=(r=t.dataUpdatedAt)?r:Date.now(),error:null,fetchFailureCount:0,isFetching:!1,isInvalidated:!1,isPaused:!1,status:"success"});case"error":var i=t.error;return Ls(i)&&i.revert&&this.revertState?m({},this.revertState):m({},e,{error:i,errorUpdateCount:e.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:e.fetchFailureCount+1,isFetching:!1,isPaused:!1,status:"error"});case"invalidate":return m({},e,{isInvalidated:!0});case"setState":return m({},e,t.state);default:return e}},e}(),Hs=function(e){function t(t){var n;return(n=e.call(this)||this).config=t||{},n.queries=[],n.queriesMap={},n}v(t,e);var n=t.prototype;return n.build=function(e,t,n){var r,i=t.queryKey,s=null!=(r=t.queryHash)?r:Ss(i,t),o=this.get(s);return o||(o=new Us({cache:this,queryKey:i,queryHash:s,options:e.defaultQueryOptions(t),state:n,defaultOptions:e.getQueryDefaults(i),meta:t.meta}),this.add(o)),o},n.add=function(e){this.queriesMap[e.queryHash]||(this.queriesMap[e.queryHash]=e,this.queries.push(e),this.notify({type:"queryAdded",query:e}))},n.remove=function(e){var t=this.queriesMap[e.queryHash];t&&(e.destroy(),this.queries=this.queries.filter(function(t){return t!==e}),t===e&&delete this.queriesMap[e.queryHash],this.notify({type:"queryRemoved",query:e}))},n.clear=function(){var e=this;Bs.batch(function(){e.queries.forEach(function(t){e.remove(t)})})},n.get=function(e){return this.queriesMap[e]},n.getAll=function(){return this.queries},n.find=function(e,t){var n=l(e,t)[0];return void 0===n.exact&&(n.exact=!0),this.queries.find(function(e){return c(n,e)})},n.findAll=function(e,t){var n=l(e,t)[0];return Object.keys(n).length>0?this.queries.filter(function(e){return c(n,e)}):this.queries},n.notify=function(e){var t=this;Bs.batch(function(){t.listeners.forEach(function(t){t(e)})})},n.onFocus=function(){var e=this;Bs.batch(function(){e.queries.forEach(function(e){e.onFocus()})})},n.onOnline=function(){var e=this;Bs.batch(function(){e.queries.forEach(function(e){e.onOnline()})})},t}(r),$s=function(){function e(e){this.options=m({},e.defaultOptions,e.options),this.mutationId=e.mutationId,this.mutationCache=e.mutationCache,this.observers=[],this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,isPaused:!1,status:"idle",variables:void 0},this.meta=e.meta}var t=e.prototype;return t.setState=function(e){this.dispatch({type:"setState",state:e})},t.addObserver=function(e){-1===this.observers.indexOf(e)&&this.observers.push(e)},t.removeObserver=function(e){this.observers=this.observers.filter(function(t){return t!==e})},t.cancel=function(){return this.retryer?(this.retryer.cancel(),this.retryer.promise.then(s).catch(s)):Promise.resolve()},t.continue=function(){return this.retryer?(this.retryer.continue(),this.retryer.promise):this.execute()},t.execute=function(){var e,t=this,n="loading"===this.state.status,r=Promise.resolve();return n||(this.dispatch({type:"loading",variables:this.options.variables}),r=r.then(function(){null==t.mutationCache.config.onMutate||t.mutationCache.config.onMutate(t.state.variables,t)}).then(function(){return null==t.options.onMutate?void 0:t.options.onMutate(t.state.variables)}).then(function(e){e!==t.state.context&&t.dispatch({type:"loading",context:e,variables:t.state.variables})})),r.then(function(){return t.executeMutation()}).then(function(n){e=n,null==t.mutationCache.config.onSuccess||t.mutationCache.config.onSuccess(e,t.state.variables,t.state.context,t)}).then(function(){return null==t.options.onSuccess?void 0:t.options.onSuccess(e,t.state.variables,t.state.context)}).then(function(){return null==t.options.onSettled?void 0:t.options.onSettled(e,null,t.state.variables,t.state.context)}).then(function(){return t.dispatch({type:"success",data:e}),e}).catch(function(e){return null==t.mutationCache.config.onError||t.mutationCache.config.onError(e,t.state.variables,t.state.context,t),Ws().error(e),Promise.resolve().then(function(){return null==t.options.onError?void 0:t.options.onError(e,t.state.variables,t.state.context)}).then(function(){return null==t.options.onSettled?void 0:t.options.onSettled(void 0,e,t.state.variables,t.state.context)}).then(function(){throw t.dispatch({type:"error",error:e}),e})})},t.executeMutation=function(){var e,t=this;return this.retryer=new Fs({fn:function(){return t.options.mutationFn?t.options.mutationFn(t.state.variables):Promise.reject("No mutationFn found")},onFail:function(){t.dispatch({type:"failed"})},onPause:function(){t.dispatch({type:"pause"})},onContinue:function(){t.dispatch({type:"continue"})},retry:null!=(e=this.options.retry)?e:0,retryDelay:this.options.retryDelay}),this.retryer.promise},t.dispatch=function(e){var t=this;this.state=function(e,t){switch(t.type){case"failed":return m({},e,{failureCount:e.failureCount+1});case"pause":return m({},e,{isPaused:!0});case"continue":return m({},e,{isPaused:!1});case"loading":return m({},e,{context:t.context,data:void 0,error:null,isPaused:!1,status:"loading",variables:t.variables});case"success":return m({},e,{data:t.data,error:null,status:"success",isPaused:!1});case"error":return m({},e,{data:void 0,error:t.error,failureCount:e.failureCount+1,isPaused:!1,status:"error"});case"setState":return m({},e,t.state);default:return e}}(this.state,e),Bs.batch(function(){t.observers.forEach(function(t){t.onMutationUpdate(e)}),t.mutationCache.notify(t)})},e}(),qs=function(e){function t(t){var n;return(n=e.call(this)||this).config=t||{},n.mutations=[],n.mutationId=0,n}v(t,e);var n=t.prototype;return n.build=function(e,t,n){var r=new $s({mutationCache:this,mutationId:++this.mutationId,options:e.defaultMutationOptions(t),state:n,defaultOptions:t.mutationKey?e.getMutationDefaults(t.mutationKey):void 0,meta:t.meta});return this.add(r),r},n.add=function(e){this.mutations.push(e),this.notify(e)},n.remove=function(e){this.mutations=this.mutations.filter(function(t){return t!==e}),e.cancel(),this.notify(e)},n.clear=function(){var e=this;Bs.batch(function(){e.mutations.forEach(function(t){e.remove(t)})})},n.getAll=function(){return this.mutations},n.find=function(e){return void 0===e.exact&&(e.exact=!0),this.mutations.find(function(t){return ws(e,t)})},n.findAll=function(e){return this.mutations.filter(function(t){return ws(e,t)})},n.notify=function(e){var t=this;Bs.batch(function(){t.listeners.forEach(function(t){t(e)})})},n.onFocus=function(){this.resumePausedMutations()},n.onOnline=function(){this.resumePausedMutations()},n.resumePausedMutations=function(){var e=this.mutations.filter(function(e){return e.state.isPaused});return Bs.batch(function(){return e.reduce(function(e,t){return e.then(function(){return t.continue().catch(s)})},Promise.resolve())})},t}(r);function Xs(e,t){return null==e.getNextPageParam?void 0:e.getNextPageParam(t[t.length-1],t)}var Ks=function(){function e(e){void 0===e&&(e={}),this.queryCache=e.queryCache||new Hs,this.mutationCache=e.mutationCache||new qs,this.defaultOptions=e.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[]}var t=e.prototype;return t.mount=function(){var e=this;this.unsubscribeFocus=Ps.subscribe(function(){Ps.isFocused()&&As.isOnline()&&(e.mutationCache.onFocus(),e.queryCache.onFocus())}),this.unsubscribeOnline=As.subscribe(function(){Ps.isFocused()&&As.isOnline()&&(e.mutationCache.onOnline(),e.queryCache.onOnline())})},t.unmount=function(){var e,t;null==(e=this.unsubscribeFocus)||e.call(this),null==(t=this.unsubscribeOnline)||t.call(this)},t.isFetching=function(e,t){var n=l(e,t)[0];return n.fetching=!0,this.queryCache.findAll(n).length},t.isMutating=function(e){return this.mutationCache.findAll(m({},e,{fetching:!0})).length},t.getQueryData=function(e,t){var n;return null==(n=this.queryCache.find(e,t))?void 0:n.state.data},t.getQueriesData=function(e){return this.getQueryCache().findAll(e).map(function(e){return[e.queryKey,e.state.data]})},t.setQueryData=function(e,t,n){var r=a(e),i=this.defaultQueryOptions(r);return this.queryCache.build(this,i).setData(t,n)},t.setQueriesData=function(e,t,n){var r=this;return Bs.batch(function(){return r.getQueryCache().findAll(e).map(function(e){var i=e.queryKey;return[i,r.setQueryData(i,t,n)]})})},t.getQueryState=function(e,t){var n;return null==(n=this.queryCache.find(e,t))?void 0:n.state},t.removeQueries=function(e,t){var n=l(e,t)[0],r=this.queryCache;Bs.batch(function(){r.findAll(n).forEach(function(e){r.remove(e)})})},t.resetQueries=function(e,t,n){var r=this,i=l(e,t,n),s=i[0],o=i[1],a=this.queryCache,c=m({},s,{active:!0});return Bs.batch(function(){return a.findAll(s).forEach(function(e){e.reset()}),r.refetchQueries(c,o)})},t.cancelQueries=function(e,t,n){var r=this,i=l(e,t,n),o=i[0],a=i[1],c=void 0===a?{}:a;void 0===c.revert&&(c.revert=!0);var u=Bs.batch(function(){return r.queryCache.findAll(o).map(function(e){return e.cancel(c)})});return Promise.all(u).then(s).catch(s)},t.invalidateQueries=function(e,t,n){var r,i,s,o=this,a=l(e,t,n),c=a[0],u=a[1],h=m({},c,{active:null==(r=null!=(i=c.refetchActive)?i:c.active)||r,inactive:null!=(s=c.refetchInactive)&&s});return Bs.batch(function(){return o.queryCache.findAll(c).forEach(function(e){e.invalidate()}),o.refetchQueries(h,u)})},t.refetchQueries=function(e,t,n){var r=this,i=l(e,t,n),o=i[0],a=i[1],c=Bs.batch(function(){return r.queryCache.findAll(o).map(function(e){return e.fetch(void 0,m({},a,{meta:{refetchPage:null==o?void 0:o.refetchPage}}))})}),u=Promise.all(c).then(s);return(null==a?void 0:a.throwOnError)||(u=u.catch(s)),u},t.fetchQuery=function(e,t,n){var r=a(e,t,n),i=this.defaultQueryOptions(r);void 0===i.retry&&(i.retry=!1);var s=this.queryCache.build(this,i);return s.isStaleByTime(i.staleTime)?s.fetch(i):Promise.resolve(s.state.data)},t.prefetchQuery=function(e,t,n){return this.fetchQuery(e,t,n).then(s).catch(s)},t.fetchInfiniteQuery=function(e,t,n){var r=a(e,t,n);return r.behavior={onFetch:function(e){e.fetchFn=function(){var t,n,r,i,s,o,a,l,c,u=null==(t=e.fetchOptions)||null==(n=t.meta)?void 0:n.refetchPage,h=null==(r=e.fetchOptions)||null==(i=r.meta)?void 0:i.fetchMore,d=null==h?void 0:h.pageParam,f="forward"===(null==h?void 0:h.direction),p="backward"===(null==h?void 0:h.direction),g=(null==(s=e.state.data)?void 0:s.pages)||[],m=(null==(o=e.state.data)?void 0:o.pageParams)||[],v=Ms(),y=null==v?void 0:v.signal,x=m,b=!1,w=e.options.queryFn||function(){return Promise.reject("Missing queryFn")},S=function(e,t,n,r){return x=r?[t].concat(x):[].concat(x,[t]),r?[n].concat(e):[].concat(e,[n])},k=function(t,n,r,i){if(b)return Promise.reject("Cancelled");if(void 0===r&&!n&&t.length)return Promise.resolve(t);var s={queryKey:e.queryKey,signal:y,pageParam:r,meta:e.meta},o=w(s),a=Promise.resolve(o).then(function(e){return S(t,r,e,i)});return Os(o)&&(a.cancel=o.cancel),a};if(g.length)if(f){var C=void 0!==d,E=C?d:Xs(e.options,g);a=k(g,C,E)}else if(p){var I=void 0!==d,D=I?d:(l=e.options,c=g,null==l.getPreviousPageParam?void 0:l.getPreviousPageParam(c[0],c));a=k(g,I,D,!0)}else!function(){x=[];var t=void 0===e.options.getNextPageParam,n=!u||!g[0]||u(g[0],0,g);a=n?k([],t,m[0]):Promise.resolve(S([],m[0],g[0]));for(var r=function(n){a=a.then(function(r){if(!u||!g[n]||u(g[n],n,g)){var i=t?m[n]:Xs(e.options,r);return k(r,t,i)}return Promise.resolve(S(r,m[n],g[n]))})},i=1;i<g.length;i++)r(i)}();else a=k([]);var T=a.then(function(e){return{pages:e,pageParams:x}});return T.cancel=function(){b=!0,null==v||v.abort(),Os(a)&&a.cancel()},T}}},this.fetchQuery(r)},t.prefetchInfiniteQuery=function(e,t,n){return this.fetchInfiniteQuery(e,t,n).then(s).catch(s)},t.cancelMutations=function(){var e=this,t=Bs.batch(function(){return e.mutationCache.getAll().map(function(e){return e.cancel()})});return Promise.all(t).then(s).catch(s)},t.resumePausedMutations=function(){return this.getMutationCache().resumePausedMutations()},t.executeMutation=function(e){return this.mutationCache.build(this,e).execute()},t.getQueryCache=function(){return this.queryCache},t.getMutationCache=function(){return this.mutationCache},t.getDefaultOptions=function(){return this.defaultOptions},t.setDefaultOptions=function(e){this.defaultOptions=e},t.setQueryDefaults=function(e,t){var n=this.queryDefaults.find(function(t){return ks(e)===ks(t.queryKey)});n?n.defaultOptions=t:this.queryDefaults.push({queryKey:e,defaultOptions:t})},t.getQueryDefaults=function(e){var t;return e?null==(t=this.queryDefaults.find(function(t){return Cs(e,t.queryKey)}))?void 0:t.defaultOptions:void 0},t.setMutationDefaults=function(e,t){var n=this.mutationDefaults.find(function(t){return ks(e)===ks(t.mutationKey)});n?n.defaultOptions=t:this.mutationDefaults.push({mutationKey:e,defaultOptions:t})},t.getMutationDefaults=function(e){var t;return e?null==(t=this.mutationDefaults.find(function(t){return Cs(e,t.mutationKey)}))?void 0:t.defaultOptions:void 0},t.defaultQueryOptions=function(e){if(null==e?void 0:e._defaulted)return e;var t=m({},this.defaultOptions.queries,this.getQueryDefaults(null==e?void 0:e.queryKey),e,{_defaulted:!0});return!t.queryHash&&t.queryKey&&(t.queryHash=Ss(t.queryKey,t)),t},t.defaultQueryObserverOptions=function(e){return this.defaultQueryOptions(e)},t.defaultMutationOptions=function(e){return(null==e?void 0:e._defaulted)?e:m({},this.defaultOptions.mutations,this.getMutationDefaults(null==e?void 0:e.mutationKey),e,{_defaulted:!0})},t.clear=function(){this.queryCache.clear(),this.mutationCache.clear()},e}(),Gs=rn.unstable_batchedUpdates;Bs.setBatchNotifyFunction(Gs);var Ys=console;zs=Ys;var Qs=sn.createContext(void 0),Js=sn.createContext(!1),Zs=function(e){var t=e.client,n=e.contextSharing,r=void 0!==n&&n,i=e.children;sn.useEffect(function(){return t.mount(),function(){t.unmount()}},[t]);var s=function(e){return e&&"undefined"!=typeof window?(window.ReactQueryClientContext||(window.ReactQueryClientContext=Qs),window.ReactQueryClientContext):Qs}(r);return sn.createElement(Js.Provider,{value:r},sn.createElement(s.Provider,{value:t},i))};const eo=on.createContext(void 0),to=()=>{const e=on.useContext(eo);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},no=({children:t})=>{const[n,r]=on.useState(null),[i,s]=on.useState(!0);on.useEffect(()=>{const e=localStorage.getItem("taskAppUser");if(e)try{const t=JSON.parse(e);r(t)}catch(t){console.error("ユーザー情報の復元に失敗しました:",t),localStorage.removeItem("taskAppUser")}s(!1)},[]);const o={user:n,login:(t,n)=>g(e,null,function*(){s(!0);try{if("demo@example.com"!==t||"password"!==n)throw new Error("メールアドレスまたはパスワードが正しくありません");{const e={id:"1",name:"デモユーザー",email:t};r(e),localStorage.setItem("taskAppUser",JSON.stringify(e))}}catch(e){throw e}finally{s(!1)}}),logout:()=>{r(null),localStorage.removeItem("taskAppUser")},register:(t,n,i)=>g(e,null,function*(){s(!0);try{const e={id:Date.now().toString(),name:t,email:n};r(e),localStorage.setItem("taskAppUser",JSON.stringify(e))}catch(e){throw e}finally{s(!1)}}),isLoading:i};return y.jsx(eo.Provider,{value:o,children:t})},ro=x({palette:{mode:"light",primary:{main:"#6366f1",light:"#818cf8",dark:"#4f46e5",contrastText:"#ffffff"},secondary:{main:"#ec4899",light:"#f472b6",dark:"#db2777",contrastText:"#ffffff"},background:{default:"#f1f5f9",paper:"#ffffff"},text:{primary:"#0f172a",secondary:"#64748b",disabled:"#94a3b8"},divider:"#e2e8f0",success:{main:"#10b981",light:"#34d399",dark:"#059669"},warning:{main:"#f59e0b",light:"#fbbf24",dark:"#d97706"},error:{main:"#ef4444",light:"#f87171",dark:"#dc2626"},info:{main:"#3b82f6",light:"#60a5fa",dark:"#2563eb"}},typography:{fontFamily:'"Inter", "Roboto", "Helvetica", "Arial", sans-serif',h1:{fontWeight:700,fontSize:"2.5rem",lineHeight:1.2},h2:{fontWeight:600,fontSize:"2rem",lineHeight:1.3},h3:{fontWeight:600,fontSize:"1.75rem",lineHeight:1.3},h4:{fontWeight:600,fontSize:"1.5rem",lineHeight:1.4},h5:{fontWeight:600,fontSize:"1.25rem",lineHeight:1.4},h6:{fontWeight:600,fontSize:"1rem",lineHeight:1.4},body1:{fontSize:"1rem",lineHeight:1.5,fontWeight:400},body2:{fontSize:"0.875rem",lineHeight:1.5,fontWeight:400},button:{fontWeight:500,textTransform:"none"},caption:{fontSize:"0.75rem",fontWeight:400}},shape:{borderRadius:12},spacing:8,components:{MuiButton:{styleOverrides:{root:{borderRadius:12,padding:"10px 20px",fontWeight:600,textTransform:"none",boxShadow:"none","&:hover":{boxShadow:"0 4px 12px rgba(99, 102, 241, 0.15)"}},contained:{"&:hover":{boxShadow:"0 6px 16px rgba(99, 102, 241, 0.25)"}},outlined:{borderWidth:"2px","&:hover":{borderWidth:"2px"}}}},MuiCard:{styleOverrides:{root:{borderRadius:16,boxShadow:"0 1px 3px rgba(0, 0, 0, 0.05), 0 1px 2px rgba(0, 0, 0, 0.03)",border:"1px solid #f1f5f9","&:hover":{boxShadow:"0 8px 25px rgba(0, 0, 0, 0.08), 0 4px 10px rgba(0, 0, 0, 0.04)"}}}},MuiPaper:{styleOverrides:{root:{borderRadius:16,boxShadow:"0 1px 3px rgba(0, 0, 0, 0.05), 0 1px 2px rgba(0, 0, 0, 0.03)"},elevation1:{boxShadow:"0 1px 3px rgba(0, 0, 0, 0.05), 0 1px 2px rgba(0, 0, 0, 0.03)"},elevation2:{boxShadow:"0 4px 12px rgba(0, 0, 0, 0.08), 0 2px 6px rgba(0, 0, 0, 0.04)"}}},MuiTextField:{styleOverrides:{root:{"& .MuiOutlinedInput-root":{borderRadius:12,"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#6366f1"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#6366f1",borderWidth:"2px"}}}}},MuiChip:{styleOverrides:{root:{borderRadius:20,fontWeight:600,fontSize:"0.75rem"},filled:{"&.MuiChip-colorPrimary":{backgroundColor:"#6366f1",color:"#ffffff"},"&.MuiChip-colorSecondary":{backgroundColor:"#ec4899",color:"#ffffff"}}}},MuiAppBar:{styleOverrides:{root:{backgroundColor:"#ffffff",color:"#0f172a",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.05)",borderBottom:"1px solid #f1f5f9"}}},MuiDrawer:{styleOverrides:{paper:{backgroundColor:"#ffffff",borderRight:"1px solid #f1f5f9",boxShadow:"2px 0 8px rgba(0, 0, 0, 0.05)"}}},MuiListItem:{styleOverrides:{root:{borderRadius:12,marginBottom:4,"&:hover":{backgroundColor:"#f8fafc"}}}},MuiListItemButton:{styleOverrides:{root:{borderRadius:12,"&:hover":{backgroundColor:"#f8fafc"},"&.Mui-selected":{backgroundColor:"#eef2ff","&:hover":{backgroundColor:"#eef2ff"}}}}},MuiDialog:{styleOverrides:{paper:{borderRadius:20,boxShadow:"0 25px 50px rgba(0, 0, 0, 0.1)"}}},MuiMenu:{styleOverrides:{paper:{borderRadius:16,boxShadow:"0 10px 30px rgba(0, 0, 0, 0.08)",border:"1px solid #f1f5f9"}}},MuiTooltip:{styleOverrides:{tooltip:{backgroundColor:"#0f172a",color:"#ffffff",borderRadius:12,fontSize:"0.75rem",padding:"8px 12px"}}},MuiBadge:{styleOverrides:{badge:{borderRadius:12,fontSize:"0.75rem",fontWeight:600}}},MuiAvatar:{styleOverrides:{root:{fontWeight:600}}},MuiLinearProgress:{styleOverrides:{root:{borderRadius:6,backgroundColor:"#f1f5f9"},bar:{borderRadius:6}}},MuiTable:{styleOverrides:{root:{"& .MuiTableCell-root":{borderBottom:"1px solid #f1f5f9"}}}},MuiTableHead:{styleOverrides:{root:{"& .MuiTableCell-root":{fontWeight:600,backgroundColor:"#f8fafc"}}}}}}),io=x({palette:{mode:"dark",primary:{main:"#a855f7",light:"#c084fc",dark:"#9333ea",contrastText:"#ffffff"},secondary:{main:"#f472b6",light:"#f9a8d4",dark:"#ec4899",contrastText:"#ffffff"},background:{default:"#0f172a",paper:"#1e293b"},text:{primary:"#f8fafc",secondary:"#cbd5e1",disabled:"#64748b"},divider:"#334155",success:{main:"#10b981",light:"#34d399",dark:"#059669"},warning:{main:"#f59e0b",light:"#fbbf24",dark:"#d97706"},error:{main:"#ef4444",light:"#f87171",dark:"#dc2626"},info:{main:"#3b82f6",light:"#60a5fa",dark:"#2563eb"}},typography:{fontFamily:'"Inter", "Roboto", "Helvetica", "Arial", sans-serif',h1:{fontWeight:700,fontSize:"2.5rem",lineHeight:1.2},h2:{fontWeight:600,fontSize:"2rem",lineHeight:1.3},h3:{fontWeight:600,fontSize:"1.75rem",lineHeight:1.3},h4:{fontWeight:600,fontSize:"1.5rem",lineHeight:1.4},h5:{fontWeight:600,fontSize:"1.25rem",lineHeight:1.4},h6:{fontWeight:600,fontSize:"1rem",lineHeight:1.4},body1:{fontSize:"1rem",lineHeight:1.5,fontWeight:400},body2:{fontSize:"0.875rem",lineHeight:1.5,fontWeight:400},button:{fontWeight:500,textTransform:"none"},caption:{fontSize:"0.75rem",fontWeight:400}},shape:{borderRadius:12},spacing:8,components:{MuiButton:{styleOverrides:{root:{borderRadius:12,padding:"10px 20px",fontWeight:600,textTransform:"none",boxShadow:"none","&:hover":{boxShadow:"0 4px 12px rgba(168, 85, 247, 0.3)"}},contained:{"&:hover":{boxShadow:"0 6px 16px rgba(168, 85, 247, 0.4)"}},outlined:{borderWidth:"2px","&:hover":{borderWidth:"2px"}}}},MuiCard:{styleOverrides:{root:{borderRadius:16,boxShadow:"0 1px 3px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2)",border:"1px solid #334155","&:hover":{boxShadow:"0 8px 25px rgba(0, 0, 0, 0.4), 0 4px 10px rgba(0, 0, 0, 0.3)"}}}},MuiPaper:{styleOverrides:{root:{borderRadius:16,boxShadow:"0 1px 3px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2)"},elevation1:{boxShadow:"0 1px 3px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2)"},elevation2:{boxShadow:"0 4px 12px rgba(0, 0, 0, 0.4), 0 2px 6px rgba(0, 0, 0, 0.3)"}}},MuiTextField:{styleOverrides:{root:{"& .MuiOutlinedInput-root":{borderRadius:12,"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#a855f7"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#a855f7",borderWidth:"2px"}}}}},MuiChip:{styleOverrides:{root:{borderRadius:20,fontWeight:600,fontSize:"0.75rem"},filled:{"&.MuiChip-colorPrimary":{backgroundColor:"#a855f7",color:"#ffffff"},"&.MuiChip-colorSecondary":{backgroundColor:"#f472b6",color:"#ffffff"}}}},MuiAppBar:{styleOverrides:{root:{backgroundColor:"#1e293b",color:"#f8fafc",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.3)",borderBottom:"1px solid #334155"}}},MuiDrawer:{styleOverrides:{paper:{backgroundColor:"#1e293b",borderRight:"1px solid #334155",boxShadow:"2px 0 8px rgba(0, 0, 0, 0.4)"}}},MuiListItem:{styleOverrides:{root:{borderRadius:12,marginBottom:4,"&:hover":{backgroundColor:"#334155"}}}},MuiListItemButton:{styleOverrides:{root:{borderRadius:12,"&:hover":{backgroundColor:"#334155"},"&.Mui-selected":{backgroundColor:"#581c87","&:hover":{backgroundColor:"#581c87"}}}}},MuiDialog:{styleOverrides:{paper:{borderRadius:20,boxShadow:"0 25px 50px rgba(0, 0, 0, 0.5)"}}},MuiMenu:{styleOverrides:{paper:{borderRadius:16,boxShadow:"0 10px 30px rgba(0, 0, 0, 0.4)",border:"1px solid #334155"}}},MuiTooltip:{styleOverrides:{tooltip:{backgroundColor:"#ffffff",color:"#0f172a",borderRadius:12,fontSize:"0.75rem",padding:"8px 12px"}}},MuiBadge:{styleOverrides:{badge:{borderRadius:12,fontSize:"0.75rem",fontWeight:600}}},MuiAvatar:{styleOverrides:{root:{fontWeight:600}}},MuiLinearProgress:{styleOverrides:{root:{borderRadius:6,backgroundColor:"#334155"},bar:{borderRadius:6}}},MuiTable:{styleOverrides:{root:{"& .MuiTableCell-root":{borderBottom:"1px solid #334155"}}}},MuiTableHead:{styleOverrides:{root:{"& .MuiTableCell-root":{fontWeight:600,backgroundColor:"#334155"}}}}}}),so=on.createContext(void 0),oo=()=>{const e=on.useContext(so);if(void 0===e)throw new Error("useTheme must be used within a ThemeProvider");return e},ao=({children:e})=>{const[t,n]=on.useState(()=>{const e=localStorage.getItem("darkMode");return!!e&&JSON.parse(e)});on.useEffect(()=>{localStorage.setItem("darkMode",JSON.stringify(t))},[t]);const r=t?io:ro;return y.jsx(so.Provider,{value:{isDarkMode:t,toggleTheme:()=>{n(!t)}},children:y.jsx(b,{theme:r,children:e})})};var lo={};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const co=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},uo={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0,c=t>>2,u=(3&t)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),r.push(n[c],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(co(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==o||null==a)throw new ho;const l=t<<2|s>>4;if(r.push(l),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class ho extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const fo=function(e){return function(e){const t=co(e);return uo.encodeByteArray(t,!0)}(e).replace(/\./g,"")},po=function(e){try{return uo.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},go=()=>
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */().__FIREBASE_DEFAULTS__,mo=()=>{try{return go()||(()=>{if("undefined"==typeof process)return;const e=lo.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&po(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},vo=e=>{var t,n;return null===(n=null===(t=mo())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},yo=e=>{const t=vo(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},xo=()=>{var e;return null===(e=mo())||void 0===e?void 0:e.config},bo=e=>{var t;return null===(t=mo())||void 0===t?void 0:t[`_${e}`]};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class wo{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function So(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[fo(JSON.stringify({alg:"none",type:"JWT"})),fo(JSON.stringify(s)),""].join(".")}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ko(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}class Co extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Co.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Eo.prototype.create)}}class Eo{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(Io,(e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`})}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new Co(r,o,n)}}const Io=/\{\$([^}]+)}/g;function Do(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(To(n)&&To(s)){if(!Do(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function To(e){return null!==e&&"object"==typeof e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function jo(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}class _o{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=Mo),void 0===r.error&&(r.error=Mo),void 0===r.complete&&(r.complete=Mo);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!=typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Mo(){}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Po(e){return e&&e._delegate?e._delegate:e}class Ao{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Ro="[DEFAULT]";
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Oo{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new wo;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e))try{this.getOrInitializeService({instanceIdentifier:Ro})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(e=Ro){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return g(this,null,function*(){const e=Array.from(this.instances.values());yield Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])})}isComponentSet(){return null!=this.component}isInitialized(e=Ro){return this.instances.has(e)}getOptions(e=Ro){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(i)&&s.resolve(r);return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===Ro?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(i){}var r;return n||null}normalizeInstanceIdentifier(e=Ro){return this.component?this.component.multipleInstances?e:Ro:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class No{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Oo(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Lo,Fo;(Fo=Lo||(Lo={}))[Fo.DEBUG=0]="DEBUG",Fo[Fo.VERBOSE=1]="VERBOSE",Fo[Fo.INFO=2]="INFO",Fo[Fo.WARN=3]="WARN",Fo[Fo.ERROR=4]="ERROR",Fo[Fo.SILENT=5]="SILENT";const Vo={debug:Lo.DEBUG,verbose:Lo.VERBOSE,info:Lo.INFO,warn:Lo.WARN,error:Lo.ERROR,silent:Lo.SILENT},Bo=Lo.INFO,zo={[Lo.DEBUG]:"log",[Lo.VERBOSE]:"log",[Lo.INFO]:"info",[Lo.WARN]:"warn",[Lo.ERROR]:"error"},Wo=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=zo[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class Uo{constructor(e){this.name=e,this._logLevel=Bo,this._logHandler=Wo,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Lo))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?Vo[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Lo.DEBUG,...e),this._logHandler(this,Lo.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Lo.VERBOSE,...e),this._logHandler(this,Lo.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Lo.INFO,...e),this._logHandler(this,Lo.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Lo.WARN,...e),this._logHandler(this,Lo.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Lo.ERROR,...e),this._logHandler(this,Lo.ERROR,...e)}}let Ho,$o;const qo=new WeakMap,Xo=new WeakMap,Ko=new WeakMap,Go=new WeakMap,Yo=new WeakMap;let Qo={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Xo.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Ko.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ea(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Jo(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?($o||($o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(ta(this),t),ea(qo.get(this))}:function(...t){return ea(e.apply(ta(this),t))}:function(t,...n){const r=e.call(ta(this),t,...n);return Ko.set(r,t.sort?t.sort():[t]),ea(r)}}function Zo(e){return"function"==typeof e?Jo(e):(e instanceof IDBTransaction&&function(e){if(Xo.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});Xo.set(e,t)}(e),t=e,(Ho||(Ho=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,Qo):e);var t}function ea(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(ea(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&qo.set(t,e)}).catch(()=>{}),Yo.set(t,e),t}(e);if(Go.has(e))return Go.get(e);const t=Zo(e);return t!==e&&(Go.set(e,t),Yo.set(t,e)),t}const ta=e=>Yo.get(e),na=["get","getKey","getAll","getAllKeys","count"],ra=["put","add","delete","clear"],ia=new Map;function sa(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(ia.get(t))return ia.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=ra.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!na.includes(n))return;const s=function(e,...t){return g(this,null,function*(){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(yield Promise.all([o[n](...t),i&&s.done]))[0]})};return ia.set(t,s),s}var oa;Qo=h(u({},oa=Qo),{get:(e,t,n)=>sa(e,t)||oa.get(e,t,n),has:(e,t)=>!!sa(e,t)||oa.has(e,t)});
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class aa{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const la="@firebase/app",ca="0.9.13",ua=new Uo("@firebase/app"),ha="@firebase/app-compat",da="@firebase/analytics-compat",fa="@firebase/analytics",pa="@firebase/app-check-compat",ga="@firebase/app-check",ma="@firebase/auth",va="@firebase/auth-compat",ya="@firebase/database",xa="@firebase/database-compat",ba="@firebase/functions",wa="@firebase/functions-compat",Sa="@firebase/installations",ka="@firebase/installations-compat",Ca="@firebase/messaging",Ea="@firebase/messaging-compat",Ia="@firebase/performance",Da="@firebase/performance-compat",Ta="@firebase/remote-config",ja="@firebase/remote-config-compat",_a="@firebase/storage",Ma="@firebase/storage-compat",Pa="@firebase/firestore",Aa="@firebase/firestore-compat",Ra="firebase",Oa="[DEFAULT]",Na={[la]:"fire-core",[ha]:"fire-core-compat",[fa]:"fire-analytics",[da]:"fire-analytics-compat",[ga]:"fire-app-check",[pa]:"fire-app-check-compat",[ma]:"fire-auth",[va]:"fire-auth-compat",[ya]:"fire-rtdb",[xa]:"fire-rtdb-compat",[ba]:"fire-fn",[wa]:"fire-fn-compat",[Sa]:"fire-iid",[ka]:"fire-iid-compat",[Ca]:"fire-fcm",[Ea]:"fire-fcm-compat",[Ia]:"fire-perf",[Da]:"fire-perf-compat",[Ta]:"fire-rc",[ja]:"fire-rc-compat",[_a]:"fire-gcs",[Ma]:"fire-gcs-compat",[Pa]:"fire-fst",[Aa]:"fire-fst-compat","fire-js":"fire-js",[Ra]:"fire-js-all"},La=new Map,Fa=new Map;function Va(e,t){try{e.container.addComponent(t)}catch(n){ua.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Ba(e){const t=e.name;if(Fa.has(t))return ua.debug(`There were multiple attempts to register component ${t}.`),!1;Fa.set(t,e);for(const n of La.values())Va(n,e);return!0}function za(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Wa=new Eo("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Ua{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ao("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Wa.create("app-deleted",{appName:this._name})}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Ha="9.23.0";function $a(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:Oa,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw Wa.create("bad-app-name",{appName:String(i)});if(n||(n=xo()),!n)throw Wa.create("no-options");const s=La.get(i);if(s){if(Do(n,s.options)&&Do(r,s.config))return s;throw Wa.create("duplicate-app",{appName:i})}const o=new No(i);for(const l of Fa.values())o.addComponent(l);const a=new Ua(n,r,o);return La.set(i,a),a}function qa(e=Oa){const t=La.get(e);if(!t&&e===Oa&&xo())return $a();if(!t)throw Wa.create("no-app",{appName:e});return t}function Xa(e,t,n){var r;let i=null!==(r=Na[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void ua.warn(e.join(" "))}Ba(new Ao(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Ka="firebase-heartbeat-store";let Ga=null;function Ya(){return Ga||(Ga=function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=ea(o);return r&&o.addEventListener("upgradeneeded",e=>{r(ea(o.result),e.oldVersion,e.newVersion,ea(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(Ka)}}).catch(e=>{throw Wa.create("idb-open",{originalErrorMessage:e.message})})),Ga}function Qa(e,t){return g(this,null,function*(){try{const n=(yield Ya()).transaction(Ka,"readwrite"),r=n.objectStore(Ka);yield r.put(t,Ja(e)),yield n.done}catch(n){if(n instanceof Co)ua.warn(n.message);else{const e=Wa.create("idb-set",{originalErrorMessage:null==n?void 0:n.message});ua.warn(e.message)}}})}function Ja(e){return`${e.name}!${e.options.appId}`}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Za{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new tl(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}triggerHeartbeat(){return g(this,null,function*(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=el();if(null===this._heartbeatsCache&&(this._heartbeatsCache=yield this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some(e=>e.date===t))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return g(this,null,function*(){if(null===this._heartbeatsCache&&(yield this._heartbeatsCachePromise),null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=el(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),nl(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),nl(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=fo(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r})}}function el(){return(new Date).toISOString().substring(0,10)}class tl{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return g(this,null,function*(){return!!function(){try{return"object"==typeof indexedDB}catch(e){return!1}}()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)})}read(){return g(this,null,function*(){return(yield this._canUseIndexedDBPromise)&&(yield function(e){return g(this,null,function*(){try{const t=yield Ya();return yield t.transaction(Ka).objectStore(Ka).get(Ja(e))}catch(t){if(t instanceof Co)ua.warn(t.message);else{const e=Wa.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});ua.warn(e.message)}}})}(this.app))||{heartbeats:[]}})}overwrite(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){const n=yield this.read();return Qa(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})}add(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){const n=yield this.read();return Qa(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}})}}function nl(e){return fo(JSON.stringify({version:2,heartbeats:e})).length}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var rl;function il(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function sl(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}rl="",Ba(new Ao("platform-logger",e=>new aa(e),"PRIVATE")),Ba(new Ao("heartbeat",e=>new Za(e),"PRIVATE")),Xa(la,ca,rl),Xa(la,ca,"esm2017"),Xa("fire-js",""),
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
Xa("firebase","9.23.0","app"),"function"==typeof SuppressedError&&SuppressedError;const ol=sl,al=new Eo("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),ll=new Uo("@firebase/auth");function cl(e,...t){ll.logLevel<=Lo.ERROR&&ll.error(`Auth (${Ha}): ${e}`,...t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ul(e,...t){throw dl(e,...t)}function hl(e,...t){return dl(e,...t)}function dl(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return al.create(e,...t)}function fl(e,t,...n){if(!e)throw dl(t,...n)}function pl(e){const t="INTERNAL ASSERTION FAILED: "+e;throw cl(t),new Error(t)}function gl(e,t){e||pl(t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ml(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function vl(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function yl(){return"undefined"==typeof navigator||!navigator||!("onLine"in navigator)||"boolean"!=typeof navigator.onLine||"http:"!==vl()&&"https:"!==vl()&&!function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()&&!("connection"in navigator)||navigator.onLine}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class xl{constructor(e,t){this.shortDelay=e,this.longDelay=t,gl(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ko())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return yl()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function bl(e,t){gl(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class wl{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void pl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void pl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void pl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Sl={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},kl=new xl(3e4,6e4);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Cl(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function El(e,t,n,r){return g(this,arguments,function*(e,t,n,r,i={}){return Il(e,i,()=>g(this,null,function*(){let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=jo(Object.assign({key:e.config.apiKey},s)).slice(1),a=yield e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),wl.fetch()(Dl(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))})}function Il(e,t,n){return g(this,null,function*(){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Sl),t);try{const t=new Tl(e),i=yield Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=yield i.json();if("needConfirmation"in s)throw jl(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw jl(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw jl(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw jl(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(e,t,n){const r=Object.assign(Object.assign({},ol()),{[t]:n});return new Eo("auth","Firebase",r).create(t,{appName:e.name})}(e,a,o);ul(e,a)}}catch(i){if(i instanceof Co)throw i;ul(e,"network-request-failed",{message:String(i)})}})}function Dl(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?bl(e.config,i):`${e.config.apiScheme}://${i}`}class Tl{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(hl(this.auth,"network-request-failed")),kl.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function jl(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=hl(e,t,r);return i.customData._tokenResponse=n,i}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function _l(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function Ml(e){return 1e3*Number(e)}function Pl(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return cl("JWT malformed, contained fewer than 3 sections"),null;try{const e=po(n);return e?JSON.parse(e):(cl("Failed to decode base64 JWT payload"),null)}catch(i){return cl("Caught error parsing JWT payload as JSON",null==i?void 0:i.toString()),null}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Al(e,t,n=!1){return g(this,null,function*(){if(n)return t;try{return yield t}catch(r){throw r instanceof Co&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(r)&&e.auth.currentUser===e&&(yield e.auth.signOut()),r}})}class Rl{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(()=>g(this,null,function*(){yield this.iteration()}),t)}iteration(){return g(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ol{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=_l(this.lastLoginAt),this.creationTime=_l(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Nl(e){return g(this,null,function*(){var t;const n=e.auth,r=yield e.getIdToken(),i=yield Al(e,function(e,t){return g(this,null,function*(){return El(e,"POST","/v1/accounts:lookup",t)})}(n,{idToken:r}));fl(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map(e=>{var{providerId:t}=e,n=il(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}):[],a=(l=e.providerData,c=o,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const u=e.isAnonymous,h=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!u&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Ol(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Ll{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){fl(e.idToken,"internal-error"),fl(void 0!==e.idToken,"internal-error"),fl(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=Pl(e);return fl(t,"internal-error"),fl(void 0!==t.exp,"internal-error"),fl(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}getToken(e,t=!1){return g(this,null,function*(){return fl(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return g(this,null,function*(){const{accessToken:n,refreshToken:r,expiresIn:i}=
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */yield function(e,t){return g(this,null,function*(){const n=yield Il(e,{},()=>g(this,null,function*(){const n=jo({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=Dl(e,r,"/v1/token",`key=${i}`),o=yield e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",wl.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}})}(e,t);this.updateTokensAndExpiration(n,r,Number(i))})}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Ll;return n&&(fl("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(fl("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(fl("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ll,this.toJSON())}_performRefresh(){return pl("not implemented")}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Fl(e,t){fl("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Vl{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=il(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Rl(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Ol(i.createdAt||void 0,i.lastLoginAt||void 0)}getIdToken(e){return g(this,null,function*(){const t=yield Al(this,this.stsTokenManager.getToken(this.auth,e));return fl(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return function(e,t=!1){return g(this,null,function*(){const n=Po(e),r=yield n.getIdToken(t),i=Pl(r);fl(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:_l(Ml(i.auth_time)),issuedAtTime:_l(Ml(i.iat)),expirationTime:_l(Ml(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}})}(this,e)}reload(){return function(e){return g(this,null,function*(){const t=Po(e);yield Nl(t),yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)})}(this)}_assign(e){this!==e&&(fl(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Vl(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){fl(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return g(this,null,function*(){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&(yield Nl(this)),yield this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)})}delete(){return g(this,null,function*(){const e=yield this.getIdToken();return yield Al(this,function(e,t){return g(this,null,function*(){return El(e,"POST","/v1/accounts:delete",t)})}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:x,isAnonymous:b,providerData:w,stsTokenManager:S}=t;fl(y&&S,e,"internal-error");const k=Ll.fromJSON(this.name,S);fl("string"==typeof y,e,"internal-error"),Fl(u,e.name),Fl(h,e.name),fl("boolean"==typeof x,e,"internal-error"),fl("boolean"==typeof b,e,"internal-error"),Fl(d,e.name),Fl(f,e.name),Fl(p,e.name),Fl(g,e.name),Fl(m,e.name),Fl(v,e.name);const C=new Vl({uid:y,auth:e,email:h,emailVerified:x,displayName:u,isAnonymous:b,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:k,createdAt:m,lastLoginAt:v});return w&&Array.isArray(w)&&(C.providerData=w.map(e=>Object.assign({},e))),g&&(C._redirectEventId=g),C}static _fromIdTokenResponse(e,t,n=!1){return g(this,null,function*(){const r=new Ll;r.updateFromServerResponse(t);const i=new Vl({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return yield Nl(i),i})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Bl=new Map;function zl(e){gl(e instanceof Function,"Expected a class definition");let t=Bl.get(e);return t?(gl(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Bl.set(e,t),t)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Wl{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return g(this,null,function*(){return!0})}_set(e,t){return g(this,null,function*(){this.storage[e]=t})}_get(e){return g(this,null,function*(){const t=this.storage[e];return void 0===t?null:t})}_remove(e){return g(this,null,function*(){delete this.storage[e]})}_addListener(e,t){}_removeListener(e,t){}}Wl.type="NONE";const Ul=Wl;
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Hl(e,t,n){return`firebase:${e}:${t}:${n}`}class $l{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Hl(this.userKey,r.apiKey,i),this.fullPersistenceKey=Hl("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return g(this,null,function*(){const e=yield this.persistence._get(this.fullUserKey);return e?Vl._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return g(this,null,function*(){if(this.persistence===e)return;const t=yield this.getCurrentUser();return yield this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,n="authUser"){return g(this,null,function*(){if(!t.length)return new $l(zl(Ul),e,n);const r=(yield Promise.all(t.map(e=>g(this,null,function*(){if(yield e._isAvailable())return e})))).filter(e=>e);let i=r[0]||zl(Ul);const s=Hl(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=yield n._get(s);if(t){const r=Vl._fromJSON(e,t);n!==i&&(o=r),i=n;break}}catch(l){}const a=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&a.length?(i=a[0],o&&(yield i._set(s,o.toJSON())),yield Promise.all(t.map(e=>g(this,null,function*(){if(e!==i)try{yield e._remove(s)}catch(l){}}))),new $l(i,e,n)):new $l(i,e,n)})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ql(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Yl(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Xl(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Jl(t))return"Blackberry";if(Zl(t))return"Webos";if(Kl(t))return"Safari";if((t.includes("chrome/")||Gl(t))&&!t.includes("edge/"))return"Chrome";if(Ql(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Xl(e=ko()){return/firefox\//i.test(e)}function Kl(e=ko()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Gl(e=ko()){return/crios\//i.test(e)}function Yl(e=ko()){return/iemobile/i.test(e)}function Ql(e=ko()){return/android/i.test(e)}function Jl(e=ko()){return/blackberry/i.test(e)}function Zl(e=ko()){return/webos/i.test(e)}function ec(e=ko()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function tc(){return function(){const e=ko();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function nc(e=ko()){return ec(e)||Ql(e)||Zl(e)||Jl(e)||/windows phone/i.test(e)||Yl(e)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function rc(e,t=[]){let n;switch(e){case"Browser":n=ql(ko());break;case"Worker":n=`${ql(ko())}-${e}`;break;default:n=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ha}/${r}`}function ic(e,t){return g(this,null,function*(){return El(e,"GET","/v2/recaptchaConfig",Cl(e,t))})}function sc(e){return void 0!==e&&void 0!==e.enterprise}class oc{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(e=>"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ac(e){return new Promise((t,n)=>{const r=document.createElement("script");var i,s;r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=hl("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(null!==(s=null===(i=document.getElementsByTagName("head"))||void 0===i?void 0:i[0])&&void 0!==s?s:document).appendChild(r)})}class lc{constructor(e){this.type="recaptcha-enterprise",this.auth=hc(e)}verify(e="verify",t=!1){return g(this,null,function*(){function n(t,n,r){const i=window.grecaptcha;sc(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n("NO_RECAPTCHA")})}):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((e,r)=>{(function(e){return g(this,null,function*(){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((t,n)=>g(this,null,function*(){ic(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new oc(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})}))})})(this.auth).then(i=>{if(!t&&sc(window.grecaptcha))n(i,e,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));ac("https://www.google.com/recaptcha/enterprise.js?render="+i).then(()=>{n(i,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})})}}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class cc{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(i){r(i)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}runMiddleware(e){return g(this,null,function*(){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)yield n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==n?void 0:n.message})}})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class uc{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new dc(this),this.idTokenSubscription=new dc(this),this.beforeStateQueue=new cc(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=al,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=zl(t)),this._initializationPromise=this.queue(()=>g(this,null,function*(){var n,r;if(!this._deleted&&(this.persistenceManager=yield $l.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch(i){}yield this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return g(this,null,function*(){if(this._deleted)return;const e=yield this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void(yield this.currentUser.getIdToken())):void(yield this._updateCurrentUser(e,!0)):void 0})}initializeCurrentUser(e){return g(this,null,function*(){var t;const n=yield this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==r?void 0:r._redirectEventId,o=yield this.tryRedirectSignIn(e);n&&n!==s||!(null==o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{yield this.beforeStateQueue.runMiddleware(r)}catch(s){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return fl(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)})}tryRedirectSignIn(e){return g(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return g(this,null,function*(){try{yield Nl(e)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}_delete(){return g(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return g(this,null,function*(){const t=e?Po(e):null;return t&&fl(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return g(this,null,function*(){if(!this._deleted)return e&&fl(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>g(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return g(this,null,function*(){return yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0)})}setPersistence(e){return this.queue(()=>g(this,null,function*(){yield this.assertedPersistence.setPersistence(zl(e))}))}initializeRecaptchaConfig(){return g(this,null,function*(){const e=yield ic(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new oc(e);null==this.tenantId?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled&&new lc(this).verify()})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Eo("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}_setRedirectUser(e,t){return g(this,null,function*(){const n=yield this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return g(this,null,function*(){if(!this.redirectPersistenceManager){const t=e&&zl(e)||this._popupRedirectResolver;fl(t,this,"argument-error"),this.redirectPersistenceManager=yield $l.create(this,[zl(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return g(this,null,function*(){var t,n;return this._isInitialized&&(yield this.queue(()=>g(this,null,function*(){}))),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return g(this,null,function*(){if(e===this.currentUser)return this.queue(()=>g(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return fl(s,this,"internal-error"),s.then(()=>i(this.currentUser)),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}directlySetCurrentUser(e){return g(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return fl(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=rc(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return g(this,null,function*(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=yield null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader();n&&(t["X-Firebase-Client"]=n);const r=yield this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t})}_getAppCheckToken(){return g(this,null,function*(){var e;const t=yield null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken();return(null==t?void 0:t.error)&&function(e,...t){ll.logLevel<=Lo.WARN&&ll.warn(`Auth (${Ha}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token})}}function hc(e){return Po(e)}class dc{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new _o(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return fl(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function fc(e,t,n){const r=hc(e);fl(r._canInitEmulator,r,"emulator-config-failed"),fl(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=pc(t),{host:s,port:o}=function(e){const t=pc(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:gc(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:gc(t)}}}(t),a=null===o?"":`:${o}`;r.config.emulator={url:`${i}//${s}${a}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:!1})}),function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */()}function pc(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function gc(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class mc{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return pl("not implemented")}_getIdTokenResponse(e){return pl("not implemented")}_linkToIdToken(e,t){return pl("not implemented")}_getReauthenticationResolver(e){return pl("not implemented")}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function vc(e,t){return g(this,null,function*(){return function(e,t,n,r){return g(this,arguments,function*(e,t,n,r,i={}){const s=yield El(e,t,n,r,i);return"mfaPendingCredential"in s&&ul(e,"multi-factor-auth-required",{_serverResponse:s}),s})}(e,"POST","/v1/accounts:signInWithIdp",Cl(e,t))})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class yc extends mc{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new yc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ul("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=il(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new yc(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return vc(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,vc(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,vc(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=jo(t)}return e}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class xc{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class bc extends xc{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class wc extends bc{constructor(){super("facebook.com")}static credential(e){return yc._fromParams({providerId:wc.PROVIDER_ID,signInMethod:wc.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wc.credentialFromTaggedObject(e)}static credentialFromError(e){return wc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return wc.credential(e.oauthAccessToken)}catch(t){return null}}}wc.FACEBOOK_SIGN_IN_METHOD="facebook.com",wc.PROVIDER_ID="facebook.com";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Sc extends bc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return yc._fromParams({providerId:Sc.PROVIDER_ID,signInMethod:Sc.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Sc.credentialFromTaggedObject(e)}static credentialFromError(e){return Sc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Sc.credential(t,n)}catch(r){return null}}}Sc.GOOGLE_SIGN_IN_METHOD="google.com",Sc.PROVIDER_ID="google.com";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class kc extends bc{constructor(){super("github.com")}static credential(e){return yc._fromParams({providerId:kc.PROVIDER_ID,signInMethod:kc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return kc.credentialFromTaggedObject(e)}static credentialFromError(e){return kc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return kc.credential(e.oauthAccessToken)}catch(t){return null}}}kc.GITHUB_SIGN_IN_METHOD="github.com",kc.PROVIDER_ID="github.com";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Cc extends bc{constructor(){super("twitter.com")}static credential(e,t){return yc._fromParams({providerId:Cc.PROVIDER_ID,signInMethod:Cc.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Cc.credentialFromTaggedObject(e)}static credentialFromError(e){return Cc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Cc.credential(t,n)}catch(r){return null}}}Cc.TWITTER_SIGN_IN_METHOD="twitter.com",Cc.PROVIDER_ID="twitter.com";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Ec{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,n,r=!1){return g(this,null,function*(){const i=yield Vl._fromIdTokenResponse(e,n,r),s=Ic(n);return new Ec({user:i,providerId:s,_tokenResponse:n,operationType:t})})}static _forOperation(e,t,n){return g(this,null,function*(){yield e._updateTokensIfNecessary(n,!0);const r=Ic(n);return new Ec({user:e,providerId:r,_tokenResponse:n,operationType:t})})}}function Ic(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Dc extends Co{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Dc.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Dc(e,t,n,r)}}function Tc(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw Dc._fromErrorAndOperation(e,n,t,r);throw n})}const jc="__sak";
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class _c{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(jc,"1"),this.storage.removeItem(jc),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Mc extends _c{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=ko();return Kl(e)||ec(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=nc(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);tc()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(e,t){return g(this,null,function*(){yield p(Mc.prototype,this,"_set").call(this,e,t),this.localCache[e]=JSON.stringify(t)})}_get(e){return g(this,null,function*(){const t=yield p(Mc.prototype,this,"_get").call(this,e);return this.localCache[e]=JSON.stringify(t),t})}_remove(e){return g(this,null,function*(){yield p(Mc.prototype,this,"_remove").call(this,e),delete this.localCache[e]})}}Mc.type="LOCAL";const Pc=Mc;
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ac extends _c{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Ac.type="SESSION";const Rc=Ac;
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Oc{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Oc(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}handleEvent(e){return g(this,null,function*(){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map(e=>g(this,null,function*(){return e(t.origin,i)})),a=yield function(e){return Promise.all(e.map(e=>g(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Nc(e="",t=10){let n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */Oc.receivers=[];class Lc{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,n=50){return g(this,null,function*(){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise((o,a)=>{const l=Nc("",20);r.port1.start();const c=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(c),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Fc(){return window}
/**
     * @license
     * Copyright 2020 Google LLC.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Vc(){return void 0!==Fc().WorkerGlobalScope&&"function"==typeof Fc().importScripts}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Bc="firebaseLocalStorageDb",zc="firebaseLocalStorage",Wc="fbase_key";class Uc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Hc(e,t){return e.transaction([zc],t?"readwrite":"readonly").objectStore(zc)}function $c(){const e=indexedDB.open(Bc,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(zc,{keyPath:Wc})}catch(r){n(r)}}),e.addEventListener("success",()=>g(this,null,function*(){const n=e.result;n.objectStoreNames.contains(zc)?t(n):(n.close(),yield function(){const e=indexedDB.deleteDatabase(Bc);return new Uc(e).toPromise()}(),t(yield $c()))}))})}function qc(e,t,n){return g(this,null,function*(){const r=Hc(e,!0).put({[Wc]:t,value:n});return new Uc(r).toPromise()})}function Xc(e,t){const n=Hc(e,!0).delete(t);return new Uc(n).toPromise()}class Kc{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return g(this,null,function*(){return this.db||(this.db=yield $c()),this.db})}_withRetries(e){return g(this,null,function*(){let t=0;for(;;)try{const t=yield this._openDb();return yield e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return g(this,null,function*(){return Vc()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return g(this,null,function*(){this.receiver=Oc._getInstance(Vc()?self:null),this.receiver._subscribe("keyChanged",(e,t)=>g(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(t.key)}})),this.receiver._subscribe("ping",(e,t)=>g(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return g(this,null,function*(){var e,t;if(this.activeServiceWorker=yield function(){return g(this,null,function*(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch(e){return null}})}(),!this.activeServiceWorker)return;this.sender=new Lc(this.activeServiceWorker);const n=yield this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(e){return g(this,null,function*(){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{yield this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}})}_isAvailable(){return g(this,null,function*(){try{if(!indexedDB)return!1;const e=yield $c();return yield qc(e,jc,"1"),yield Xc(e,jc),!0}catch(e){}return!1})}_withPendingWrite(e){return g(this,null,function*(){this.pendingWrites++;try{yield e()}finally{this.pendingWrites--}})}_set(e,t){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(n=>qc(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)}))})}_get(e){return g(this,null,function*(){const t=yield this._withRetries(t=>function(e,t){return g(this,null,function*(){const n=Hc(e,!1).get(t),r=yield new Uc(n).toPromise();return void 0===r?null:r.value})}(t,e));return this.localCache[e]=t,t})}_remove(e){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(t=>Xc(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)}))})}_poll(){return g(this,null,function*(){const e=yield this._withRetries(e=>{const t=Hc(e,!1).getAll();return new Uc(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t})}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>g(this,null,function*(){return this._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Kc.type="LOCAL";const Gc=Kc;new xl(3e4,6e4);
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Yc extends mc{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return vc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return vc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return vc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Qc(e){
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
return function(e,t,n=!1){return g(this,null,function*(){const r="signIn",i=yield Tc(e,r,t),s=yield Ec._fromIdTokenResponse(e,r,i);return n||(yield e._updateCurrentUser(s.user)),s})}(e.auth,new Yc(e),e.bypassAuthState)}function Jc(e){const{auth:t,user:n}=e;return fl(n,t,"internal-error"),
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e,t,n=!1){return g(this,null,function*(){const{auth:r}=e,i="reauthenticate";try{const s=yield Al(e,Tc(r,i,t,e),n);fl(s.idToken,r,"internal-error");const o=Pl(s.idToken);fl(o,r,"internal-error");const{sub:a}=o;return fl(e.uid===a,r,"user-mismatch"),Ec._forOperation(e,i,s)}catch(s){throw"auth/user-not-found"===(null==s?void 0:s.code)&&ul(r,"user-mismatch"),s}})}(n,new Yc(e),e.bypassAuthState)}function Zc(e){return g(this,null,function*(){const{auth:t,user:n}=e;return fl(n,t,"internal-error"),function(e,t,n=!1){return g(this,null,function*(){const r=yield Al(e,t._linkToIdToken(e.auth,yield e.getIdToken()),n);return Ec._forOperation(e,"link",r)})}(n,new Yc(e),e.bypassAuthState)})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class eu{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>g(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}onAuthEvent(e){return g(this,null,function*(){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(o)(a))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Qc;case"linkViaPopup":case"linkViaRedirect":return Zc;case"reauthViaPopup":case"reauthViaRedirect":return Jc;default:ul(this.auth,"internal-error")}}resolve(e){gl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){gl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const tu=new xl(2e3,1e4);class nu extends eu{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,nu.currentPopupAction&&nu.currentPopupAction.cancel(),nu.currentPopupAction=this}executeNotNull(){return g(this,null,function*(){const e=yield this.execute();return fl(e,this.auth,"internal-error"),e})}onExecution(){return g(this,null,function*(){gl(1===this.filter.length,"Popup operations only handle one event");const e=Nc();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(hl(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(hl(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,nu.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(hl(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,tu.get())};e()}}nu.currentPopupAction=null;
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const ru="pendingRedirect",iu=new Map;class su extends eu{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}execute(){return g(this,null,function*(){let e=iu.get(this.auth._key());if(!e){try{const t=(yield function(e,t){return g(this,null,function*(){const n=function(e){return Hl(ru,e.config.apiKey,e.name)}(t),r=function(e){return zl(e._redirectPersistence)}(e);if(!(yield r._isAvailable()))return!1;const i="true"===(yield r._get(n));return yield r._remove(n),i})}(this.resolver,this.auth))?yield p(su.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}iu.set(this.auth._key(),e)}return this.bypassAuthState||iu.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return g(this,null,function*(){if("signInViaRedirect"===e.type)return p(su.prototype,this,"onAuthEvent").call(this,e);if("unknown"!==e.type){if(e.eventId){const t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,p(su.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}}else this.resolve(null)})}onExecution(){return g(this,null,function*(){})}cleanUp(){}}function ou(e,t){iu.set(e._key(),t)}function au(e,t,n=!1){return g(this,null,function*(){const r=hc(e),i=
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e,t){return t?zl(t):(fl(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(r,t),s=new su(r,i,n),o=yield s.execute();return o&&!n&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,t)),o})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class lu{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return uu(e);default:return!1}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!uu(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(hl(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(cu(e))}saveEventToCache(e){this.cachedEventUids.add(cu(e)),this.lastProcessedEventTime=Date.now()}}function cu(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function uu({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const hu=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,du=/^https?/;function fu(e){return g(this,null,function*(){if(e.config.emulator)return;const{authorizedDomains:t}=yield function(e){return g(this,arguments,function*(e,t={}){return El(e,"GET","/v1/projects",t)})}(e);for(const e of t)try{if(pu(e))return}catch(n){}ul(e,"unauthorized-domain")})}function pu(e){const t=ml(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!du.test(n))return!1;if(hu.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}
/**
     * @license
     * Copyright 2020 Google LLC.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const gu=new xl(3e4,6e4);function mu(){const e=Fc().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function vu(e){return new Promise((t,n)=>{var r,i,s;function o(){mu(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{mu(),n(hl(e,"network-request-failed"))},timeout:gu.get()})}if(null===(i=null===(r=Fc().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Fc().gapi)||void 0===s?void 0:s.load)){const t=`__iframefcb${Math.floor(1e6*Math.random())}`;return Fc()[t]=()=>{gapi.load?o():n(hl(e,"network-request-failed"))},ac(`https://apis.google.com/js/api.js?onload=${t}`).catch(e=>n(e))}o()}}).catch(e=>{throw yu=null,e})}let yu=null;
/**
     * @license
     * Copyright 2020 Google LLC.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const xu=new xl(5e3,15e3),bu={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},wu=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Su(e){const t=e.config;fl(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?bl(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:Ha},i=wu.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${jo(r).slice(1)}`}function ku(e){return g(this,null,function*(){const t=yield function(e){return yu=yu||vu(e),yu}(e),n=Fc().gapi;return fl(n,e,"internal-error"),t.open({where:document.body,url:Su(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:bu,dontclear:!0},t=>new Promise((n,r)=>g(this,null,function*(){yield t.restyle({setHideOnLeave:!1});const i=hl(e,"network-request-failed"),s=Fc().setTimeout(()=>{r(i)},xu.get());function o(){Fc().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{r(i)})})))})}
/**
     * @license
     * Copyright 2020 Google LLC.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Cu={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Eu{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Iu(e,t,n,r=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},Cu),{width:r.toString(),height:i.toString(),top:s,left:o}),c=ko().toLowerCase();n&&(a=Gl(c)?"_blank":n),Xl(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(function(e=ko()){var t;return ec(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(c)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t||"",a),new Eu(null);const h=window.open(t||"",a,u);fl(h,e,"popup-blocked");try{h.focus()}catch(d){}return new Eu(h)}const Du="__/auth/handler",Tu="emulator/auth/handler",ju=encodeURIComponent("fac");function _u(e,t,n,r,i,s){return g(this,null,function*(){fl(e.config.authDomain,e,"auth-domain-config-required"),fl(e.config.apiKey,e,"invalid-api-key");const s={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Ha,eventId:i};if(t instanceof xc){t.setDefaultLanguage(e.languageCode),s.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries({}))s[e]=t}if(t instanceof bc){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(s.scopes=e.join(","))}e.tenantId&&(s.tid=e.tenantId);const o=s;for(const e of Object.keys(o))void 0===o[e]&&delete o[e];const a=yield e._getAppCheckToken(),l=a?`#${ju}=${encodeURIComponent(a)}`:"";return`${function({config:e}){return e.emulator?bl(e,Tu):`https://${e.authDomain}/${Du}`}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e)}?${jo(o).slice(1)}${l}`})}const Mu="webStorageSupport",Pu=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Rc,this._completeRedirectFn=au,this._overrideRedirectResult=ou}_openPopup(e,t,n,r){return g(this,null,function*(){var i;gl(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");const s=yield _u(e,t,n,ml(),r);return Iu(e,s,Nc())})}_openRedirect(e,t,n,r){return g(this,null,function*(){return yield this._originValidation(e),function(e){Fc().location.href=e}(yield _u(e,t,n,ml(),r)),new Promise(()=>{})})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(gl(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}initAndGetManager(e){return g(this,null,function*(){const t=yield ku(e),n=new lu(e);return t.register("authEvent",t=>(fl(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Mu,{type:Mu},n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[Mu];void 0!==i&&t(!!i),ul(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=fu(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return nc()||Kl()||ec()}};var Au="@firebase/auth",Ru="0.23.2";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Ou{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}getToken(e){return g(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){fl(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Nu=bo("authIdTokenMaxAge")||300;let Lu=null;var Fu;Fu="Browser",Ba(new Ao("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;fl(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:Fu,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:rc(Fu)},l=new uc(n,r,i,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(zl);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Ba(new Ao("auth-internal",e=>{const t=hc(e.getProvider("auth").getImmediate());return new Ou(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Xa(Au,Ru,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Fu)),Xa(Au,Ru,"esm2017");var Vu,Bu="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},zu=zu||{},Wu=Bu||self;function Uu(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function Hu(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function $u(e,t,n){return e.call.apply(e.bind,arguments)}function qu(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Xu(e,t,n){return(Xu=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?$u:qu).apply(null,arguments)}function Ku(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Gu(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function Yu(){this.s=this.s,this.o=this.o}Yu.prototype.s=!1,Yu.prototype.sa=function(){!this.s&&(this.s=!0,this.N())},Yu.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Qu=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Ju(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function Zu(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(Uu(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function eh(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}eh.prototype.h=function(){this.defaultPrevented=!0};var th=function(){if(!Wu.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Wu.addEventListener("test",()=>{},t),Wu.removeEventListener("test",()=>{},t)}catch(n){}return e}();function nh(e){return/^[\s\xa0]*$/.test(e)}function rh(){var e=Wu.navigator;return e&&(e=e.userAgent)?e:""}function ih(e){return-1!=rh().indexOf(e)}function sh(e){return sh[" "](e),e}sh[" "]=function(){};var oh,ah,lh,ch=ih("Opera"),uh=ih("Trident")||ih("MSIE"),hh=ih("Edge"),dh=hh||uh,fh=ih("Gecko")&&!(-1!=rh().toLowerCase().indexOf("webkit")&&!ih("Edge"))&&!(ih("Trident")||ih("MSIE"))&&!ih("Edge"),ph=-1!=rh().toLowerCase().indexOf("webkit")&&!ih("Edge");function gh(){var e=Wu.document;return e?e.documentMode:void 0}e:{var mh="",vh=(ah=rh(),fh?/rv:([^\);]+)(\)|;)/.exec(ah):hh?/Edge\/([\d\.]+)/.exec(ah):uh?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ah):ph?/WebKit\/(\S+)/.exec(ah):ch?/(?:Version)[ \/]?(\S+)/.exec(ah):void 0);if(vh&&(mh=vh?vh[1]:""),uh){var yh=gh();if(null!=yh&&yh>parseFloat(mh)){oh=String(yh);break e}}oh=mh}if(Wu.document&&uh){var xh=gh();lh=xh||parseInt(oh,10)||void 0}else lh=void 0;var bh=lh;function wh(e,t){if(eh.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(fh){e:{try{sh(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Sh[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&wh.$.h.call(this)}}Gu(wh,eh);var Sh={2:"touch",3:"pen",4:"mouse"};wh.prototype.h=function(){wh.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var kh="closure_listenable_"+(1e6*Math.random()|0),Ch=0;function Eh(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=i,this.key=++Ch,this.fa=this.ia=!1}function Ih(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function Dh(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function Th(e){const t={};for(const n in e)t[n]=e[n];return t}const jh="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _h(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<jh.length;t++)n=jh[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Mh(e){this.src=e,this.g={},this.h=0}function Ph(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Qu(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(Ih(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Ah(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.fa&&s.listener==t&&s.capture==!!n&&s.la==r)return i}return-1}Mh.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=Ah(e,t,r,i);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new Eh(t,this.src,s,!!r,i)).ia=n,e.push(t)),t};var Rh="closure_lm_"+(1e6*Math.random()|0),Oh={};function Nh(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)Nh(e,t[s],n,r,i);return null}return n=Uh(n),e&&e[kh]?e.O(t,n,!!Hu(r)&&!!r.capture,i):function(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=Hu(i)?!!i.capture:!!i,a=zh(e);if(a||(e[Rh]=a=new Mh(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=Bh;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)th||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Vh(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}(e,t,n,!1,r,i)}function Lh(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)Lh(e,t[s],n,r,i);else r=Hu(r)?!!r.capture:!!r,n=Uh(n),e&&e[kh]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=Ah(s=e.g[t],n,r,i))&&(Ih(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--))):e&&(e=zh(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Ah(t,n,r,i)),(n=-1<e?t[e]:null)&&Fh(n))}function Fh(e){if("number"!=typeof e&&e&&!e.fa){var t=e.src;if(t&&t[kh])Ph(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Vh(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=zh(t))?(Ph(n,e),0==n.h&&(n.src=null,t[Rh]=null)):Ih(e)}}}function Vh(e){return e in Oh?Oh[e]:Oh[e]="on"+e}function Bh(e,t){if(e.fa)e=!0;else{t=new wh(t,this);var n=e.listener,r=e.la||e.src;e.ia&&Fh(e),e=n.call(r,t)}return e}function zh(e){return(e=e[Rh])instanceof Mh?e:null}var Wh="__closure_events_fn_"+(1e9*Math.random()>>>0);function Uh(e){return"function"==typeof e?e:(e[Wh]||(e[Wh]=function(t){return e.handleEvent(t)}),e[Wh])}function Hh(){Yu.call(this),this.i=new Mh(this),this.S=this,this.J=null}function $h(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"==typeof t)t=new eh(t,e);else if(t instanceof eh)t.target=t.target||e;else{var i=t;_h(t=new eh(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=qh(o,r,!0,t)&&i}if(i=qh(o=t.g=e,r,!0,t)&&i,i=qh(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=qh(o=t.g=n[s],r,!1,t)&&i}function qh(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&Ph(e.i,o),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}Gu(Hh,Yu),Hh.prototype[kh]=!0,Hh.prototype.removeEventListener=function(e,t,n,r){Lh(this,e,t,n,r)},Hh.prototype.N=function(){if(Hh.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Ih(n[r]);delete t.g[e],t.h--}}this.J=null},Hh.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Hh.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Xh=Wu.JSON.stringify;function Kh(){var e=td;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Gh=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new Yh,e=>e.reset());class Yh{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Qh(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Jh(e){Wu.setTimeout(()=>{throw e},0)}let Zh,ed=!1,td=new class{constructor(){this.h=this.g=null}add(e,t){const n=Gh.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},nd=()=>{const e=Wu.Promise.resolve(void 0);Zh=()=>{e.then(rd)}};var rd=()=>{for(var e;e=Kh();){try{e.h.call(e.g)}catch(n){Jh(n)}var t=Gh;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}ed=!1};function id(e,t){Hh.call(this),this.h=e||1,this.g=t||Wu,this.j=Xu(this.qb,this),this.l=Date.now()}function sd(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function od(e,t,n){if("function"==typeof e)n&&(e=Xu(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Xu(e.handleEvent,e)}return 2147483647<Number(t)?-1:Wu.setTimeout(e,t||0)}function ad(e){e.g=od(()=>{e.g=null,e.i&&(e.i=!1,ad(e))},e.j);const t=e.h;e.h=null,e.m.apply(null,t)}Gu(id,Hh),(Vu=id.prototype).ga=!1,Vu.T=null,Vu.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),$h(this,"tick"),this.ga&&(sd(this),this.start()))}},Vu.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Vu.N=function(){id.$.N.call(this),sd(this),delete this.g};class ld extends Yu{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:ad(this)}N(){super.N(),this.g&&(Wu.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function cd(e){Yu.call(this),this.h=e,this.g={}}Gu(cd,Yu);var ud=[];function hd(e,t,n,r){Array.isArray(n)||(n&&(ud[0]=n.toString()),n=ud);for(var i=0;i<n.length;i++){var s=Nh(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function dd(e){Dh(e.g,function(e,t){this.g.hasOwnProperty(t)&&Fh(e)},e),e.g={}}function fd(){this.g=!0}function pd(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return Xh(n)}catch(a){return t}}(e,n)+(r?" "+r:"")})}cd.prototype.N=function(){cd.$.N.call(this),dd(this)},cd.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fd.prototype.Ea=function(){this.g=!1},fd.prototype.info=function(){};var gd={},md=null;function vd(){return md=md||new Hh}function yd(e){eh.call(this,gd.Ta,e)}function xd(e){const t=vd();$h(t,new yd(t))}function bd(e,t){eh.call(this,gd.STAT_EVENT,e),this.stat=t}function wd(e){const t=vd();$h(t,new bd(t,e))}function Sd(e,t){eh.call(this,gd.Ua,e),this.size=t}function kd(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return Wu.setTimeout(function(){e()},t)}gd.Ta="serverreachability",Gu(yd,eh),gd.STAT_EVENT="statevent",Gu(bd,eh),gd.Ua="timingevent",Gu(Sd,eh);var Cd={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Ed={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Id(){}function Dd(e){return e.h||(e.h=e.i())}function Td(){}Id.prototype.h=null;var jd,_d={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Md(){eh.call(this,"d")}function Pd(){eh.call(this,"c")}function Ad(){}function Rd(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new cd(this),this.P=Nd,e=dh?125:void 0,this.V=new id(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Od}function Od(){this.i=null,this.g="",this.h=!1}Gu(Md,eh),Gu(Pd,eh),Gu(Ad,Id),Ad.prototype.g=function(){return new XMLHttpRequest},Ad.prototype.i=function(){return{}},jd=new Ad;var Nd=45e3,Ld={},Fd={};function Vd(e,t,n){e.L=1,e.v=sf(Zd(t)),e.s=n,e.S=!0,Bd(e,null)}function Bd(e,t){e.G=Date.now(),Hd(e),e.A=Zd(e.v);var n=e.A,r=e.W;Array.isArray(r)||(r=[String(r)]),yf(n.i,"t",r),e.C=0,n=e.l.J,e.h=new Od,e.g=yp(e.l,n?t:null,!e.s),0<e.O&&(e.M=new ld(Xu(e.Pa,e,e.g),e.O)),hd(e.U,e.g,"readystatechange",e.nb),t=e.I?Th(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),xd(),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+c+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.j,e.u,e.A,e.m,e.W,e.s)}function zd(e){return!!e.g&&"GET"==e.u&&2!=e.L&&e.l.Ha}function Wd(e,t,n){let r,i=!0;for(;!e.J&&e.C<n.length;){if(r=Ud(e,n),r==Fd){4==t&&(e.o=4,wd(14),i=!1),pd(e.j,e.m,null,"[Incomplete Response]");break}if(r==Ld){e.o=4,wd(15),pd(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}pd(e.j,e.m,r,null),Gd(e,r)}zd(e)&&r!=Fd&&r!=Ld&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,wd(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),up(t),t.M=!0,wd(11))):(pd(e.j,e.m,n,"[Invalid Chunked Response]"),Kd(e),Xd(e))}function Ud(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Fd:(n=Number(t.substring(n,r)),isNaN(n)?Ld:(r+=1)+n>t.length?Fd:(t=t.slice(r,r+n),e.C=r+n,t))}function Hd(e){e.Y=Date.now()+e.P,$d(e,e.P)}function $d(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=kd(Xu(e.lb,e),t)}function qd(e){e.B&&(Wu.clearTimeout(e.B),e.B=null)}function Xd(e){0==e.l.H||e.J||fp(e.l,e)}function Kd(e){qd(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,sd(e.V),dd(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function Gd(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||Ef(n.i,e)))if(!e.K&&Ef(n.i,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(c){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;dp(n),np(n)}cp(n),wd(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=kd(Xu(n.ib,n),6e3));if(1>=Cf(n.i)&&n.oa){try{n.oa()}catch(c){}n.oa=void 0}}else gp(n,11)}else if((e.K||n.g==e)&&dp(n),!nh(t))for(i=n.Ja.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.V=c[0],c=c[1],2==n.H)if("c"==c[0]){n.K=c[1],n.pa=c[2];const t=c[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const i=c[4];null!=i&&(n.Ga=i,n.l.info("SVER="+n.Ga));const u=c[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.i;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(If(s,s.h),s.h=null))}if(r.F){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.Da=e,rf(r.I,r.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=e;if((r=n).wa=vp(r,r.J?r.pa:null,r.Y),o.K){Df(r.i,o);var a=o,l=r.L;l&&a.setTimeout(l),a.B&&(qd(a),Hd(a)),r.g=o}else lp(r);0<n.j.length&&ip(n)}else"stop"!=c[0]&&"close"!=c[0]||gp(n,7);else 3==n.H&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?gp(n,7):tp(n):"noop"!=c[0]&&n.h&&n.h.Aa(c),n.A=0)}xd()}catch(c){}}function Yd(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Uu(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(Uu(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(Uu(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}(Vu=Rd.prototype).setTimeout=function(e){this.P=e},Vu.nb=function(e){e=e.target;const t=this.M;t&&3==Gf(e)?t.l():this.Pa(e)},Vu.Pa=function(e){try{if(e==this.g)e:{const u=Gf(this.g);var t=this.g.Ia();if(this.g.da(),!(3>u)&&(3!=u||dh||this.g&&(this.h.h||this.g.ja()||Yf(this.g)))){this.J||4!=u||7==t||xd(),qd(this);var n=this.g.da();this.ca=n;t:if(zd(this)){var r=Yf(this.g);e="";var i=r.length,s=4==Gf(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Kd(this),Xd(this);var o="";break t}this.h.i=new Wu.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.splice(0,i),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(e,t,n,r,i,s,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!nh(a)){var c=a;break t}}c=null}if(!(n=c)){this.i=!1,this.o=3,wd(12),Kd(this),Xd(this);break e}pd(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Gd(this,n)}this.S?(Wd(this,u,o),dh&&this.i&&3==u&&(hd(this.U,this.V,"tick",this.mb),this.V.start())):(pd(this.j,this.m,o,null),Gd(this,o)),4==u&&Kd(this),this.i&&!this.J&&(4==u?fp(this.l,this):(this.i=!1,Hd(this)))}else(function(e){const t={};e=(e.g&&2<=Gf(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(nh(e[r]))continue;var n=Qh(e[r]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.o=3,wd(12)):(this.o=0,wd(13)),Kd(this),Xd(this)}}}catch(u){}},Vu.mb=function(){if(this.g){var e=Gf(this.g),t=this.g.ja();this.C<t.length&&(qd(this),Wd(this,e,t),this.i&&4!=e&&Hd(this))}},Vu.cancel=function(){this.J=!0,Kd(this)},Vu.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.L&&(xd(),wd(17)),Kd(this),this.o=2,Xd(this)):$d(this,this.Y-e)};var Qd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Jd(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Jd){this.h=e.h,ef(this,e.j),this.s=e.s,this.g=e.g,tf(this,e.m),this.l=e.l;var t=e.i,n=new pf;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),nf(this,n),this.o=e.o}else e&&(t=String(e).match(Qd))?(this.h=!1,ef(this,t[1]||"",!0),this.s=of(t[2]||""),this.g=of(t[3]||"",!0),tf(this,t[4]),this.l=of(t[5]||"",!0),nf(this,t[6]||"",!0),this.o=of(t[7]||"")):(this.h=!1,this.i=new pf(null,this.h))}function Zd(e){return new Jd(e)}function ef(e,t,n){e.j=n?of(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function tf(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function nf(e,t,n){t instanceof pf?(e.i=t,function(e,t){t&&!e.j&&(gf(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(mf(this,t),yf(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=af(t,df)),e.i=new pf(t,e.h))}function rf(e,t,n){e.i.set(t,n)}function sf(e){return rf(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function of(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function af(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,lf),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function lf(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Jd.prototype.toString=function(){var e=[],t=this.j;t&&e.push(af(t,cf,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(af(t,cf,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(af(n,"/"==n.charAt(0)?hf:uf,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",af(n,ff)),e.join("")};var cf=/[#\/\?@]/g,uf=/[#\?:]/g,hf=/[#\?]/g,df=/[#\?@]/g,ff=/#/g;function pf(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function gf(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function mf(e,t){gf(e),t=xf(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function vf(e,t){return gf(e),t=xf(e,t),e.g.has(t)}function yf(e,t,n){mf(e,t),0<n.length&&(e.i=null,e.g.set(xf(e,t),Ju(n)),e.h+=n.length)}function xf(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(Vu=pf.prototype).add=function(e,t){gf(this),this.i=null,e=xf(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},Vu.forEach=function(e,t){gf(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},Vu.ta=function(){gf(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},Vu.Z=function(e){gf(this);let t=[];if("string"==typeof e)vf(this,e)&&(t=t.concat(this.g.get(xf(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},Vu.set=function(e,t){return gf(this),this.i=null,vf(this,e=xf(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},Vu.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},Vu.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")};var bf=class{constructor(e,t){this.g=e,this.map=t}};function wf(e){this.l=e||Sf,e=Wu.PerformanceNavigationTiming?0<(e=Wu.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(Wu.g&&Wu.g.Ka&&Wu.g.Ka()&&Wu.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Sf=10;function kf(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Cf(e){return e.h?1:e.g?e.g.size:0}function Ef(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function If(e,t){e.g?e.g.add(t):e.h=t}function Df(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Tf(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return Ju(e.i)}wf.prototype.cancel=function(){if(this.i=Tf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var jf=class{stringify(e){return Wu.JSON.stringify(e,void 0)}parse(e){return Wu.JSON.parse(e,void 0)}};function _f(){this.g=new jf}function Mf(e,t,n){const r=n||"";try{Yd(e,function(e,n){let i=e;Hu(e)&&(i=Xh(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function Pf(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(s){}}function Af(e){this.l=e.fc||null,this.j=e.ob||!1}function Rf(e,t){Hh.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=Of,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Gu(Af,Id),Af.prototype.g=function(){return new Rf(this.l,this.j)},Af.prototype.i=function(e){return function(){return e}}({}),Gu(Rf,Hh);var Of=0;function Nf(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function Lf(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Ff(e)}function Ff(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(Vu=Rf.prototype).open=function(e,t){if(this.readyState!=Of)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Ff(this)},Vu.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||Wu).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},Vu.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Lf(this)),this.readyState=Of},Vu.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ff(this)),this.g&&(this.readyState=3,Ff(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Wu.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Nf(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},Vu.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Lf(this):Ff(this),3==this.readyState&&Nf(this)}},Vu.Za=function(e){this.g&&(this.response=this.responseText=e,Lf(this))},Vu.Ya=function(e){this.g&&(this.response=e,Lf(this))},Vu.ka=function(){this.g&&Lf(this)},Vu.setRequestHeader=function(e,t){this.v.append(e,t)},Vu.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},Vu.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Rf.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Vf=Wu.JSON.parse;function Bf(e){Hh.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=zf,this.L=this.M=!1}Gu(Bf,Hh);var zf="",Wf=/^https?$/i,Uf=["POST","PUT"];function Hf(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,$f(e),Xf(e)}function $f(e){e.F||(e.F=!0,$h(e,"complete"),$h(e,"error"))}function qf(e){if(e.h&&void 0!==zu&&(!e.C[1]||4!=Gf(e)||2!=e.da()))if(e.v&&4==Gf(e))od(e.La,0,e);else if($h(e,"readystatechange"),4==Gf(e)){e.h=!1;try{const a=e.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===a){var i=String(e.I).match(Qd)[1]||null;!i&&Wu.self&&Wu.self.location&&(i=Wu.self.location.protocol.slice(0,-1)),r=!Wf.test(i?i.toLowerCase():"")}n=r}if(n)$h(e,"complete"),$h(e,"success");else{e.m=6;try{var s=2<Gf(e)?e.g.statusText:""}catch(o){s=""}e.j=s+" ["+e.da()+"]",$f(e)}}finally{Xf(e)}}}function Xf(e,t){if(e.g){Kf(e);const r=e.g,i=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||$h(e,"ready");try{r.onreadystatechange=i}catch(n){}}}function Kf(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(Wu.clearTimeout(e.A),e.A=null)}function Gf(e){return e.g?e.g.readyState:0}function Yf(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case zf:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Qf(e){let t="";return Dh(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Jf(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Qf(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):rf(e,t,n))}function Zf(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function ep(e){this.Ga=0,this.j=[],this.l=new fd,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Zf("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Zf("baseRetryDelayMs",5e3,e),this.hb=Zf("retryDelaySeedMs",1e4,e),this.eb=Zf("forwardChannelMaxRetries",2,e),this.xa=Zf("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new wf(e&&e.concurrentRequestLimit),this.Ja=new _f,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function tp(e){if(rp(e),3==e.H){var t=e.W++,n=Zd(e.I);if(rf(n,"SID",e.K),rf(n,"RID",t),rf(n,"TYPE","terminate"),op(e,n),(t=new Rd(e,e.l,t)).L=2,t.v=sf(Zd(n)),n=!1,Wu.navigator&&Wu.navigator.sendBeacon)try{n=Wu.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&Wu.Image&&((new Image).src=t.v,n=!0),n||(t.g=yp(t.l,null),t.g.ha(t.v)),t.G=Date.now(),Hd(t)}mp(e)}function np(e){e.g&&(up(e),e.g.cancel(),e.g=null)}function rp(e){np(e),e.u&&(Wu.clearTimeout(e.u),e.u=null),dp(e),e.i.cancel(),e.m&&("number"==typeof e.m&&Wu.clearTimeout(e.m),e.m=null)}function ip(e){if(!kf(e.i)&&!e.m){e.m=!0;var t=e.Na;Zh||nd(),ed||(Zh(),ed=!0),td.add(t,e),e.C=0}}function sp(e,t){var n;n=t?t.m:e.W++;const r=Zd(e.I);rf(r,"SID",e.K),rf(r,"RID",n),rf(r,"AID",e.V),op(e,r),e.o&&e.s&&Jf(r,e.o,e.s),n=new Rd(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=ap(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),If(e.i,n),Vd(n,r,t)}function op(e,t){e.na&&Dh(e.na,function(e,n){rf(t,n,e)}),e.h&&Yd({},function(e,n){rf(t,n,e)})}function ap(e,t,n){n=Math.min(e.j.length,n);var r=e.h?Xu(e.h.Va,e.h,e):null;e:{var i=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let o=!0;for(let a=0;a<n;a++){let n=i[a].g;const l=i[a].map;if(n-=t,0>n)t=Math.max(0,i[a].g-100),o=!1;else try{Mf(l,e,"req"+n+"_")}catch(s){r&&r(l)}}if(o){r=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,r}function lp(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Zh||nd(),ed||(Zh(),ed=!0),td.add(t,e),e.A=0}}function cp(e){return!(e.g||e.u||3<=e.A||(e.ba++,e.u=kd(Xu(e.Ma,e),pp(e,e.A)),e.A++,0))}function up(e){null!=e.B&&(Wu.clearTimeout(e.B),e.B=null)}function hp(e){e.g=new Rd(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=Zd(e.wa);rf(t,"RID","rpc"),rf(t,"SID",e.K),rf(t,"AID",e.V),rf(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&rf(t,"TO",e.qa),rf(t,"TYPE","xmlhttp"),op(e,t),e.o&&e.s&&Jf(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=sf(Zd(t)),n.s=null,n.S=!0,Bd(n,e)}function dp(e){null!=e.v&&(Wu.clearTimeout(e.v),e.v=null)}function fp(e,t){var n=null;if(e.g==t){dp(e),up(e),e.g=null;var r=2}else{if(!Ef(e.i,t))return;n=t.F,Df(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.G;var i=e.C;$h(r=vd(),new Sd(r,n)),ip(e)}else lp(e);else if(3==(i=t.o)||0==i&&0<t.ca||!(1==r&&function(e,t){return!(Cf(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.F.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.cb?0:e.eb)||(e.m=kd(Xu(e.Na,e,t),pp(e,e.C)),e.C++,0)))}(e,t)||2==r&&cp(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:gp(e,5);break;case 4:gp(e,10);break;case 3:gp(e,6);break;default:gp(e,2)}}function pp(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function gp(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=Xu(e.pb,e);n||(n=new Jd("//www.google.com/images/cleardot.gif"),Wu.location&&"http"==Wu.location.protocol||ef(n,"https"),sf(n)),function(e,t){const n=new fd;if(Wu.Image){const r=new Image;r.onload=Ku(Pf,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Ku(Pf,n,r,"TestLoadImage: error",!1,t),r.onabort=Ku(Pf,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Ku(Pf,n,r,"TestLoadImage: timeout",!1,t),Wu.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else wd(2);e.H=0,e.h&&e.h.za(t),mp(e),rp(e)}function mp(e){if(e.H=0,e.ma=[],e.h){const t=Tf(e.i);0==t.length&&0==e.j.length||(Zu(e.ma,t),Zu(e.ma,e.j),e.i.i.length=0,Ju(e.j),e.j.length=0),e.h.ya()}}function vp(e,t,n){var r=n instanceof Jd?Zd(n):new Jd(n);if(""!=r.g)t&&(r.g=t+"."+r.g),tf(r,r.m);else{var i=Wu.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new Jd(null);r&&ef(s,r),t&&(s.g=t),i&&tf(s,i),n&&(s.l=n),r=s}return n=e.F,t=e.Da,n&&t&&rf(r,n,t),rf(r,"VER",e.ra),op(e,r),r}function yp(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new Bf(new Af({ob:!0})):new Bf(e.va)).Oa(e.J),t}function xp(){}function bp(){if(uh&&!(10<=Number(bh)))throw Error("Environmental error: no available transport.")}function wp(e,t){Hh.call(this),this.g=new ep(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!nh(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!nh(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new Cp(this)}function Sp(e){Md.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function kp(){Pd.call(this),this.status=1}function Cp(e){this.g=e}function Ep(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Ip(e,t,n){n||(n=0);var r=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function Dp(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}(Vu=Bf.prototype).Oa=function(e){this.M=e},Vu.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():jd.g(),this.C=this.u?Dd(this.u):Dd(jd),this.g.onreadystatechange=Xu(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(s){return void Hf(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=Wu.FormData&&e instanceof Wu.FormData,!(0<=Qu(Uf,t))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,a]of n)this.g.setRequestHeader(o,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Kf(this),0<this.B&&((this.L=function(e){return uh&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Xu(this.ua,this)):this.A=od(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){Hf(this,s)}},Vu.ua=function(){void 0!==zu&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,$h(this,"timeout"),this.abort(8))},Vu.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,$h(this,"complete"),$h(this,"abort"),Xf(this))},Vu.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Xf(this,!0)),Bf.$.N.call(this)},Vu.La=function(){this.s||(this.G||this.v||this.l?qf(this):this.kb())},Vu.kb=function(){qf(this)},Vu.isActive=function(){return!!this.g},Vu.da=function(){try{return 2<Gf(this)?this.g.status:-1}catch(ah){return-1}},Vu.ja=function(){try{return this.g?this.g.responseText:""}catch(ah){return""}},Vu.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Vf(t)}},Vu.Ia=function(){return this.m},Vu.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Vu=ep.prototype).ra=8,Vu.H=1,Vu.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const i=new Rd(this,this.l,e);let s=this.s;if(this.U&&(s?(s=Th(s),_h(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=ap(this,i,t),rf(n=Zd(this.I),"RID",e),rf(n,"CVER",22),this.F&&rf(n,"X-HTTP-Session-Id",this.F),op(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Qf(s)))+"&"+t:this.o&&Jf(n,this.o,s)),If(this.i,i),this.bb&&rf(n,"TYPE","init"),this.P?(rf(n,"$req",t),rf(n,"SID","null"),i.aa=!0,Vd(i,n,null)):Vd(i,n,t),this.H=2}}else 3==this.H&&(e?sp(this,e):0==this.j.length||kf(this.i)||sp(this))},Vu.Ma=function(){if(this.u=null,hp(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=kd(Xu(this.jb,this),e)}},Vu.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,wd(10),np(this),hp(this))},Vu.ib=function(){null!=this.v&&(this.v=null,np(this),cp(this),wd(19))},Vu.pb=function(e){e?(this.l.info("Successfully pinged google.com"),wd(2)):(this.l.info("Failed to ping google.com"),wd(1))},Vu.isActive=function(){return!!this.h&&this.h.isActive(this)},(Vu=xp.prototype).Ba=function(){},Vu.Aa=function(){},Vu.za=function(){},Vu.ya=function(){},Vu.isActive=function(){return!0},Vu.Va=function(){},bp.prototype.g=function(e,t){return new wp(e,t)},Gu(wp,Hh),wp.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;wd(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=vp(e,null,e.Y),ip(e)},wp.prototype.close=function(){tp(this.g)},wp.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=Xh(e),e=n);t.j.push(new bf(t.fb++,e)),3==t.H&&ip(t)},wp.prototype.N=function(){this.g.h=null,delete this.j,tp(this.g),delete this.g,wp.$.N.call(this)},Gu(Sp,Md),Gu(kp,Pd),Gu(Cp,xp),Cp.prototype.Ba=function(){$h(this.g,"a")},Cp.prototype.Aa=function(e){$h(this.g,new Sp(e))},Cp.prototype.za=function(e){$h(this.g,new kp)},Cp.prototype.ya=function(){$h(this.g,"b")},Gu(Ep,function(){this.blockSize=-1}),Ep.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Ep.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,s=0;s<t;){if(0==i)for(;s<=n;)Ip(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(r[i++]=e.charCodeAt(s++),i==this.blockSize){Ip(this,r),i=0;break}}else for(;s<t;)if(r[i++]=e[s++],i==this.blockSize){Ip(this,r),i=0;break}}this.h=i,this.i+=t},Ep.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var Tp={};function jp(e){return-128<=e&&128>e?function(e,t){var n=Tp;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new Dp([0|e],0>e?-1:0)}):new Dp([0|e],0>e?-1:0)}function _p(e){if(isNaN(e)||!isFinite(e))return Pp;if(0>e)return Lp(_p(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=Mp;return new Dp(t,0)}var Mp=4294967296,Pp=jp(0),Ap=jp(1),Rp=jp(16777216);function Op(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function Np(e){return-1==e.h}function Lp(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new Dp(n,~e.h).add(Ap)}function Fp(e,t){return e.add(Lp(t))}function Vp(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Bp(e,t){this.g=e,this.h=t}function zp(e,t){if(Op(t))throw Error("division by zero");if(Op(e))return new Bp(Pp,Pp);if(Np(e))return t=zp(Lp(e),t),new Bp(Lp(t.g),Lp(t.h));if(Np(t))return t=zp(e,Lp(t)),new Bp(Lp(t.g),t.h);if(30<e.g.length){if(Np(e)||Np(t))throw Error("slowDivide_ only works with positive integers.");for(var n=Ap,r=t;0>=r.X(e);)n=Wp(n),r=Wp(r);var i=Up(n,1),s=Up(r,1);for(r=Up(r,2),n=Up(n,2);!Op(r);){var o=s.add(r);0>=o.X(e)&&(i=i.add(n),s=o),r=Up(r,1),n=Up(n,1)}return t=Fp(e,i.R(t)),new Bp(i,t)}for(i=Pp;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=_p(n)).R(t);Np(o)||0<o.X(e);)o=(s=_p(n-=r)).R(t);Op(s)&&(s=Ap),i=i.add(s),e=Fp(e,o)}return new Bp(i,e)}function Wp(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new Dp(n,e.h)}function Up(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],s=0;s<r;s++)i[s]=0<t?e.D(s+n)>>>t|e.D(s+n+1)<<32-t:e.D(s+n);return new Dp(i,e.h)}(Vu=Dp.prototype).ea=function(){if(Np(this))return-Lp(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:Mp+r)*t,t*=Mp}return e},Vu.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(Op(this))return"0";if(Np(this))return"-"+Lp(this).toString(e);for(var t=_p(Math.pow(e,6)),n=this,r="";;){var i=zp(n,t).g,s=((0<(n=Fp(n,i.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(Op(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},Vu.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},Vu.X=function(e){return Np(e=Fp(this,e))?-1:Op(e)?0:1},Vu.abs=function(){return Np(this)?Lp(this):this},Vu.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var s=r+(65535&this.D(i))+(65535&e.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Dp(n,-2147483648&n[n.length-1]?-1:0)},Vu.R=function(e){if(Op(this)||Op(e))return Pp;if(Np(this))return Np(e)?Lp(this).R(Lp(e)):Lp(Lp(this).R(e));if(Np(e))return Lp(this.R(Lp(e)));if(0>this.X(Rp)&&0>e.X(Rp))return _p(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=e.D(i)>>>16,l=65535&e.D(i);n[2*r+2*i]+=o*l,Vp(n,2*r+2*i),n[2*r+2*i+1]+=s*l,Vp(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Vp(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Vp(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new Dp(n,0)},Vu.gb=function(e){return zp(this,e).h},Vu.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new Dp(n,this.h&e.h)},Vu.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new Dp(n,this.h|e.h)},Vu.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new Dp(n,this.h^e.h)},bp.prototype.createWebChannel=bp.prototype.g,wp.prototype.send=wp.prototype.u,wp.prototype.open=wp.prototype.m,wp.prototype.close=wp.prototype.close,Cd.NO_ERROR=0,Cd.TIMEOUT=8,Cd.HTTP_ERROR=6,Ed.COMPLETE="complete",Td.EventType=_d,_d.OPEN="a",_d.CLOSE="b",_d.ERROR="c",_d.MESSAGE="d",Hh.prototype.listen=Hh.prototype.O,Bf.prototype.listenOnce=Bf.prototype.P,Bf.prototype.getLastError=Bf.prototype.Sa,Bf.prototype.getLastErrorCode=Bf.prototype.Ia,Bf.prototype.getStatus=Bf.prototype.da,Bf.prototype.getResponseJson=Bf.prototype.Wa,Bf.prototype.getResponseText=Bf.prototype.ja,Bf.prototype.send=Bf.prototype.ha,Bf.prototype.setWithCredentials=Bf.prototype.Oa,Ep.prototype.digest=Ep.prototype.l,Ep.prototype.reset=Ep.prototype.reset,Ep.prototype.update=Ep.prototype.j,Dp.prototype.add=Dp.prototype.add,Dp.prototype.multiply=Dp.prototype.R,Dp.prototype.modulo=Dp.prototype.gb,Dp.prototype.compare=Dp.prototype.X,Dp.prototype.toNumber=Dp.prototype.ea,Dp.prototype.toString=Dp.prototype.toString,Dp.prototype.getBits=Dp.prototype.D,Dp.fromNumber=_p,Dp.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return Lp(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=_p(Math.pow(n,8)),i=Pp,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=_p(Math.pow(n,o)),i=i.R(o).add(_p(a))):i=(i=i.R(r)).add(_p(a))}return i};var Hp=Cd,$p=Ed,qp=gd,Xp=10,Kp=11,Gp=Af,Yp=Td,Qp=Bf,Jp=Ep,Zp=Dp;const eg="@firebase/firestore";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class tg{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}tg.UNAUTHENTICATED=new tg(null),tg.GOOGLE_CREDENTIALS=new tg("google-credentials-uid"),tg.FIRST_PARTY=new tg("first-party-uid"),tg.MOCK_USER=new tg("mock-user");
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
let ng="9.23.0";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const rg=new Uo("@firebase/firestore");function ig(){return rg.logLevel}function sg(e,...t){if(rg.logLevel<=Lo.DEBUG){const n=t.map(lg);rg.debug(`Firestore (${ng}): ${e}`,...n)}}function og(e,...t){if(rg.logLevel<=Lo.ERROR){const n=t.map(lg);rg.error(`Firestore (${ng}): ${e}`,...n)}}function ag(e,...t){if(rg.logLevel<=Lo.WARN){const n=t.map(lg);rg.warn(`Firestore (${ng}): ${e}`,...n)}}function lg(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(n){return e}
/**
      * @license
      * Copyright 2020 Google LLC
      *
      * Licensed under the Apache License, Version 2.0 (the "License");
      * you may not use this file except in compliance with the License.
      * You may obtain a copy of the License at
      *
      *   http://www.apache.org/licenses/LICENSE-2.0
      *
      * Unless required by applicable law or agreed to in writing, software
      * distributed under the License is distributed on an "AS IS" BASIS,
      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      * See the License for the specific language governing permissions and
      * limitations under the License.
      */var t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function cg(e="Unexpected state"){const t=`FIRESTORE (${ng}) INTERNAL ASSERTION FAILED: `+e;throw og(t),new Error(t)}function ug(e,t){e||cg()}function hg(e,t){return e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const dg={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class fg extends Co{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class pg{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class gg{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class mg{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(tg.UNAUTHENTICATED))}shutdown(){}}class vg{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class yg{constructor(e){this.t=e,this.currentUser=tg.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new pg;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new pg,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=i;e.enqueueRetryable(()=>g(this,null,function*(){yield t.promise,yield r(this.currentUser)}))},o=e=>{sg("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(sg("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new pg)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(sg("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(ug("string"==typeof t.accessToken),new gg(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ug(null===e||"string"==typeof e),new tg(e)}}class xg{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=tg.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class bg{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new xg(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(tg.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class wg{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Sg{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=e=>{null!=e.error&&sg("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.T;return this.T=e.token,sg("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{sg("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.I.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.I.getImmediate({optional:!0});e?r(e):sg("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(ug("string"==typeof e.token),this.T=e.token,new wg(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function kg(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Cg{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=kg(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function Eg(e,t){return e<t?-1:e>t?1:0}function Ig(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Dg{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new fg(dg.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new fg(dg.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new fg(dg.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new fg(dg.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Dg.fromMillis(Date.now())}static fromDate(e){return Dg.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Dg(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Eg(this.nanoseconds,e.nanoseconds):Eg(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Tg{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Tg(e)}static min(){return new Tg(new Dg(0,0))}static max(){return new Tg(new Dg(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class jg{constructor(e,t,n){void 0===t?t=0:t>e.length&&cg(),void 0===n?n=e.length-t:n>e.length-t&&cg(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===jg.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof jg?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class _g extends jg{construct(e,t,n){return new _g(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new fg(dg.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new _g(t)}static emptyPath(){return new _g([])}}const Mg=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Pg extends jg{construct(e,t,n){return new Pg(e,t,n)}static isValidIdentifier(e){return Mg.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Pg.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Pg(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new fg(dg.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new fg(dg.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new fg(dg.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new fg(dg.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Pg(t)}static emptyPath(){return new Pg([])}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ag{constructor(e){this.path=e}static fromPath(e){return new Ag(_g.fromString(e))}static fromName(e){return new Ag(_g.fromString(e).popFirst(5))}static empty(){return new Ag(_g.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===_g.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return _g.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ag(new _g(e.slice()))}}function Rg(e){return new Og(e.readTime,e.key,-1)}class Og{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Og(Tg.min(),Ag.empty(),-1)}static max(){return new Og(Tg.max(),Ag.empty(),-1)}}function Ng(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Ag.comparator(e.documentKey,t.documentKey),0!==n?n:Eg(e.largestBatchId,t.largestBatchId)
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */)}class Lg{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Fg(e){return g(this,null,function*(){if(e.code!==dg.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;sg("LocalStore","Unexpectedly lost primary lease")})}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Vg{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&cg(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Vg((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Vg?t:Vg.resolve(t)}catch(t){return Vg.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Vg.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Vg.reject(t)}static resolve(e){return new Vg((t,n)=>{t(e)})}static reject(e){return new Vg((t,n)=>{n(e)})}static waitFor(e){return new Vg((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=Vg.resolve(!1);for(const n of e)t=t.next(e=>e?Vg.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new Vg((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next(e=>{s[l]=e,++o,o===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new Vg((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}function Bg(e){return"IndexedDbTransactionError"===e.name}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class zg{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ot(e),this.ut=e=>t.writeSequenceNumber(e))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}function Wg(e){return null==e}function Ug(e){return 0===e&&1/e==-1/0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Hg(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function $g(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function qg(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */zg.ct=-1;class Xg{constructor(e,t){this.comparator=e,this.root=t||Gg.EMPTY}insert(e,t){return new Xg(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Gg.BLACK,null,null))}remove(e){return new Xg(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Gg.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Kg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Kg(this.root,e,this.comparator,!1)}getReverseIterator(){return new Kg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Kg(this.root,e,this.comparator,!0)}}class Kg{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Gg{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Gg.RED,this.left=null!=r?r:Gg.EMPTY,this.right=null!=i?i:Gg.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Gg(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Gg.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Gg.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Gg.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Gg.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw cg();if(this.right.isRed())throw cg();const e=this.left.check();if(e!==this.right.check())throw cg();return e+(this.isRed()?0:1)}}Gg.EMPTY=null,Gg.RED=!0,Gg.BLACK=!1,Gg.EMPTY=new class{constructor(){this.size=0}get key(){throw cg()}get value(){throw cg()}get color(){throw cg()}get left(){throw cg()}get right(){throw cg()}copy(e,t,n,r,i){return this}insert(e,t,n){return new Gg(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Yg{constructor(e){this.comparator=e,this.data=new Xg(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Qg(this.data.getIterator())}getIteratorFrom(e){return new Qg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Yg))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Yg(this.comparator);return t.data=e,t}}class Qg{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Jg{constructor(e){this.fields=e,e.sort(Pg.comparator)}static empty(){return new Jg([])}unionWith(e){let t=new Yg(Pg.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Jg(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ig(this.fields,e.fields,(e,t)=>e.isEqual(t))}}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Zg extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class em{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new Zg("Invalid base64 string: "+t):t}}(e);return new em(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new em(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Eg(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}em.EMPTY_BYTE_STRING=new em("");const tm=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function nm(e){if(ug(!!e),"string"==typeof e){let t=0;const n=tm.exec(e);if(ug(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:rm(e.seconds),nanos:rm(e.nanos)}}function rm(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function im(e){return"string"==typeof e?em.fromBase64String(e):em.fromUint8Array(e)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function sm(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function om(e){const t=e.mapValue.fields.__previous_value__;return sm(t)?om(t):t}function am(e){const t=nm(e.mapValue.fields.__local_write_time__.timestampValue);return new Dg(t.seconds,t.nanos)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class lm{constructor(e,t,n,r,i,s,o,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l}}class cm{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new cm("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof cm&&e.projectId===this.projectId&&e.database===this.database}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const um={};function hm(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?sm(e)?4:function(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e)?9007199254740991:10:cg()}function dm(e,t){if(e===t)return!0;const n=hm(e);if(n!==hm(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return am(e).isEqual(am(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=nm(e.timestampValue),r=nm(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return r=t,im(e.bytesValue).isEqual(im(r.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return rm(e.geoPointValue.latitude)===rm(t.geoPointValue.latitude)&&rm(e.geoPointValue.longitude)===rm(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return rm(e.integerValue)===rm(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=rm(e.doubleValue),r=rm(t.doubleValue);return n===r?Ug(n)===Ug(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Ig(e.arrayValue.values||[],t.arrayValue.values||[],dm);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Hg(n)!==Hg(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!dm(n[i],r[i])))return!1;return!0}(e,t);default:return cg()}var r}function fm(e,t){return void 0!==(e.values||[]).find(e=>dm(e,t))}function pm(e,t){if(e===t)return 0;const n=hm(e),r=hm(t);if(n!==r)return Eg(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Eg(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=rm(e.integerValue||e.doubleValue),r=rm(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return gm(e.timestampValue,t.timestampValue);case 4:return gm(am(e),am(t));case 5:return Eg(e.stringValue,t.stringValue);case 6:return function(e,t){const n=im(e),r=im(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=Eg(n[i],r[i]);if(0!==e)return e}return Eg(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Eg(rm(e.latitude),rm(t.latitude));return 0!==n?n:Eg(rm(e.longitude),rm(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=pm(n[i],r[i]);if(e)return e}return Eg(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===um&&t===um)return 0;if(e===um)return 1;if(t===um)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=Eg(r[o],s[o]);if(0!==e)return e;const t=pm(n[r[o]],i[s[o]]);if(0!==t)return t}return Eg(r.length,s.length)}(e.mapValue,t.mapValue);default:throw cg()}}function gm(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Eg(e,t);const n=nm(e),r=nm(t),i=Eg(n.seconds,r.seconds);return 0!==i?i:Eg(n.nanos,r.nanos)}function mm(e){return vm(e)}function vm(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=nm(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?im(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,Ag.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=vm(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${vm(e.fields[i])}`;return n+"}"}(e.mapValue):cg();var t,n}function ym(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function xm(e){return!!e&&"integerValue"in e}function bm(e){return!!e&&"arrayValue"in e}function wm(e){return!!e&&"nullValue"in e}function Sm(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function km(e){return!!e&&"mapValue"in e}function Cm(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return $g(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Cm(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Cm(e.arrayValue.values[n]);return t}return Object.assign({},e)}class Em{constructor(e){this.value=e}static empty(){return new Em({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!km(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Cm(t)}setAll(e){let t=Pg.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Cm(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());km(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return dm(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];km(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){$g(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new Em(Cm(this.value))}}function Im(e){const t=[];return $g(e.fields,(e,n)=>{const r=new Pg([e]);if(km(n)){const e=Im(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new Jg(t)
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}class Dm{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Dm(e,0,Tg.min(),Tg.min(),Tg.min(),Em.empty(),0)}static newFoundDocument(e,t,n,r){return new Dm(e,1,t,Tg.min(),n,r,0)}static newNoDocument(e,t){return new Dm(e,2,t,Tg.min(),Tg.min(),Em.empty(),0)}static newUnknownDocument(e,t){return new Dm(e,3,t,Tg.min(),Tg.min(),Em.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Tg.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Em.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Em.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Tg.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Dm&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Dm(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Tm{constructor(e,t){this.position=e,this.inclusive=t}}function jm(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?Ag.comparator(Ag.fromName(o.referenceValue),n.key):pm(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function _m(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!dm(e.position[n],t.position[n]))return!1;return!0}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Mm{constructor(e,t="asc"){this.field=e,this.dir=t}}function Pm(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Am{}class Rm extends Am{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new zm(e,t,n):"array-contains"===t?new $m(e,n):"in"===t?new qm(e,n):"not-in"===t?new Xm(e,n):"array-contains-any"===t?new Km(e,n):new Rm(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Wm(e,n):new Um(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(pm(t,this.value)):null!==t&&hm(this.value)===hm(t)&&this.matchesComparison(pm(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return cg()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Om extends Am{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new Om(e,t)}matches(e){return Nm(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(e=>e.isInequality());return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function Nm(e){return"and"===e.op}function Lm(e){return function(e){for(const t of e.filters)if(t instanceof Om)return!1;return!0}(e)&&Nm(e)}function Fm(e){if(e instanceof Rm)return e.field.canonicalString()+e.op.toString()+mm(e.value);if(Lm(e))return e.filters.map(e=>Fm(e)).join(",");{const t=e.filters.map(e=>Fm(e)).join(",");return`${e.op}(${t})`}}function Vm(e,t){return e instanceof Rm?(n=e,(r=t)instanceof Rm&&n.op===r.op&&n.field.isEqual(r.field)&&dm(n.value,r.value)):e instanceof Om?function(e,t){return t instanceof Om&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&Vm(n,t.filters[r]),!0)}(e,t):void cg();var n,r}function Bm(e){return e instanceof Rm?`${(t=e).field.canonicalString()} ${t.op} ${mm(t.value)}`:e instanceof Om?function(e){return e.op.toString()+" {"+e.getFilters().map(Bm).join(" ,")+"}"}(e):"Filter";var t}class zm extends Rm{constructor(e,t,n){super(e,t,n),this.key=Ag.fromName(n.referenceValue)}matches(e){const t=Ag.comparator(e.key,this.key);return this.matchesComparison(t)}}class Wm extends Rm{constructor(e,t){super(e,"in",t),this.keys=Hm(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Um extends Rm{constructor(e,t){super(e,"not-in",t),this.keys=Hm(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Hm(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>Ag.fromName(e.referenceValue))}class $m extends Rm{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return bm(t)&&fm(t.arrayValue,this.value)}}class qm extends Rm{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&fm(this.value.arrayValue,t)}}class Xm extends Rm{constructor(e,t){super(e,"not-in",t)}matches(e){if(fm(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!fm(this.value.arrayValue,t)}}class Km extends Rm{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!bm(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>fm(this.value.arrayValue,e))}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Gm{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.dt=null}}function Ym(e,t=null,n=[],r=[],i=null,s=null,o=null){return new Gm(e,t,n,r,i,s,o)}function Qm(e){const t=hg(e);if(null===t.dt){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Fm(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>{return(t=e).field.canonicalString()+t.dir;var t}).join(","),Wg(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>mm(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>mm(e)).join(",")),t.dt=e}return t.dt}function Jm(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Pm(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Vm(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!_m(e.startAt,t.startAt)&&_m(e.endAt,t.endAt)}function Zm(e){return Ag.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ev{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.wt=null,this._t=null,this.startAt,this.endAt}}function tv(e){return new ev(e)}function nv(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function rv(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function iv(e){for(const t of e.filters){const e=t.getFirstInequalityField();if(null!==e)return e}return null}function sv(e){return null!==e.collectionGroup}function ov(e){const t=hg(e);if(null===t.wt){t.wt=[];const e=iv(t),n=rv(t);if(null!==e&&null===n)e.isKeyField()||t.wt.push(new Mm(e)),t.wt.push(new Mm(Pg.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.wt.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.wt.push(new Mm(Pg.keyField(),e))}}}return t.wt}function av(e){const t=hg(e);if(!t._t)if("F"===t.limitType)t._t=Ym(t.path,t.collectionGroup,ov(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const i of ov(t)){const t="desc"===i.dir?"asc":"desc";e.push(new Mm(i.field,t))}const n=t.endAt?new Tm(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Tm(t.startAt.position,t.startAt.inclusive):null;t._t=Ym(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t._t}function lv(e,t){t.getFirstInequalityField(),iv(e);const n=e.filters.concat([t]);return new ev(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function cv(e,t,n){return new ev(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function uv(e,t){return Jm(av(e),av(t))&&e.limitType===t.limitType}function hv(e){return`${Qm(av(e))}|lt:${e.limitType}`}function dv(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>Bm(e)).join(", ")}]`),Wg(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>{return`${(t=e).field.canonicalString()} (${t.dir})`;var t}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>mm(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>mm(e)).join(",")),`Target(${t})`}(av(e))}; limitType=${e.limitType})`}function fv(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Ag.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of ov(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&(r=t,!((n=e).startAt&&!function(e,t,n){const r=jm(e,t,n);return e.inclusive?r<=0:r<0}(n.startAt,ov(n),r)||n.endAt&&!function(e,t,n){const r=jm(e,t,n);return e.inclusive?r>=0:r>0}(n.endAt,ov(n),r)));var n,r}function pv(e){return(t,n)=>{let r=!1;for(const i of ov(e)){const e=gv(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function gv(e,t,n){const r=e.field.isKeyField()?Ag.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?pm(r,i):cg()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return cg()}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class mv{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){$g(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return qg(this.inner)}size(){return this.innerSize}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const vv=new Xg(Ag.comparator);function yv(){return vv}const xv=new Xg(Ag.comparator);function bv(...e){let t=xv;for(const n of e)t=t.insert(n.key,n);return t}function wv(e){let t=xv;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Sv(){return Cv()}function kv(){return Cv()}function Cv(){return new mv(e=>e.toString(),(e,t)=>e.isEqual(t))}const Ev=new Xg(Ag.comparator),Iv=new Yg(Ag.comparator);function Dv(...e){let t=Iv;for(const n of e)t=t.add(n);return t}const Tv=new Yg(Eg);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function jv(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ug(t)?"-0":t}}function _v(e){return{integerValue:""+e}}function Mv(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!Ug(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?_v(t):jv(e,t)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Pv{constructor(){this._=void 0}}function Av(e,t,n){return e instanceof Nv?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&sm(t)&&(t=om(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Lv?Fv(e,t):e instanceof Vv?Bv(e,t):function(e,t){const n=Ov(e,t),r=Wv(n)+Wv(e.gt);return xm(n)&&xm(e.gt)?_v(r):jv(e.serializer,r)}(e,t)}function Rv(e,t,n){return e instanceof Lv?Fv(e,t):e instanceof Vv?Bv(e,t):n}function Ov(e,t){return e instanceof zv?xm(r=t)||(n=r)&&"doubleValue"in n?t:{integerValue:0}:null;var n,r}class Nv extends Pv{}class Lv extends Pv{constructor(e){super(),this.elements=e}}function Fv(e,t){const n=Uv(t);for(const r of e.elements)n.some(e=>dm(e,r))||n.push(r);return{arrayValue:{values:n}}}class Vv extends Pv{constructor(e){super(),this.elements=e}}function Bv(e,t){let n=Uv(t);for(const r of e.elements)n=n.filter(e=>!dm(e,r));return{arrayValue:{values:n}}}class zv extends Pv{constructor(e,t){super(),this.serializer=e,this.gt=t}}function Wv(e){return rm(e.integerValue||e.doubleValue)}function Uv(e){return bm(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Hv{constructor(e,t){this.version=e,this.transformResults=t}}class $v{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new $v}static exists(e){return new $v(void 0,e)}static updateTime(e){return new $v(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function qv(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Xv{}function Kv(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new iy(e.key,$v.none()):new Zv(e.key,e.data,$v.none());{const n=e.data,r=Em.empty();let i=new Yg(Pg.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new ey(e.key,r,new Jg(i.toArray()),$v.none())}}function Gv(e,t,n){var r;e instanceof Zv?function(e,t,n){const r=e.value.clone(),i=ny(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof ey?function(e,t,n){if(!qv(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=ny(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(ty(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):(r=n,t.convertToNoDocument(r.version).setHasCommittedMutations())}function Yv(e,t,n,r){return e instanceof Zv?function(e,t,n,r){if(!qv(e.precondition,t))return n;const i=e.value.clone(),s=ry(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof ey?function(e,t,n,r){if(!qv(e.precondition,t))return n;const i=ry(e.fieldTransforms,r,t),s=t.data;return s.setAll(ty(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):(i=t,s=n,qv(e.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):s);var i,s}function Qv(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Ov(r.transform,e||null);null!=i&&(null===n&&(n=Em.empty()),n.set(r.field,i))}return n||null}function Jv(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,r=t.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Ig(n,r,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&(n=e.transform,r=t.transform,n instanceof Lv&&r instanceof Lv||n instanceof Vv&&r instanceof Vv?Ig(n.elements,r.elements,dm):n instanceof zv&&r instanceof zv?dm(n.gt,r.gt):n instanceof Nv&&r instanceof Nv);var n,r}(e,t)))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask)));var n,r}class Zv extends Xv{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class ey extends Xv{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function ty(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function ny(e,t,n){const r=new Map;ug(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,Rv(o,a,n[i]))}return r}function ry(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,Av(e,s,t))}return r}class iy extends Xv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class sy extends Xv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class oy{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Gv(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Yv(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Yv(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=kv();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=Kv(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(Tg.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Dv())}isEqual(e){return this.batchId===e.batchId&&Ig(this.mutations,e.mutations,(e,t)=>Jv(e,t))&&Ig(this.baseMutations,e.baseMutations,(e,t)=>Jv(e,t))}}class ay{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){ug(e.mutations.length===n.length);let r=Ev;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new ay(e,t,n,r)}}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ly{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class cy{constructor(e,t){this.count=e,this.unchangedNames=t}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var uy,hy;function dy(e){if(void 0===e)return og("GRPC error has no .code"),dg.UNKNOWN;switch(e){case uy.OK:return dg.OK;case uy.CANCELLED:return dg.CANCELLED;case uy.UNKNOWN:return dg.UNKNOWN;case uy.DEADLINE_EXCEEDED:return dg.DEADLINE_EXCEEDED;case uy.RESOURCE_EXHAUSTED:return dg.RESOURCE_EXHAUSTED;case uy.INTERNAL:return dg.INTERNAL;case uy.UNAVAILABLE:return dg.UNAVAILABLE;case uy.UNAUTHENTICATED:return dg.UNAUTHENTICATED;case uy.INVALID_ARGUMENT:return dg.INVALID_ARGUMENT;case uy.NOT_FOUND:return dg.NOT_FOUND;case uy.ALREADY_EXISTS:return dg.ALREADY_EXISTS;case uy.PERMISSION_DENIED:return dg.PERMISSION_DENIED;case uy.FAILED_PRECONDITION:return dg.FAILED_PRECONDITION;case uy.ABORTED:return dg.ABORTED;case uy.OUT_OF_RANGE:return dg.OUT_OF_RANGE;case uy.UNIMPLEMENTED:return dg.UNIMPLEMENTED;case uy.DATA_LOSS:return dg.DATA_LOSS;default:return cg()}}(hy=uy||(uy={}))[hy.OK=0]="OK",hy[hy.CANCELLED=1]="CANCELLED",hy[hy.UNKNOWN=2]="UNKNOWN",hy[hy.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",hy[hy.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",hy[hy.NOT_FOUND=5]="NOT_FOUND",hy[hy.ALREADY_EXISTS=6]="ALREADY_EXISTS",hy[hy.PERMISSION_DENIED=7]="PERMISSION_DENIED",hy[hy.UNAUTHENTICATED=16]="UNAUTHENTICATED",hy[hy.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",hy[hy.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",hy[hy.ABORTED=10]="ABORTED",hy[hy.OUT_OF_RANGE=11]="OUT_OF_RANGE",hy[hy.UNIMPLEMENTED=12]="UNIMPLEMENTED",hy[hy.INTERNAL=13]="INTERNAL",hy[hy.UNAVAILABLE=14]="UNAVAILABLE",hy[hy.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class fy{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return py}static getOrCreateInstance(){return null===py&&(py=new fy),py}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let py=null;
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const gy=new Zp([4294967295,4294967295],0);function my(e){const t=(new TextEncoder).encode(e),n=new Jp;return n.update(t),new Uint8Array(n.digest())}function vy(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Zp([n,r],0),new Zp([i,s],0)]}class yy{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new xy(`Invalid padding: ${t}`);if(n<0)throw new xy(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new xy(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new xy(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=Zp.fromNumber(this.It)}Et(e,t,n){let r=e.add(t.multiply(Zp.fromNumber(n)));return 1===r.compare(gy)&&(r=new Zp([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Tt).toNumber()}At(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=my(e),[n,r]=vy(t);for(let i=0;i<this.hashCount;i++){const e=this.Et(n,r,i);if(!this.At(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new yy(i,r,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.It)return;const t=my(e),[n,r]=vy(t);for(let i=0;i<this.hashCount;i++){const e=this.Et(n,r,i);this.Rt(e)}}Rt(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class xy extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class by{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,wy.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new by(Tg.min(),r,new Xg(Eg),yv(),Dv())}}class wy{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new wy(n,t,Dv(),Dv(),Dv())}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Sy{constructor(e,t,n,r){this.Pt=e,this.removedTargetIds=t,this.key=n,this.bt=r}}class ky{constructor(e,t){this.targetId=e,this.Vt=t}}class Cy{constructor(e,t,n=em.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Ey{constructor(){this.St=0,this.Dt=Ty(),this.Ct=em.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=Dv(),t=Dv(),n=Dv();return this.Dt.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:cg()}}),new wy(this.Ct,this.xt,e,t,n)}Ft(){this.Nt=!1,this.Dt=Ty()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class Iy{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=yv(),this.zt=Dy(),this.Wt=new Xg(Eg)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const n=this.Zt(t);switch(e.state){case 0:this.te(t)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(t);break;case 3:this.te(t)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),n.$t(e.resumeToken));break;default:cg()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((e,n)=>{this.te(n)&&t(n)})}ne(e){var t;const n=e.targetId,r=e.Vt.count,i=this.se(n);if(i){const s=i.target;if(Zm(s))if(0===r){const e=new Ag(s.path);this.Yt(n,e,Dm.newNoDocument(e,Tg.min()))}else ug(1===r);else{const i=this.ie(n);if(i!==r){const r=this.re(e,i);if(0!==r){this.ee(n);const e=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(n,e)}null===(t=fy.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(e,t,n){var r,i,s,o,a,l;const c={localCacheCount:t,existenceFilterCount:n.count},u=n.unchangedNames;return u&&(c.bloomFilter={applied:0===e,hashCount:null!==(r=null==u?void 0:u.hashCount)&&void 0!==r?r:0,bitmapLength:null!==(o=null===(s=null===(i=null==u?void 0:u.bits)||void 0===i?void 0:i.bitmap)||void 0===s?void 0:s.length)&&void 0!==o?o:0,padding:null!==(l=null===(a=null==u?void 0:u.bits)||void 0===a?void 0:a.padding)&&void 0!==l?l:0}),c}(r,i,e.Vt))}}}}re(e,t){const{unchangedNames:n,count:r}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:i="",padding:s=0},hashCount:o=0}=n;let a,l;try{a=im(i).toUint8Array()}catch(c){if(c instanceof Zg)return ag("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw c}try{l=new yy(a,s,o)}catch(c){return ag(c instanceof xy?"BloomFilter error: ":"Applying bloom filter failed: ",c),1}return 0===l.It?1:r!==t-this.oe(e.targetId,l)?2:0}oe(e,t){const n=this.Gt.getRemoteKeysForTarget(e);let r=0;return n.forEach(n=>{const i=this.Gt.ue(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;t.vt(s)||(this.Yt(e,n,null),r++)}),r}ce(e){const t=new Map;this.Qt.forEach((n,r)=>{const i=this.se(r);if(i){if(n.current&&Zm(i.target)){const t=new Ag(i.target.path);null!==this.jt.get(t)||this.ae(r,t)||this.Yt(r,t,Dm.newNoDocument(t,e))}n.Mt&&(t.set(r,n.Ot()),n.Ft())}});let n=Dv();this.zt.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.se(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.jt.forEach((t,n)=>n.setReadTime(e));const r=new by(e,t,this.Wt,this.jt,n);return this.jt=yv(),this.zt=Dy(),this.Wt=new Xg(Eg),r}Jt(e,t){if(!this.te(e))return;const n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,n){if(!this.te(e))return;const r=this.Zt(e);this.ae(e,t)?r.Bt(t,1):r.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new Ey,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new Yg(Eg),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||sg("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new Ey),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function Dy(){return new Xg(Ag.comparator)}function Ty(){return new Xg(Ag.comparator)}const jy=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),_y=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),My=(()=>({and:"AND",or:"OR"}))();class Py{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ay(e,t){return e.useProto3Json||Wg(t)?t:{value:t}}function Ry(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Oy(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Ny(e,t){return Ry(e,t.toTimestamp())}function Ly(e){return ug(!!e),Tg.fromTimestamp(function(e){const t=nm(e);return new Dg(t.seconds,t.nanos)}(e))}function Fy(e,t){return(n=e,new _g(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function Vy(e){const t=_g.fromString(e);return ug(rx(t)),t}function By(e,t){return Fy(e.databaseId,t.path)}function zy(e,t){const n=Vy(t);if(n.get(1)!==e.databaseId.projectId)throw new fg(dg.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new fg(dg.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Ag(Hy(n))}function Wy(e,t){return Fy(e.databaseId,t)}function Uy(e){return new _g(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Hy(e){return ug(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function $y(e,t,n){return{name:By(e,t),fields:n.value.mapValue.fields}}function qy(e,t){return{documents:[Wy(e,t.path)]}}function Xy(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=Wy(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Wy(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0!==e.length)return tx(Om.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map(e=>{return{field:Zy((t=e).field),direction:Yy(t.dir)};var t})}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=Ay(e,t.limit);var a,l;return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt={before:(a=t.startAt).inclusive,values:a.position}),t.endAt&&(n.structuredQuery.endAt={before:!(l=t.endAt).inclusive,values:l.position}),n}function Ky(e){let t=function(e){const t=Vy(e);return 4===t.length?_g.emptyPath():Hy(t)}(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ug(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Gy(e);return t instanceof Om&&Lm(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(e=>{return new Mm(ex((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Wg(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Tm(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Tm(n,t)}(n.endAt)),function(e,t,n,r,i,s,o,a){return new ev(e,t,n,r,i,s,o,a)}(t,i,o,s,a,"F",l,c)}function Gy(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=ex(e.unaryFilter.field);return Rm.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=ex(e.unaryFilter.field);return Rm.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=ex(e.unaryFilter.field);return Rm.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=ex(e.unaryFilter.field);return Rm.create(i,"!=",{nullValue:"NULL_VALUE"});default:return cg()}}(e):void 0!==e.fieldFilter?(t=e,Rm.create(ex(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return cg()}}(t.fieldFilter.op),t.fieldFilter.value)):void 0!==e.compositeFilter?function(e){return Om.create(e.compositeFilter.filters.map(e=>Gy(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return cg()}}(e.compositeFilter.op))}(e):cg();var t}function Yy(e){return jy[e]}function Qy(e){return _y[e]}function Jy(e){return My[e]}function Zy(e){return{fieldPath:e.canonicalString()}}function ex(e){return Pg.fromServerFormat(e.fieldPath)}function tx(e){return e instanceof Rm?function(e){if("=="===e.op){if(Sm(e.value))return{unaryFilter:{field:Zy(e.field),op:"IS_NAN"}};if(wm(e.value))return{unaryFilter:{field:Zy(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Sm(e.value))return{unaryFilter:{field:Zy(e.field),op:"IS_NOT_NAN"}};if(wm(e.value))return{unaryFilter:{field:Zy(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zy(e.field),op:Qy(e.op),value:e.value}}}(e):e instanceof Om?function(e){const t=e.getFilters().map(e=>tx(e));return 1===t.length?t[0]:{compositeFilter:{op:Jy(e.op),filters:t}}}(e):cg()}function nx(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function rx(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ix{constructor(e,t,n,r,i=Tg.min(),s=Tg.min(),o=em.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new ix(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ix(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ix(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ix(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class sx{constructor(e){this.fe=e}}function ox(e){const t=Ky({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?cv(t,t.limit,"L"):t}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ax{constructor(){this.rn=new lx}addToCollectionParentIndex(e,t){return this.rn.add(t),Vg.resolve()}getCollectionParents(e,t){return Vg.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return Vg.resolve()}deleteFieldIndex(e,t){return Vg.resolve()}getDocumentsMatchingTarget(e,t){return Vg.resolve(null)}getIndexType(e,t){return Vg.resolve(0)}getFieldIndexes(e,t){return Vg.resolve([])}getNextCollectionGroupToUpdate(e){return Vg.resolve(null)}getMinOffset(e,t){return Vg.resolve(Og.min())}getMinOffsetFromCollectionGroup(e,t){return Vg.resolve(Og.min())}updateCollectionGroup(e,t,n){return Vg.resolve()}updateIndexEntries(e,t){return Vg.resolve()}}class lx{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Yg(_g.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Yg(_g.comparator)).toArray()}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class cx{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new cx(0)}static Mn(){return new cx(-1)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ux{constructor(){this.changes=new mv(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Dm.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Vg.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class hx{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class dx{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&Yv(n.mutation,e,Jg.empty(),Dg.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Dv()).next(()=>t))}getLocalViewOfDocuments(e,t,n=Dv()){const r=Sv();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=bv();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Sv();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Dv()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=yv();const s=Cv(),o=Cv();return t.forEach((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof ey)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),Yv(o.mutation,t,o.mutation.getFieldMask(),Dg.now())):s.set(t.key,Jg.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new hx(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){const n=Cv();let r=new Xg((e,t)=>e-t),i=Dv();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||Jg.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||Dv()).add(e);r=r.insert(i.batchId,a)})}).next(()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,l=r.value,c=kv();l.forEach(e=>{if(!i.has(e)){const r=Kv(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return Vg.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n){return r=t,Ag.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):sv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var r}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Vg.resolve(Sv());let o=-1,a=i;return s.next(t=>Vg.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?Vg.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,a,t,Dv())).next(e=>({batchId:o,changes:wv(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ag(t)).next(e=>{let t=bv();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n){const r=t.collectionGroup;let i=bv();return this.indexManager.getCollectionParents(e,r).next(s=>Vg.forEach(s,s=>{const o=(a=t,l=s.child(r),new ev(l,null,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt));var a,l;return this.getDocumentsMatchingCollectionQuery(e,o,n).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(i=>(r=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r))).next(e=>{r.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Dm.newInvalidDocument(r)))});let n=bv();return e.forEach((e,i)=>{const s=r.get(e);void 0!==s&&Yv(s.mutation,i,Jg.empty(),Dg.now()),fv(t,i)&&(n=n.insert(e,i))}),n})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class fx{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return Vg.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:Ly(n.createTime)}),Vg.resolve()}getNamedQuery(e,t){return Vg.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,{name:(n=t).name,query:ox(n.bundledQuery),readTime:Ly(n.readTime)}),Vg.resolve();var n}}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class px{constructor(){this.overlays=new Xg(Ag.comparator),this.ls=new Map}getOverlay(e,t){return Vg.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Sv();return Vg.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.we(e,t,r)}),Vg.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.ls.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.ls.delete(n)),Vg.resolve()}getOverlaysForCollection(e,t,n){const r=Sv(),i=t.length+1,s=new Ag(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Vg.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Xg((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Sv(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Sv(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return Vg.resolve(o)}we(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.ls.get(r.largestBatchId).delete(n.key);this.ls.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new ly(t,n));let i=this.ls.get(t);void 0===i&&(i=Dv(),this.ls.set(t,i)),this.ls.set(t,i.add(n.key))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class gx{constructor(){this.fs=new Yg(mx.ds),this.ws=new Yg(mx._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new mx(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.ys(new mx(e,t))}ps(e,t){e.forEach(e=>this.removeReference(e,t))}Is(e){const t=new Ag(new _g([])),n=new mx(t,e),r=new mx(t,e+1),i=[];return this.ws.forEachInRange([n,r],e=>{this.ys(e),i.push(e.key)}),i}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new Ag(new _g([])),n=new mx(t,e),r=new mx(t,e+1);let i=Dv();return this.ws.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new mx(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class mx{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return Ag.comparator(e.key,t.key)||Eg(e.As,t.As)}static _s(e,t){return Eg(e.As,t.As)||Ag.comparator(e.key,t.key)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class vx{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new Yg(mx.ds)}checkEmpty(e){return Vg.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new oy(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.Rs=this.Rs.add(new mx(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Vg.resolve(s)}lookupMutationBatch(e,t){return Vg.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.bs(n),i=r<0?0:r;return Vg.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Vg.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return Vg.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new mx(t,0),r=new mx(t,Number.POSITIVE_INFINITY),i=[];return this.Rs.forEachInRange([n,r],e=>{const t=this.Ps(e.As);i.push(t)}),Vg.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Yg(Eg);return t.forEach(e=>{const t=new mx(e,0),r=new mx(e,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([t,r],e=>{n=n.add(e.As)})}),Vg.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Ag.isDocumentKey(i)||(i=i.child(""));const s=new mx(new Ag(i),0);let o=new Yg(Eg);return this.Rs.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.As)),!0)},s),Vg.resolve(this.Vs(o))}Vs(e){const t=[];return e.forEach(e=>{const n=this.Ps(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){ug(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return Vg.forEach(t.mutations,r=>{const i=new mx(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Rs=n})}Cn(e){}containsKey(e,t){const n=new mx(t,0),r=this.Rs.firstAfterOrEqual(n);return Vg.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Vg.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class yx{constructor(e){this.Ds=e,this.docs=new Xg(Ag.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Vg.resolve(n?n.document.mutableCopy():Dm.newInvalidDocument(t))}getEntries(e,t){let n=yv();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Dm.newInvalidDocument(e))}),Vg.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=yv();const s=t.path,o=new Ag(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Ng(Rg(o),n)<=0||(r.has(o.key)||fv(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return Vg.resolve(i)}getAllFromCollectionGroup(e,t,n,r){cg()}Cs(e,t){return Vg.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new xx(this)}getSize(e){return Vg.resolve(this.size)}}class xx extends ux{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.os.addEntry(e,r)):this.os.removeEntry(n)}),Vg.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class bx{constructor(e){this.persistence=e,this.xs=new mv(e=>Qm(e),Jm),this.lastRemoteSnapshotVersion=Tg.min(),this.highestTargetId=0,this.Ns=0,this.ks=new gx,this.targetCount=0,this.Ms=cx.kn()}forEachTarget(e,t){return this.xs.forEach((e,n)=>t(n)),Vg.resolve()}getLastRemoteSnapshotVersion(e){return Vg.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Vg.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),Vg.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),Vg.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new cx(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,Vg.resolve()}updateTargetData(e,t){return this.Fn(t),Vg.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,Vg.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.xs.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.xs.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),Vg.waitFor(i).next(()=>r)}getTargetCount(e){return Vg.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return Vg.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),Vg.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),Vg.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),Vg.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return Vg.resolve(n)}containsKey(e,t){return Vg.resolve(this.ks.containsKey(t))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class wx{constructor(e,t){this.$s={},this.overlays={},this.Os=new zg(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new bx(this),this.indexManager=new ax,this.remoteDocumentCache=new yx(e=>this.referenceDelegate.Ls(e)),this.serializer=new sx(t),this.qs=new fx(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new px,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new vx(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){sg("MemoryPersistence","Starting transaction:",e);const r=new Sx(this.Os.next());return this.referenceDelegate.Us(),n(r).next(e=>this.referenceDelegate.Ks(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Gs(e,t){return Vg.or(Object.values(this.$s).map(n=>()=>n.containsKey(e,t)))}}class Sx extends Lg{constructor(e){super(),this.currentSequenceNumber=e}}class kx{constructor(e){this.persistence=e,this.Qs=new gx,this.js=null}static zs(e){return new kx(e)}get Ws(){if(this.js)return this.js;throw cg()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),Vg.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),Vg.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),Vg.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(e=>this.Ws.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.Ws.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Vg.forEach(this.Ws,n=>{const r=Ag.fromPath(n);return this.Hs(e,r).next(e=>{e||t.removeEntry(r,Tg.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(e=>{e?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return Vg.or([()=>Vg.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Cx{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=r}static Li(e,t){let n=Dv(),r=Dv();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Cx(e,t.fromCache,n,r)}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ex{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,r){return this.Ki(e,t).next(i=>i||this.Gi(e,t,r,n)).next(n=>n||this.Qi(e,t))}Ki(e,t){if(nv(t))return Vg.resolve(null);let n=av(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=cv(t,null,"F"),n=av(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=Dv(...r);return this.Ui.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.ji(t,r);return this.zi(t,s,i,n.readTime)?this.Ki(e,cv(t,null,"F")):this.Wi(e,s,t,n)}))})))}Gi(e,t,n,r){return nv(t)||r.isEqual(Tg.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next(i=>{const s=this.ji(t,i);return this.zi(t,s,n,r)?this.Qi(e,t):(ig()<=Lo.DEBUG&&sg("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),dv(t)),this.Wi(e,s,t,function(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Tg.fromTimestamp(1e9===r?new Dg(n+1,0):new Dg(n,r));return new Og(i,Ag.empty(),t)}(r,-1)))})}ji(e,t){let n=new Yg(pv(e));return t.forEach((t,r)=>{fv(e,r)&&(n=n.add(r))}),n}zi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Qi(e,t){return ig()<=Lo.DEBUG&&sg("QueryEngine","Using full collection scan to execute query:",dv(t)),this.Ui.getDocumentsMatchingQuery(e,t,Og.min())}Wi(e,t,n,r){return this.Ui.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ix{constructor(e,t,n,r){this.persistence=e,this.Hi=t,this.serializer=r,this.Ji=new Xg(Eg),this.Yi=new mv(e=>Qm(e),Jm),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new dx(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function Dx(e,t){return g(this,null,function*(){const n=hg(e);return yield n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.tr(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let o=Dv();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({er:e,removedBatchIds:i,addedBatchIds:s}))})})})}function Tx(e){const t=hg(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Bs.getLastRemoteSnapshotVersion(e))}function jx(e,t){const n=hg(e),r=t.snapshotVersion;let i=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.Zi.newChangeBuffer({trackRemovals:!0});i=n.Ji;const o=[];t.targetChanges.forEach((s,a)=>{const l=i.get(a);if(!l)return;o.push(n.Bs.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.Bs.addMatchingKeys(e,s.addedDocuments,a)));let c=l.withSequenceNumber(e.currentSequenceNumber);var u,h,d;null!==t.targetMismatches.get(a)?c=c.withResumeToken(em.EMPTY_BYTE_STRING,Tg.min()).withLastLimboFreeSnapshotVersion(Tg.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(a,c),h=c,d=s,(0===(u=l).resumeToken.approximateByteSize()||h.snapshotVersion.toMicroseconds()-u.snapshotVersion.toMicroseconds()>=3e8||d.addedDocuments.size+d.modifiedDocuments.size+d.removedDocuments.size>0)&&o.push(n.Bs.updateTargetData(e,c))});let a=yv(),l=Dv();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(function(e,t,n){let r=Dv(),i=Dv();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=yv();return n.forEach((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(Tg.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):sg("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{nr:r,sr:i}})}(e,s,t.documentUpdates).next(e=>{a=e.nr,l=e.sr})),!r.isEqual(Tg.min())){const t=n.Bs.getLastRemoteSnapshotVersion(e).next(t=>n.Bs.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return Vg.waitFor(o).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,l)).next(()=>a)}).then(e=>(n.Ji=i,e))}function _x(e,t){const n=hg(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function Mx(e,t,n){return g(this,null,function*(){const r=hg(e),i=r.Ji.get(t),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(o){if(!Bg(o))throw o;sg("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}r.Ji=r.Ji.remove(t),r.Yi.delete(i.target)})}function Px(e,t,n){const r=hg(e);let i=Tg.min(),s=Dv();return r.persistence.runTransaction("Execute query","readonly",e=>function(e,t,n){const r=hg(e),i=r.Yi.get(n);return void 0!==i?Vg.resolve(r.Ji.get(i)):r.Bs.getTargetData(t,n)}(r,e,av(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.Hi.getDocumentsMatchingQuery(e,t,n?i:Tg.min(),n?s:Dv())).next(e=>(function(e,t,n){let r=e.Xi.get(t)||Tg.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Xi.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,ir:s})))}class Ax{constructor(){this.activeTargetIds=Tv}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Rx{constructor(){this.Hr=new Ax,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new Ax,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ox{Yr(e){}shutdown(){}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Nx{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){sg("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){sg("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */let Lx=null;function Fx(){return null===Lx?Lx=268435456+Math.round(2147483648*Math.random()):Lx++,"0x"+Lx.toString(16)
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}const Vx={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Bx{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const zx="WebChannelConnection";class Wx extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.mo=t+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,r,i){const s=Fx(),o=this.To(e,t);sg("RestConnection",`Sending RPC '${e}' ${s}:`,o,n);const a={};return this.Eo(a,r,i),this.Ao(e,o,a,n).then(t=>(sg("RestConnection",`Received RPC '${e}' ${s}: `,t),t),t=>{throw ag("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t})}vo(e,t,n,r,i,s){return this.Io(e,t,n,r,i)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+ng,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}To(e,t){const n=Vx[e];return`${this.mo}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,r){const i=Fx();return new Promise((s,o)=>{const a=new Qp;a.setWithCredentials(!0),a.listenOnce($p.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Hp.NO_ERROR:const t=a.getResponseJson();sg(zx,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case Hp.TIMEOUT:sg(zx,`RPC '${e}' ${i} timed out`),o(new fg(dg.DEADLINE_EXCEEDED,"Request time out"));break;case Hp.HTTP_ERROR:const n=a.getStatus();if(sg(zx,`RPC '${e}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(dg).indexOf(t)>=0?t:dg.UNKNOWN}(t.status);o(new fg(e,t.message))}else o(new fg(dg.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new fg(dg.UNAVAILABLE,"Connection failed."));break;default:cg()}}finally{sg(zx,`RPC '${e}' ${i} completed.`)}});const l=JSON.stringify(r);sg(zx,`RPC '${e}' ${i} sending request:`,r),a.send(t,"POST",l,n,15)})}Ro(e,t,n){const r=Fx(),i=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=new bp,o=vd(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.xmlHttpFactory=new Gp({})),this.Eo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const c=i.join("");sg(zx,`Creating RPC '${e}' stream ${r}: ${c}`,a);const u=s.createWebChannel(c,a);let h=!1,d=!1;const f=new Bx({ro:t=>{d?sg(zx,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(h||(sg(zx,`Opening RPC '${e}' stream ${r} transport.`),u.open(),h=!0),sg(zx,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},oo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(t){setTimeout(()=>{throw t},0)}})};return p(u,Yp.EventType.OPEN,()=>{d||sg(zx,`RPC '${e}' stream ${r} transport opened.`)}),p(u,Yp.EventType.CLOSE,()=>{d||(d=!0,sg(zx,`RPC '${e}' stream ${r} transport closed`),f.wo())}),p(u,Yp.EventType.ERROR,t=>{d||(d=!0,ag(zx,`RPC '${e}' stream ${r} transport errored:`,t),f.wo(new fg(dg.UNAVAILABLE,"The operation could not be completed")))}),p(u,Yp.EventType.MESSAGE,t=>{var n;if(!d){const i=t.data[0];ug(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){sg(zx,`RPC '${e}' stream ${r} received error:`,o);const t=o.status;let n=function(e){const t=uy[e];if(void 0!==t)return dy(t)}(t),i=o.message;void 0===n&&(n=dg.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),d=!0,f.wo(new fg(n,i)),u.close()}else sg(zx,`RPC '${e}' stream ${r} received:`,i),f._o(i)}}),p(o,qp.STAT_EVENT,t=>{t.stat===Xp?sg(zx,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===Kp&&sg(zx,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{f.fo()},0),f}}function Ux(){return"undefined"!=typeof document?document:null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Hx(e){return new Py(e,!0)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class $x{constructor(e,t,n=1e3,r=1.5,i=6e4){this.ii=e,this.timerId=t,this.Po=n,this.bo=r,this.Vo=i,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),r=Math.max(0,t-n);r>0&&sg("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,r,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class qx{constructor(e,t,n,r,i,s,o,a){this.ii=e,this.$o=n,this.Oo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new $x(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}stop(){return g(this,null,function*(){this.Uo()&&(yield this.close(0))})}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}zo(){return g(this,null,function*(){if(this.Ko())return this.close(0)})}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}close(e,t){return g(this,null,function*(){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,4!==e?this.qo.reset():t&&t.code===dg.RESOURCE_EXHAUSTED?(og(t.toString()),og("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):t&&t.code===dg.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.ao(t)})}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,n])=>{this.Fo===t&&this.Zo(e,n)},t=>{e(()=>{const e=new fg(dg.UNKNOWN,"Fetching auth token failed: "+t.message);return this.tu(e)})})}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{n(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(e=>{n(()=>this.tu(e))}),this.stream.onMessage(e=>{n(()=>this.onMessage(e))})}Go(){this.state=5,this.qo.No(()=>g(this,null,function*(){this.state=0,this.start()}))}tu(e){return sg("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(sg("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Xx extends qx{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:cg(),s=t.targetChange.targetIds||[],o=function(e,t){return e.useProto3Json?(ug(void 0===t||"string"==typeof t),em.fromBase64String(t||"")):(ug(void 0===t||t instanceof Uint8Array),em.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,l=a&&function(e){const t=void 0===e.code?dg.UNKNOWN:dy(e.code);return new fg(t,e.message||"")}(a);n=new Cy(i,s,o,l||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=zy(e,r.document.name),s=Ly(r.document.updateTime),o=r.document.createTime?Ly(r.document.createTime):Tg.min(),a=new Em({mapValue:{fields:r.document.fields}}),l=Dm.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Sy(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=zy(e,r.document),s=r.readTime?Ly(r.readTime):Tg.min(),o=Dm.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Sy([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=zy(e,r.document),s=r.removedTargetIds||[];n=new Sy([],s,i,null)}else{if(!("filter"in t))return cg();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new cy(r,i),o=e.targetId;n=new ky(o,s)}}var r;return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Tg.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Tg.min():t.readTime?Ly(t.readTime):Tg.min()}(e);return this.listener.nu(t,n)}su(e){const t={};t.database=Uy(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Zm(r)?{documents:qy(e,r)}:{query:Xy(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Oy(e,t.resumeToken);const r=Ay(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Tg.min())>0){n.readTime=Ry(e,t.snapshotVersion.toTimestamp());const r=Ay(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return cg()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.Wo(t)}iu(e){const t={};t.database=Uy(this.serializer),t.removeTarget=e,this.Wo(t)}}class Kx extends qx{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(ug(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function(e,t){return e&&e.length>0?(ug(void 0!==t),e.map(e=>function(e,t){let n=e.updateTime?Ly(e.updateTime):Ly(t);return n.isEqual(Tg.min())&&(n=Ly(t)),new Hv(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Ly(e.commitTime);return this.listener.cu(n,t)}return ug(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=Uy(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>function(e,t){let n;if(t instanceof Zv)n={update:$y(e,t.key,t.value)};else if(t instanceof iy)n={delete:By(e,t.key)};else if(t instanceof ey)n={update:$y(e,t.key,t.data),updateMask:nx(t.fieldMask)};else{if(!(t instanceof sy))return cg();n={verify:By(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof Nv)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Lv)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Vv)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof zv)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw cg()}(0,e))),t.precondition.isNone||(n.currentDocument=(r=e,void 0!==(i=t.precondition).updateTime?{updateTime:Ny(r,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:cg())),n;var r,i}(this.serializer,e))};this.Wo(t)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Gx extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.lu=!1}fu(){if(this.lu)throw new fg(dg.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,i])=>this.connection.Io(e,t,n,r,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===dg.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new fg(dg.UNKNOWN,e.toString())})}vo(e,t,n,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.vo(e,t,n,i,s,r)).catch(e=>{throw"FirebaseError"===e.name?(e.code===dg.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new fg(dg.UNKNOWN,e.toString())})}terminate(){this.lu=!0}}class Yx{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(og(t),this.mu=!1):sg("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Qx{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=i,this.Pu.Yr(e=>{n.enqueueAndForget(()=>g(this,null,function*(){ob(this)&&(sg("RemoteStore","Restarting streams for network reachability change."),yield function(e){return g(this,null,function*(){const t=hg(e);t.vu.add(4),yield Zx(t),t.bu.set("Unknown"),t.vu.delete(4),yield Jx(t)})}(this))}))}),this.bu=new Yx(n,r)}}function Jx(e){return g(this,null,function*(){if(ob(e))for(const t of e.Ru)yield t(!0)})}function Zx(e){return g(this,null,function*(){for(const t of e.Ru)yield t(!1)})}function eb(e,t){const n=hg(e);n.Au.has(t.targetId)||(n.Au.set(t.targetId,t),sb(n)?ib(n):kb(n).Ko()&&nb(n,t))}function tb(e,t){const n=hg(e),r=kb(n);n.Au.delete(t),r.Ko()&&rb(n,t),0===n.Au.size&&(r.Ko()?r.jo():ob(n)&&n.bu.set("Unknown"))}function nb(e,t){if(e.Vu.qt(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Tg.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}kb(e).su(t)}function rb(e,t){e.Vu.qt(t),kb(e).iu(t)}function ib(e){e.Vu=new Iy({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),le:t=>e.Au.get(t)||null,ue:()=>e.datastore.serializer.databaseId}),kb(e).start(),e.bu.gu()}function sb(e){return ob(e)&&!kb(e).Uo()&&e.Au.size>0}function ob(e){return 0===hg(e).vu.size}function ab(e){e.Vu=void 0}function lb(e){return g(this,null,function*(){e.Au.forEach((t,n)=>{nb(e,t)})})}function cb(e,t){return g(this,null,function*(){ab(e),sb(e)?(e.bu.Iu(t),ib(e)):e.bu.set("Unknown")})}function ub(e,t,n){return g(this,null,function*(){if(e.bu.set("Online"),t instanceof Cy&&2===t.state&&t.cause)try{yield function(e,t){return g(this,null,function*(){const n=t.cause;for(const r of t.targetIds)e.Au.has(r)&&(yield e.remoteSyncer.rejectListen(r,n),e.Au.delete(r),e.Vu.removeTarget(r))})}(e,t)}catch(r){sg("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),yield hb(e,r)}else if(t instanceof Sy?e.Vu.Ht(t):t instanceof ky?e.Vu.ne(t):e.Vu.Xt(t),!n.isEqual(Tg.min()))try{const t=yield Tx(e.localStore);n.compareTo(t)>=0&&(yield function(e,t){const n=e.Vu.ce(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Au.get(r);i&&e.Au.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Au.get(t);if(!r)return;e.Au.set(t,r.withResumeToken(em.EMPTY_BYTE_STRING,r.snapshotVersion)),rb(e,t);const i=new ix(r.target,t,n,r.sequenceNumber);nb(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n))}catch(i){sg("RemoteStore","Failed to raise snapshot:",i),yield hb(e,i)}})}function hb(e,t,n){return g(this,null,function*(){if(!Bg(t))throw t;e.vu.add(1),yield Zx(e),e.bu.set("Offline"),n||(n=()=>Tx(e.localStore)),e.asyncQueue.enqueueRetryable(()=>g(this,null,function*(){sg("RemoteStore","Retrying IndexedDB access"),yield n(),e.vu.delete(1),yield Jx(e)}))})}function db(e,t){return t().catch(n=>hb(e,n,t))}function fb(e){return g(this,null,function*(){const t=hg(e),n=Cb(t);let r=t.Eu.length>0?t.Eu[t.Eu.length-1].batchId:-1;for(;pb(t);)try{const e=yield _x(t.localStore,r);if(null===e){0===t.Eu.length&&n.jo();break}r=e.batchId,gb(t,e)}catch(i){yield hb(t,i)}mb(t)&&vb(t)})}function pb(e){return ob(e)&&e.Eu.length<10}function gb(e,t){e.Eu.push(t);const n=Cb(e);n.Ko()&&n.ou&&n.uu(t.mutations)}function mb(e){return ob(e)&&!Cb(e).Uo()&&e.Eu.length>0}function vb(e){Cb(e).start()}function yb(e){return g(this,null,function*(){Cb(e).hu()})}function xb(e){return g(this,null,function*(){const t=Cb(e);for(const n of e.Eu)t.uu(n.mutations)})}function bb(e,t,n){return g(this,null,function*(){const r=e.Eu.shift(),i=ay.from(r,t,n);yield db(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),yield fb(e)})}function wb(e,t){return g(this,null,function*(){t&&Cb(e).ou&&(yield function(e,t){return g(this,null,function*(){if(function(e){switch(e){default:return cg();case dg.CANCELLED:case dg.UNKNOWN:case dg.DEADLINE_EXCEEDED:case dg.RESOURCE_EXHAUSTED:case dg.INTERNAL:case dg.UNAVAILABLE:case dg.UNAUTHENTICATED:return!1;case dg.INVALID_ARGUMENT:case dg.NOT_FOUND:case dg.ALREADY_EXISTS:case dg.PERMISSION_DENIED:case dg.FAILED_PRECONDITION:case dg.ABORTED:case dg.OUT_OF_RANGE:case dg.UNIMPLEMENTED:case dg.DATA_LOSS:return!0}}(n=t.code)&&n!==dg.ABORTED){const n=e.Eu.shift();Cb(e).Qo(),yield db(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),yield fb(e)}var n})}(e,t)),mb(e)&&vb(e)})}function Sb(e,t){return g(this,null,function*(){const n=hg(e);n.asyncQueue.verifyOperationInProgress(),sg("RemoteStore","RemoteStore received new credentials");const r=ob(n);n.vu.add(3),yield Zx(n),r&&n.bu.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(t),n.vu.delete(3),yield Jx(n)})}function kb(e){return e.Su||(e.Su=function(e,t,n){const r=hg(e);return r.fu(),new Xx(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:lb.bind(null,e),ao:cb.bind(null,e),nu:ub.bind(null,e)}),e.Ru.push(t=>g(this,null,function*(){t?(e.Su.Qo(),sb(e)?ib(e):e.bu.set("Unknown")):(yield e.Su.stop(),ab(e))}))),e.Su}function Cb(e){return e.Du||(e.Du=function(e,t,n){const r=hg(e);return r.fu(),new Kx(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:yb.bind(null,e),ao:wb.bind(null,e),au:xb.bind(null,e),cu:bb.bind(null,e)}),e.Ru.push(t=>g(this,null,function*(){t?(e.Du.Qo(),yield fb(e)):(yield e.Du.stop(),e.Eu.length>0&&(sg("RemoteStore",`Stopping write stream with ${e.Eu.length} pending writes`),e.Eu=[]))}))),e.Du
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}class Eb{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new pg,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new Eb(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new fg(dg.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ib(e,t){if(og("AsyncQueue",`${t}: ${e}`),Bg(e))return new fg(dg.UNAVAILABLE,`${t}: ${e}`);throw e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Db{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Ag.comparator(t.key,n.key):(e,t)=>Ag.comparator(e.key,t.key),this.keyedMap=bv(),this.sortedSet=new Xg(this.comparator)}static emptySet(e){return new Db(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Db))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Db;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Tb{constructor(){this.Cu=new Xg(Ag.comparator)}track(e){const t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):cg():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,n)=>{e.push(n)}),e}}class jb{constructor(e,t,n,r,i,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new jb(e,t,Db.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&uv(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class _b{constructor(){this.Nu=void 0,this.listeners=[]}}class Mb{constructor(){this.queries=new mv(e=>hv(e),uv),this.onlineState="Unknown",this.ku=new Set}}function Pb(e,t){const n=hg(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.listeners)e.$u(i)&&(r=!0);t.Nu=i}}r&&Rb(n)}function Ab(e,t,n){const r=hg(e),i=r.queries.get(t);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(t)}function Rb(e){e.ku.forEach(e=>{e.next()})}class Ob{constructor(e,t,n){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new jb(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.Ku||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){if(e.docChanges.length>0)return!0;const t=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Uu(e){e=jb.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Nb{constructor(e){this.key=e}}class Lb{constructor(e){this.key=e}}class Fb{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=Dv(),this.mutatedKeys=Dv(),this.tc=pv(e),this.ec=new Db(this.tc)}get nc(){return this.Yu}sc(e,t){const n=t?t.ic:new Tb,r=t?t.ec:this.ec;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=fv(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.rc(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.tc(u,a)>0||l&&this.tc(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{ec:s,ic:n,zi:o,mutatedKeys:i}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const i=e.ic.xu();i.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return cg()}};return n(e)-n(t)}(e.type,t.type)||this.tc(e.doc,t.doc)),this.oc(n);const s=t?this.uc():[],o=0===this.Zu.size&&this.current?1:0,a=o!==this.Xu;return this.Xu=o,0!==i.length||a?{snapshot:new jb(this.query,e.ec,r,i,e.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:s}:{cc:s}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new Tb,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(e=>this.Yu=this.Yu.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Yu=this.Yu.delete(e)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=Dv(),this.ec.forEach(e=>{this.ac(e.key)&&(this.Zu=this.Zu.add(e.key))});const t=[];return e.forEach(e=>{this.Zu.has(e)||t.push(new Lb(e))}),this.Zu.forEach(n=>{e.has(n)||t.push(new Nb(n))}),t}hc(e){this.Yu=e.ir,this.Zu=Dv();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return jb.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class Vb{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Bb{constructor(e){this.key=e,this.fc=!1}}class zb{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.dc={},this.wc=new mv(e=>hv(e),uv),this._c=new Map,this.mc=new Set,this.gc=new Xg(Ag.comparator),this.yc=new Map,this.Ic=new gx,this.Tc={},this.Ec=new Map,this.Ac=cx.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function Wb(e,t){return g(this,null,function*(){const n=function(e){const t=hg(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=$b.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=sw.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Xb.bind(null,t),t.dc.nu=Pb.bind(null,t.eventManager),t.dc.Pc=Ab.bind(null,t.eventManager),t}(e);let r,i;const s=n.wc.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.lc();else{const e=yield function(e,t){const n=hg(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Bs.getTargetData(e,t).next(i=>i?(r=i,Vg.resolve(r)):n.Bs.allocateTargetId(e).next(i=>(r=new ix(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Bs.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ji.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(e.targetId,e),n.Yi.set(t,e.targetId)),e})}(n.localStore,av(t)),s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=yield function(e,t,n,r,i){return g(this,null,function*(){e.Rc=(t,n,r)=>function(e,t,n,r){return g(this,null,function*(){let i=t.view.sc(n);i.zi&&(i=yield Px(e.localStore,t.query,!1).then(({documents:e})=>t.view.sc(e,i)));const s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return ew(e,t.targetId,o.cc),o.snapshot})}(e,t,n,r);const s=yield Px(e.localStore,t,!0),o=new Fb(t,s.ir),a=o.sc(s.documents),l=wy.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=o.applyChanges(a,e.isPrimaryClient,l);ew(e,n,c.cc);const u=new Vb(t,n,o);return e.wc.set(t,u),e._c.has(n)?e._c.get(n).push(t):e._c.set(n,[t]),c.snapshot})}(n,t,r,"current"===s,e.resumeToken),n.isPrimaryClient&&eb(n.remoteStore,e)}return i})}function Ub(e,t){return g(this,null,function*(){const n=hg(e),r=n.wc.get(t),i=n._c.get(r.targetId);if(i.length>1)return n._c.set(r.targetId,i.filter(e=>!uv(e,t))),void n.wc.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Mx(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),tb(n.remoteStore,r.targetId),Jb(n,r.targetId)}).catch(Fg))):(Jb(n,r.targetId),yield Mx(n.localStore,r.targetId,!0))})}function Hb(e,t,n){return g(this,null,function*(){const r=function(e){const t=hg(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Kb.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Gb.bind(null,t),t}(e);try{const e=yield function(e,t){const n=hg(e),r=Dg.now(),i=t.reduce((e,t)=>e.add(t.key),Dv());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=yv(),l=Dv();return n.Zi.getEntries(e,i).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(i=>{s=i;const o=[];for(const e of t){const t=Qv(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new ey(e.key,t,Im(t.value.mapValue),$v.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)}).next(t=>{o=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:o.batchId,changes:wv(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Tc[e.currentUser.toKey()];r||(r=new Xg(Eg)),r=r.insert(t,n),e.Tc[e.currentUser.toKey()]=r}(r,e.batchId,n),yield rw(r,e.changes),yield fb(r.remoteStore)}catch(i){const e=Ib(i,"Failed to persist write");n.reject(e)}})}function $b(e,t){return g(this,null,function*(){const n=hg(e);try{const e=yield jx(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.yc.get(t);r&&(ug(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.fc=!0:e.modifiedDocuments.size>0?ug(r.fc):e.removedDocuments.size>0&&(ug(r.fc),r.fc=!1))}),yield rw(n,e,t)}catch(r){yield Fg(r)}})}function qb(e,t,n){const r=hg(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.wc.forEach((n,r)=>{const i=r.view.Mu(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=hg(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.listeners)i.Mu(t)&&(r=!0)}),r&&Rb(n)}(r.eventManager,t),e.length&&r.dc.nu(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function Xb(e,t,n){return g(this,null,function*(){const r=hg(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.yc.get(t),s=i&&i.key;if(s){let e=new Xg(Ag.comparator);e=e.insert(s,Dm.newNoDocument(s,Tg.min()));const n=Dv().add(s),i=new by(Tg.min(),new Map,new Xg(Eg),e,n);yield $b(r,i),r.gc=r.gc.remove(s),r.yc.delete(t),nw(r)}else yield Mx(r.localStore,t,!1).then(()=>Jb(r,t,n)).catch(Fg)})}function Kb(e,t){return g(this,null,function*(){const n=hg(e),r=t.batch.batchId;try{const e=yield function(e,t){const n=hg(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.Zi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=Vg.resolve();return s.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);ug(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Dv();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);Qb(n,r,null),Yb(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield rw(n,e)}catch(i){yield Fg(i)}})}function Gb(e,t,n){return g(this,null,function*(){const r=hg(e);try{const e=yield function(e,t){const n=hg(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(ug(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);Qb(r,t,n),Yb(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),yield rw(r,e)}catch(i){yield Fg(i)}})}function Yb(e,t){(e.Ec.get(t)||[]).forEach(e=>{e.resolve()}),e.Ec.delete(t)}function Qb(e,t,n){const r=hg(e);let i=r.Tc[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Tc[r.currentUser.toKey()]=i}}function Jb(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e._c.get(t))e.wc.delete(r),n&&e.dc.Pc(r,n);e._c.delete(t),e.isPrimaryClient&&e.Ic.Is(t).forEach(t=>{e.Ic.containsKey(t)||Zb(e,t)})}function Zb(e,t){e.mc.delete(t.path.canonicalString());const n=e.gc.get(t);null!==n&&(tb(e.remoteStore,n),e.gc=e.gc.remove(t),e.yc.delete(n),nw(e))}function ew(e,t,n){for(const r of n)r instanceof Nb?(e.Ic.addReference(r.key,t),tw(e,r)):r instanceof Lb?(sg("SyncEngine","Document no longer in limbo: "+r.key),e.Ic.removeReference(r.key,t),e.Ic.containsKey(r.key)||Zb(e,r.key)):cg()}function tw(e,t){const n=t.key,r=n.path.canonicalString();e.gc.get(n)||e.mc.has(r)||(sg("SyncEngine","New document in limbo: "+n),e.mc.add(r),nw(e))}function nw(e){for(;e.mc.size>0&&e.gc.size<e.maxConcurrentLimboResolutions;){const t=e.mc.values().next().value;e.mc.delete(t);const n=new Ag(_g.fromString(t)),r=e.Ac.next();e.yc.set(r,new Bb(n)),e.gc=e.gc.insert(n,r),eb(e.remoteStore,new ix(av(tv(n.path)),r,"TargetPurposeLimboResolution",zg.ct))}}function rw(e,t,n){return g(this,null,function*(){const r=hg(e),i=[],s=[],o=[];r.wc.isEmpty()||(r.wc.forEach((e,a)=>{o.push(r.Rc(a,t,n).then(e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);const t=Cx.Li(a.targetId,e);s.push(t)}}))}),yield Promise.all(o),r.dc.nu(i),yield function(e,t){return g(this,null,function*(){const n=hg(e);try{yield n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Vg.forEach(t,t=>Vg.forEach(t.Fi,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>Vg.forEach(t.Bi,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(r){if(!Bg(r))throw r;sg("LocalStore","Failed to update sequence numbers: "+r)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.Ji.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.Ji=n.Ji.insert(t,i)}}})}(r.localStore,s))})}function iw(e,t){return g(this,null,function*(){const n=hg(e);if(!n.currentUser.isEqual(t)){sg("SyncEngine","User change. New user:",t.toKey());const e=yield Dx(n.localStore,t);n.currentUser=t,(r=n).Ec.forEach(e=>{e.forEach(e=>{e.reject(new fg(dg.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),r.Ec.clear(),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),yield rw(n,e.er)}var r})}function sw(e,t){const n=hg(e),r=n.yc.get(t);if(r&&r.fc)return Dv().add(r.key);{let e=Dv();const r=n._c.get(t);if(!r)return e;for(const t of r){const r=n.wc.get(t);e=e.unionWith(r.view.nc)}return e}}class ow{constructor(){this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){this.serializer=Hx(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return function(e,t,n,r){return new Ix(e,t,n,r)}(this.persistence,new Ex,e.initialUser,this.serializer)}createPersistence(e){return new wx(kx.zs,this.serializer)}createSharedClientState(e){return new Rx}terminate(){return g(this,null,function*(){this.gcScheduler&&this.gcScheduler.stop(),yield this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}class aw{initialize(e,t){return g(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>qb(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=iw.bind(null,this.syncEngine),yield function(e,t){return g(this,null,function*(){const n=hg(e);t?(n.vu.delete(2),yield Jx(n)):t||(n.vu.add(2),yield Zx(n),n.bu.set("Unknown"))})}(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return new Mb}createDatastore(e){const t=Hx(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new Wx(r));var r,i,s;return i=e.authCredentials,s=e.appCheckCredentials,new Gx(i,s,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>qb(this.syncEngine,e,0),s=Nx.D()?new Nx:new Ox,new Qx(t,n,r,i,s);var t,n,r,i,s}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new zb(e,t,n,r,i,s);return o&&(a.vc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return function(e){return g(this,null,function*(){const t=hg(e);sg("RemoteStore","RemoteStore shutting down."),t.vu.add(5),yield Zx(t),t.Pu.shutdown(),t.bu.set("Unknown")})}(this.remoteStore)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class lw{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):og("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class cw{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=tg.UNAUTHENTICATED,this.clientId=Cg.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,e=>g(this,null,function*(){sg("FirestoreClient","Received user=",e.uid),yield this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,e=>(sg("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}getConfiguration(){return g(this,null,function*(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}})}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new fg(dg.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new pg;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Ib(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}function uw(e,t){return g(this,null,function*(){e.asyncQueue.verifyOperationInProgress(),sg("FirestoreClient","Initializing OfflineComponentProvider");const n=yield e.getConfiguration();yield t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(e=>g(this,null,function*(){r.isEqual(e)||(yield Dx(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t})}function hw(e,t){return g(this,null,function*(){e.asyncQueue.verifyOperationInProgress();const n=yield function(e){return g(this,null,function*(){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){sg("FirestoreClient","Using user provided OfflineComponentProvider");try{yield uw(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!function(e){return"FirebaseError"===e.name?e.code===dg.FAILED_PRECONDITION||e.code===dg.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(r))throw r;ag("Error using user provided cache. Falling back to memory cache: "+r),yield uw(e,new ow)}}else sg("FirestoreClient","Using default OfflineComponentProvider"),yield uw(e,new ow);return e._offlineComponents})}(e);sg("FirestoreClient","Initializing OnlineComponentProvider");const r=yield e.getConfiguration();yield t.initialize(n,r),e.setCredentialChangeListener(e=>Sb(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>Sb(t.remoteStore,n)),e._onlineComponents=t})}function dw(e){return g(this,null,function*(){return e._onlineComponents||(e._uninitializedComponentsProvider?(sg("FirestoreClient","Using user provided OnlineComponentProvider"),yield hw(e,e._uninitializedComponentsProvider._online)):(sg("FirestoreClient","Using default OnlineComponentProvider"),yield hw(e,new aw))),e._onlineComponents})}function fw(e){return g(this,null,function*(){const t=yield dw(e),n=t.eventManager;return n.onListen=Wb.bind(null,t.syncEngine),n.onUnlisten=Ub.bind(null,t.syncEngine),n})}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function pw(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}const gw=new Map;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function mw(e,t,n){if(!n)throw new fg(dg.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function vw(e){if(!Ag.isDocumentKey(e))throw new fg(dg.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function yw(e){if(Ag.isDocumentKey(e))throw new fg(dg.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function xw(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const n=(t=e).constructor?t.constructor.name:null;return n?`a custom ${n} object`:"an object"}}var t;return"function"==typeof e?"a function":cg()}function bw(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new fg(dg.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=xw(e);throw new fg(dg.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ww{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new fg(dg.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new fg(dg.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new fg(dg.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=pw(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new fg(dg.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new fg(dg.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new fg(dg.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}class Sw{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ww({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new fg(dg.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new fg(dg.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ww(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new mg;switch(e.type){case"firstParty":return new bg(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new fg(dg.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=gw.get(e);t&&(sg("ComponentProvider","Removing Datastore"),gw.delete(e),t.terminate())}(this),Promise.resolve()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class kw{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ew(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new kw(this.firestore,e,this._key)}}class Cw{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Cw(this.firestore,e,this._query)}}class Ew extends Cw{constructor(e,t,n){super(e,t,tv(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new kw(this.firestore,null,new Ag(e))}withConverter(e){return new Ew(this.firestore,e,this._path)}}function Iw(e,t,...n){if(e=Po(e),1===arguments.length&&(t=Cg.A()),mw("doc","path",t),e instanceof Sw){const r=_g.fromString(t,...n);return vw(r),new kw(e,null,new Ag(r))}{if(!(e instanceof kw||e instanceof Ew))throw new fg(dg.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(_g.fromString(t,...n));return vw(r),new kw(e.firestore,e instanceof Ew?e.converter:null,new Ag(r))}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Dw{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new $x(this,"async_queue_retry"),this.Xc=()=>{const e=Ux();e&&sg("AsyncQueue","Visibility state changed to "+e.visibilityState),this.qo.Mo()};const e=Ux();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=Ux();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new pg;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}ea(){return g(this,null,function*(){if(0!==this.Qc.length){try{yield this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!Bg(e))throw e;sg("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No(()=>this.ea())}})}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(e=>{throw this.Wc=e,this.Hc=!1,og("INTERNAL UNHANDLED ERROR: ",function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e}).then(e=>(this.Hc=!1,e))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const r=Eb.createAndSchedule(this,e,t,n,e=>this.na(e));return this.zc.push(r),r}Zc(){this.Wc&&cg()}verifyOperationInProgress(){}sa(){return g(this,null,function*(){let e;do{e=this.Gc,yield e}while(e!==this.Gc)})}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function Tw(e){return function(e){if("object"!=typeof e||null===e)return!1;const t=e;for(const n of["next","error","complete"])if(n in t&&"function"==typeof t[n])return!0;return!1}(e)}class jw extends Sw{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Dw,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Mw(this),this._firestoreClient.terminate()}}function _w(e){return e._firestoreClient||Mw(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Mw(e){var t,n,r;const i=e._freezeSettings(),s=(o=e._databaseId,a=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",l=e._persistenceKey,new lm(o,a,l,(c=i).host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,pw(c.experimentalLongPollingOptions),c.useFetchStreams));var o,a,l,c;e._firestoreClient=new cw(e._authCredentials,e._appCheckCredentials,e._queue,s),(null===(n=i.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.cache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Pw{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Pw(em.fromBase64String(e))}catch(t){throw new fg(dg.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Pw(em.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Aw{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new fg(dg.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Pg(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Rw{constructor(e){this._methodName=e}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ow{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new fg(dg.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new fg(dg.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Eg(this._lat,e._lat)||Eg(this._long,e._long)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Nw=/^__.*__$/;class Lw{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new ey(e,this.data,this.fieldMask,t,this.fieldTransforms):new Zv(e,this.data,t,this.fieldTransforms)}}class Fw{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new ey(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Vw(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw cg()}}class Bw{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.ua(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new Bw(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.fa(e),r}da(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.ua(),r}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return Jw(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(Vw(this.ca)&&Nw.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class zw{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Hx(e)}ya(e,t,n,r=!1){return new Bw({ca:e,methodName:t,ga:n,path:Pg.emptyPath(),la:!1,ma:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ww(e){const t=e._freezeSettings(),n=Hx(e._databaseId);return new zw(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Uw(e,t,n,r,i,s={}){const o=e.ya(s.merge||s.mergeFields?2:0,t,n,i);Kw("Data must be an object, but it was:",o,r);const a=qw(r,o);let l,c;if(s.merge)l=new Jg(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=Gw(t,r,n);if(!o.contains(i))throw new fg(dg.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Zw(e,i)||e.push(i)}l=new Jg(e),c=o.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=o.fieldTransforms;return new Lw(new Em(a),l,c)}class Hw extends Rw{_toFieldTransform(e){if(2!==e.ca)throw 1===e.ca?e._a(`${this._methodName}() can only appear at the top level of your update data`):e._a(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Hw}}function $w(e,t){if(Xw(e=Po(e)))return Kw("Unsupported field value:",t,e),qw(e,t);if(e instanceof Rw)return function(e,t){if(!Vw(t.ca))throw t._a(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t._a(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.la&&4!==t.ca)throw t._a("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=$w(i,t.wa(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Po(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Mv(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Dg.fromDate(e);return{timestampValue:Ry(t.serializer,n)}}if(e instanceof Dg){const n=new Dg(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Ry(t.serializer,n)}}if(e instanceof Ow)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Pw)return{bytesValue:Oy(t.serializer,e._byteString)};if(e instanceof kw){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t._a(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Fy(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t._a(`Unsupported field value: ${xw(e)}`)}(e,t)}function qw(e,t){const n={};return qg(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):$g(e,(e,r)=>{const i=$w(r,t.ha(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function Xw(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Dg||e instanceof Ow||e instanceof Pw||e instanceof kw||e instanceof Rw)}function Kw(e,t,n){if(!Xw(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=xw(n);throw"an object"===r?t._a(e+" a custom object"):t._a(e+" "+r)}var r}function Gw(e,t,n){if((t=Po(t))instanceof Aw)return t._internalPath;if("string"==typeof t)return Qw(e,t);throw Jw("Field path arguments must be of type string or ",e,!1,void 0,n)}const Yw=new RegExp("[~\\*/\\[\\]]");function Qw(e,t,n){if(t.search(Yw)>=0)throw Jw(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Aw(...t.split("."))._internalPath}catch(r){throw Jw(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Jw(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new fg(dg.INVALID_ARGUMENT,a+e+l)}function Zw(e,t){return e.some(e=>e.isEqual(t))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class eS{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new kw(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new tS(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(nS("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class tS extends eS{data(){return super.data()}}function nS(e,t){return"string"==typeof t?Qw(e,t):t instanceof Aw?t._internalPath:t._delegate._internalPath}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class rS{}class iS extends rS{}class sS extends iS{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new sS(e,t,n)}_apply(e){const t=this._parse(e);return uS(e._query,t),new Cw(e.firestore,e.converter,lv(e._query,t))}_parse(e){const t=Ww(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new fg(dg.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){cS(o,s);const t=[];for(const n of o)t.push(lS(r,e,n));a={arrayValue:{values:t}}}else a=lS(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||cS(o,s),a=function(e,t,n,r=!1){return $w(n,e.ya(r?4:3,t))}(n,"where",o,"in"===s||"not-in"===s);return Rm.create(i,s,a)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class oS extends rS{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new oS(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:Om.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)uS(n,i),n=lv(n,i)}(e._query,t),new Cw(e.firestore,e.converter,lv(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class aS extends iS{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new aS(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new fg(dg.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new fg(dg.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new Mm(t,n);return function(e,t){if(null===rv(e)){const n=iv(e);null!==n&&hS(0,n,t.field)}}(e,r),r}(e._query,this._field,this._direction);return new Cw(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new ev(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function lS(e,t,n){if("string"==typeof(n=Po(n))){if(""===n)throw new fg(dg.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sv(t)&&-1!==n.indexOf("/"))throw new fg(dg.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(_g.fromString(n));if(!Ag.isDocumentKey(r))throw new fg(dg.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ym(e,new Ag(r))}if(n instanceof kw)return ym(e,n._key);throw new fg(dg.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${xw(n)}.`)}function cS(e,t){if(!Array.isArray(e)||0===e.length)throw new fg(dg.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function uS(e,t){if(t.isInequality()){const n=iv(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new fg(dg.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${r.toString()}'`);const i=rv(e);null!==i&&hS(0,r,i)}const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new fg(dg.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new fg(dg.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function hS(e,t,n){if(!n.isEqual(t))throw new fg(dg.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class dS{convertValue(e,t="none"){switch(hm(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rm(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(im(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw cg()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return $g(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertGeoPoint(e){return new Ow(rm(e.latitude),rm(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=om(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(am(e));default:return null}}convertTimestamp(e){const t=nm(e);return new Dg(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=_g.fromString(e);ug(rx(n));const r=new cm(n.get(1),n.get(3)),i=new Ag(n.popFirst(5));return r.isEqual(t)||og(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class fS{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class pS extends eS{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new gS(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(nS("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class gS extends pS{data(e={}){return super.data(e)}}class mS{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new fS(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new gS(this._firestore,this._userDataWriter,n.key,n,new fS(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new fg(dg.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new gS(e._firestore,e._userDataWriter,n.doc.key,n.doc,new fS(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new gS(e._firestore,e._userDataWriter,t.doc.key,t.doc,new fS(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:vS(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function vS(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return cg()}}class yS extends dS{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pw(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new kw(this.firestore,null,t)}}function xS(e,t,n,...r){e=bw(e,kw);const i=bw(e.firestore,jw),s=Ww(i);let o;return o="string"==typeof(t=Po(t))||t instanceof Aw?function(e,t,n,r,i,s){const o=e.ya(1,t,n),a=[Gw(t,r,n)],l=[i];if(s.length%2!=0)throw new fg(dg.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(Gw(t,s[d])),l.push(s[d+1]);const c=[],u=Em.empty();for(let d=a.length-1;d>=0;--d)if(!Zw(c,a[d])){const e=a[d];let t=l[d];t=Po(t);const n=o.da(e);if(t instanceof Hw)c.push(e);else{const r=$w(t,n);null!=r&&(c.push(e),u.set(e,r))}}const h=new Jg(c);return new Fw(u,h,o.fieldTransforms)}(s,"updateDoc",e._key,t,n,r):function(e,t,n,r){const i=e.ya(1,t,n);Kw("Data must be an object, but it was:",i,r);const s=[],o=Em.empty();$g(r,(e,r)=>{const a=Qw(t,e,n);r=Po(r);const l=i.da(a);if(r instanceof Hw)s.push(a);else{const e=$w(r,l);null!=e&&(s.push(a),o.set(a,e))}});const a=new Jg(s);return new Fw(o,a,i.fieldTransforms)}(s,"updateDoc",e._key,t),wS(i,[o.toMutation(e._key,$v.exists(!0))])}function bS(e,...t){var n,r,i;e=Po(e);let s={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||Tw(t[o])||(s=t[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(Tw(t[o])){const e=t[o];t[o]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[o+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[o+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let l,c,u;if(e instanceof kw)c=bw(e.firestore,jw),u=tv(e._key.path),l={next:n=>{t[o]&&t[o](function(e,t,n){const r=n.docs.get(t._key),i=new yS(e);return new pS(e,i,t._key,r,new fS(n.hasPendingWrites,n.fromCache),t.converter)}(c,e,n))},error:t[o+1],complete:t[o+2]};else{const n=bw(e,Cw);c=bw(n.firestore,jw),u=n._query;const r=new yS(c);l={next:e=>{t[o]&&t[o](new mS(c,r,n,e))},error:t[o+1],complete:t[o+2]},function(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new fg(dg.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(e._query)}return function(e,t,n,r){const i=new lw(r),s=new Ob(t,i,n);return e.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(t,n){return g(this,null,function*(){const r=hg(t),i=n.query;let s=!1,o=r.queries.get(i);if(o||(s=!0,o=new _b),s)try{o.Nu=yield r.onListen(i)}catch(e){const r=Ib(e,`Initialization of query '${dv(n.query)}' failed`);return void n.onError(r)}r.queries.set(i,o),o.listeners.push(n),n.Mu(r.onlineState),o.Nu&&n.$u(o.Nu)&&Rb(r)})}(yield fw(e),s)})),()=>{i.Dc(),e.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(e,t){return g(this,null,function*(){const n=hg(e),r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)})}(yield fw(e),s)}))}}(_w(c),u,a,l)}function wS(e,t){return function(e,t){const n=new pg;return e.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return Hb(yield function(e){return dw(e).then(e=>e.syncEngine)}(e),t,n)})),n.promise}(_w(e),t)}!function(e,t=!0){ng=Ha,Ba(new Ao("firestore",(e,{instanceIdentifier:n,options:r})=>{const i=e.getProvider("app").getImmediate(),s=new jw(new yg(e.getProvider("auth-internal")),new Sg(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new fg(dg.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new cm(e.options.projectId,t)}(i,n),i);return r=Object.assign({useFetchStreams:t},r),s._setSettings(r),s},"PUBLIC").setMultipleInstances(!0)),Xa(eg,"3.13.0",e),Xa(eg,"3.13.0","esm2017")}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const SS="firebasestorage.googleapis.com";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class kS extends Co{constructor(e,t,n=0){super(TS(e),`Firebase Storage: ${t} (${TS(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,kS.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return TS(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var CS,ES,IS,DS;function TS(e){return"storage/"+e}function jS(e){return new kS(CS.INVALID_ARGUMENT,e)}function _S(){return new kS(CS.APP_DELETED,"The Firebase app was deleted.")}(ES=CS||(CS={})).UNKNOWN="unknown",ES.OBJECT_NOT_FOUND="object-not-found",ES.BUCKET_NOT_FOUND="bucket-not-found",ES.PROJECT_NOT_FOUND="project-not-found",ES.QUOTA_EXCEEDED="quota-exceeded",ES.UNAUTHENTICATED="unauthenticated",ES.UNAUTHORIZED="unauthorized",ES.UNAUTHORIZED_APP="unauthorized-app",ES.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",ES.INVALID_CHECKSUM="invalid-checksum",ES.CANCELED="canceled",ES.INVALID_EVENT_NAME="invalid-event-name",ES.INVALID_URL="invalid-url",ES.INVALID_DEFAULT_BUCKET="invalid-default-bucket",ES.NO_DEFAULT_BUCKET="no-default-bucket",ES.CANNOT_SLICE_BLOB="cannot-slice-blob",ES.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",ES.NO_DOWNLOAD_URL="no-download-url",ES.INVALID_ARGUMENT="invalid-argument",ES.INVALID_ARGUMENT_COUNT="invalid-argument-count",ES.APP_DELETED="app-deleted",ES.INVALID_ROOT_OPERATION="invalid-root-operation",ES.INVALID_FORMAT="invalid-format",ES.INTERNAL_ERROR="internal-error",ES.UNSUPPORTED_ENVIRONMENT="unsupported-environment";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class MS{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=MS.makeFromUrl(e,t)}catch(i){return new MS(e,"")}if(""===n.path)return n;throw r=e,new kS(CS.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)",i=new RegExp("^gs://"+r+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),a=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp(`^https?://${t===SS?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let l=0;l<a.length;l++){const t=a[l],r=t.regex.exec(e);if(r){const e=r[t.indices.bucket];let i=r[t.indices.path];i||(i=""),n=new MS(e,i),t.postModify(n);break}}if(null==n)throw function(e){return new kS(CS.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class PS{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function AS(e,t,n,r){if(r<t)throw jS(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw jS(`Invalid value for '${e}'. Expected ${n} or less.`)}(DS=IS||(IS={}))[DS.NO_ERROR=0]="NO_ERROR",DS[DS.NETWORK_ERROR=1]="NETWORK_ERROR",DS[DS.ABORT=2]="ABORT";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class RS{constructor(e,t,n,r,i,s,o,a,l,c,u,h=!0){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=l,this.progressCallback_=c,this.connectionFactory_=u,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new OS(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===IS.NO_ERROR,i=n.getStatus();if(!t||
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}(i,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===IS.ABORT;return void e(!1,new OS(!1,null,t))}const s=-1!==this.successCodes_.indexOf(i);e(!0,new OS(s,n))})},t=(e,t)=>{const n=this.resolve_,r=this.reject_,i=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(i,i.getResponse());void 0!==e?n(e):n()}catch(s){r(s)}else if(null!==i){const e=new kS(CS.UNKNOWN,"An unknown error occurred, please check the error payload for server response.");e.serverResponse=i.getErrorText(),this.errorCallback_?r(this.errorCallback_(i,e)):r(e)}else t.canceled?r(this.appDelete_?_S():new kS(CS.CANCELED,"User canceled the upload/download.")):r(new kS(CS.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))};this.canceled_?t(0,new OS(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return 2===a}let c=!1;function u(...e){c||(c=!0,t.apply(null,e))}function h(t){i=setTimeout(()=>{i=null,e(f,l())},t)}function d(){s&&clearTimeout(s)}function f(e,...t){if(c)return void d();if(e)return d(),void u.call(null,e,...t);if(l()||o)return d(),void u.call(null,e,...t);let n;r<64&&(r*=2),1===a?(a=2,n=0):n=1e3*(r+Math.random()),h(n)}let p=!1;function g(e){p||(p=!0,d(),c||(null!==i?(e||(a=2),clearTimeout(i),h(0)):e||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,g(!0)},n),g}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class OS{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function NS(e,t,n,r,i,s,o=!0){const a=function(e){const t=encodeURIComponent;let n="?";for(const r in e)e.hasOwnProperty(r)&&(n=n+(t(r)+"=")+t(e[r])+"&");return n=n.slice(0,-1),n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e.urlParams),l=e.url+a,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(c,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,r),new RS(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,o)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class LS{constructor(e,t){this._service=e,this._location=t instanceof MS?t:MS.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new LS(e,t)}get root(){const e=new MS(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return function(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new MS(this._location.bucket,e);return new LS(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new kS(CS.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function FS(e,t){const n=null==t?void 0:t.storageBucket;return null==n?null:MS.makeFromBucketSpec(n,e)}class VS{constructor(e,t,n,r,i){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=SS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?MS.makeFromBucketSpec(r,this._host):FS(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=MS.makeFromBucketSpec(this._url,e):this._bucket=FS(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){AS("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){AS("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return g(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=yield e.getToken();if(null!==t)return t.accessToken}return null})}_getAppCheckToken(){return g(this,null,function*(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new LS(this,e)}_makeRequest(e,t,n,r,i=!0){if(this._deleted)return new PS(_S());{const s=NS(e,this._appId,n,r,t,this._firebaseVersion,i);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}makeRequestWithTokens(e,t){return g(this,null,function*(){const[n,r]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()})}}const BS="@firebase/storage",zS="0.11.2",WS="storage";function US(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new VS(n,r,i,t,Ha)}Ba(new Ao(WS,US,"PUBLIC").setMultipleInstances(!0)),Xa(BS,zS,""),Xa(BS,zS,"esm2017");var HS={exports:{}};const $S=Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})),qS=an($S);var XS;function KS(){return XS||(XS=1,HS.exports=(e=e||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==ln&&ln.crypto&&(n=ln.crypto),!n)try{n=qS}catch(g){}var r=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(g){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(g){}}throw new Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),s={},o=s.lib={},a=o.Base=function(){return{extend:function(e){var t=i(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),l=o.WordArray=a.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var s=0;s<i;s++){var o=n[s>>>2]>>>24-s%4*8&255;t[r+s>>>2]|=o<<24-(r+s)%4*8}else for(var a=0;a<i;a+=4)t[r+a>>>2]=n[a>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(r());return new l.init(t,e)}}),c=s.enc={},u=c.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var s=t[i>>>2]>>>24-i%4*8&255;r.push((s>>>4).toString(16)),r.push((15&s).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new l.init(n,t/2)}},h=c.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var s=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(s))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new l.init(n,t)}},d=c.Utf8={stringify:function(e){try{return decodeURIComponent(escape(h.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return h.parse(unescape(encodeURIComponent(e)))}},f=o.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r=this._data,i=r.words,s=r.sigBytes,o=this.blockSize,a=s/(4*o),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*o,u=e.min(4*c,s);if(c){for(var h=0;h<c;h+=o)this._doProcessBlock(i,h);n=i.splice(0,c),r.sigBytes-=u}return new l.init(n,u)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});o.Hasher=f.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}});var p=s.algo={};return s}(Math),e)),HS.exports;var e}var GS,YS={exports:{}};function QS(){return GS||(GS=1,YS.exports=(o=KS(),n=(t=o).lib,r=n.Base,i=n.WordArray,(s=t.x64={}).Word=r.extend({init:function(e,t){this.high=e,this.low=t}}),s.WordArray=r.extend({init:function(t,n){t=this.words=t||[],this.sigBytes=n!=e?n:8*t.length},toX32:function(){for(var e=this.words,t=e.length,n=[],r=0;r<t;r++){var s=e[r];n.push(s.high),n.push(s.low)}return i.create(n,this.sigBytes)},clone:function(){for(var e=r.clone.call(this),t=e.words=this.words.slice(0),n=t.length,i=0;i<n;i++)t[i]=t[i].clone();return e}}),o)),YS.exports;var e,t,n,r,i,s,o}var JS,ZS={exports:{}};function ek(){return JS||(JS=1,ZS.exports=(e=KS(),function(){if("function"==typeof ArrayBuffer){var t=e.lib.WordArray,n=t.init,r=t.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var t=e.byteLength,r=[],i=0;i<t;i++)r[i>>>2]|=e[i]<<24-i%4*8;n.call(this,r,t)}else n.apply(this,arguments)};r.prototype=t}}(),e.lib.WordArray)),ZS.exports;var e}var tk,nk={exports:{}};function rk(){return tk||(tk=1,nk.exports=(e=KS(),function(){var t=e,n=t.lib.WordArray,r=t.enc;function i(e){return e<<8&4278255360|e>>>8&16711935}r.Utf16=r.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i+=2){var s=t[i>>>2]>>>16-i%4*8&65535;r.push(String.fromCharCode(s))}return r.join("")},parse:function(e){for(var t=e.length,r=[],i=0;i<t;i++)r[i>>>1]|=e.charCodeAt(i)<<16-i%2*16;return n.create(r,2*t)}},r.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],s=0;s<n;s+=2){var o=i(t[s>>>2]>>>16-s%4*8&65535);r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var t=e.length,r=[],s=0;s<t;s++)r[s>>>1]|=i(e.charCodeAt(s)<<16-s%2*16);return n.create(r,2*t)}}}(),e.enc.Utf16)),nk.exports;var e}var ik,sk={exports:{}};function ok(){return ik||(ik=1,sk.exports=(e=KS(),function(){var t=e,n=t.lib.WordArray;function r(e,t,r){for(var i=[],s=0,o=0;o<t;o++)if(o%4){var a=r[e.charCodeAt(o-1)]<<o%4*2|r[e.charCodeAt(o)]>>>6-o%4*2;i[s>>>2]|=a<<24-s%4*8,s++}return n.create(i,s)}t.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var i=[],s=0;s<n;s+=3)for(var o=(t[s>>>2]>>>24-s%4*8&255)<<16|(t[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|t[s+2>>>2]>>>24-(s+2)%4*8&255,a=0;a<4&&s+.75*a<n;a++)i.push(r.charAt(o>>>6*(3-a)&63));var l=r.charAt(64);if(l)for(;i.length%4;)i.push(l);return i.join("")},parse:function(e){var t=e.length,n=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var s=0;s<n.length;s++)i[n.charCodeAt(s)]=s}var o=n.charAt(64);if(o){var a=e.indexOf(o);-1!==a&&(t=a)}return r(e,t,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64)),sk.exports;var e}var ak,lk={exports:{}};function ck(){return ak||(ak=1,lk.exports=(e=KS(),function(){var t=e,n=t.lib.WordArray;function r(e,t,r){for(var i=[],s=0,o=0;o<t;o++)if(o%4){var a=r[e.charCodeAt(o-1)]<<o%4*2|r[e.charCodeAt(o)]>>>6-o%4*2;i[s>>>2]|=a<<24-s%4*8,s++}return n.create(i,s)}t.enc.Base64url={stringify:function(e,t){void 0===t&&(t=!0);var n=e.words,r=e.sigBytes,i=t?this._safe_map:this._map;e.clamp();for(var s=[],o=0;o<r;o+=3)for(var a=(n[o>>>2]>>>24-o%4*8&255)<<16|(n[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|n[o+2>>>2]>>>24-(o+2)%4*8&255,l=0;l<4&&o+.75*l<r;l++)s.push(i.charAt(a>>>6*(3-l)&63));var c=i.charAt(64);if(c)for(;s.length%4;)s.push(c);return s.join("")},parse:function(e,t){void 0===t&&(t=!0);var n=e.length,i=t?this._safe_map:this._map,s=this._reverseMap;if(!s){s=this._reverseMap=[];for(var o=0;o<i.length;o++)s[i.charCodeAt(o)]=o}var a=i.charAt(64);if(a){var l=e.indexOf(a);-1!==l&&(n=l)}return r(e,n,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"}}(),e.enc.Base64url)),lk.exports;var e}var uk,hk={exports:{}};function dk(){return uk||(uk=1,hk.exports=(e=KS(),function(t){var n=e,r=n.lib,i=r.WordArray,s=r.Hasher,o=n.algo,a=[];!function(){for(var e=0;e<64;e++)a[e]=4294967296*t.abs(t.sin(e+1))|0}();var l=o.MD5=s.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,i=e[r];e[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var s=this._hash.words,o=e[t+0],l=e[t+1],f=e[t+2],p=e[t+3],g=e[t+4],m=e[t+5],v=e[t+6],y=e[t+7],x=e[t+8],b=e[t+9],w=e[t+10],S=e[t+11],k=e[t+12],C=e[t+13],E=e[t+14],I=e[t+15],D=s[0],T=s[1],j=s[2],_=s[3];D=c(D,T,j,_,o,7,a[0]),_=c(_,D,T,j,l,12,a[1]),j=c(j,_,D,T,f,17,a[2]),T=c(T,j,_,D,p,22,a[3]),D=c(D,T,j,_,g,7,a[4]),_=c(_,D,T,j,m,12,a[5]),j=c(j,_,D,T,v,17,a[6]),T=c(T,j,_,D,y,22,a[7]),D=c(D,T,j,_,x,7,a[8]),_=c(_,D,T,j,b,12,a[9]),j=c(j,_,D,T,w,17,a[10]),T=c(T,j,_,D,S,22,a[11]),D=c(D,T,j,_,k,7,a[12]),_=c(_,D,T,j,C,12,a[13]),j=c(j,_,D,T,E,17,a[14]),D=u(D,T=c(T,j,_,D,I,22,a[15]),j,_,l,5,a[16]),_=u(_,D,T,j,v,9,a[17]),j=u(j,_,D,T,S,14,a[18]),T=u(T,j,_,D,o,20,a[19]),D=u(D,T,j,_,m,5,a[20]),_=u(_,D,T,j,w,9,a[21]),j=u(j,_,D,T,I,14,a[22]),T=u(T,j,_,D,g,20,a[23]),D=u(D,T,j,_,b,5,a[24]),_=u(_,D,T,j,E,9,a[25]),j=u(j,_,D,T,p,14,a[26]),T=u(T,j,_,D,x,20,a[27]),D=u(D,T,j,_,C,5,a[28]),_=u(_,D,T,j,f,9,a[29]),j=u(j,_,D,T,y,14,a[30]),D=h(D,T=u(T,j,_,D,k,20,a[31]),j,_,m,4,a[32]),_=h(_,D,T,j,x,11,a[33]),j=h(j,_,D,T,S,16,a[34]),T=h(T,j,_,D,E,23,a[35]),D=h(D,T,j,_,l,4,a[36]),_=h(_,D,T,j,g,11,a[37]),j=h(j,_,D,T,y,16,a[38]),T=h(T,j,_,D,w,23,a[39]),D=h(D,T,j,_,C,4,a[40]),_=h(_,D,T,j,o,11,a[41]),j=h(j,_,D,T,p,16,a[42]),T=h(T,j,_,D,v,23,a[43]),D=h(D,T,j,_,b,4,a[44]),_=h(_,D,T,j,k,11,a[45]),j=h(j,_,D,T,I,16,a[46]),D=d(D,T=h(T,j,_,D,f,23,a[47]),j,_,o,6,a[48]),_=d(_,D,T,j,y,10,a[49]),j=d(j,_,D,T,E,15,a[50]),T=d(T,j,_,D,m,21,a[51]),D=d(D,T,j,_,k,6,a[52]),_=d(_,D,T,j,p,10,a[53]),j=d(j,_,D,T,w,15,a[54]),T=d(T,j,_,D,l,21,a[55]),D=d(D,T,j,_,x,6,a[56]),_=d(_,D,T,j,I,10,a[57]),j=d(j,_,D,T,v,15,a[58]),T=d(T,j,_,D,C,21,a[59]),D=d(D,T,j,_,g,6,a[60]),_=d(_,D,T,j,S,10,a[61]),j=d(j,_,D,T,f,15,a[62]),T=d(T,j,_,D,b,21,a[63]),s[0]=s[0]+D|0,s[1]=s[1]+T|0,s[2]=s[2]+j|0,s[3]=s[3]+_|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;n[i>>>5]|=128<<24-i%32;var s=t.floor(r/4294967296),o=r;n[15+(i+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),n[14+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),e.sigBytes=4*(n.length+1),this._process();for(var a=this._hash,l=a.words,c=0;c<4;c++){var u=l[c];l[c]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}return a},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,n,r,i,s,o){var a=e+(t&n|~t&r)+i+o;return(a<<s|a>>>32-s)+t}function u(e,t,n,r,i,s,o){var a=e+(t&r|n&~r)+i+o;return(a<<s|a>>>32-s)+t}function h(e,t,n,r,i,s,o){var a=e+(t^n^r)+i+o;return(a<<s|a>>>32-s)+t}function d(e,t,n,r,i,s,o){var a=e+(n^(t|~r))+i+o;return(a<<s|a>>>32-s)+t}n.MD5=s._createHelper(l),n.HmacMD5=s._createHmacHelper(l)}(Math),e.MD5)),hk.exports;var e}var fk,pk={exports:{}};function gk(){return fk||(fk=1,pk.exports=(a=KS(),t=(e=a).lib,n=t.WordArray,r=t.Hasher,i=e.algo,s=[],o=i.SHA1=r.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],l=n[4],c=0;c<80;c++){if(c<16)s[c]=0|e[t+c];else{var u=s[c-3]^s[c-8]^s[c-14]^s[c-16];s[c]=u<<1|u>>>31}var h=(r<<5|r>>>27)+l+s[c];h+=c<20?1518500249+(i&o|~i&a):c<40?1859775393+(i^o^a):c<60?(i&o|i&a|o&a)-1894007588:(i^o^a)-899497514,l=a,a=o,o=i<<30|i>>>2,i=r,r=h}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+l|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}}),e.SHA1=r._createHelper(o),e.HmacSHA1=r._createHmacHelper(o),a.SHA1)),pk.exports;var e,t,n,r,i,s,o,a}var mk,vk={exports:{}};function yk(){return mk||(mk=1,vk.exports=(e=KS(),function(t){var n=e,r=n.lib,i=r.WordArray,s=r.Hasher,o=n.algo,a=[],l=[];!function(){function e(e){for(var n=t.sqrt(e),r=2;r<=n;r++)if(!(e%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,i=0;i<64;)e(r)&&(i<8&&(a[i]=n(t.pow(r,.5))),l[i]=n(t.pow(r,1/3)),i++),r++}();var c=[],u=o.SHA256=s.extend({_doReset:function(){this._hash=new i.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],s=n[2],o=n[3],a=n[4],u=n[5],h=n[6],d=n[7],f=0;f<64;f++){if(f<16)c[f]=0|e[t+f];else{var p=c[f-15],g=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,m=c[f-2],v=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;c[f]=g+c[f-7]+v+c[f-16]}var y=r&i^r&s^i&s,x=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),b=d+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&u^~a&h)+l[f]+c[f];d=h,h=u,u=a,a=o+b|0,o=s,s=i,i=r,r=b+(x+y)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+a|0,n[5]=n[5]+u|0,n[6]=n[6]+h|0,n[7]=n[7]+d|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=t.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=s._createHelper(u),n.HmacSHA256=s._createHmacHelper(u)}(Math),e.SHA256)),vk.exports;var e}var xk,bk,wk={exports:{}},Sk={exports:{}};function kk(){return bk||(bk=1,Sk.exports=(e=KS(),QS(),function(){var t=e,n=t.lib.Hasher,r=t.x64,i=r.Word,s=r.WordArray,o=t.algo;function a(){return i.create.apply(i,arguments)}var l=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=a()}();var u=o.SHA512=n.extend({_doReset:function(){this._hash=new s.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],s=n[2],o=n[3],a=n[4],u=n[5],h=n[6],d=n[7],f=r.high,p=r.low,g=i.high,m=i.low,v=s.high,y=s.low,x=o.high,b=o.low,w=a.high,S=a.low,k=u.high,C=u.low,E=h.high,I=h.low,D=d.high,T=d.low,j=f,_=p,M=g,P=m,A=v,R=y,O=x,N=b,L=w,F=S,V=k,B=C,z=E,W=I,U=D,H=T,$=0;$<80;$++){var q,X,K=c[$];if($<16)X=K.high=0|e[t+2*$],q=K.low=0|e[t+2*$+1];else{var G=c[$-15],Y=G.high,Q=G.low,J=(Y>>>1|Q<<31)^(Y>>>8|Q<<24)^Y>>>7,Z=(Q>>>1|Y<<31)^(Q>>>8|Y<<24)^(Q>>>7|Y<<25),ee=c[$-2],te=ee.high,ne=ee.low,re=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,ie=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),se=c[$-7],oe=se.high,ae=se.low,le=c[$-16],ce=le.high,ue=le.low;X=(X=(X=J+oe+((q=Z+ae)>>>0<Z>>>0?1:0))+re+((q+=ie)>>>0<ie>>>0?1:0))+ce+((q+=ue)>>>0<ue>>>0?1:0),K.high=X,K.low=q}var he,de=L&V^~L&z,fe=F&B^~F&W,pe=j&M^j&A^M&A,ge=_&P^_&R^P&R,me=(j>>>28|_<<4)^(j<<30|_>>>2)^(j<<25|_>>>7),ve=(_>>>28|j<<4)^(_<<30|j>>>2)^(_<<25|j>>>7),ye=(L>>>14|F<<18)^(L>>>18|F<<14)^(L<<23|F>>>9),xe=(F>>>14|L<<18)^(F>>>18|L<<14)^(F<<23|L>>>9),be=l[$],we=be.high,Se=be.low,ke=U+ye+((he=H+xe)>>>0<H>>>0?1:0),Ce=ve+ge;U=z,H=W,z=V,W=B,V=L,B=F,L=O+(ke=(ke=(ke=ke+de+((he+=fe)>>>0<fe>>>0?1:0))+we+((he+=Se)>>>0<Se>>>0?1:0))+X+((he+=q)>>>0<q>>>0?1:0))+((F=N+he|0)>>>0<N>>>0?1:0)|0,O=A,N=R,A=M,R=P,M=j,P=_,j=ke+(me+pe+(Ce>>>0<ve>>>0?1:0))+((_=he+Ce|0)>>>0<he>>>0?1:0)|0}p=r.low=p+_,r.high=f+j+(p>>>0<_>>>0?1:0),m=i.low=m+P,i.high=g+M+(m>>>0<P>>>0?1:0),y=s.low=y+R,s.high=v+A+(y>>>0<R>>>0?1:0),b=o.low=b+N,o.high=x+O+(b>>>0<N>>>0?1:0),S=a.low=S+F,a.high=w+L+(S>>>0<F>>>0?1:0),C=u.low=C+B,u.high=k+V+(C>>>0<B>>>0?1:0),I=h.low=I+W,h.high=E+z+(I>>>0<W>>>0?1:0),T=d.low=T+H,d.high=D+U+(T>>>0<H>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[30+(r+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(r+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});t.SHA512=n._createHelper(u),t.HmacSHA512=n._createHmacHelper(u)}(),e.SHA512)),Sk.exports;var e}var Ck,Ek,Ik={exports:{}},Dk={exports:{}};function Tk(){return Ek||(Ek=1,Dk.exports=(e=KS(),QS(),function(t){var n=e,r=n.lib,i=r.WordArray,s=r.Hasher,o=n.x64.Word,a=n.algo,l=[],c=[],u=[];!function(){for(var e=1,t=0,n=0;n<24;n++){l[e+5*t]=(n+1)*(n+2)/2%64;var r=(2*e+3*t)%5;e=t%5,t=r}for(e=0;e<5;e++)for(t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var i=1,s=0;s<24;s++){for(var a=0,h=0,d=0;d<7;d++){if(1&i){var f=(1<<d)-1;f<32?h^=1<<f:a^=1<<f-32}128&i?i=i<<1^113:i<<=1}u[s]=o.create(a,h)}}();var h=[];!function(){for(var e=0;e<25;e++)h[e]=o.create()}();var d=a.SHA3=s.extend({cfg:s.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new o.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,r=this.blockSize/2,i=0;i<r;i++){var s=e[t+2*i],o=e[t+2*i+1];s=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),(T=n[i]).high^=o,T.low^=s}for(var a=0;a<24;a++){for(var d=0;d<5;d++){for(var f=0,p=0,g=0;g<5;g++)f^=(T=n[d+5*g]).high,p^=T.low;var m=h[d];m.high=f,m.low=p}for(d=0;d<5;d++){var v=h[(d+4)%5],y=h[(d+1)%5],x=y.high,b=y.low;for(f=v.high^(x<<1|b>>>31),p=v.low^(b<<1|x>>>31),g=0;g<5;g++)(T=n[d+5*g]).high^=f,T.low^=p}for(var w=1;w<25;w++){var S=(T=n[w]).high,k=T.low,C=l[w];C<32?(f=S<<C|k>>>32-C,p=k<<C|S>>>32-C):(f=k<<C-32|S>>>64-C,p=S<<C-32|k>>>64-C);var E=h[c[w]];E.high=f,E.low=p}var I=h[0],D=n[0];for(I.high=D.high,I.low=D.low,d=0;d<5;d++)for(g=0;g<5;g++){var T=n[w=d+5*g],j=h[w],_=h[(d+1)%5+5*g],M=h[(d+2)%5+5*g];T.high=j.high^~_.high&M.high,T.low=j.low^~_.low&M.low}T=n[0];var P=u[a];T.high^=P.high,T.low^=P.low}},_doFinalize:function(){var e=this._data,n=e.words;this._nDataBytes;var r=8*e.sigBytes,s=32*this.blockSize;n[r>>>5]|=1<<24-r%32,n[(t.ceil((r+1)/s)*s>>>5)-1]|=128,e.sigBytes=4*n.length,this._process();for(var o=this._state,a=this.cfg.outputLength/8,l=a/8,c=[],u=0;u<l;u++){var h=o[u],d=h.high,f=h.low;d=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),f=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),c.push(f),c.push(d)}return new i.init(c,a)},clone:function(){for(var e=s.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});n.SHA3=s._createHelper(d),n.HmacSHA3=s._createHmacHelper(d)}(Math),e.SHA3)),Dk.exports;var e}var jk,_k,Mk={exports:{}},Pk={exports:{}};function Ak(){return _k||(_k=1,Pk.exports=(e=KS(),n=(t=e).lib.Base,r=t.enc.Utf8,void(t.algo.HMAC=n.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=r.parse(t));var n=e.blockSize,i=4*n;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var s=this._oKey=t.clone(),o=this._iKey=t.clone(),a=s.words,l=o.words,c=0;c<n;c++)a[c]^=1549556828,l[c]^=909522486;s.sigBytes=o.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))),Pk.exports;var e,t,n,r}var Rk,Ok,Nk={exports:{}},Lk={exports:{}};function Fk(){return Ok||(Ok=1,Lk.exports=(a=KS(),gk(),Ak(),t=(e=a).lib,n=t.Base,r=t.WordArray,i=e.algo,s=i.MD5,o=i.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:s,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n,i=this.cfg,s=i.hasher.create(),o=r.create(),a=o.words,l=i.keySize,c=i.iterations;a.length<l;){n&&s.update(n),n=s.update(e).finalize(t),s.reset();for(var u=1;u<c;u++)n=s.finalize(n),s.reset();o.concat(n)}return o.sigBytes=4*l,o}}),e.EvpKDF=function(e,t,n){return o.create(n).compute(e,t)},a.EvpKDF)),Lk.exports;var e,t,n,r,i,s,o,a}var Vk,Bk={exports:{}};function zk(){return Vk||(Vk=1,Bk.exports=(e=KS(),Fk(),void(e.lib.Cipher||function(t){var n=e,r=n.lib,i=r.Base,s=r.WordArray,o=r.BufferedBlockAlgorithm,a=n.enc;a.Utf8;var l=a.Base64,c=n.algo.EvpKDF,u=r.Cipher=o.extend({cfg:i.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?x:v}return function(t){return{encrypt:function(n,r,i){return e(r).encrypt(t,n,r,i)},decrypt:function(n,r,i){return e(r).decrypt(t,n,r,i)}}}}()});r.StreamCipher=u.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var h=n.mode={},d=r.BlockCipherMode=i.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),f=h.CBC=function(){var e=d.extend();function n(e,n,r){var i,s=this._iv;s?(i=s,this._iv=t):i=this._prevBlock;for(var o=0;o<r;o++)e[n+o]^=i[o]}return e.Encryptor=e.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize;n.call(this,e,t,i),r.encryptBlock(e,t),this._prevBlock=e.slice(t,t+i)}}),e.Decryptor=e.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize,s=e.slice(t,t+i);r.decryptBlock(e,t),n.call(this,e,t,i),this._prevBlock=s}}),e}(),p=(n.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,r=n-e.sigBytes%n,i=r<<24|r<<16|r<<8|r,o=[],a=0;a<r;a+=4)o.push(i);var l=s.create(o,r);e.concat(l)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}};r.BlockCipher=u.extend({cfg:u.cfg.extend({mode:f,padding:p}),reset:function(){var e;u.reset.call(this);var t=this.cfg,n=t.iv,r=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=r.createEncryptor:(e=r.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,n&&n.words):(this._mode=e.call(r,this,n&&n.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4});var g=r.CipherParams=i.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),m=(n.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;return(n?s.create([1398893684,1701076831]).concat(n).concat(t):t).toString(l)},parse:function(e){var t,n=l.parse(e),r=n.words;return 1398893684==r[0]&&1701076831==r[1]&&(t=s.create(r.slice(2,4)),r.splice(0,4),n.sigBytes-=16),g.create({ciphertext:n,salt:t})}},v=r.SerializableCipher=i.extend({cfg:i.extend({format:m}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var i=e.createEncryptor(n,r),s=i.finalize(t),o=i.cfg;return g.create({ciphertext:s,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),y=(n.kdf={}).OpenSSL={execute:function(e,t,n,r,i){if(r||(r=s.random(8)),i)o=c.create({keySize:t+n,hasher:i}).compute(e,r);else var o=c.create({keySize:t+n}).compute(e,r);var a=s.create(o.words.slice(t),4*n);return o.sigBytes=4*t,g.create({key:o,iv:a,salt:r})}},x=r.PasswordBasedCipher=v.extend({cfg:v.cfg.extend({kdf:y}),encrypt:function(e,t,n,r){var i=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize,r.salt,r.hasher);r.iv=i.iv;var s=v.encrypt.call(this,e,t,i.key,r);return s.mixIn(i),s},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var i=r.kdf.execute(n,e.keySize,e.ivSize,t.salt,r.hasher);return r.iv=i.iv,v.decrypt.call(this,e,t,i.key,r)}})}()))),Bk.exports;var e}var Wk,Uk,Hk,$k={exports:{}},qk={exports:{}},Xk={exports:{}};function Kk(){return Hk||(Hk=1,Xk.exports=(e=KS(),zk(),
/** @preserve
           * Counter block mode compatible with  Dr Brian Gladman fileenc.c
           * derived from CryptoJS.mode.CTR
           * Jan Hruby jhruby.web@gmail.com
           */
e.mode.CTRGladman=function(){var t=e.lib.BlockCipherMode.extend();function n(e){if(255&~(e>>24))e+=1<<24;else{var t=e>>16&255,n=e>>8&255,r=255&e;255===t?(t=0,255===n?(n=0,255===r?r=0:++r):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=r}return e}function r(e){return 0===(e[0]=n(e[0]))&&(e[1]=n(e[1])),e}var i=t.Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,s=this._iv,o=this._counter;s&&(o=this._counter=s.slice(0),this._iv=void 0),r(o);var a=o.slice(0);n.encryptBlock(a,0);for(var l=0;l<i;l++)e[t+l]^=a[l]}});return t.Decryptor=i,t}(),e.mode.CTRGladman)),Xk.exports;var e}var Gk,Yk,Qk,Jk,Zk,eC,tC,nC,rC,iC,sC={exports:{}},oC={exports:{}},aC={exports:{}},lC={exports:{}},cC={exports:{}},uC={exports:{}},hC={exports:{}},dC={exports:{}},fC={exports:{}},pC={exports:{}};function gC(){return iC||(iC=1,pC.exports=(e=KS(),ok(),dk(),Fk(),zk(),function(){var t=e,n=t.lib,r=n.WordArray,i=n.BlockCipher,s=t.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],l=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],u=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],h=s.DES=i.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var r=o[n]-1;t[n]=e[r>>>5]>>>31-r%32&1}for(var i=this._subKeys=[],s=0;s<16;s++){var c=i[s]=[],u=l[s];for(n=0;n<24;n++)c[n/6|0]|=t[(a[n]-1+u)%28]<<31-n%6,c[4+(n/6|0)]|=t[28+(a[n+24]-1+u)%28]<<31-n%6;for(c[0]=c[0]<<1|c[0]>>>31,n=1;n<7;n++)c[n]=c[n]>>>4*(n-1)+3;c[7]=c[7]<<5|c[7]>>>27}var h=this._invSubKeys=[];for(n=0;n<16;n++)h[n]=i[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],d.call(this,4,252645135),d.call(this,16,65535),f.call(this,2,858993459),f.call(this,8,16711935),d.call(this,1,1431655765);for(var r=0;r<16;r++){for(var i=n[r],s=this._lBlock,o=this._rBlock,a=0,l=0;l<8;l++)a|=c[l][((o^i[l])&u[l])>>>0];this._lBlock=o,this._rBlock=s^a}var h=this._lBlock;this._lBlock=this._rBlock,this._rBlock=h,d.call(this,1,1431655765),f.call(this,8,16711935),f.call(this,2,858993459),d.call(this,16,65535),d.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function d(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function f(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}t.DES=i._createHelper(h);var p=s.TripleDES=i.extend({_doReset:function(){var e=this._key.words;if(2!==e.length&&4!==e.length&&e.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var t=e.slice(0,2),n=e.length<4?e.slice(0,2):e.slice(2,4),i=e.length<6?e.slice(0,2):e.slice(4,6);this._des1=h.createEncryptor(r.create(t)),this._des2=h.createEncryptor(r.create(n)),this._des3=h.createEncryptor(r.create(i))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});t.TripleDES=i._createHelper(p)}(),e.TripleDES)),pC.exports;var e}var mC,vC,yC,xC,bC,wC,SC,kC,CC,EC,IC={exports:{}},DC={exports:{}},TC={exports:{}},jC={exports:{}};function _C(){return xC||(xC=1,jC.exports=(e=KS(),ok(),dk(),Fk(),zk(),function(){var t=e,n=t.lib.BlockCipher,r=t.algo;const i=16,s=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],o=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var a={pbox:[],sbox:[]};function l(e,t){let n=t>>24&255,r=t>>16&255,i=t>>8&255,s=255&t,o=e.sbox[0][n]+e.sbox[1][r];return o^=e.sbox[2][i],o+=e.sbox[3][s],o}function c(e,t,n){let r,s=t,o=n;for(let a=0;a<i;++a)s^=e.pbox[a],o=l(e,s)^o,r=s,s=o,o=r;return r=s,s=o,o=r,o^=e.pbox[i],s^=e.pbox[i+1],{left:s,right:o}}function u(e,t,n){let r,s=t,o=n;for(let a=i+1;a>1;--a)s^=e.pbox[a],o=l(e,s)^o,r=s,s=o,o=r;return r=s,s=o,o=r,o^=e.pbox[1],s^=e.pbox[0],{left:s,right:o}}function h(e,t,n){for(let i=0;i<4;i++){e.sbox[i]=[];for(let t=0;t<256;t++)e.sbox[i][t]=o[i][t]}let r=0;for(let o=0;o<i+2;o++)e.pbox[o]=s[o]^t[r],r++,r>=n&&(r=0);let a=0,l=0,u=0;for(let s=0;s<i+2;s+=2)u=c(e,a,l),a=u.left,l=u.right,e.pbox[s]=a,e.pbox[s+1]=l;for(let i=0;i<4;i++)for(let t=0;t<256;t+=2)u=c(e,a,l),a=u.left,l=u.right,e.sbox[i][t]=a,e.sbox[i][t+1]=l;return!0}var d=r.Blowfish=n.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4;h(a,t,n)}},encryptBlock:function(e,t){var n=c(a,e[t],e[t+1]);e[t]=n.left,e[t+1]=n.right},decryptBlock:function(e,t){var n=u(a,e[t],e[t+1]);e[t]=n.left,e[t+1]=n.right},blockSize:2,keySize:4,ivSize:2});t.Blowfish=n._createHelper(d)}(),e.Blowfish)),jC.exports;var e}KS(),QS(),ek(),rk(),ok(),ck(),dk(),gk(),yk(),xk||(xk=1,wk.exports=(EC=KS(),yk(),wC=(bC=EC).lib.WordArray,SC=bC.algo,kC=SC.SHA256,CC=SC.SHA224=kC.extend({_doReset:function(){this._hash=new wC.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=kC._doFinalize.call(this);return e.sigBytes-=4,e}}),bC.SHA224=kC._createHelper(CC),bC.HmacSHA224=kC._createHmacHelper(CC),EC.SHA224)),kk(),function(){return Ck||(Ck=1,Ik.exports=(a=KS(),QS(),kk(),t=(e=a).x64,n=t.Word,r=t.WordArray,i=e.algo,s=i.SHA512,o=i.SHA384=s.extend({_doReset:function(){this._hash=new r.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},_doFinalize:function(){var e=s._doFinalize.call(this);return e.sigBytes-=16,e}}),e.SHA384=s._createHelper(o),e.HmacSHA384=s._createHmacHelper(o),a.SHA384)),Ik.exports;var e,t,n,r,i,s,o,a}(),Tk(),function(){return jk||(jk=1,Mk.exports=(e=KS(),
/** @preserve
          			(c) 2012 by Cédric Mesnil. All rights reserved.
          
          			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
          
          			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
          			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
          
          			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
          			*/
function(){var t=e,n=t.lib,r=n.WordArray,i=n.Hasher,s=t.algo,o=r.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),a=r.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),l=r.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),c=r.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=r.create([0,1518500249,1859775393,2400959708,2840853838]),h=r.create([1352829926,1548603684,1836072691,2053994217,0]),d=s.RIPEMD160=i.extend({_doReset:function(){this._hash=r.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,i=e[r];e[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var s,d,x,b,w,S,k,C,E,I,D,T=this._hash.words,j=u.words,_=h.words,M=o.words,P=a.words,A=l.words,R=c.words;for(S=s=T[0],k=d=T[1],C=x=T[2],E=b=T[3],I=w=T[4],n=0;n<80;n+=1)D=s+e[t+M[n]]|0,D+=n<16?f(d,x,b)+j[0]:n<32?p(d,x,b)+j[1]:n<48?g(d,x,b)+j[2]:n<64?m(d,x,b)+j[3]:v(d,x,b)+j[4],D=(D=y(D|=0,A[n]))+w|0,s=w,w=b,b=y(x,10),x=d,d=D,D=S+e[t+P[n]]|0,D+=n<16?v(k,C,E)+_[0]:n<32?m(k,C,E)+_[1]:n<48?g(k,C,E)+_[2]:n<64?p(k,C,E)+_[3]:f(k,C,E)+_[4],D=(D=y(D|=0,R[n]))+I|0,S=I,I=E,E=y(C,10),C=k,k=D;D=T[1]+x+E|0,T[1]=T[2]+b+I|0,T[2]=T[3]+w+S|0,T[3]=T[4]+s+k|0,T[4]=T[0]+d+C|0,T[0]=D},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var i=this._hash,s=i.words,o=0;o<5;o++){var a=s[o];s[o]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}return i},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function f(e,t,n){return e^t^n}function p(e,t,n){return e&t|~e&n}function g(e,t,n){return(e|~t)^n}function m(e,t,n){return e&n|t&~n}function v(e,t,n){return e^(t|~n)}function y(e,t){return e<<t|e>>>32-t}t.RIPEMD160=i._createHelper(d),t.HmacRIPEMD160=i._createHmacHelper(d)}(),e.RIPEMD160)),Mk.exports;var e}(),Ak(),function(){return Rk||(Rk=1,Nk.exports=(l=KS(),yk(),Ak(),t=(e=l).lib,n=t.Base,r=t.WordArray,i=e.algo,s=i.SHA256,o=i.HMAC,a=i.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:s,iterations:25e4}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,i=o.create(n.hasher,e),s=r.create(),a=r.create([1]),l=s.words,c=a.words,u=n.keySize,h=n.iterations;l.length<u;){var d=i.update(t).finalize(a);i.reset();for(var f=d.words,p=f.length,g=d,m=1;m<h;m++){g=i.finalize(g),i.reset();for(var v=g.words,y=0;y<p;y++)f[y]^=v[y]}s.concat(d),c[0]++}return s.sigBytes=4*u,s}}),e.PBKDF2=function(e,t,n){return a.create(n).compute(e,t)},l.PBKDF2)),Nk.exports;var e,t,n,r,i,s,o,a,l}(),Fk(),zk(),function(){return Wk||(Wk=1,$k.exports=(e=KS(),zk(),e.mode.CFB=function(){var t=e.lib.BlockCipherMode.extend();function n(e,t,n,r){var i,s=this._iv;s?(i=s.slice(0),this._iv=void 0):i=this._prevBlock,r.encryptBlock(i,0);for(var o=0;o<n;o++)e[t+o]^=i[o]}return t.Encryptor=t.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize;n.call(this,e,t,i,r),this._prevBlock=e.slice(t,t+i)}}),t.Decryptor=t.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize,s=e.slice(t,t+i);n.call(this,e,t,i,r),this._prevBlock=s}}),t}(),e.mode.CFB)),$k.exports;var e}(),function(){return Uk||(Uk=1,qk.exports=(n=KS(),zk(),n.mode.CTR=(e=n.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=this._iv,s=this._counter;i&&(s=this._counter=i.slice(0),this._iv=void 0);var o=s.slice(0);n.encryptBlock(o,0),s[r-1]=s[r-1]+1|0;for(var a=0;a<r;a++)e[t+a]^=o[a]}}),e.Decryptor=t,e),n.mode.CTR)),qk.exports;var e,t,n}(),Kk(),function(){return Gk||(Gk=1,sC.exports=(n=KS(),zk(),n.mode.OFB=(e=n.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=this._iv,s=this._keystream;i&&(s=this._keystream=i.slice(0),this._iv=void 0),n.encryptBlock(s,0);for(var o=0;o<r;o++)e[t+o]^=s[o]}}),e.Decryptor=t,e),n.mode.OFB)),sC.exports;var e,t,n}(),function(){return Yk||(Yk=1,oC.exports=(t=KS(),zk(),t.mode.ECB=((e=t.lib.BlockCipherMode.extend()).Encryptor=e.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),e.Decryptor=e.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),e),t.mode.ECB)),oC.exports;var e,t}(),function(){return Qk||(Qk=1,aC.exports=(e=KS(),zk(),e.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,r=4*t,i=r-n%r,s=n+i-1;e.clamp(),e.words[s>>>2]|=i<<24-s%4*8,e.sigBytes+=i},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Ansix923)),aC.exports;var e}(),function(){return Jk||(Jk=1,lC.exports=(e=KS(),zk(),e.pad.Iso10126={pad:function(t,n){var r=4*n,i=r-t.sigBytes%r;t.concat(e.lib.WordArray.random(i-1)).concat(e.lib.WordArray.create([i<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Iso10126)),lC.exports;var e}(),function(){return Zk||(Zk=1,cC.exports=(e=KS(),zk(),e.pad.Iso97971={pad:function(t,n){t.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(t,n)},unpad:function(t){e.pad.ZeroPadding.unpad(t),t.sigBytes--}},e.pad.Iso97971)),cC.exports;var e}(),function(){return eC||(eC=1,uC.exports=(e=KS(),zk(),e.pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){var t=e.words,n=e.sigBytes-1;for(n=e.sigBytes-1;n>=0;n--)if(t[n>>>2]>>>24-n%4*8&255){e.sigBytes=n+1;break}}},e.pad.ZeroPadding)),uC.exports;var e}(),function(){return tC||(tC=1,hC.exports=(e=KS(),zk(),e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding)),hC.exports;var e}(),function(){return nC||(nC=1,dC.exports=(r=KS(),zk(),t=(e=r).lib.CipherParams,n=e.enc.Hex,e.format.Hex={stringify:function(e){return e.ciphertext.toString(n)},parse:function(e){var r=n.parse(e);return t.create({ciphertext:r})}},r.format.Hex)),dC.exports;var e,t,n,r}(),function(){return rC||(rC=1,fC.exports=(e=KS(),ok(),dk(),Fk(),zk(),function(){var t=e,n=t.lib.BlockCipher,r=t.algo,i=[],s=[],o=[],a=[],l=[],c=[],u=[],h=[],d=[],f=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,r=0;for(t=0;t<256;t++){var p=r^r<<1^r<<2^r<<3^r<<4;p=p>>>8^255&p^99,i[n]=p,s[p]=n;var g=e[n],m=e[g],v=e[m],y=257*e[p]^16843008*p;o[n]=y<<24|y>>>8,a[n]=y<<16|y>>>16,l[n]=y<<8|y>>>24,c[n]=y,y=16843009*v^65537*m^257*g^16843008*n,u[p]=y<<24|y>>>8,h[p]=y<<16|y>>>16,d[p]=y<<8|y>>>24,f[p]=y,n?(n=g^e[e[e[v^g]]],r^=e[e[r]]):n=r=1}}();var p=[0,1,2,4,8,16,32,64,128,27,54],g=r.AES=n.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,r=4*((this._nRounds=n+6)+1),s=this._keySchedule=[],o=0;o<r;o++)o<n?s[o]=t[o]:(c=s[o-1],o%n?n>6&&o%n==4&&(c=i[c>>>24]<<24|i[c>>>16&255]<<16|i[c>>>8&255]<<8|i[255&c]):(c=i[(c=c<<8|c>>>24)>>>24]<<24|i[c>>>16&255]<<16|i[c>>>8&255]<<8|i[255&c],c^=p[o/n|0]<<24),s[o]=s[o-n]^c);for(var a=this._invKeySchedule=[],l=0;l<r;l++){if(o=r-l,l%4)var c=s[o];else c=s[o-4];a[l]=l<4||o<=4?c:u[i[c>>>24]]^h[i[c>>>16&255]]^d[i[c>>>8&255]]^f[i[255&c]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,o,a,l,c,i)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,u,h,d,f,s),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,i,s,o,a){for(var l=this._nRounds,c=e[t]^n[0],u=e[t+1]^n[1],h=e[t+2]^n[2],d=e[t+3]^n[3],f=4,p=1;p<l;p++){var g=r[c>>>24]^i[u>>>16&255]^s[h>>>8&255]^o[255&d]^n[f++],m=r[u>>>24]^i[h>>>16&255]^s[d>>>8&255]^o[255&c]^n[f++],v=r[h>>>24]^i[d>>>16&255]^s[c>>>8&255]^o[255&u]^n[f++],y=r[d>>>24]^i[c>>>16&255]^s[u>>>8&255]^o[255&h]^n[f++];c=g,u=m,h=v,d=y}g=(a[c>>>24]<<24|a[u>>>16&255]<<16|a[h>>>8&255]<<8|a[255&d])^n[f++],m=(a[u>>>24]<<24|a[h>>>16&255]<<16|a[d>>>8&255]<<8|a[255&c])^n[f++],v=(a[h>>>24]<<24|a[d>>>16&255]<<16|a[c>>>8&255]<<8|a[255&u])^n[f++],y=(a[d>>>24]<<24|a[c>>>16&255]<<16|a[u>>>8&255]<<8|a[255&h])^n[f++],e[t]=g,e[t+1]=m,e[t+2]=v,e[t+3]=y},keySize:8});t.AES=n._createHelper(g)}(),e.AES)),fC.exports;var e}(),gC(),function(){return mC||(mC=1,IC.exports=(e=KS(),ok(),dk(),Fk(),zk(),function(){var t=e,n=t.lib.StreamCipher,r=t.algo,i=r.RC4=n.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,r=this._S=[],i=0;i<256;i++)r[i]=i;i=0;for(var s=0;i<256;i++){var o=i%n,a=t[o>>>2]>>>24-o%4*8&255;s=(s+r[i]+a)%256;var l=r[i];r[i]=r[s],r[s]=l}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=s.call(this)},keySize:8,ivSize:0});function s(){for(var e=this._S,t=this._i,n=this._j,r=0,i=0;i<4;i++){n=(n+e[t=(t+1)%256])%256;var s=e[t];e[t]=e[n],e[n]=s,r|=e[(e[t]+e[n])%256]<<24-8*i}return this._i=t,this._j=n,r}t.RC4=n._createHelper(i);var o=r.RC4Drop=i.extend({cfg:i.cfg.extend({drop:192}),_doReset:function(){i._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)s.call(this)}});t.RC4Drop=n._createHelper(o)}(),e.RC4)),IC.exports;var e}(),function(){return vC||(vC=1,DC.exports=(e=KS(),ok(),dk(),Fk(),zk(),function(){var t=e,n=t.lib.StreamCipher,r=t.algo,i=[],s=[],o=[],a=r.Rabbit=n.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)l.call(this);for(n=0;n<8;n++)i[n]^=r[n+4&7];if(t){var s=t.words,o=s[0],a=s[1],c=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),u=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),h=c>>>16|4294901760&u,d=u<<16|65535&c;for(i[0]^=c,i[1]^=h,i[2]^=u,i[3]^=d,i[4]^=c,i[5]^=h,i[6]^=u,i[7]^=d,n=0;n<4;n++)l.call(this)}},_doProcessBlock:function(e,t){var n=this._X;l.call(this),i[0]=n[0]^n[5]>>>16^n[3]<<16,i[1]=n[2]^n[7]>>>16^n[5]<<16,i[2]=n[4]^n[1]>>>16^n[7]<<16,i[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)i[r]=16711935&(i[r]<<8|i[r]>>>24)|4278255360&(i[r]<<24|i[r]>>>8),e[t+r]^=i[r]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,n=0;n<8;n++)s[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<s[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<s[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<s[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<s[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<s[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<s[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<s[6]>>>0?1:0)|0,this._b=t[7]>>>0<s[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],i=65535&r,a=r>>>16,l=((i*i>>>17)+i*a>>>15)+a*a,c=((4294901760&r)*r|0)+((65535&r)*r|0);o[n]=l^c}e[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,e[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,e[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,e[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,e[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,e[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,e[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,e[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}t.Rabbit=n._createHelper(a)}(),e.Rabbit)),DC.exports;var e}(),function(){return yC||(yC=1,TC.exports=(e=KS(),ok(),dk(),Fk(),zk(),function(){var t=e,n=t.lib.StreamCipher,r=t.algo,i=[],s=[],o=[],a=r.RabbitLegacy=n.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var i=0;i<4;i++)l.call(this);for(i=0;i<8;i++)r[i]^=n[i+4&7];if(t){var s=t.words,o=s[0],a=s[1],c=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),u=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),h=c>>>16|4294901760&u,d=u<<16|65535&c;for(r[0]^=c,r[1]^=h,r[2]^=u,r[3]^=d,r[4]^=c,r[5]^=h,r[6]^=u,r[7]^=d,i=0;i<4;i++)l.call(this)}},_doProcessBlock:function(e,t){var n=this._X;l.call(this),i[0]=n[0]^n[5]>>>16^n[3]<<16,i[1]=n[2]^n[7]>>>16^n[5]<<16,i[2]=n[4]^n[1]>>>16^n[7]<<16,i[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)i[r]=16711935&(i[r]<<8|i[r]>>>24)|4278255360&(i[r]<<24|i[r]>>>8),e[t+r]^=i[r]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,n=0;n<8;n++)s[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<s[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<s[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<s[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<s[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<s[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<s[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<s[6]>>>0?1:0)|0,this._b=t[7]>>>0<s[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],i=65535&r,a=r>>>16,l=((i*i>>>17)+i*a>>>15)+a*a,c=((4294901760&r)*r|0)+((65535&r)*r|0);o[n]=l^c}e[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,e[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,e[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,e[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,e[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,e[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,e[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,e[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}t.RabbitLegacy=n._createHelper(a)}(),e.RabbitLegacy)),TC.exports;var e}(),_C();const MC=class e{constructor(){f(this,"logs",[]),setInterval(()=>{this.clearOldLogs()},864e5)}static getInstance(){return e.instance||(e.instance=new e),e.instance}log(e,t,n){const r={timestamp:Date.now(),level:e,message:t,data:n};this.logs.push(r),console.log(`[Security ${e.toUpperCase()}] ${t}`,n||"")}getLogs(){return[...this.logs]}clearOldLogs(){const e=Date.now()-864e5;this.logs=this.logs.filter(t=>t.timestamp>e)}};f(MC,"instance");let PC=MC;const AC={apiKey:"AIzaSyBXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",authDomain:"task-management-app-xxxxx.firebaseapp.com",projectId:"task-management-app-xxxxx",storageBucket:"task-management-app-xxxxx.appspot.com",messagingSenderId:"123456789012",appId:"1:123456789012:web:abcdefghijklmnop"},RC=$a(AC);!function(t=qa()){const n=za(t,"auth");if(n.isInitialized())return n.getImmediate();const r=function(e,t){const n=za(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(Do(n.getOptions(),null!=t?t:{}))return e;ul(e,"already-initialized")}return n.initialize({options:t})}(t,{popupRedirectResolver:Pu,persistence:[Gc,Pc,Rc]}),i=bo("authTokenSyncURL");if(i){const t=(s=i,t=>g(e,null,function*(){const e=t&&(yield t.getIdTokenResult()),n=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>Nu)return;const r=null==e?void 0:e.token;Lu!==r&&(Lu=r,yield fetch(s,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))}));!function(e,t,n){Po(e).beforeAuthStateChanged(t,n)}(r,t,()=>t(r.currentUser)),function(e,t,n,r){Po(e).onIdTokenChanged(t,n,r)}(r,e=>t(e))}var s;const o=vo("auth");o&&fc(r,`http://${o}`)}(RC);const OC=function(e){const t="string"==typeof e?e:"(default)",n=za("object"==typeof e?e:qa(),"firestore").getImmediate({identifier:t});if(!n._initialized){const e=yo("firestore");e&&function(e,t,n,r={}){var i;const s=(e=bw(e,Sw))._getSettings(),o=`${t}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&ag("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=tg.MOCK_USER;else{t=So(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new fg(dg.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new tg(s)}e._authCredentials=new vg(new gg(t,n))}}(n,...e)}return n}(RC);!function(e=qa(),t){const n=za(e=Po(e),WS).getImmediate({identifier:t}),r=yo("storage");r&&function(e,t,n,r={}){!function(e,t,n,r={}){e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:i}=r;i&&(e._overrideAuthToken="string"==typeof i?i:So(i,e.app.options.projectId))}(e,t,n,r)}(n,...r)}(RC);const NC=(e,t)=>{try{if(console.log("Firebaseリスナーを設定中...",e),"AIzaSyBXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"===AC.apiKey){console.log("Firebase設定がダミーのため、ローカルストレージを使用します"),(e=>{const t=localStorage.getItem(`tasks_${e}`);if(t){const n=JSON.parse(t),r=n.filter((e,t,n)=>t===n.findIndex(t=>t.id===e.id));if(r.length!==n.length)console.log("重複データをクリアしました"),localStorage.setItem(`tasks_${e}`,JSON.stringify(r))}})(e);const r=localStorage.getItem(`tasks_${e}`);if(r)try{const e=JSON.parse(r);console.log("ローカルストレージから取得したタスク:",e);const n=Array.isArray(e)?e:[];t(n)}catch(n){console.error("ローカルストレージのタスクデータの解析に失敗:",n),t([])}else console.log("ローカルストレージにタスクがありません"),t([]);const i=setInterval(()=>{const r=localStorage.getItem(`tasks_${e}`);if(r)try{const e=JSON.parse(r);console.log("ローカルストレージの更新を検知:",e.length);const n=Array.isArray(e)?e:[];t(n)}catch(n){console.error("ローカルストレージの更新データの解析に失敗:",n),t([])}else t([])},1e3);return PC.getInstance().log("info","Firebaseリスナーを設定しました",{userId:e}),()=>{clearInterval(i)}}const r=function(e,t,...n){if(e=Po(e),mw("collection","path",t),e instanceof Sw){const r=_g.fromString(t,...n);return yw(r),new Ew(e,null,r)}{if(!(e instanceof kw||e instanceof Ew))throw new fg(dg.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(_g.fromString(t,...n));return yw(r),new Ew(e.firestore,null,r)}}(OC,"users",e,"tasks");return bS(function(e,t,...n){let r=[];t instanceof rS&&r.push(t),r=r.concat(n),function(e){const t=e.filter(e=>e instanceof oS).length,n=e.filter(e=>e instanceof sS).length;if(t>1||t>0&&n>0)throw new fg(dg.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)e=i._apply(e);return e}(r,function(e,t="asc"){const n=t,r=nS("orderBy",e);return aS._create(r,n)}("createdAt","desc")),e=>{const n=[];e.forEach(e=>{n.push(u({id:e.id},e.data()))}),console.log("Firebaseからタスクを取得:",n.length),t(n)},n=>{console.error("Firebaseリスナーのエラー:",n);const r=localStorage.getItem(`tasks_${e}`);if(r)try{const e=JSON.parse(r),n=Array.isArray(e)?e:[];t(n)}catch(i){console.error("エラー時のローカルストレージデータの解析に失敗:",i),t([])}else t([])})}catch(n){console.error("Firebaseリスナーの設定に失敗しました:",n);const i=localStorage.getItem(`tasks_${e}`);if(i)try{const e=JSON.parse(i),n=Array.isArray(e)?e:[];t(n)}catch(r){console.error("エラー時のローカルストレージデータの解析に失敗:",r),t([])}else t([]);return()=>{}}},LC=(t,n)=>g(e,null,function*(){try{if(console.log("タスクを保存中...",n),"AIzaSyBXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"===AC.apiKey){console.log("Firebase設定がダミーのため、ローカルストレージに保存します");const r=localStorage.getItem(`tasks_${t}`);let i=[];if(r)try{i=JSON.parse(r),Array.isArray(i)||(console.warn("ローカルストレージのタスクデータが配列ではありません。初期化します。"),i=[])}catch(e){console.error("ローカルストレージのタスクデータの解析に失敗:",e),i=[]}const s=i.findIndex(e=>e.id===n.id);return-1!==s?(i[s]=u(u({},i[s]),n),console.log("既存のタスクを更新しました")):(i.push(n),console.log("新しいタスクを追加しました")),localStorage.setItem(`tasks_${t}`,JSON.stringify(i)),void PC.getInstance().log("info","タスクを保存しました",{taskId:n.id,userId:t})}const r=Iw(OC,"users",t,"tasks",n.id);yield function(e,t,n){e=bw(e,kw);const r=bw(e.firestore,jw),i=function(e,t){let n;return n=e?e.toFirestore(t):t,n}(e.converter,t);return wS(r,[Uw(Ww(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,$v.none())])}(r,n),console.log("タスク保存成功");const i=localStorage.getItem(`tasks_${t}`);let s=[];if(i)try{s=JSON.parse(i),Array.isArray(s)||(s=[])}catch(e){console.error("ローカルストレージのタスクデータの解析に失敗:",e),s=[]}const o=s.findIndex(e=>e.id===n.id);-1!==o?s[o]=u(u({},s[o]),n):s.push(n),localStorage.setItem(`tasks_${t}`,JSON.stringify(s))}catch(e){console.error("タスクの保存に失敗しました:",e);const i=localStorage.getItem(`tasks_${t}`);let s=[];if(i)try{s=JSON.parse(i),Array.isArray(s)||(s=[])}catch(r){console.error("エラー時のローカルストレージデータの解析に失敗:",r),s=[]}const o=s.findIndex(e=>e.id===n.id);throw-1!==o?s[o]=u(u({},s[o]),n):s.push(n),localStorage.setItem(`tasks_${t}`,JSON.stringify(s)),e}}),FC=(t,n,r)=>g(e,null,function*(){try{if(console.log("タスクを更新中...",n,r),"AIzaSyBXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"===AC.apiKey){console.log("Firebase設定がダミーのため、ローカルストレージを更新します");const e=localStorage.getItem(`tasks_${t}`);if(e){const i=JSON.parse(e).map(e=>e.id===n?u(u({},e),r):e);localStorage.setItem(`tasks_${t}`,JSON.stringify(i))}return}const e=Iw(OC,"users",t,"tasks",n);yield xS(e,r),console.log("タスク更新成功");const i=localStorage.getItem(`tasks_${t}`);if(i){const e=JSON.parse(i).map(e=>e.id===n?u(u({},e),r):e);localStorage.setItem(`tasks_${t}`,JSON.stringify(e))}}catch(e){console.error("タスクの更新に失敗しました:",e);const i=localStorage.getItem(`tasks_${t}`);if(i){const e=JSON.parse(i).map(e=>e.id===n?u(u({},e),r):e);localStorage.setItem(`tasks_${t}`,JSON.stringify(e))}throw e}}),VC=(t,n)=>g(e,null,function*(){try{if(console.log("タスクを削除中...",n),"AIzaSyBXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"===AC.apiKey){console.log("Firebase設定がダミーのため、ローカルストレージから削除します");const e=localStorage.getItem(`tasks_${t}`);if(e){const r=JSON.parse(e).filter(e=>e.id!==n);localStorage.setItem(`tasks_${t}`,JSON.stringify(r)),console.log("ローカルストレージからタスクを削除しました"),setTimeout(()=>{const e=localStorage.getItem(`tasks_${t}`);if(e){const t=JSON.parse(e);console.log("削除後のタスク更新:",t)}},100)}return}const r=Iw(OC,"users",t,"tasks",n);yield(e=r,wS(bw(e.firestore,jw),[new iy(e._key,$v.none())])),console.log("タスク削除成功");const i=localStorage.getItem(`tasks_${t}`);if(i){const e=JSON.parse(i).filter(e=>e.id!==n);localStorage.setItem(`tasks_${t}`,JSON.stringify(e))}}catch(r){console.error("タスクの削除に失敗しました:",r);const e=localStorage.getItem(`tasks_${t}`);if(e){const r=JSON.parse(e).filter(e=>e.id!==n);localStorage.setItem(`tasks_${t}`,JSON.stringify(r))}throw r}var e}),BC=({onMenuClick:e})=>{const t=un(),{user:n,logout:r}=to(),{isDarkMode:i,toggleTheme:s}=oo(),[o,a]=on.useState(null),[l,c]=on.useState(null),[d,f]=on.useState([]),[p,g]=on.useState([]),m=()=>{if(!(null==n?void 0:n.id))return[];const e=localStorage.getItem(`notifications_${n.id}`);return e?JSON.parse(e):[]},v=e=>{(null==n?void 0:n.id)&&localStorage.setItem(`notifications_${n.id}`,JSON.stringify(e))},x=()=>{a(null),c(null)};on.useEffect(()=>{if(!(null==n?void 0:n.id))return;const e=m();f(e)},[null==n?void 0:n.id]),on.useEffect(()=>{if(!(null==n?void 0:n.id))return;const e=NC(n.id,e=>{g(e);const t=m(),n=((e,t)=>{const n=[],r=new Date;return e.forEach(e=>{const i=new Date(e.dueDate),s=Math.ceil((i.getTime()-r.getTime())/864e5);if(s<=1&&s>=0&&"done"!==e.status){const r=`due-${e.id}`;t.some(e=>e.id===r)||n.push({id:r,title:"タスクの期限が近づいています",message:`「${e.title}」の期限が${0===s?"今日":"明日"}です`,time:0===s?"今日":"明日",read:!1,type:"task",createdAt:(new Date).toISOString()})}}),e.filter(e=>{const t=new Date(e.createdAt);return(r.getTime()-t.getTime())/36e5<=24}).forEach(e=>{const r=`new-${e.id}`;t.some(e=>e.id===r)||n.push({id:r,title:"新しいタスクが作成されました",message:`「${e.title}」が作成されました`,time:"新着",read:!1,type:"task",createdAt:(new Date).toISOString()})}),n})(e,t),r=new Date;r.setDate(r.getDate()-7);const i=[...t.filter(e=>new Date(e.createdAt)>r),...n];f(i),v(i)});return()=>e()},[null==n?void 0:n.id]);const b=d.filter(e=>!e.read).length;return n?y.jsx(w,{position:"fixed",sx:{zIndex:e=>e.zIndex.drawer+1,backgroundColor:"#ffffff",color:"#1a1a1a",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.08)",borderBottom:"1px solid #e9ecef"},children:y.jsxs(S,{sx:{minHeight:"64px !important"},children:[y.jsx(k,{edge:"start",color:"inherit","aria-label":"menu",onClick:e,sx:{mr:2,color:"#6c757d","&:hover":{backgroundColor:"#f8f9fa"}},children:y.jsx(C,{})}),y.jsx(E,{variant:"h5",component:"div",sx:{flexGrow:1,fontWeight:700,color:"#6366f1",cursor:"pointer",fontSize:"1.5rem"},onClick:()=>t("/"),children:"TaskFlow"}),y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(D,{title:"検索",children:y.jsx(k,{color:"inherit",sx:{color:"#6c757d","&:hover":{backgroundColor:"#f8f9fa"}},children:y.jsx(T,{})})}),y.jsx(D,{title:"新しいタスク",children:y.jsx(j,{size:"small",onClick:()=>t("/task/new"),sx:{backgroundColor:"#6366f1",color:"white",width:36,height:36,boxShadow:"0 2px 8px rgba(99, 102, 241, 0.3)","&:hover":{backgroundColor:"#4f46e5",boxShadow:"0 4px 12px rgba(99, 102, 241, 0.4)"}},children:y.jsx(_,{sx:{fontSize:18}})})}),y.jsx(D,{title:"通知",children:y.jsx(k,{color:"inherit",onClick:e=>{c(e.currentTarget)},sx:{color:"#6c757d","&:hover":{backgroundColor:"#f8f9fa"}},children:y.jsx(M,{badgeContent:b,color:"error",sx:{"& .MuiBadge-badge":{backgroundColor:"#dc3545",color:"white",fontSize:"0.75rem",fontWeight:600}},children:y.jsx(P,{})})})}),y.jsx(D,{title:i?"ライトモード":"ダークモード",children:y.jsx(k,{color:"inherit",onClick:s,sx:{color:"#6c757d","&:hover":{backgroundColor:"#f8f9fa"}},children:i?y.jsx(A,{}):y.jsx(R,{})})}),y.jsx(D,{title:"アカウント",children:y.jsx(k,{color:"inherit",onClick:e=>{a(e.currentTarget)},sx:{color:"#6c757d","&:hover":{backgroundColor:"#f8f9fa"}},children:y.jsx(O,{sx:{width:32,height:32,bgcolor:"#6366f1",fontSize:"0.875rem",fontWeight:600},children:n.name.charAt(0)})})})]}),y.jsxs(N,{anchorEl:l,open:Boolean(l),onClose:x,PaperProps:{sx:{width:360,maxHeight:400,borderRadius:2,boxShadow:"0 8px 24px rgba(0, 0, 0, 0.12)",border:"1px solid #e9ecef"}},children:[y.jsxs(I,{sx:{p:2,borderBottom:1,borderColor:"divider",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[y.jsx(E,{variant:"h6",sx:{fontWeight:600,color:"#1a1a1a"},children:"通知"}),b>0&&y.jsx(E,{variant:"body2",sx:{color:"#6366f1",cursor:"pointer",fontWeight:500,"&:hover":{textDecoration:"underline"}},onClick:()=>{const e=d.map(e=>h(u({},e),{read:!0}));f(e),v(e)},children:"すべて既読にする"})]}),d.map(e=>y.jsx(L,{onClick:()=>(e=>{const t=d.map(t=>t.id===e?h(u({},t),{read:!0}):t);f(t),v(t)})(e.id),sx:{py:1.5,px:2,backgroundColor:e.read?"transparent":"#f8f9fa","&:hover":{backgroundColor:"#f8f9fa"},cursor:"pointer"},children:y.jsxs(I,{sx:{width:"100%"},children:[y.jsx(E,{variant:"body2",sx:{fontWeight:500,mb:.5,color:e.read?"#6c757d":"#1a1a1a"},children:e.title}),y.jsx(E,{variant:"caption",color:"text.secondary",sx:{lineHeight:1.4},children:e.message}),y.jsx(E,{variant:"caption",color:"text.secondary",display:"block",sx:{mt:.5},children:e.time})]})},e.id)),0===d.length&&y.jsx(L,{children:y.jsx(E,{variant:"body2",color:"text.secondary",children:"通知はありません"})})]}),y.jsxs(N,{anchorEl:o,open:Boolean(o),onClose:x,PaperProps:{sx:{width:240,borderRadius:2,boxShadow:"0 8px 24px rgba(0, 0, 0, 0.12)",border:"1px solid #e9ecef"}},children:[y.jsx(I,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:2},children:[y.jsx(O,{sx:{width:48,height:48,bgcolor:"#6366f1",fontSize:"1.25rem",fontWeight:600},children:n.name.charAt(0)}),y.jsxs(I,{children:[y.jsx(E,{variant:"body1",sx:{fontWeight:600,color:"#1a1a1a"},children:n.name}),y.jsx(E,{variant:"caption",color:"text.secondary",children:n.email})]})]})}),y.jsxs(L,{onClick:()=>{t("/profile"),x()},sx:{py:1.5},children:[y.jsx(F,{children:y.jsx(V,{fontSize:"small",sx:{color:"#6c757d"}})}),y.jsx(B,{primary:"プロフィール",primaryTypographyProps:{sx:{fontWeight:500,color:"#1a1a1a"}}})]}),y.jsxs(L,{onClick:()=>{t("/settings"),x()},sx:{py:1.5},children:[y.jsx(F,{children:y.jsx(z,{fontSize:"small",sx:{color:"#6c757d"}})}),y.jsx(B,{primary:"設定",primaryTypographyProps:{sx:{fontWeight:500,color:"#1a1a1a"}}})]}),y.jsx(W,{}),y.jsxs(L,{onClick:()=>{r(),x(),t("/login")},sx:{py:1.5},children:[y.jsx(F,{children:y.jsx(U,{fontSize:"small",sx:{color:"#dc3545"}})}),y.jsx(B,{primary:"ログアウト",primaryTypographyProps:{sx:{fontWeight:500,color:"#dc3545"}}})]})]})]})}):null},zC=({open:e,onToggle:t})=>{const n=un(),r=hn(),{user:i}=to(),{isDarkMode:s,toggleTheme:o}=oo(),[a,l]=on.useState(null),[c,d]=on.useState(null),[f,p]=on.useState([]),[g,m]=on.useState([{text:"個人プロジェクト",icon:y.jsx(V,{}),path:"/project/personal",badge:0},{text:"仕事",icon:y.jsx(H,{}),path:"/project/work",badge:0},{text:"学習",icon:y.jsx($,{}),path:"/project/study",badge:0}]),[v,x]=on.useState([{text:"個人プロジェクト",icon:y.jsx(V,{}),path:"/workspace/personal",badge:0},{text:"チームA",icon:y.jsx(q,{}),path:"/workspace/team-a",badge:0},{text:"プロジェクトX",icon:y.jsx(q,{}),path:"/workspace/project-x",badge:0}]),b=[{text:"ダッシュボード",icon:y.jsx(J,{}),path:"/",badge:null},{text:"カンバンボード",icon:y.jsx(Z,{}),path:"/kanban",badge:null},{text:"カレンダー",icon:y.jsx(ee,{}),path:"/calendar",badge:null},{text:"タイムライン",icon:y.jsx(te,{}),path:"/timeline",badge:null},{text:"リスト",icon:y.jsx(ne,{}),path:"/list",badge:null},{text:"ポモドーロ",icon:y.jsx(re,{}),path:"/pomodoro",badge:null},{text:"マインドマップ",icon:y.jsx(ie,{}),path:"/mindmap",badge:null}],w=on.useCallback(()=>{if(console.log("Sidebar: updateBadgeCounts呼び出し"),console.log("Sidebar: タスク数:",f.length),console.log("Sidebar: タスク詳細:",f),!Array.isArray(f))return void console.log("Sidebar: tasksが配列ではありません:",f);const e=f.filter(e=>!e.workspace||"個人プロジェクト"===e.workspace).length;console.log("Sidebar: 個人プロジェクトのタスク数:",e);const t=f.filter(e=>"チームA"===e.workspace).length;console.log("Sidebar: チームAのタスク数:",t);const n=f.filter(e=>"プロジェクトX"===e.workspace).length;console.log("Sidebar: プロジェクトXのタスク数:",n);const r=f.filter(e=>"仕事"===e.project).length;console.log("Sidebar: 仕事プロジェクトのタスク数:",r);const i=f.filter(e=>"学習"===e.project).length;console.log("Sidebar: 学習プロジェクトのタスク数:",i),x(r=>{const i=r.map(r=>"個人プロジェクト"===r.text?h(u({},r),{badge:e>0?e:null}):"チームA"===r.text?h(u({},r),{badge:t>0?t:null}):"プロジェクトX"===r.text?h(u({},r),{badge:n>0?n:null}):r);return console.log("Sidebar: ワークスペースバッジ更新:",i),i}),m(t=>{const n=t.map(t=>"個人プロジェクト"===t.text?h(u({},t),{badge:e>0?e:null}):"仕事"===t.text?h(u({},t),{badge:r>0?r:null}):"学習"===t.text?h(u({},t),{badge:i>0?i:null}):t);return console.log("Sidebar: プロジェクトバッジ更新:",n),n})},[f]);return on.useEffect(()=>{if(!(null==i?void 0:i.id))return;const e=NC(i.id,e=>{console.log("Sidebar: Firebaseからタスクを受信:",e),console.log("Sidebar: 受信したタスク数:",e.length);const t=Array.isArray(e)?e:[];p(t)}),t=localStorage.getItem("currentProject"),n=localStorage.getItem("currentWorkspace");return t&&(l(t),console.log("Sidebar: 保存されたプロジェクトを復元:",t)),n&&(d(n),console.log("Sidebar: 保存されたワークスペースを復元:",n)),()=>e()},[null==i?void 0:i.id]),on.useEffect(()=>{Array.isArray(f)&&f.length>=0&&(console.log("Sidebar: タスク更新によりバッジ数を再計算, タスク数:",f.length),w())},[f,w]),on.useEffect(()=>{a&&(localStorage.setItem("currentProject",a),console.log("Sidebar: プロジェクト選択を保存:",a)),c&&(localStorage.setItem("currentWorkspace",c),console.log("Sidebar: ワークスペース選択を保存:",c))},[a,c]),i?y.jsxs(X,{variant:"permanent",open:e,sx:{width:e?240:64,flexShrink:0,"& .MuiDrawer-paper":{width:e?240:64,overflowX:"hidden",transition:"width 0.3s ease-in-out"}},children:[y.jsxs(I,{sx:{p:2,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e&&y.jsx(Cr.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3},children:y.jsx(E,{variant:"h6",sx:{fontWeight:600,color:"primary.main"},children:"TaskFlow"})}),y.jsx(D,{title:e?"サイドバーを閉じる":"サイドバーを開く",children:y.jsx(k,{onClick:t,size:"small",children:y.jsx(T,{})})})]}),y.jsx(W,{}),y.jsx(I,{sx:{p:2},children:y.jsx(D,{title:"新しいタスク",placement:"right",children:y.jsxs(k,{color:"primary",sx:{width:"100%",height:48,borderRadius:2,backgroundColor:"primary.main",color:"white","&:hover":{backgroundColor:"primary.dark"}},onClick:()=>n("/task/new"),children:[y.jsx(_,{}),e&&y.jsx(Cr.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3},style:{marginLeft:8},children:y.jsx(E,{variant:"body2",sx:{fontWeight:500},children:"新しいタスク"})})]})})}),y.jsx(W,{}),y.jsx(K,{sx:{px:1},children:b.map(t=>y.jsx(G,{disablePadding:!0,sx:{mb:.5},children:y.jsxs(Y,{onClick:()=>{return e=t.path,void n(e);var e},selected:r.pathname===t.path,sx:{borderRadius:2,minHeight:48,"&.Mui-selected":{backgroundColor:"primary.main",color:"white","&:hover":{backgroundColor:"primary.dark"}},"&:hover":{backgroundColor:"action.hover"}},children:[y.jsx(F,{sx:{minWidth:40,color:r.pathname===t.path?"white":"inherit"},children:t.icon}),e&&y.jsxs(Cr.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3},style:{flex:1,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[y.jsx(B,{primary:t.text,primaryTypographyProps:{fontSize:"0.875rem",fontWeight:r.pathname===t.path?600:500}}),t.badge&&y.jsx(M,{badgeContent:t.badge,color:"error",sx:{"& .MuiBadge-badge":{backgroundColor:r.pathname===t.path?"white":"primary.main",color:r.pathname===t.path?"primary.main":"white"}}})]})]})},t.text))}),y.jsx(W,{}),e&&y.jsx(Cr.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{duration:.3},children:y.jsx(I,{sx:{p:2},children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[y.jsx(E,{variant:"overline",sx:{color:"text.secondary",fontWeight:600},children:"プロジェクト"}),y.jsx(k,{size:"small",onClick:()=>{const e=prompt("新しいプロジェクト名を入力してください:");if(e&&e.trim()){const t={text:e.trim(),icon:y.jsx(H,{}),path:`/project/${e.toLowerCase().replace(/\s+/g,"-")}`,badge:0};m(e=>[...e,t]),mn.success(`プロジェクト「${e}」を作成しました`)}},sx:{color:"primary.main","&:hover":{backgroundColor:"primary.50"}},children:y.jsx(_,{sx:{fontSize:16}})})]})})}),y.jsx(K,{sx:{px:1},children:g.map(t=>y.jsx(G,{disablePadding:!0,sx:{mb:.5},children:y.jsxs(Y,{onClick:()=>(e=>{console.log(`プロジェクト "${e}" が選択されました`),l(e),d(null);let t=[];switch(e){case"個人プロジェクト":t=f.filter(e=>!e.project||"個人プロジェクト"===e.project);break;case"仕事":t=f.filter(e=>"仕事"===e.project);break;case"学習":t=f.filter(e=>"学習"===e.project);break;default:t=f}console.log("フィルタリングされたタスク:",t),localStorage.setItem("filteredTasks",JSON.stringify(t)),localStorage.setItem("currentProject",e),localStorage.removeItem("currentWorkspace"),window.dispatchEvent(new CustomEvent("filterChanged",{detail:{type:"project",value:e,filteredTasks:t}})),mn.success(`${e}のタスクを表示中`)})(t.text),selected:a===t.text,sx:{borderRadius:2,minHeight:48,"&.Mui-selected":{backgroundColor:"primary.main",color:"primary.contrastText","&:hover":{backgroundColor:"primary.dark"}}},children:[y.jsx(F,{sx:{minWidth:40},children:t.icon}),e&&y.jsxs(I,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",flex:1},children:[y.jsx(B,{primary:t.text,primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500}}),y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(M,{badgeContent:t.badge,color:"primary",sx:{"& .MuiBadge-badge":{fontSize:"0.625rem",height:18,minWidth:18}}}),"個人プロジェクト"!==t.text&&y.jsx(k,{size:"small",onClick:e=>{var n;e.stopPropagation(),n=t.text,confirm(`プロジェクト「${n}」を削除しますか？`)&&(m(e=>e.filter(e=>e.text!==n)),mn.success(`プロジェクト「${n}」を削除しました`))},sx:{color:"error.main","&:hover":{backgroundColor:"error.50"},ml:1},children:y.jsx(Q,{sx:{fontSize:14}})})]})]})]})},t.text))}),y.jsx(W,{}),e&&y.jsx(Cr.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{duration:.3},children:y.jsx(I,{sx:{p:2},children:y.jsx(E,{variant:"overline",sx:{color:"text.secondary",fontWeight:600},children:"ワークスペース"})})}),y.jsx(K,{sx:{px:1},children:v.map(t=>y.jsx(G,{disablePadding:!0,sx:{mb:.5},children:y.jsxs(Y,{onClick:()=>(e=>{console.log(`ワークスペース "${e}" が選択されました`),d(e),l(null);let t=[];switch(e){case"個人プロジェクト":t=f.filter(e=>!e.workspace||"個人プロジェクト"===e.workspace);break;case"チームA":t=f.filter(e=>"チームA"===e.workspace);break;case"プロジェクトX":t=f.filter(e=>"プロジェクトX"===e.workspace);break;default:t=f}console.log("フィルタリングされたタスク:",t),localStorage.setItem("filteredTasks",JSON.stringify(t)),localStorage.setItem("currentWorkspace",e),localStorage.removeItem("currentProject"),window.dispatchEvent(new CustomEvent("filterChanged",{detail:{type:"workspace",value:e,filteredTasks:t}})),mn.success(`${e}のタスクを表示中`)})(t.text),selected:c===t.text,sx:{borderRadius:2,minHeight:48,"&.Mui-selected":{backgroundColor:"primary.main",color:"white","&:hover":{backgroundColor:"primary.dark"}},"&:hover":{backgroundColor:"action.hover"}},children:[y.jsx(F,{sx:{minWidth:40,color:c===t.text?"white":"inherit"},children:t.icon}),e&&y.jsxs(Cr.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3},style:{flex:1,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[y.jsx(B,{primary:t.text,primaryTypographyProps:{fontSize:"0.875rem",fontWeight:c===t.text?600:500}}),y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[t.badge&&y.jsx(M,{badgeContent:t.badge,color:"error",sx:{"& .MuiBadge-badge":{backgroundColor:c===t.text?"white":"primary.main",color:c===t.text?"primary.main":"white"}}}),"個人プロジェクト"!==t.text&&y.jsx(k,{size:"small",onClick:e=>{var n;e.stopPropagation(),n=t.text,confirm(`ワークスペース「${n}」を削除しますか？`)&&(x(e=>e.filter(e=>e.text!==n)),mn.success(`ワークスペース「${n}」を削除しました`))},sx:{color:"error.main","&:hover":{backgroundColor:"error.50"},ml:1},children:y.jsx(Q,{sx:{fontSize:14}})})]})]})]})},t.text))}),y.jsx(I,{sx:{flexGrow:1}}),y.jsx(W,{}),y.jsxs(K,{sx:{px:1},children:[y.jsx(G,{disablePadding:!0,sx:{mb:.5},children:y.jsxs(Y,{onClick:()=>n("/profile"),sx:{borderRadius:2,minHeight:48,"&:hover":{backgroundColor:"action.hover"}},children:[y.jsx(F,{sx:{minWidth:40},children:y.jsx(V,{})}),e&&y.jsx(Cr.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3},children:y.jsx(B,{primary:"プロフィール",primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500}})})]})}),y.jsx(G,{disablePadding:!0,sx:{mb:.5},children:y.jsxs(Y,{onClick:()=>n("/settings"),sx:{borderRadius:2,minHeight:48,"&:hover":{backgroundColor:"action.hover"}},children:[y.jsx(F,{sx:{minWidth:40},children:y.jsx(z,{})}),e&&y.jsx(Cr.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3},children:y.jsx(B,{primary:"設定",primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500}})})]})})]})]}):null};var WC={lessThanXSeconds:{one:"1秒未満",other:"{{count}}秒未満",oneWithSuffix:"約1秒",otherWithSuffix:"約{{count}}秒"},xSeconds:{one:"1秒",other:"{{count}}秒"},halfAMinute:"30秒",lessThanXMinutes:{one:"1分未満",other:"{{count}}分未満",oneWithSuffix:"約1分",otherWithSuffix:"約{{count}}分"},xMinutes:{one:"1分",other:"{{count}}分"},aboutXHours:{one:"約1時間",other:"約{{count}}時間"},xHours:{one:"1時間",other:"{{count}}時間"},xDays:{one:"1日",other:"{{count}}日"},aboutXWeeks:{one:"約1週間",other:"約{{count}}週間"},xWeeks:{one:"1週間",other:"{{count}}週間"},aboutXMonths:{one:"約1か月",other:"約{{count}}か月"},xMonths:{one:"1か月",other:"{{count}}か月"},aboutXYears:{one:"約1年",other:"約{{count}}年"},xYears:{one:"1年",other:"{{count}}年"},overXYears:{one:"1年以上",other:"{{count}}年以上"},almostXYears:{one:"1年近く",other:"{{count}}年近く"}},UC={date:vn({formats:{full:"y年M月d日EEEE",long:"y年M月d日",medium:"y/MM/dd",short:"y/MM/dd"},defaultWidth:"full"}),time:vn({formats:{full:"H時mm分ss秒 zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},defaultWidth:"full"}),dateTime:vn({formats:{full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},defaultWidth:"full"})},HC={lastWeek:"先週のeeeeのp",yesterday:"昨日のp",today:"今日のp",tomorrow:"明日のp",nextWeek:"翌週のeeeeのp",other:"P"},$C={code:"ja",formatDistance:function(e,t,n){var r;n=n||{};var i=WC[e];return r="string"==typeof i?i:1===t?n.addSuffix&&i.oneWithSuffix?i.oneWithSuffix:i.one:n.addSuffix&&i.otherWithSuffix?i.otherWithSuffix.replace("{{count}}",String(t)):i.other.replace("{{count}}",String(t)),n.addSuffix?n.comparison&&n.comparison>0?r+"後":r+"前":r},formatLong:UC,formatRelative:function(e,t,n,r){return HC[e]},localize:{ordinalNumber:function(e,t){var n=Number(e);switch(String(null==t?void 0:t.unit)){case"year":return"".concat(n,"年");case"quarter":return"第".concat(n,"四半期");case"month":return"".concat(n,"月");case"week":return"第".concat(n,"週");case"date":return"".concat(n,"日");case"hour":return"".concat(n,"時");case"minute":return"".concat(n,"分");case"second":return"".concat(n,"秒");default:return"".concat(n)}},era:yn({values:{narrow:["BC","AC"],abbreviated:["紀元前","西暦"],wide:["紀元前","西暦"]},defaultWidth:"wide"}),quarter:yn({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["第1四半期","第2四半期","第3四半期","第4四半期"]},defaultWidth:"wide",argumentCallback:function(e){return Number(e)-1}}),month:yn({values:{narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],wide:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]},defaultWidth:"wide"}),day:yn({values:{narrow:["日","月","火","水","木","金","土"],short:["日","月","火","水","木","金","土"],abbreviated:["日","月","火","水","木","金","土"],wide:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"]},defaultWidth:"wide"}),dayPeriod:yn({values:{narrow:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},abbreviated:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},wide:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"}},defaultWidth:"wide",formattingValues:{narrow:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},abbreviated:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},wide:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:bn({matchPattern:/^第?\d+(年|四半期|月|週|日|時|分|秒)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:xn({matchPatterns:{narrow:/^(B\.?C\.?|A\.?D\.?)/i,abbreviated:/^(紀元[前後]|西暦)/i,wide:/^(紀元[前後]|西暦)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^B/i,/^A/i],any:[/^(紀元前)/i,/^(西暦|紀元後)/i]},defaultParseWidth:"any"}),quarter:xn({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^Q[1234]/i,wide:/^第[1234一二三四１２３４]四半期/i},defaultMatchWidth:"wide",parsePatterns:{any:[/(1|一|１)/i,/(2|二|２)/i,/(3|三|３)/i,/(4|四|４)/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:xn({matchPatterns:{narrow:/^([123456789]|1[012])/,abbreviated:/^([123456789]|1[012])月/i,wide:/^([123456789]|1[012])月/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^1\D/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},defaultParseWidth:"any"}),day:xn({matchPatterns:{narrow:/^[日月火水木金土]/,short:/^[日月火水木金土]/,abbreviated:/^[日月火水木金土]/,wide:/^[日月火水木金土]曜日/},defaultMatchWidth:"wide",parsePatterns:{any:[/^日/,/^月/,/^火/,/^水/,/^木/,/^金/,/^土/]},defaultParseWidth:"any"}),dayPeriod:xn({matchPatterns:{any:/^(AM|PM|午前|午後|正午|深夜|真夜中|夜|朝)/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^(A|午前)/i,pm:/^(P|午後)/i,midnight:/^深夜|真夜中/i,noon:/^正午/i,morning:/^朝/i,afternoon:/^午後/i,evening:/^夜/i,night:/^深夜/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function qC(e,t,n){return"function"==typeof e?e(t,n):e}function XC(e){if(void 0===e)return{};const t={};return Object.keys(e).filter(t=>!(t.match(/^on[A-Z]/)&&"function"==typeof e[t])).forEach(n=>{t[n]=e[n]}),t}function KC(e){const{getSlotProps:t,additionalProps:n,externalSlotProps:r,externalForwardedProps:i,className:s}=e;if(!t){const e=se(null==n?void 0:n.className,s,null==i?void 0:i.className,null==r?void 0:r.className),t=u(u(u({},null==n?void 0:n.style),null==i?void 0:i.style),null==r?void 0:r.style),o=u(u(u({},n),i),r);return e.length>0&&(o.className=e),Object.keys(t).length>0&&(o.style=t),{props:o,internalRef:void 0}}const o=function(e,t=[]){if(void 0===e)return{};const n={};return Object.keys(e).filter(n=>n.match(/^on[A-Z]/)&&"function"==typeof e[n]&&!t.includes(n)).forEach(t=>{n[t]=e[t]}),n}(u(u({},i),r)),a=XC(r),l=XC(i),c=t(o),h=se(null==c?void 0:c.className,null==n?void 0:n.className,s,null==i?void 0:i.className,null==r?void 0:r.className),d=u(u(u(u({},null==c?void 0:c.style),null==n?void 0:n.style),null==i?void 0:i.style),null==r?void 0:r.style),f=u(u(u(u({},c),n),l),a);return h.length>0&&(f.className=h),Object.keys(d).length>0&&(f.style=d),{props:f,internalRef:c.ref}}function GC(e){var t;const n=e,{elementType:r,externalSlotProps:i,ownerState:s,skipResolvingSlotProps:o=!1}=n,a=d(n,["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"]),l=o?{}:qC(i,s),{props:c,internalRef:f}=KC(h(u({},a),{externalSlotProps:l})),p=function(...e){const t=on.useRef(void 0),n=on.useCallback(t=>{const n=e.map(e=>{if(null==e)return null;if("function"==typeof e){const n=e,r=n(t);return"function"==typeof r?r:()=>{n(null)}}return e.current=t,()=>{e.current=null}});return()=>{n.forEach(e=>null==e?void 0:e())}},e);return on.useMemo(()=>e.every(e=>null==e)?null:e=>{t.current&&(t.current(),t.current=void 0),null!=e&&(t.current=n(e))},e)}(f,null==l?void 0:l.ref,null==(t=e.additionalProps)?void 0:t.ref),g=function(e,t,n){return void 0===e||"string"==typeof e?t:h(u({},t),{ownerState:u(u({},t.ownerState),n)})}(r,h(u({},c),{ref:p}),s);return g}const YC=(e,t)=>e.length===t.length&&t.every(t=>e.includes(t)),QC=(e,t,n)=>{let r=t;return r=e.setHours(r,e.getHours(n)),r=e.setMinutes(r,e.getMinutes(n)),r=e.setSeconds(r,e.getSeconds(n)),r},JC=({date:e,disableFuture:t,disablePast:n,maxDate:r,minDate:i,isDateDisabled:s,utils:o,timezone:a})=>{const l=QC(o,o.dateWithTimezone(void 0,a),e);n&&o.isBefore(i,l)&&(i=l),t&&o.isAfter(r,l)&&(r=l);let c=e,u=e;for(o.isBefore(e,i)&&(c=i,u=null),o.isAfter(e,r)&&(u&&(u=r),c=null);c||u;){if(c&&o.isAfter(c,r)&&(c=null),u&&o.isBefore(u,i)&&(u=null),c){if(!s(c))return c;c=o.addDays(c,1)}if(u){if(!s(u))return u;u=o.addDays(u,-1)}}return null},ZC=(e,t,n)=>null!=t&&e.isValid(t)?t:n,eE=(e,t)=>{const n=[e.startOfYear(t)];for(;n.length<12;){const t=n[n.length-1];n.push(e.addMonths(t,1))}return n},tE=(e,t,n)=>"date"===n?e.startOfDay(e.dateWithTimezone(void 0,t)):e.dateWithTimezone(void 0,t),nE=["year","month","day"],rE=e=>nE.includes(e),iE=(e,{format:t,views:n},r)=>{if(null!=t)return t;const i=e.formats;return YC(n,["year"])?i.year:YC(n,["month"])?i.month:YC(n,["day"])?i.dayOfMonth:YC(n,["month","year"])?`${i.month} ${i.year}`:YC(n,["day","month"])?`${i.month} ${i.dayOfMonth}`:r?/en/.test(e.getCurrentLocaleCode())?i.normalDateWithWeekday:i.normalDate:i.keyboardDate},sE=(e,t)=>{const n=e.startOfWeek(t);return[0,1,2,3,4,5,6].map(t=>e.addDays(n,t))},oE=["hours","minutes","seconds"],aE=(e,t)=>3600*t.getHours(e)+60*t.getMinutes(e)+t.getSeconds(e),lE={year:1,month:2,day:3,hours:4,minutes:5,seconds:6,milliseconds:7},cE=(e,t,n)=>{if(t===lE.year)return e.startOfYear(n);if(t===lE.month)return e.startOfMonth(n);if(t===lE.day)return e.startOfDay(n);let r=n;return t<lE.minutes&&(r=e.setMinutes(r,0)),t<lE.seconds&&(r=e.setSeconds(r,0)),t<lE.milliseconds&&(r=e.setMilliseconds(r,0)),r},uE=({props:e,utils:t,granularity:n,timezone:r,getTodayDate:i})=>{var s;let o=i?i():cE(t,n,tE(t,r));null!=e.minDate&&t.isAfterDay(e.minDate,o)&&(o=cE(t,n,e.minDate)),null!=e.maxDate&&t.isBeforeDay(e.maxDate,o)&&(o=cE(t,n,e.maxDate));const a=((e,t)=>(n,r)=>e?t.isAfter(n,r):aE(n,t)>aE(r,t))(null!=(s=e.disableIgnoringDatePartForTimeValidation)&&s,t);return null!=e.minTime&&a(e.minTime,o)&&(o=cE(t,n,e.disableIgnoringDatePartForTimeValidation?e.minTime:QC(t,o,e.minTime))),null!=e.maxTime&&a(o,e.maxTime)&&(o=cE(t,n,e.disableIgnoringDatePartForTimeValidation?e.maxTime:QC(t,o,e.maxTime))),o},hE=(e,t)=>{const n=e.formatTokenMap[t];if(null==n)throw new Error([`MUI: The token "${t}" is not supported by the Date and Time Pickers.`,"Please try using another token or open an issue on https://github.com/mui/mui-x/issues/new/choose if you think it should be supported."].join("\n"));return"string"==typeof n?{type:n,contentType:"meridiem"===n?"letter":"digit",maxLength:void 0}:{type:n.sectionType,contentType:n.contentType,maxLength:n.maxLength}},dE=(e,t,n)=>{const r=[],i=e.dateWithTimezone(void 0,t),s=e.startOfWeek(i),o=e.endOfWeek(i);let a=s;for(;e.isBefore(a,o);)r.push(a),a=e.addDays(a,1);return r.map(t=>e.formatByString(t,n))},fE=(e,t,n,r)=>{switch(n){case"month":return eE(e,e.dateWithTimezone(void 0,t)).map(t=>e.formatByString(t,r));case"weekDay":return dE(e,t,r);case"meridiem":{const n=e.dateWithTimezone(void 0,t);return[e.startOfDay(n),e.endOfDay(n)].map(t=>e.formatByString(t,r))}default:return[]}},pE=(e,t,n)=>{let r=t;for(r=Number(r).toString();r.length<n;)r=`0${r}`;return r},gE=(e,t,n,r,i)=>{if("day"===i.type&&"digit-with-letter"===i.contentType){const t=e.setDate(r.longestMonth,n);return e.formatByString(t,i.format)}const s=n.toString();return i.hasLeadingZerosInInput?pE(0,s,i.maxLength):s},mE=(e,t,n,r,i,s,o)=>{const a=(e=>{switch(e){case"ArrowUp":return 1;case"ArrowDown":return-1;case"PageUp":return 5;case"PageDown":return-5;default:return 0}})(r),l="Home"===r,c="End"===r,u=""===n.value||l||c;return"digit"===n.contentType||"digit-with-letter"===n.contentType?(()=>{const r=i[n.type]({currentDate:s,format:n.format,contentType:n.contentType}),h=t=>gE(e,0,t,r,n),d="minutes"===n.type&&null!=o&&o.minutesStep?o.minutesStep:1;let f=parseInt(n.value,10)+a*d;if(u){if("year"===n.type&&!c&&!l)return e.formatByString(e.dateWithTimezone(void 0,t),n.format);f=a>0||l?r.minimum:r.maximum}return f%d!==0&&((a<0||l)&&(f+=d-(d+f)%d),(a>0||c)&&(f-=f%d)),f>r.maximum?h(r.minimum+(f-r.maximum-1)%(r.maximum-r.minimum+1)):f<r.minimum?h(r.maximum-(r.minimum-f-1)%(r.maximum-r.minimum+1)):h(f)})():(()=>{const r=fE(e,t,n.type,n.format);if(0===r.length)return n.value;if(u)return a>0||l?r[0]:r[r.length-1];const i=r.indexOf(n.value);return r[(i+r.length+a)%r.length]})()},vE=(e,t)=>{let n=e.value||e.placeholder;const r="non-input"===t?e.hasLeadingZerosInFormat:e.hasLeadingZerosInInput;return"non-input"===t&&e.hasLeadingZerosInInput&&!e.hasLeadingZerosInFormat&&(n=Number(n).toString()),["input-rtl","input-ltr"].includes(t)&&"digit"===e.contentType&&!r&&1===n.length&&(n=`${n}‎`),"input-rtl"===t&&(n=`⁨${n}⁩`),n},yE=e=>e.replace(/[\u2066\u2067\u2068\u2069]/g,""),xE=(e,t)=>{let n=0,r=t?1:0;const i=[];for(let s=0;s<e.length;s+=1){const o=e[s],a=vE(o,t?"input-rtl":"input-ltr"),l=`${o.startSeparator}${a}${o.endSeparator}`,c=yE(l).length,u=l.length,h=yE(a),d=r+a.indexOf(h[0])+o.startSeparator.length,f=d+h.length;i.push(m({},o,{start:n,end:n+c,startInInput:d,endInInput:f})),n+=c,r+=u}return i},bE=(e,t,n,r,i)=>{switch(r.type){case"year":return n.fieldYearPlaceholder({digitAmount:e.formatByString(e.dateWithTimezone(void 0,t),i).length,format:i});case"month":return n.fieldMonthPlaceholder({contentType:r.contentType,format:i});case"day":return n.fieldDayPlaceholder({format:i});case"weekDay":return n.fieldWeekDayPlaceholder({contentType:r.contentType,format:i});case"hours":return n.fieldHoursPlaceholder({format:i});case"minutes":return n.fieldMinutesPlaceholder({format:i});case"seconds":return n.fieldSecondsPlaceholder({format:i});case"meridiem":return n.fieldMeridiemPlaceholder({format:i});default:return i}},wE=(e,t,n,r)=>e.formatByString(e.parse(t,n),r),SE=(e,t,n)=>4===e.formatByString(e.dateWithTimezone(void 0,t),n).length,kE=(e,t,n,r,i)=>{if("digit"!==n)return!1;const s=e.dateWithTimezone(void 0,t);switch(r){case"year":return SE(e,t,i)?"0001"===e.formatByString(e.setYear(s,1),i):"01"===e.formatByString(e.setYear(s,2001),i);case"month":return e.formatByString(e.startOfYear(s),i).length>1;case"day":return e.formatByString(e.startOfMonth(s),i).length>1;case"weekDay":return e.formatByString(e.startOfWeek(s),i).length>1;case"hours":return e.formatByString(e.setHours(s,1),i).length>1;case"minutes":return e.formatByString(e.setMinutes(s,1),i).length>1;case"seconds":return e.formatByString(e.setSeconds(s,1),i).length>1;default:throw new Error("Invalid section type")}},CE=(e,t,n,r,i,s,o,a)=>{let l="";const c=[],u=e.date(),h=r=>{if(""===r)return null;const s=hE(e,r),a=kE(e,t,s.contentType,s.type,r),h=o?a:"digit"===s.contentType,d=null!=i&&e.isValid(i);let f=d?e.formatByString(i,r):"",p=null;if(h)if(a)p=""===f?e.formatByString(u,r).length:f.length;else{if(null==s.maxLength)throw new Error(`MUI: The token ${r} should have a 'maxDigitNumber' property on it's adapter`);p=s.maxLength,d&&(f=pE(0,f,p))}return c.push(m({},s,{format:r,maxLength:p,value:f,placeholder:bE(e,t,n,s,r),hasLeadingZeros:a,hasLeadingZerosInFormat:a,hasLeadingZerosInInput:h,startSeparator:0===c.length?l:"",endSeparator:"",modified:!1})),null};let d=10,f=r,p=e.expandFormat(r);for(;p!==f;)if(f=p,p=e.expandFormat(f),d-=1,d<0)throw new Error("MUI: The format expansion seems to be  enter in an infinite loop. Please open an issue with the format passed to the picker component");const g=p,v=((e,t)=>{const n=[],{start:r,end:i}=e.escapedCharacters,s=new RegExp(`(\\${r}[^\\${i}]*\\${i})+`,"g");let o=null;for(;o=s.exec(t);)n.push({start:o.index,end:s.lastIndex-1});return n})(e,g),y=new RegExp(`^(${Object.keys(e.formatTokenMap).sort((e,t)=>t.length-e.length).join("|")})`,"g");let x="";for(let m=0;m<g.length;m+=1){const e=v.find(e=>e.start<=m&&e.end>=m),t=g[m],n=null!=e,r=`${x}${g.slice(m)}`,i=y.test(r);!n&&t.match(/([A-Za-z]+)/)&&i?(x=r.slice(0,y.lastIndex),m+=y.lastIndex-1):n&&(null==e?void 0:e.start)===m||(null==e?void 0:e.end)===m||(h(x),x="",0===c.length?l+=t:c[c.length-1].endSeparator+=t)}return h(x),c.map(e=>{const t=e=>{let t=e;return a&&null!==t&&t.includes(" ")&&(t=`⁩${t}⁦`),"spacious"===s&&["/",".","-"].includes(t)&&(t=` ${t} `),t};return e.startSeparator=t(e.startSeparator),e.endSeparator=t(e.endSeparator),e})},EE={year:1,month:2,day:3,weekDay:4,hours:5,minutes:6,seconds:7,meridiem:8},IE=(e,t,n,r,i,s)=>[...r].sort((e,t)=>EE[e.type]-EE[t.type]).reduce((r,i)=>!s||i.modified?((e,t,n,r,i)=>{switch(n.type){case"year":return e.setYear(i,e.getYear(r));case"month":return e.setMonth(i,e.getMonth(r));case"weekDay":{const i=dE(e,t,n.format),s=e.formatByString(r,n.format),o=i.indexOf(s),a=i.indexOf(n.value)-o;return e.addDays(r,a)}case"day":return e.setDate(i,e.getDate(r));case"meridiem":{const t=e.getHours(r)<12,n=e.getHours(i);return t&&n>=12?e.addHours(i,-12):!t&&n<12?e.addHours(i,12):i}case"hours":return e.setHours(i,e.getHours(r));case"minutes":return e.setMinutes(i,e.getMinutes(r));case"seconds":return e.setSeconds(i,e.getSeconds(r));default:return i}})(e,t,i,n,r):r,i),DE=["value","referenceDate"],TE={emptyValue:null,getTodayValue:tE,getInitialReferenceValue:e=>{let{value:t,referenceDate:n}=e,r=oe(e,DE);return null!=t&&r.utils.isValid(t)?t:null!=n?n:uE(r)},cleanValue:(e,t)=>null!=t&&e.isValid(t)?t:null,areValuesEqual:(e,t,n)=>!e.isValid(t)&&null!=t&&!e.isValid(n)&&null!=n||e.isEqual(t,n),isSameError:(e,t)=>e===t,hasError:e=>null!=e,defaultErrorState:null,getTimezone:(e,t)=>null!=t&&e.isValid(t)?e.getTimezone(t):null,setTimezone:(e,t,n)=>null==n?null:e.setTimezone(n,t)},jE={updateReferenceValue:(e,t,n)=>null!=t&&e.isValid(t)?t:n,getSectionsFromValue:(e,t,n,r,i)=>!e.isValid(t)&&n?n:xE(i(t),r),getValueStrFromSections:(e,t)=>{const n=e.map(e=>{const n=vE(e,t?"input-rtl":"input-ltr");return`${e.startSeparator}${n}${e.endSeparator}`}).join("");return t?`⁦${n}⁩`:n},getActiveDateManager:(e,t)=>({date:t.value,referenceDate:t.referenceValue,getSections:e=>e,getNewValuesFromNewActiveDate:n=>({value:n,referenceValue:null!=n&&e.isValid(n)?n:t.referenceValue})}),parseValueStr:(e,t,n)=>n(e.trim(),t)},_E=["localeText"],ME=on.createContext(null),PE=function(e){var t;const{localeText:n}=e,r=oe(e,_E),{utils:i,localeText:s}=null!=(t=on.useContext(ME))?t:{utils:void 0,localeText:void 0},o=ae({props:r,name:"MuiLocalizationProvider"}),{children:a,dateAdapter:l,dateFormats:c,dateLibInstance:u,adapterLocale:h,localeText:d}=o,f=on.useMemo(()=>m({},d,s,n),[d,s,n]),p=on.useMemo(()=>{if(!l)return i||null;const e=new l({locale:h,formats:c,instance:u});if(!e.isMUIAdapter)throw new Error(["MUI: The date adapter should be imported from `@mui/x-date-pickers` or `@mui/x-date-pickers-pro`, not from `@date-io`","For example, `import { AdapterDayjs } from '@mui/x-date-pickers/AdapterDayjs'` instead of `import AdapterDayjs from '@date-io/dayjs'`","More information on the installation documentation: https://mui.com/x/react-date-pickers/getting-started/#installation"].join("\n"));return e},[l,h,c,u,i]),g=on.useMemo(()=>p?{minDate:p.date("1900-01-01T00:00:00.000"),maxDate:p.date("2099-12-31T00:00:00.000")}:null,[p]),v=on.useMemo(()=>({utils:p,defaultDates:g,localeText:f}),[g,p,f]);return y.jsx(ME.Provider,{value:v,children:a})},AE={previousMonth:"Previous month",nextMonth:"Next month",openPreviousView:"open previous view",openNextView:"open next view",calendarViewSwitchingButtonAriaLabel:e=>"year"===e?"year view is open, switch to calendar view":"calendar view is open, switch to year view",start:"Start",end:"End",cancelButtonLabel:"Cancel",clearButtonLabel:"Clear",okButtonLabel:"OK",todayButtonLabel:"Today",datePickerToolbarTitle:"Select date",dateTimePickerToolbarTitle:"Select date & time",timePickerToolbarTitle:"Select time",dateRangePickerToolbarTitle:"Select date range",clockLabelText:(e,t,n)=>`Select ${e}. ${null===t?"No time selected":`Selected time is ${n.format(t,"fullTime")}`}`,hoursClockNumberText:e=>`${e} hours`,minutesClockNumberText:e=>`${e} minutes`,secondsClockNumberText:e=>`${e} seconds`,selectViewText:e=>`Select ${e}`,calendarWeekNumberHeaderLabel:"Week number",calendarWeekNumberHeaderText:"#",calendarWeekNumberAriaLabelText:e=>`Week ${e}`,calendarWeekNumberText:e=>`${e}`,openDatePickerDialogue:(e,t)=>null!==e&&t.isValid(e)?`Choose date, selected date is ${t.format(e,"fullDate")}`:"Choose date",openTimePickerDialogue:(e,t)=>null!==e&&t.isValid(e)?`Choose time, selected time is ${t.format(e,"fullTime")}`:"Choose time",fieldClearLabel:"Clear value",timeTableLabel:"pick time",dateTableLabel:"pick date",fieldYearPlaceholder:e=>"Y".repeat(e.digitAmount),fieldMonthPlaceholder:e=>"letter"===e.contentType?"MMMM":"MM",fieldDayPlaceholder:()=>"DD",fieldWeekDayPlaceholder:e=>"letter"===e.contentType?"EEEE":"EE",fieldHoursPlaceholder:()=>"hh",fieldMinutesPlaceholder:()=>"mm",fieldSecondsPlaceholder:()=>"ss",fieldMeridiemPlaceholder:()=>"aa"},RE=AE;m({},AE);const OE=()=>{const e=on.useContext(ME);if(null===e)throw new Error(["MUI: Can not find the date and time pickers localization context.","It looks like you forgot to wrap your component in LocalizationProvider.","This can also happen if you are bundling multiple versions of the `@mui/x-date-pickers` package"].join("\n"));if(null===e.utils)throw new Error(["MUI: Can not find the date and time pickers adapter from its localization context.","It looks like you forgot to pass a `dateAdapter` to your LocalizationProvider."].join("\n"));const t=on.useMemo(()=>m({},RE,e.localeText),[e.localeText]);return on.useMemo(()=>m({},e,{localeText:t}),[e,t])},NE=()=>OE().utils,LE=()=>OE().defaultDates,FE=()=>OE().localeText,VE=e=>{const t=NE(),n=on.useRef();return void 0===n.current&&(n.current=t.dateWithTimezone(void 0,e)),n.current};function BE(e){return le("MuiPickersToolbar",e)}ce("MuiPickersToolbar",["root","content"]);const zE=ue("div",{name:"MuiPickersToolbar",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>m({display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",padding:e.spacing(2,3)},t.isLandscape&&{height:"auto",maxWidth:160,padding:16,justifyContent:"flex-start",flexWrap:"wrap"})),WE=ue("div",{name:"MuiPickersToolbar",slot:"Content",overridesResolver:(e,t)=>t.content})(({ownerState:e})=>{var t;return{display:"flex",flexWrap:"wrap",width:"100%",justifyContent:e.isLandscape?"flex-start":"space-between",flexDirection:e.isLandscape?null!=(t=e.landscapeDirection)?t:"column":"row",flex:1,alignItems:e.isLandscape?"flex-start":"center"}}),UE=on.forwardRef(function(e,t){const n=ae({props:e,name:"MuiPickersToolbar"}),{children:r,className:i,toolbarTitle:s,hidden:o,titleId:a}=n,l=n,c=(e=>{const{classes:t,isLandscape:n}=e;return he({root:["root"],content:["content"],penIconButton:["penIconButton",n&&"penIconButtonLandscape"]},BE,t)})(l);return o?null:y.jsxs(zE,{ref:t,className:se(c.root,i),ownerState:l,children:[y.jsx(E,{color:"text.secondary",variant:"overline",id:a,children:s}),y.jsx(WE,{className:c.content,ownerState:l,children:r})]})});function HE(e){return le("MuiDatePickerToolbar",e)}ce("MuiDatePickerToolbar",["root","title"]);const $E=["value","isLandscape","onChange","toolbarFormat","toolbarPlaceholder","views","className"],qE=ue(UE,{name:"MuiDatePickerToolbar",slot:"Root",overridesResolver:(e,t)=>t.root})({}),XE=ue(E,{name:"MuiDatePickerToolbar",slot:"Title",overridesResolver:(e,t)=>t.title})(({ownerState:e})=>m({},e.isLandscape&&{margin:"auto 16px auto auto"})),KE=on.forwardRef(function(e,t){const n=ae({props:e,name:"MuiDatePickerToolbar"}),{value:r,isLandscape:i,toolbarFormat:s,toolbarPlaceholder:o="––",views:a,className:l}=n,c=oe(n,$E),u=NE(),h=FE(),d=(e=>{const{classes:t}=e;return he({root:["root"],title:["title"]},HE,t)})(n),f=on.useMemo(()=>{if(!r)return o;const e=iE(u,{format:s,views:a},!0);return u.formatByString(r,e)},[r,s,o,u,a]),p=n;return y.jsx(qE,m({ref:t,toolbarTitle:h.datePickerToolbarTitle,isLandscape:i,className:se(d.root,l)},c,{children:y.jsx(XE,{variant:"h4",align:i?"left":"center",ownerState:p,className:d.title,children:f})}))}),GE=e=>{if(void 0!==e)return Object.keys(e).reduce((t,n)=>m({},t,{[`${n.slice(0,1).toLowerCase()}${n.slice(1)}`]:e[n]}),{})};function YE(e,t){var n,r,i,s;const o=NE(),a=LE(),l=ae({props:e,name:t}),c=on.useMemo(()=>{var e;return null==(null==(e=l.localeText)?void 0:e.toolbarTitle)?l.localeText:m({},l.localeText,{datePickerToolbarTitle:l.localeText.toolbarTitle})},[l.localeText]),u=null!=(n=l.slots)?n:GE(l.components);return m({},l,{localeText:c},(({openTo:e,defaultOpenTo:t,views:n,defaultViews:r})=>{const i=null!=n?n:r;let s;if(null!=e)s=e;else if(i.includes(t))s=t;else{if(!(i.length>0))throw new Error("MUI: The `views` prop must contain at least one view");s=i[0]}return{views:i,openTo:s}})({views:l.views,openTo:l.openTo,defaultViews:["year","day"],defaultOpenTo:"day"}),{disableFuture:null!=(r=l.disableFuture)&&r,disablePast:null!=(i=l.disablePast)&&i,minDate:ZC(o,l.minDate,a.minDate),maxDate:ZC(o,l.maxDate,a.maxDate),slots:m({toolbar:KE},u),slotProps:null!=(s=l.slotProps)?s:l.componentsProps})}const QE=de(y.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),JE=de(y.jsx("path",{d:"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"}),"ArrowLeft"),ZE=de(y.jsx("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"ArrowRight"),eI=de(y.jsx("path",{d:"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"}),"Calendar");de(y.jsxs(on.Fragment,{children:[y.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),y.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Clock"),de(y.jsx("path",{d:"M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"}),"DateRange"),de(y.jsxs(on.Fragment,{children:[y.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),y.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Time");const tI=de(y.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");function nI(e){return le("MuiPickersArrowSwitcher",e)}ce("MuiPickersArrowSwitcher",["root","spacer","button"]);const rI=["children","className","slots","slotProps","isNextDisabled","isNextHidden","onGoToNext","nextLabel","isPreviousDisabled","isPreviousHidden","onGoToPrevious","previousLabel"],iI=["ownerState"],sI=["ownerState"],oI=ue("div",{name:"MuiPickersArrowSwitcher",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex"}),aI=ue("div",{name:"MuiPickersArrowSwitcher",slot:"Spacer",overridesResolver:(e,t)=>t.spacer})(({theme:e})=>({width:e.spacing(3)})),lI=ue(k,{name:"MuiPickersArrowSwitcher",slot:"Button",overridesResolver:(e,t)=>t.button})(({ownerState:e})=>m({},e.hidden&&{visibility:"hidden"})),cI=on.forwardRef(function(e,t){var n,r,i,s;const o="rtl"===fe().direction,a=ae({props:e,name:"MuiPickersArrowSwitcher"}),{children:l,className:c,slots:u,slotProps:h,isNextDisabled:d,isNextHidden:f,onGoToNext:p,nextLabel:g,isPreviousDisabled:v,isPreviousHidden:x,onGoToPrevious:b,previousLabel:w}=a,S=oe(a,rI),k=a,C=(e=>{const{classes:t}=e;return he({root:["root"],spacer:["spacer"],button:["button"]},nI,t)})(k),I={isDisabled:d,isHidden:f,goTo:p,label:g},D={isDisabled:v,isHidden:x,goTo:b,label:w},T=null!=(n=null==u?void 0:u.previousIconButton)?n:lI,j=GC({elementType:T,externalSlotProps:null==h?void 0:h.previousIconButton,additionalProps:{size:"medium",title:D.label,"aria-label":D.label,disabled:D.isDisabled,edge:"end",onClick:D.goTo},ownerState:m({},k,{hidden:D.isHidden}),className:C.button}),_=null!=(r=null==u?void 0:u.nextIconButton)?r:lI,M=GC({elementType:_,externalSlotProps:null==h?void 0:h.nextIconButton,additionalProps:{size:"medium",title:I.label,"aria-label":I.label,disabled:I.isDisabled,edge:"start",onClick:I.goTo},ownerState:m({},k,{hidden:I.isHidden}),className:C.button}),P=null!=(i=null==u?void 0:u.leftArrowIcon)?i:JE,A=GC({elementType:P,externalSlotProps:null==h?void 0:h.leftArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:void 0}),R=oe(A,iI),O=null!=(s=null==u?void 0:u.rightArrowIcon)?s:ZE,N=GC({elementType:O,externalSlotProps:null==h?void 0:h.rightArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:void 0}),L=oe(N,sI);return y.jsxs(oI,m({ref:t,className:se(C.root,c),ownerState:k},S,{children:[y.jsx(T,m({},j,{children:o?y.jsx(O,m({},L)):y.jsx(P,m({},R))})),l?y.jsx(E,{variant:"subtitle1",component:"span",children:l}):y.jsx(aI,{className:C.spacer,ownerState:k}),y.jsx(_,m({},M,{children:o?y.jsx(P,m({},R)):y.jsx(O,m({},L))}))]}))}),uI=320,hI=ue(ge)({[`& .${me.container}`]:{outline:0},[`& .${me.paper}`]:{outline:0,minWidth:uI}}),dI=ue(ve)({"&:first-of-type":{padding:0}});function fI(e){var t,n;const{children:r,onDismiss:i,open:s,slots:o,slotProps:a}=e,l=null!=(t=null==o?void 0:o.dialog)?t:hI,c=null!=(n=null==o?void 0:o.mobileTransition)?n:pe;return y.jsx(l,m({open:s,onClose:i},null==a?void 0:a.dialog,{TransitionComponent:c,TransitionProps:null==a?void 0:a.mobileTransition,PaperComponent:null==o?void 0:o.mobilePaper,PaperProps:null==a?void 0:a.mobilePaper,children:y.jsx(dI,{children:r})}))}function pI(e){return le("MuiPickersPopper",e)}ce("MuiPickersPopper",["root","paper"]);const gI=(e=document)=>{const t=e.activeElement;return t?t.shadowRoot?gI(t.shadowRoot):t:null},mI="@media (pointer: fine)",vI="undefined"!=typeof navigator&&navigator.userAgent.match(/android\s(\d+)|OS\s(\d+)/i),yI=vI&&vI[1]?parseInt(vI[1],10):null,xI=vI&&vI[2]?parseInt(vI[2],10):null,bI=yI&&yI<10||xI&&xI<13||!1,wI=()=>ye("@media (prefers-reduced-motion: reduce)",{defaultMatches:!1})||bI,SI=["PaperComponent","popperPlacement","ownerState","children","paperSlotProps","paperClasses","onPaperClick","onPaperTouchStart"],kI=ue(Ee,{name:"MuiPickersPopper",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({zIndex:e.zIndex.modal})),CI=ue(Ce,{name:"MuiPickersPopper",slot:"Paper",overridesResolver:(e,t)=>t.paper})(({ownerState:e})=>m({outline:0,transformOrigin:"top center"},e.placement.includes("top")&&{transformOrigin:"bottom center"})),EI=on.forwardRef((e,t)=>{const{PaperComponent:n,popperPlacement:r,ownerState:i,children:s,paperSlotProps:o,paperClasses:a,onPaperClick:l,onPaperTouchStart:c}=e,u=oe(e,SI),h=m({},i,{placement:r}),d=GC({elementType:n,externalSlotProps:o,additionalProps:{tabIndex:-1,elevation:8,ref:t},className:a,ownerState:h});return y.jsx(n,m({},u,d,{onClick:e=>{var t;l(e),null==(t=d.onClick)||t.call(d,e)},onTouchStart:e=>{var t;c(e),null==(t=d.onTouchStart)||t.call(d,e)},ownerState:h,children:s}))});function II(e){var t,n,r,i;const s=ae({props:e,name:"MuiPickersPopper"}),{anchorEl:o,children:a,containerRef:l=null,shouldRestoreFocus:c,onBlur:u,onDismiss:h,open:d,role:f,placement:p,slots:g,slotProps:v,reduceAnimations:x}=s;on.useEffect(()=>{function e(e){!d||"Escape"!==e.key&&"Esc"!==e.key||h()}return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[h,d]);const b=on.useRef(null);on.useEffect(()=>{"tooltip"===f||c&&!c()||(d?b.current=gI(document):b.current&&b.current instanceof HTMLElement&&setTimeout(()=>{b.current instanceof HTMLElement&&b.current.focus()}))},[d,f,c]);const[w,S,k]=function(e,t){const n=on.useRef(!1),r=on.useRef(!1),i=on.useRef(null),s=on.useRef(!1);on.useEffect(()=>{if(e)return document.addEventListener("mousedown",t,!0),document.addEventListener("touchstart",t,!0),()=>{document.removeEventListener("mousedown",t,!0),document.removeEventListener("touchstart",t,!0),s.current=!1};function t(){s.current=!0}},[e]);const o=Se(e=>{if(!s.current)return;const o=r.current;r.current=!1;const a=ke(i.current);if(!i.current||"clientX"in e&&function(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}(e,a))return;if(n.current)return void(n.current=!1);let l;l=e.composedPath?e.composedPath().indexOf(i.current)>-1:!a.documentElement.contains(e.target)||i.current.contains(e.target),l||o||t(e)}),a=()=>{r.current=!0};return on.useEffect(()=>{if(e){const e=ke(i.current),t=()=>{n.current=!0};return e.addEventListener("touchstart",o),e.addEventListener("touchmove",t),()=>{e.removeEventListener("touchstart",o),e.removeEventListener("touchmove",t)}}},[e,o]),on.useEffect(()=>{if(e){const e=ke(i.current);return e.addEventListener("click",o),()=>{e.removeEventListener("click",o),r.current=!1}}},[e,o]),[i,a,a]}(d,null!=u?u:h),C=on.useRef(null),E=xe(C,l),I=xe(E,w),D=s,T=(e=>{const{classes:t}=e;return he({root:["root"],paper:["paper"]},pI,t)})(D),j=wI(),_=null!=x?x:j,M=(null!=(t=null==g?void 0:g.desktopTransition)?t:_)?pe:be,P=null!=(n=null==g?void 0:g.desktopTrapFocus)?n:we,A=null!=(r=null==g?void 0:g.desktopPaper)?r:CI,R=null!=(i=null==g?void 0:g.popper)?i:kI,O=GC({elementType:R,externalSlotProps:null==v?void 0:v.popper,additionalProps:{transition:!0,role:f,open:d,anchorEl:o,placement:p,onKeyDown:e=>{"Escape"===e.key&&(e.stopPropagation(),h())}},className:T.root,ownerState:s});return y.jsx(R,m({},O,{children:({TransitionProps:e,placement:t})=>y.jsx(P,m({open:d,disableAutoFocus:!0,disableRestoreFocus:!0,disableEnforceFocus:"tooltip"===f,isEnabled:()=>!0},null==v?void 0:v.desktopTrapFocus,{children:y.jsx(M,m({},e,null==v?void 0:v.desktopTransition,{children:y.jsx(EI,{PaperComponent:A,ownerState:D,popperPlacement:t,ref:I,onPaperClick:S,onPaperTouchStart:k,paperClasses:T.paper,paperSlotProps:null==v?void 0:v.desktopPaper,children:a})}))}))}))}const DI=({timezone:e,value:t,defaultValue:n,onChange:r,valueManager:i})=>{var s,o;const a=NE(),l=on.useRef(n),c=null!=(s=null!=t?t:l.current)?s:i.emptyValue,u=on.useMemo(()=>i.getTimezone(a,c),[a,i,c]),h=Se(e=>null==u?e:i.setTimezone(a,u,e)),d=null!=(o=null!=e?e:u)?o:"default";return{value:on.useMemo(()=>i.setTimezone(a,d,c),[i,a,d,c]),handleValueChange:Se((e,...t)=>{const n=h(e);null==r||r(n,...t)}),timezone:d}},TI=({name:e,timezone:t,value:n,defaultValue:r,onChange:i,valueManager:s})=>{const[o,a]=Ie({name:e,state:"value",controlled:n,default:null!=r?r:s.emptyValue}),l=Se((e,...t)=>{a(e),null==i||i(e,...t)});return DI({timezone:t,value:o,defaultValue:void 0,onChange:l,valueManager:s})};function jI(e,t,n,r){const{value:i,onError:s}=e,o=OE(),a=on.useRef(r),l=t({adapter:o,value:i,props:e});return on.useEffect(()=>{s&&!n(l,a.current)&&s(l,i),a.current=l},[n,s,a,l,i]),l}const _I=e=>{const t=NE(),n=FE(),r=OE(),i="rtl"===fe().direction,{valueManager:s,fieldValueManager:o,validator:a,internalProps:l,internalProps:{value:c,defaultValue:u,referenceDate:h,onChange:d,format:f,formatDensity:p="dense",selectedSections:g,onSelectedSectionsChange:v,shouldRespectLeadingZeros:y=!1,timezone:x}}=e,{timezone:b,value:w,handleValueChange:S}=DI({timezone:x,value:c,defaultValue:u,onChange:d,valueManager:s}),k=on.useMemo(()=>((e,t)=>{const n=e.dateWithTimezone(void 0,t),r=e.endOfYear(n),i=e.endOfDay(n),{maxDaysInMonth:s,longestMonth:o}=eE(e,n).reduce((t,n)=>{const r=e.getDaysInMonth(n);return r>t.maxDaysInMonth?{maxDaysInMonth:r,longestMonth:n}:t},{maxDaysInMonth:0,longestMonth:null});return{year:({format:n})=>({minimum:0,maximum:SE(e,t,n)?9999:99}),month:()=>({minimum:1,maximum:e.getMonth(r)+1}),day:({currentDate:t})=>({minimum:1,maximum:null!=t&&e.isValid(t)?e.getDaysInMonth(t):s,longestMonth:o}),weekDay:({format:n,contentType:r})=>{if("digit"===r){const r=dE(e,t,n).map(Number);return{minimum:Math.min(...r),maximum:Math.max(...r)}}return{minimum:1,maximum:7}},hours:({format:t})=>{const r=e.getHours(i);return e.formatByString(e.endOfDay(n),t)!==r.toString()?{minimum:1,maximum:Number(e.formatByString(e.startOfDay(n),t))}:{minimum:0,maximum:r}},minutes:()=>({minimum:0,maximum:e.getMinutes(i)}),seconds:()=>({minimum:0,maximum:e.getSeconds(i)}),meridiem:()=>({minimum:0,maximum:0})}})(t,b),[t,b]),C=on.useCallback((e,r=null)=>o.getSectionsFromValue(t,e,r,i,e=>CE(t,b,n,f,e,p,y,i)),[o,f,n,i,y,t,p,b]),E=on.useMemo(()=>o.getValueStrFromSections(C(s.emptyValue),i),[o,C,s.emptyValue,i]),[I,D]=on.useState(()=>{const e=C(w),n={sections:e,value:w,referenceValue:s.emptyValue,tempValueStrAndroid:null},r=(e=>Math.max(...e.map(e=>{var t;return null!=(t=lE[e.type])?t:1})))(e),i=s.getInitialReferenceValue({referenceDate:h,value:w,utils:t,props:l,granularity:r,timezone:b});return m({},n,{referenceValue:i})}),[T,j]=Ie({controlled:g,default:null,name:"useField",state:"selectedSectionIndexes"}),_=e=>{j(e),null==v||v(e),D(e=>m({},e,{selectedSectionQuery:null}))},M=on.useMemo(()=>{if(null==T)return null;if("all"===T)return{startIndex:0,endIndex:I.sections.length-1,shouldSelectBoundarySelectors:!0};if("number"==typeof T)return{startIndex:T,endIndex:T};if("string"==typeof T){const e=I.sections.findIndex(e=>e.type===T);return{startIndex:e,endIndex:e}}return T},[T,I.sections]),P=({value:e,referenceValue:n,sections:i})=>{if(D(t=>m({},t,{sections:i,value:e,referenceValue:n,tempValueStrAndroid:null})),s.areValuesEqual(t,I.value,e))return;const o={validationError:a({adapter:r,value:e,props:m({},l,{value:e,timezone:b})})};S(e,o)},A=(e,t)=>{const n=[...I.sections];return n[e]=m({},n[e],{value:t,modified:!0}),xE(n,i)};return on.useEffect(()=>{const e=C(I.value);D(t=>m({},t,{sections:e}))},[f,t.locale]),on.useEffect(()=>{let e=!1;e=!s.areValuesEqual(t,I.value,w)||s.getTimezone(t,I.value)!==s.getTimezone(t,w),e&&D(e=>m({},e,{value:w,referenceValue:o.updateReferenceValue(t,w,e.referenceValue),sections:C(w)}))},[w]),{state:I,selectedSectionIndexes:M,setSelectedSections:_,clearValue:()=>{P({value:s.emptyValue,referenceValue:I.referenceValue,sections:C(s.emptyValue)})},clearActiveSection:()=>{if(null==M)return;const e=I.sections[M.startIndex],n=o.getActiveDateManager(t,I,e),r=n.getSections(I.sections).filter(e=>""!==e.value).length===(""===e.value?0:1),i=A(M.startIndex,""),s=r?null:t.date(new Date("")),a=n.getNewValuesFromNewActiveDate(s);(null!=s&&!t.isValid(s))!=(null!=n.date&&!t.isValid(n.date))?P(m({},a,{sections:i})):D(e=>m({},e,a,{sections:i,tempValueStrAndroid:null}))},updateSectionValue:({activeSection:e,newSectionValue:n,shouldGoToNextSection:r})=>{r&&M&&M.startIndex<I.sections.length-1?_(M.startIndex+1):M&&M.startIndex!==M.endIndex&&_(M.startIndex);const i=o.getActiveDateManager(t,I,e),s=A(M.startIndex,n),a=i.getSections(s),l=((e,t)=>{const n=t.some(e=>"day"===e.type),r=[],i=[];for(let a=0;a<t.length;a+=1){const e=t[a];n&&"weekDay"===e.type||(r.push(e.format),i.push(vE(e,"non-input")))}const s=r.join(" "),o=i.join(" ");return e.parse(o,s)})(t,a);let c,u;if(null!=l&&t.isValid(l)){const e=IE(t,b,l,a,i.referenceDate,!0);c=i.getNewValuesFromNewActiveDate(e),u=!0}else c=i.getNewValuesFromNewActiveDate(l),u=(null!=l&&!t.isValid(l))!=(null!=i.date&&!t.isValid(i.date));return u?P(m({},c,{sections:s})):D(e=>m({},e,c,{sections:s,tempValueStrAndroid:null}))},updateValueFromValueStr:e=>{const r=o.parseValueStr(e,I.referenceValue,(e,r)=>{const s=t.parse(e,f);if(null==s||!t.isValid(s))return null;const o=CE(t,b,n,f,s,p,y,i);return IE(t,b,s,o,r,!1)}),s=o.updateReferenceValue(t,r,I.referenceValue);P({value:r,referenceValue:s,sections:C(r,I.sections)})},setTempAndroidValueStr:e=>D(t=>m({},t,{tempValueStrAndroid:e})),sectionsValueBoundaries:k,placeholder:E,timezone:b}},MI=e=>null!=e.saveQuery,PI=({sections:e,updateSectionValue:t,sectionsValueBoundaries:n,setTempAndroidValueStr:r,timezone:i})=>{const s=NE(),[o,a]=on.useState(null),l=Se(()=>a(null));on.useEffect(()=>{var t;null!=o&&(null==(t=e[o.sectionIndex])?void 0:t.type)!==o.sectionType&&l()},[e,o,l]),on.useEffect(()=>{if(null!=o){const e=setTimeout(()=>l(),5e3);return()=>{window.clearTimeout(e)}}return()=>{}},[o,l]);const c=({keyPressed:t,sectionIndex:n},r,i)=>{const s=t.toLowerCase(),c=e[n];if(null!=o&&(!i||i(o.value))&&o.sectionIndex===n){const e=`${o.value}${s}`,t=r(e,c);if(!MI(t))return a({sectionIndex:n,value:e,sectionType:c.type}),t}const u=r(s,c);return MI(u)&&!u.saveQuery?(l(),null):(a({sectionIndex:n,value:s,sectionType:c.type}),MI(u)?null:u)};return{applyCharacterEditing:Se(o=>{const a=e[o.sectionIndex],l=" "===o.keyPressed||Number.isNaN(Number(o.keyPressed))?(e=>{const t=(e,t,n)=>{const r=t.filter(e=>e.toLowerCase().startsWith(n));return 0===r.length?{saveQuery:!1}:{sectionValue:r[0],shouldGoToNextSection:1===r.length}},n=(e,n,r,o)=>{const a=e=>fE(s,i,n.type,e);if("letter"===n.contentType)return t(n.format,a(n.format),e);if(r&&null!=o&&"letter"===hE(s,r).contentType){const n=a(r),i=t(0,n,e);return MI(i)?{saveQuery:!1}:m({},i,{sectionValue:o(i.sectionValue,n)})}return{saveQuery:!1}};return c(e,(e,t)=>{switch(t.type){case"month":{const r=e=>wE(s,e,s.formats.month,t.format);return n(e,t,s.formats.month,r)}case"weekDay":{const r=(e,t)=>t.indexOf(e).toString();return n(e,t,s.formats.weekday,r)}case"meridiem":return n(e,t);default:return{saveQuery:!1}}})})(o):(e=>{const t=(e,t)=>{const r=Number(`${e}`),i=n[t.type]({currentDate:null,format:t.format,contentType:t.contentType});if(r>i.maximum)return{saveQuery:!1};if(r<i.minimum)return{saveQuery:!0};const o=Number(`${e}0`)>i.maximum||e.length===i.maximum.toString().length;return{sectionValue:gE(s,0,r,i,t),shouldGoToNextSection:o}};return c(e,(e,n)=>{if("digit"===n.contentType||"digit-with-letter"===n.contentType)return t(e,n);if("month"===n.type){kE(s,i,"digit","month","MM");const r=t(e,{type:n.type,format:"MM",hasLeadingZerosInInput:!0,contentType:"digit",maxLength:2});if(MI(r))return r;const o=wE(s,r.sectionValue,"MM",n.format);return m({},r,{sectionValue:o})}if("weekDay"===n.type){const r=t(e,n);if(MI(r))return r;const o=dE(s,i,n.format)[Number(r.sectionValue)-1];return m({},r,{sectionValue:o})}return{saveQuery:!1}},e=>!Number.isNaN(Number(e)))})(o);null==l?r(null):t({activeSection:a,newSectionValue:l.sectionValue,shouldGoToNextSection:l.shouldGoToNextSection})}),resetCharacterQuery:l}},AI=["onClick","onKeyDown","onFocus","onBlur","onMouseUp","onPaste","error","clearable","onClear","disabled"],RI=e=>{const t=NE(),{state:n,selectedSectionIndexes:r,setSelectedSections:i,clearValue:s,clearActiveSection:o,updateSectionValue:a,updateValueFromValueStr:l,setTempAndroidValueStr:c,sectionsValueBoundaries:u,placeholder:h,timezone:d}=_I(e),{inputRef:f,internalProps:p,internalProps:{readOnly:g=!1,unstableFieldRef:v,minutesStep:y},forwardedProps:{onClick:x,onKeyDown:b,onFocus:w,onBlur:S,onMouseUp:k,onPaste:C,error:E,clearable:I,onClear:D,disabled:T},fieldValueManager:j,valueManager:_,validator:M}=e,P=oe(e.forwardedProps,AI),{applyCharacterEditing:A,resetCharacterQuery:R}=PI({sections:n.sections,updateSectionValue:a,sectionsValueBoundaries:u,setTempAndroidValueStr:c,timezone:d}),O=on.useRef(null),N=xe(f,O),L=on.useRef(void 0),F="rtl"===fe().direction,V=on.useMemo(()=>((e,t)=>{const n={};if(!t)return e.forEach((t,r)=>{const i=0===r?null:r-1,s=r===e.length-1?null:r+1;n[r]={leftIndex:i,rightIndex:s}}),{neighbors:n,startIndex:0,endIndex:e.length-1};const r={},i={};let s=0,o=0,a=e.length-1;for(;a>=0;){o=e.findIndex((e,t)=>{var n;return t>=s&&(null==(n=e.endSeparator)?void 0:n.includes(" "))&&" / "!==e.endSeparator}),-1===o&&(o=e.length-1);for(let e=o;e>=s;e-=1)i[e]=a,r[a]=e,a-=1;s=o+1}return e.forEach((t,s)=>{const o=i[s],a=0===o?null:r[o-1],l=o===e.length-1?null:r[o+1];n[s]={leftIndex:a,rightIndex:l}}),{neighbors:n,startIndex:r[0],endIndex:r[e.length-1]}})(n.sections,F),[n.sections,F]),B=()=>{var e;if(g)return void i(null);const t=null!=(e=O.current.selectionStart)?e:0;let r;r=t<=n.sections[0].startInInput||t>=n.sections[n.sections.length-1].endInInput?1:n.sections.findIndex(e=>e.startInInput-e.startSeparator.length>t);const s=-1===r?n.sections.length-1:r-1;i(s)},z=Se((e,...t)=>{e.isDefaultPrevented()||(null==x||x(e,...t),B())}),W=Se(e=>{null==k||k(e),e.preventDefault()}),U=Se((...e)=>{null==w||w(...e);const t=O.current;window.clearTimeout(L.current),L.current=setTimeout(()=>{t&&t===O.current&&(null!=r||g||(t.value.length&&Number(t.selectionEnd)-Number(t.selectionStart)===t.value.length?i("all"):B()))})}),H=Se((...e)=>{null==S||S(...e),i(null)}),$=Se(e=>{if(null==C||C(e),g)return void e.preventDefault();const t=e.clipboardData.getData("text");if(r&&r.startIndex===r.endIndex){const i=n.sections[r.startIndex],s=/^[a-zA-Z]+$/.test(t),o=/^[0-9]+$/.test(t),l=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test(t);if("letter"===i.contentType&&s||"digit"===i.contentType&&o||"digit-with-letter"===i.contentType&&l)return R(),a({activeSection:i,newSectionValue:t,shouldGoToNextSection:!0}),void e.preventDefault();if(s||o)return void e.preventDefault()}e.preventDefault(),R(),l(t)}),q=Se(e=>{if(g)return;const t=e.target.value;if(""===t)return R(),void s();const i=e.nativeEvent.data,a=i&&i.length>1,u=a?i:t,h=yE(u);if(null==r||a)return void l(a?i:h);let d;if(0===r.startIndex&&r.endIndex===n.sections.length-1&&1===h.length)d=h;else{const e=yE(j.getValueStrFromSections(n.sections,F));let t=-1,i=-1;for(let n=0;n<e.length;n+=1)-1===t&&e[n]!==h[n]&&(t=n),-1===i&&e[e.length-n-1]!==h[h.length-n-1]&&(i=n);const s=n.sections[r.startIndex];if(t<s.start||e.length-i-1>s.end)return;const o=h.length-e.length+s.end-yE(s.endSeparator||"").length;d=h.slice(s.start+yE(s.startSeparator||"").length,o)}0!==d.length?A({keyPressed:d,sectionIndex:r.startIndex}):navigator.userAgent.toLowerCase().indexOf("android")>-1?c(u):(R(),o())}),X=Se(e=>{switch(null==b||b(e),!0){case"a"===e.key&&(e.ctrlKey||e.metaKey):e.preventDefault(),i("all");break;case"ArrowRight"===e.key:if(e.preventDefault(),null==r)i(V.startIndex);else if(r.startIndex!==r.endIndex)i(r.endIndex);else{const e=V.neighbors[r.startIndex].rightIndex;null!==e&&i(e)}break;case"ArrowLeft"===e.key:if(e.preventDefault(),null==r)i(V.endIndex);else if(r.startIndex!==r.endIndex)i(r.startIndex);else{const e=V.neighbors[r.startIndex].leftIndex;null!==e&&i(e)}break;case"Delete"===e.key:if(e.preventDefault(),g)break;null==r||0===r.startIndex&&r.endIndex===n.sections.length-1?s():o(),R();break;case["ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(e.key):{if(e.preventDefault(),g||null==r)break;const i=n.sections[r.startIndex],s=j.getActiveDateManager(t,n,i),o=mE(t,d,i,e.key,u,s.date,{minutesStep:y});a({activeSection:i,newSectionValue:o,shouldGoToNextSection:!1});break}}});De(()=>{if(!O.current)return;if(null==r)return void(O.current.scrollLeft&&(O.current.scrollLeft=0));const e=n.sections[r.startIndex],t=n.sections[r.endIndex];let i=e.startInInput,s=t.endInInput;if(r.shouldSelectBoundarySelectors&&(i-=e.startSeparator.length,s+=t.endSeparator.length),i!==O.current.selectionStart||s!==O.current.selectionEnd){const e=O.current.scrollTop;O.current===gI(document)&&O.current.setSelectionRange(i,s),O.current.scrollTop=e}});const K=jI(m({},p,{value:n.value,timezone:d}),M,_.isSameError,_.defaultErrorState),G=on.useMemo(()=>void 0!==E?E:_.hasError(K),[_,K,E]);on.useEffect(()=>{G||r||R()},[n.referenceValue,r,G]),on.useEffect(()=>(O.current&&O.current===document.activeElement&&i("all"),()=>window.clearTimeout(L.current)),[]),on.useEffect(()=>{null!=n.tempValueStrAndroid&&null!=r&&(R(),o())},[n.tempValueStrAndroid]);const Y=on.useMemo(()=>{var e;return null!=(e=n.tempValueStrAndroid)?e:j.getValueStrFromSections(n.sections,F)},[n.sections,j,n.tempValueStrAndroid,F]),Q=on.useMemo(()=>null==r||"letter"===n.sections[r.startIndex].contentType?"text":"numeric",[r,n.sections]),J=O.current&&O.current===gI(document),Z=_.areValuesEqual(t,n.value,_.emptyValue),ee=!J&&Z;on.useImperativeHandle(v,()=>({getSections:()=>n.sections,getActiveSectionIndex:()=>{var e,t,r;const i=null!=(e=O.current.selectionStart)?e:0,s=null!=(t=O.current.selectionEnd)?t:0,o=!(null==(r=O.current)||!r.readOnly);if(0===i&&0===s||o)return null;const a=i<=n.sections[0].startInInput?1:n.sections.findIndex(e=>e.startInInput-e.startSeparator.length>i);return-1===a?n.sections.length-1:a-1},setSelectedSections:e=>i(e)}));const te=Se((e,...t)=>{var n;e.preventDefault(),null==D||D(e,...t),s(),null==O||null==(n=O.current)||n.focus(),i(0)});return m({placeholder:h,autoComplete:"off",disabled:Boolean(T)},P,{value:ee?"":Y,inputMode:Q,readOnly:g,onClick:z,onFocus:U,onBlur:H,onPaste:$,onChange:q,onKeyDown:X,onMouseUp:W,onClear:te,error:G,ref:N,clearable:Boolean(I&&!Z&&!g&&!T)})},OI=({props:e,valueManager:t,valueType:n,wrapperVariant:r,validator:i})=>{const{onAccept:s,onChange:o,value:a,defaultValue:l,closeOnSelect:c="desktop"===r,selectedSections:u,onSelectedSectionsChange:h,timezone:d}=e,{current:f}=on.useRef(l),{current:p}=on.useRef(void 0!==a),g=NE(),v=OE(),[y,x]=Ie({controlled:u,default:null,name:"usePickerValue",state:"selectedSections"}),{isOpen:b,setIsOpen:w}=(({open:e,onOpen:t,onClose:n})=>{const r=on.useRef("boolean"==typeof e).current,[i,s]=on.useState(!1);return on.useEffect(()=>{if(r){if("boolean"!=typeof e)throw new Error("You must not mix controlling and uncontrolled mode for `open` prop");s(e)}},[r,e]),{isOpen:i,setIsOpen:on.useCallback(e=>{r||s(e),e&&t&&t(),!e&&n&&n()},[r,t,n])}})(e),[S,k]=on.useState(()=>{let e;return e=void 0!==a?a:void 0!==f?f:t.emptyValue,{draft:e,lastPublishedValue:e,lastCommittedValue:e,lastControlledValue:a,hasBeenModifiedSinceMount:!1}}),{timezone:C,handleValueChange:E}=DI({timezone:d,value:a,defaultValue:f,onChange:o,valueManager:t});jI(m({},e,{value:S.draft,timezone:C}),i,t.isSameError,t.defaultErrorState);const I=Se(n=>{const r={action:n,dateState:S,hasChanged:e=>!t.areValuesEqual(g,n.value,e),isControlled:p,closeOnSelect:c},o=(e=>{const{action:t,hasChanged:n,dateState:r,isControlled:i}=e,s=!i&&!r.hasBeenModifiedSinceMount;return"setValueFromField"===t.name||("setValueFromAction"===t.name?!(!s||!["accept","today","clear"].includes(t.pickerAction))||n(r.lastPublishedValue):("setValueFromView"===t.name&&"shallow"!==t.selectionState||"setValueFromShortcut"===t.name)&&(!!s||n(r.lastPublishedValue)))})(r),a=(e=>{const{action:t,hasChanged:n,dateState:r,isControlled:i,closeOnSelect:s}=e,o=!i&&!r.hasBeenModifiedSinceMount;return"setValueFromAction"===t.name?!(!o||!["accept","today","clear"].includes(t.pickerAction))||n(r.lastCommittedValue):"setValueFromView"===t.name&&"finish"===t.selectionState&&s?!!o||n(r.lastCommittedValue):"setValueFromShortcut"===t.name&&"accept"===t.changeImportance&&n(r.lastCommittedValue)})(r),l=(e=>{const{action:t,closeOnSelect:n}=e;return"setValueFromAction"===t.name||("setValueFromView"===t.name?"finish"===t.selectionState&&n:"setValueFromShortcut"===t.name&&"accept"===t.changeImportance)})(r);if(k(e=>m({},e,{draft:n.value,lastPublishedValue:o?n.value:e.lastPublishedValue,lastCommittedValue:a?n.value:e.lastCommittedValue,hasBeenModifiedSinceMount:!0})),o){const t={validationError:"setValueFromField"===n.name?n.context.validationError:i({adapter:v,value:n.value,props:m({},e,{value:n.value,timezone:C})})};"setValueFromShortcut"===n.name&&null!=n.shortcut&&(t.shortcut=n.shortcut),E(n.value,t)}a&&s&&s(n.value),l&&w(!1)});if(void 0!==a&&(void 0===S.lastControlledValue||!t.areValuesEqual(g,S.lastControlledValue,a))){const e=t.areValuesEqual(g,S.draft,a);k(t=>m({},t,{lastControlledValue:a},e?{}:{lastCommittedValue:a,lastPublishedValue:a,draft:a,hasBeenModifiedSinceMount:!0}))}const D=Se(()=>{I({value:t.emptyValue,name:"setValueFromAction",pickerAction:"clear"})}),T=Se(()=>{I({value:S.lastPublishedValue,name:"setValueFromAction",pickerAction:"accept"})}),j=Se(()=>{I({value:S.lastPublishedValue,name:"setValueFromAction",pickerAction:"dismiss"})}),_=Se(()=>{I({value:S.lastCommittedValue,name:"setValueFromAction",pickerAction:"cancel"})}),M=Se(()=>{I({value:t.getTodayValue(g,C,n),name:"setValueFromAction",pickerAction:"today"})}),P=Se(()=>w(!0)),A=Se(()=>w(!1)),R=Se((e,t="partial")=>I({name:"setValueFromView",value:e,selectionState:t})),O=Se((e,t,n)=>I({name:"setValueFromShortcut",value:e,changeImportance:null!=t?t:"accept",shortcut:n})),N=Se((e,t)=>I({name:"setValueFromField",value:e,context:t})),L=Se(e=>{x(e),null==h||h(e)}),F={onClear:D,onAccept:T,onDismiss:j,onCancel:_,onSetToday:M,onOpen:P,onClose:A},V={value:S.draft,onChange:N,selectedSections:y,onSelectedSectionsChange:L},B=on.useMemo(()=>t.cleanValue(g,S.draft),[g,t,S.draft]);return{open:b,fieldProps:V,viewProps:{value:B,onChange:R,onClose:A,open:b,onSelectedSectionsChange:L},layoutProps:m({},F,{value:B,onChange:R,onSelectShortcut:O,isValid:n=>{const r=i({adapter:v,value:n,props:m({},e,{value:n,timezone:C})});return!t.hasError(r)}}),actions:F}};function NI({onChange:e,onViewChange:t,openTo:n,view:r,views:i,autoFocus:s,focusedView:o,onFocusedViewChange:a}){var l,c;const u=on.useRef(n),h=on.useRef(i),d=on.useRef(i.includes(n)?n:i[0]),[f,p]=Ie({name:"useViews",state:"view",controlled:r,default:d.current}),g=on.useRef(s?f:null),[m,v]=Ie({name:"useViews",state:"focusedView",controlled:o,default:g.current});on.useEffect(()=>{(u.current&&u.current!==n||h.current&&h.current.some(e=>!i.includes(e)))&&(p(i.includes(n)?n:i[0]),h.current=i,u.current=n)},[n,p,f,i]);const y=i.indexOf(f),x=null!=(l=i[y-1])?l:null,b=null!=(c=i[y+1])?c:null,w=Se((e,t)=>{v(t?e:t=>e===t?null:t),null==a||a(e,t)}),S=Se(e=>{w(e,!0),e!==f&&(p(e),t&&t(e))}),k=Se(()=>{b&&S(b)}),C=Se((t,n,r)=>{const s="finish"===n,o=r?i.indexOf(r)<i.length-1:Boolean(b);if(e(t,s&&o?"partial":n,r),r&&r!==f){const e=i[i.indexOf(r)+1];e&&S(e)}else s&&k()});return{view:f,setView:S,focusedView:m,setFocusedView:w,nextView:b,previousView:x,defaultView:i.includes(n)?n:i[0],goToNextView:k,setValueAndGoToNextView:C}}const LI=["className","sx"],FI=({props:e,propsFromPickerValue:t,additionalViewProps:n,inputRef:r,autoFocusView:i})=>{const{onChange:s,open:o,onSelectedSectionsChange:a,onClose:l}=t,{view:c,views:u,openTo:h,onViewChange:d,viewRenderers:f,timezone:p}=e,g=oe(e,LI),{view:v,setView:y,defaultView:x,focusedView:b,setFocusedView:w,setValueAndGoToNextView:S}=NI({view:c,views:u,openTo:h,onChange:s,onViewChange:d,autoFocus:i}),{hasUIView:k,viewModeLookup:C}=on.useMemo(()=>u.reduce((e,t)=>{let n;return n=null!=f[t]?"UI":"field",e.viewModeLookup[t]=n,"UI"===n&&(e.hasUIView=!0),e},{hasUIView:!1,viewModeLookup:{}}),[f,u]),E=on.useMemo(()=>u.reduce((e,t)=>null!=f[t]&&(e=>oE.includes(e))(t)?e+1:e,0),[f,u]),I=C[v],D=Se(()=>"UI"===I),[T,j]=on.useState("UI"===I?v:null);return T!==v&&"UI"===C[v]&&j(v),De(()=>{"field"===I&&o&&(l(),setTimeout(()=>{null==r||r.current.focus(),a(v)}))},[v]),De(()=>{if(!o)return;let e=v;"field"===I&&null!=T&&(e=T),e!==x&&"UI"===C[e]&&"UI"===C[x]&&(e=x),e!==v&&y(e),w(e,!0)},[o]),{hasUIView:k,shouldRestoreFocus:D,layoutProps:{views:u,view:T,onViewChange:y},renderCurrentView:()=>{if(null==T)return null;const e=f[T];return null==e?null:e(m({},g,n,t,{views:u,timezone:p,onChange:S,view:T,onViewChange:y,focusedView:b,onFocusedViewChange:w,showViewSwitcher:E>1,timeViewsCount:E}))}}};function VI(){return"undefined"==typeof window?"portrait":window.screen&&window.screen.orientation&&window.screen.orientation.angle?90===Math.abs(window.screen.orientation.angle)?"landscape":"portrait":window.orientation&&90===Math.abs(Number(window.orientation))?"landscape":"portrait"}const BI=(e,t)=>{const[n,r]=on.useState(VI);return De(()=>{const e=()=>{r(VI())};return window.addEventListener("orientationchange",e),()=>{window.removeEventListener("orientationchange",e)}},[]),i=e,s=["hours","minutes","seconds"],!(Array.isArray(s)?s.every(e=>-1!==i.indexOf(e)):-1!==i.indexOf(s))&&"landscape"===(t||n);var i,s},zI=({props:e,valueManager:t,valueType:n,wrapperVariant:r,inputRef:i,additionalViewProps:s,validator:o,autoFocusView:a})=>{const l=OI({props:e,valueManager:t,valueType:n,wrapperVariant:r,validator:o}),c=FI({props:e,inputRef:i,additionalViewProps:s,autoFocusView:a,propsFromPickerValue:l.viewProps}),u=(({props:e,propsFromPickerValue:t,propsFromPickerViews:n,wrapperVariant:r})=>{const{orientation:i}=e,s=BI(n.views,i);return{layoutProps:m({},n,t,{isLandscape:s,wrapperVariant:r,disabled:e.disabled,readOnly:e.readOnly})}})({props:e,wrapperVariant:r,propsFromPickerValue:l.layoutProps,propsFromPickerViews:c.layoutProps});return{open:l.open,actions:l.actions,fieldProps:l.fieldProps,renderCurrentView:c.renderCurrentView,hasUIView:c.hasUIView,shouldRestoreFocus:c.shouldRestoreFocus,layoutProps:u.layoutProps}};function WI(e){return le("MuiPickersLayout",e)}const UI=ce("MuiPickersLayout",["root","landscape","contentWrapper","toolbar","actionBar","tabs","shortcuts"]),HI=["onAccept","onClear","onCancel","onSetToday","actions"];function $I(e){const{onAccept:t,onClear:n,onCancel:r,onSetToday:i,actions:s}=e,o=oe(e,HI),a=FE();if(null==s||0===s.length)return null;const l=null==s?void 0:s.map(e=>{switch(e){case"clear":return y.jsx(Te,{onClick:n,children:a.clearButtonLabel},e);case"cancel":return y.jsx(Te,{onClick:r,children:a.cancelButtonLabel},e);case"accept":return y.jsx(Te,{onClick:t,children:a.okButtonLabel},e);case"today":return y.jsx(Te,{onClick:i,children:a.todayButtonLabel},e);default:return null}});return y.jsx(je,m({},o,{children:l}))}const qI=["items","changeImportance","isLandscape","onChange","isValid"],XI=["getValue"];function KI(e){const{items:t,changeImportance:n,onChange:r,isValid:i}=e,s=oe(e,qI);if(null==t||0===t.length)return null;const o=t.map(e=>{let{getValue:t}=e,s=oe(e,XI);const o=t({isValid:i});return{label:s.label,onClick:()=>{r(o,n,s)},disabled:!i(o)}});return y.jsx(K,m({dense:!0,sx:[{maxHeight:334,maxWidth:200,overflow:"auto"},...Array.isArray(s.sx)?s.sx:[s.sx]]},s,{children:o.map(e=>y.jsx(G,{children:y.jsx(_e,m({},e))},e.label))}))}const GI=e=>{var t,n;const{wrapperVariant:r,onAccept:i,onClear:s,onCancel:o,onSetToday:a,view:l,views:c,onViewChange:u,value:h,onChange:d,onSelectShortcut:f,isValid:p,isLandscape:g,disabled:v,readOnly:x,children:b,components:w,componentsProps:S,slots:k,slotProps:C}=e,E=null!=k?k:GE(w),I=null!=C?C:S,D=(e=>{const{classes:t,isLandscape:n}=e;return he({root:["root",n&&"landscape"],contentWrapper:["contentWrapper"],toolbar:["toolbar"],actionBar:["actionBar"],tabs:["tabs"],landscape:["landscape"],shortcuts:["shortcuts"]},WI,t)})(e),T=null!=(t=null==E?void 0:E.actionBar)?t:$I,j=GC({elementType:T,externalSlotProps:null==I?void 0:I.actionBar,additionalProps:{onAccept:i,onClear:s,onCancel:o,onSetToday:a,actions:"desktop"===r?[]:["cancel","accept"],className:D.actionBar},ownerState:m({},e,{wrapperVariant:r})}),_=y.jsx(T,m({},j)),M=null==E?void 0:E.toolbar,P=GC({elementType:M,externalSlotProps:null==I?void 0:I.toolbar,additionalProps:{isLandscape:g,onChange:d,value:h,view:l,onViewChange:u,views:c,disabled:v,readOnly:x,className:D.toolbar},ownerState:m({},e,{wrapperVariant:r})}),A=function(e){return null!==e.view}(P)&&M?y.jsx(M,m({},P)):null,R=b,O=null==E?void 0:E.tabs,N=l&&O?y.jsx(O,m({view:l,onViewChange:u,className:D.tabs},null==I?void 0:I.tabs)):null,L=null!=(n=null==E?void 0:E.shortcuts)?n:KI,F=GC({elementType:L,externalSlotProps:null==I?void 0:I.shortcuts,additionalProps:{isValid:p,isLandscape:g,onChange:f,className:D.shortcuts},ownerState:{isValid:p,isLandscape:g,onChange:f,className:D.shortcuts,wrapperVariant:r}});return{toolbar:A,content:R,tabs:N,actionBar:_,shortcuts:l&&L?y.jsx(L,m({},F)):null}},YI=ue("div",{name:"MuiPickersLayout",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>({display:"grid",gridAutoColumns:"max-content auto max-content",gridAutoRows:"max-content auto max-content",[`& .${UI.toolbar}`]:t.isLandscape?{gridColumn:"rtl"===e.direction?3:1,gridRow:"2 / 3"}:{gridColumn:"2 / 4",gridRow:1},[`.${UI.shortcuts}`]:t.isLandscape?{gridColumn:"2 / 4",gridRow:1}:{gridColumn:"rtl"===e.direction?3:1,gridRow:"2 / 3"},[`& .${UI.actionBar}`]:{gridColumn:"1 / 4",gridRow:3}}));YI.propTypes={as:Me.elementType,ownerState:Me.shape({isLandscape:Me.bool.isRequired}).isRequired,sx:Me.oneOfType([Me.arrayOf(Me.oneOfType([Me.func,Me.object,Me.bool])),Me.func,Me.object])};const QI=ue("div",{name:"MuiPickersLayout",slot:"ContentWrapper",overridesResolver:(e,t)=>t.contentWrapper})({gridColumn:2,gridRow:2,display:"flex",flexDirection:"column"}),JI=function(e){const t=ae({props:e,name:"MuiPickersLayout"}),{toolbar:n,content:r,tabs:i,actionBar:s,shortcuts:o}=GI(t),{sx:a,className:l,isLandscape:c,ref:u,wrapperVariant:h}=t,d=t,f=(e=>{const{isLandscape:t,classes:n}=e;return he({root:["root",t&&"landscape"],contentWrapper:["contentWrapper"]},WI,n)})(d);return y.jsxs(YI,{ref:u,sx:a,className:se(l,f.root),ownerState:d,children:[c?o:n,c?n:o,y.jsx(QI,{className:f.contentWrapper,children:"desktop"===h?y.jsxs(on.Fragment,{children:[r,i]}):y.jsxs(on.Fragment,{children:[i,r]})}),s]})},ZI=["disablePast","disableFuture","minDate","maxDate","shouldDisableDate","shouldDisableMonth","shouldDisableYear"],eD=[...ZI,"disablePast","disableFuture","minTime","maxTime","shouldDisableClock","shouldDisableTime","minutesStep","ampm","disableIgnoringDatePartForTimeValidation","minDateTime","maxDateTime"],tD=e=>eD.reduce((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t),{}),nD=["value","defaultValue","referenceDate","format","formatDensity","onChange","timezone","readOnly","onError","shouldRespectLeadingZeros","selectedSections","onSelectedSectionsChange","unstableFieldRef"],rD=({props:e,value:t,adapter:n})=>{if(null===t)return null;const{shouldDisableDate:r,shouldDisableMonth:i,shouldDisableYear:s,disablePast:o,disableFuture:a,timezone:l}=e,c=n.utils.dateWithTimezone(void 0,l),u=ZC(n.utils,e.minDate,n.defaultDates.minDate),h=ZC(n.utils,e.maxDate,n.defaultDates.maxDate);switch(!0){case!n.utils.isValid(t):return"invalidDate";case Boolean(r&&r(t)):return"shouldDisableDate";case Boolean(i&&i(t)):return"shouldDisableMonth";case Boolean(s&&s(t)):return"shouldDisableYear";case Boolean(a&&n.utils.isAfterDay(t,c)):return"disableFuture";case Boolean(o&&n.utils.isBeforeDay(t,c)):return"disablePast";case Boolean(u&&n.utils.isBeforeDay(t,u)):return"minDate";case Boolean(h&&n.utils.isAfterDay(t,h)):return"maxDate";default:return null}};function iD(e){return le("MuiPickersDay",e)}const sD=ce("MuiPickersDay",["root","dayWithMargin","dayOutsideMonth","hiddenDaySpacingFiller","today","selected","disabled"]),oD=["autoFocus","className","day","disabled","disableHighlightToday","disableMargin","hidden","isAnimating","onClick","onDaySelect","onFocus","onBlur","onKeyDown","onMouseDown","onMouseEnter","outsideCurrentMonth","selected","showDaysOutsideCurrentMonth","children","today","isFirstVisibleCell","isLastVisibleCell"],aD=({theme:e,ownerState:t})=>m({},e.typography.caption,{width:36,height:36,borderRadius:"50%",padding:0,backgroundColor:"transparent",transition:e.transitions.create("background-color",{duration:e.transitions.duration.short}),color:(e.vars||e).palette.text.primary,"@media (pointer: fine)":{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Ae(e.palette.primary.main,e.palette.action.hoverOpacity)}},"&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.focusOpacity})`:Ae(e.palette.primary.main,e.palette.action.focusOpacity),[`&.${sD.selected}`]:{willChange:"background-color",backgroundColor:(e.vars||e).palette.primary.dark}},[`&.${sD.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,fontWeight:e.typography.fontWeightMedium,"&:hover":{willChange:"background-color",backgroundColor:(e.vars||e).palette.primary.dark}},[`&.${sD.disabled}:not(.${sD.selected})`]:{color:(e.vars||e).palette.text.disabled},[`&.${sD.disabled}&.${sD.selected}`]:{opacity:.6}},!t.disableMargin&&{margin:"0 2px"},t.outsideCurrentMonth&&t.showDaysOutsideCurrentMonth&&{color:(e.vars||e).palette.text.secondary},!t.disableHighlightToday&&t.today&&{[`&:not(.${sD.selected})`]:{border:`1px solid ${(e.vars||e).palette.text.secondary}`}}),lD=(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disableMargin&&t.dayWithMargin,!n.disableHighlightToday&&n.today&&t.today,!n.outsideCurrentMonth&&n.showDaysOutsideCurrentMonth&&t.dayOutsideMonth,n.outsideCurrentMonth&&!n.showDaysOutsideCurrentMonth&&t.hiddenDaySpacingFiller]},cD=ue(Pe,{name:"MuiPickersDay",slot:"Root",overridesResolver:lD})(aD),uD=ue("div",{name:"MuiPickersDay",slot:"Root",overridesResolver:lD})(({theme:e,ownerState:t})=>m({},aD({theme:e,ownerState:t}),{opacity:0,pointerEvents:"none"})),hD=()=>{},dD=on.forwardRef(function(e,t){const n=ae({props:e,name:"MuiPickersDay"}),{autoFocus:r=!1,className:i,day:s,disabled:o=!1,disableHighlightToday:a=!1,disableMargin:l=!1,isAnimating:c,onClick:u,onDaySelect:h,onFocus:d=hD,onBlur:f=hD,onKeyDown:p=hD,onMouseDown:g=hD,onMouseEnter:v=hD,outsideCurrentMonth:x,selected:b=!1,showDaysOutsideCurrentMonth:w=!1,children:S,today:k=!1}=n,C=oe(n,oD),E=m({},n,{autoFocus:r,disabled:o,disableHighlightToday:a,disableMargin:l,selected:b,showDaysOutsideCurrentMonth:w,today:k}),I=(e=>{const{selected:t,disableMargin:n,disableHighlightToday:r,today:i,disabled:s,outsideCurrentMonth:o,showDaysOutsideCurrentMonth:a,classes:l}=e,c=o&&!a;return he({root:["root",t&&!c&&"selected",s&&"disabled",!n&&"dayWithMargin",!r&&i&&"today",o&&a&&"dayOutsideMonth",c&&"hiddenDaySpacingFiller"],hiddenDaySpacingFiller:["hiddenDaySpacingFiller"]},iD,l)})(E),D=NE(),T=on.useRef(null),j=xe(T,t);return De(()=>{!r||o||c||x||T.current.focus()},[r,o,c,x]),x&&!w?y.jsx(uD,{className:se(I.root,I.hiddenDaySpacingFiller,i),ownerState:E,role:C.role}):y.jsx(cD,m({className:se(I.root,i),ref:j,centerRipple:!0,disabled:o,tabIndex:b?0:-1,onKeyDown:e=>p(e,s),onFocus:e=>d(e,s),onBlur:e=>f(e,s),onMouseEnter:e=>v(e,s),onClick:e=>{o||h(s),x&&e.currentTarget.focus(),u&&u(e)},onMouseDown:e=>{g(e),x&&e.preventDefault()}},C,{ownerState:E,children:S||D.format(s,"dayOfMonth")}))}),fD=on.memo(dD),pD=e=>le("MuiPickersSlideTransition",e),gD=ce("MuiPickersSlideTransition",["root","slideEnter-left","slideEnter-right","slideEnterActive","slideExit","slideExitActiveLeft-left","slideExitActiveLeft-right"]),mD=["children","className","reduceAnimations","slideDirection","transKey","classes"],vD=ue(Oe,{name:"MuiPickersSlideTransition",slot:"Root",overridesResolver:(e,t)=>[t.root,{[`.${gD["slideEnter-left"]}`]:t["slideEnter-left"]},{[`.${gD["slideEnter-right"]}`]:t["slideEnter-right"]},{[`.${gD.slideEnterActive}`]:t.slideEnterActive},{[`.${gD.slideExit}`]:t.slideExit},{[`.${gD["slideExitActiveLeft-left"]}`]:t["slideExitActiveLeft-left"]},{[`.${gD["slideExitActiveLeft-right"]}`]:t["slideExitActiveLeft-right"]}]})(({theme:e})=>{const t=e.transitions.create("transform",{duration:e.transitions.duration.complex,easing:"cubic-bezier(0.35, 0.8, 0.4, 1)"});return{display:"block",position:"relative",overflowX:"hidden","& > *":{position:"absolute",top:0,right:0,left:0},[`& .${gD["slideEnter-left"]}`]:{willChange:"transform",transform:"translate(100%)",zIndex:1},[`& .${gD["slideEnter-right"]}`]:{willChange:"transform",transform:"translate(-100%)",zIndex:1},[`& .${gD.slideEnterActive}`]:{transform:"translate(0%)",transition:t},[`& .${gD.slideExit}`]:{transform:"translate(0%)"},[`& .${gD["slideExitActiveLeft-left"]}`]:{willChange:"transform",transform:"translate(-100%)",transition:t,zIndex:0},[`& .${gD["slideExitActiveLeft-right"]}`]:{willChange:"transform",transform:"translate(100%)",transition:t,zIndex:0}}}),yD=({shouldDisableDate:e,shouldDisableMonth:t,shouldDisableYear:n,minDate:r,maxDate:i,disableFuture:s,disablePast:o,timezone:a})=>{const l=OE();return on.useCallback(c=>null!==rD({adapter:l,value:c,props:{shouldDisableDate:e,shouldDisableMonth:t,shouldDisableYear:n,minDate:r,maxDate:i,disableFuture:s,disablePast:o,timezone:a}}),[l,e,t,n,r,i,s,o,a])},xD=e=>le("MuiDayCalendar",e);ce("MuiDayCalendar",["root","header","weekDayLabel","loadingContainer","slideTransition","monthContainer","weekContainer","weekNumberLabel","weekNumber"]);const bD=["parentProps","day","focusableDay","selectedDays","isDateDisabled","currentMonthNumber","isViewFocused"],wD=["ownerState"],SD=ue("div",{name:"MuiDayCalendar",slot:"Root",overridesResolver:(e,t)=>t.root})({}),kD=ue("div",{name:"MuiDayCalendar",slot:"Header",overridesResolver:(e,t)=>t.header})({display:"flex",justifyContent:"center",alignItems:"center"}),CD=ue(E,{name:"MuiDayCalendar",slot:"WeekDayLabel",overridesResolver:(e,t)=>t.weekDayLabel})(({theme:e})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(e.vars||e).palette.text.secondary})),ED=ue(E,{name:"MuiDayCalendar",slot:"WeekNumberLabel",overridesResolver:(e,t)=>t.weekNumberLabel})(({theme:e})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:e.palette.text.disabled})),ID=ue(E,{name:"MuiDayCalendar",slot:"WeekNumber",overridesResolver:(e,t)=>t.weekNumber})(({theme:e})=>m({},e.typography.caption,{width:36,height:36,padding:0,margin:"0 2px",color:e.palette.text.disabled,fontSize:"0.75rem",alignItems:"center",justifyContent:"center",display:"inline-flex"})),DD=ue("div",{name:"MuiDayCalendar",slot:"LoadingContainer",overridesResolver:(e,t)=>t.loadingContainer})({display:"flex",justifyContent:"center",alignItems:"center",minHeight:240}),TD=ue(function(e){const t=ae({props:e,name:"MuiPickersSlideTransition"}),{children:n,className:r,reduceAnimations:i,transKey:s}=t,o=oe(t,mD),a=(e=>{const{classes:t,slideDirection:n}=e;return he({root:["root"],exit:["slideExit"],enterActive:["slideEnterActive"],enter:[`slideEnter-${n}`],exitActive:[`slideExitActiveLeft-${n}`]},pD,t)})(t),l=fe();if(i)return y.jsx("div",{className:se(a.root,r),children:n});const c={exit:a.exit,enterActive:a.enterActive,enter:a.enter,exitActive:a.exitActive};return y.jsx(vD,{className:se(a.root,r),childFactory:e=>on.cloneElement(e,{classNames:c}),role:"presentation",children:y.jsx(Re,m({mountOnEnter:!0,unmountOnExit:!0,timeout:l.transitions.duration.complex,classNames:c},o,{children:n}),s)})},{name:"MuiDayCalendar",slot:"SlideTransition",overridesResolver:(e,t)=>t.slideTransition})({minHeight:240}),jD=ue("div",{name:"MuiDayCalendar",slot:"MonthContainer",overridesResolver:(e,t)=>t.monthContainer})({overflow:"hidden"}),_D=ue("div",{name:"MuiDayCalendar",slot:"WeekContainer",overridesResolver:(e,t)=>t.weekContainer})({margin:"2px 0",display:"flex",justifyContent:"center"});function MD(e){var t,n,r;let{parentProps:i,day:s,focusableDay:o,selectedDays:a,isDateDisabled:l,currentMonthNumber:c,isViewFocused:u}=e,h=oe(e,bD);const{disabled:d,disableHighlightToday:f,isMonthSwitchingAnimating:p,showDaysOutsideCurrentMonth:g,components:v,componentsProps:x,slots:b,slotProps:w,timezone:S}=i,k=NE(),C=VE(S),E=null!==o&&k.isSameDay(s,o),I=a.some(e=>k.isSameDay(e,s)),D=k.isSameDay(s,C),T=null!=(t=null!=(n=null==b?void 0:b.day)?n:null==v?void 0:v.Day)?t:fD,j=GC({elementType:T,externalSlotProps:null!=(r=null==w?void 0:w.day)?r:null==x?void 0:x.day,additionalProps:m({disableHighlightToday:f,showDaysOutsideCurrentMonth:g,role:"gridcell",isAnimating:p,"data-timestamp":k.toJsDate(s).valueOf()},h),ownerState:m({},i,{day:s,selected:I})}),_=oe(j,wD),M=on.useMemo(()=>d||l(s),[d,l,s]),P=on.useMemo(()=>k.getMonth(s)!==c,[k,s,c]),A=on.useMemo(()=>{const e=k.startOfMonth(k.setMonth(s,c));return g?k.isSameDay(s,k.startOfWeek(e)):k.isSameDay(s,e)},[c,s,g,k]),R=on.useMemo(()=>{const e=k.endOfMonth(k.setMonth(s,c));return g?k.isSameDay(s,k.endOfWeek(e)):k.isSameDay(s,e)},[c,s,g,k]);return y.jsx(T,m({},_,{day:s,disabled:M,autoFocus:u&&E,today:D,outsideCurrentMonth:P,isFirstVisibleCell:A,isLastVisibleCell:R,selected:I,tabIndex:E?0:-1,"aria-selected":I,"aria-current":D?"date":void 0}))}function PD(e){const t=ae({props:e,name:"MuiDayCalendar"}),{onFocusedDayChange:n,className:r,currentMonth:i,selectedDays:s,focusedDay:o,loading:a,onSelectedDaysChange:l,onMonthSwitchingAnimationEnd:c,readOnly:u,reduceAnimations:h,renderLoading:d=()=>y.jsx("span",{children:"..."}),slideDirection:f,TransitionProps:p,disablePast:g,disableFuture:v,minDate:x,maxDate:b,shouldDisableDate:w,shouldDisableMonth:S,shouldDisableYear:k,dayOfWeekFormatter:C,hasFocus:E,onFocusedViewChange:I,gridLabelId:D,displayWeekNumber:T,fixedWeekNumber:j,autoFocus:_,timezone:M}=t,P=VE(M),A=NE(),R=(e=>{const{classes:t}=e;return he({root:["root"],header:["header"],weekDayLabel:["weekDayLabel"],loadingContainer:["loadingContainer"],slideTransition:["slideTransition"],monthContainer:["monthContainer"],weekContainer:["weekContainer"],weekNumberLabel:["weekNumberLabel"],weekNumber:["weekNumber"]},xD,t)})(t),O="rtl"===fe().direction,N=C||((e,t)=>A.format(t,"weekdayShort").charAt(0).toUpperCase()),L=yD({shouldDisableDate:w,shouldDisableMonth:S,shouldDisableYear:k,minDate:x,maxDate:b,disablePast:g,disableFuture:v,timezone:M}),F=FE(),[V,B]=Ie({name:"DayCalendar",state:"hasFocus",controlled:E,default:null!=_&&_}),[z,W]=on.useState(()=>o||P),U=Se(e=>{u||l(e)}),H=e=>{L(e)||(n(e),W(e),null==I||I(!0),B(!0))},$=Se((e,t)=>{switch(e.key){case"ArrowUp":H(A.addDays(t,-7)),e.preventDefault();break;case"ArrowDown":H(A.addDays(t,7)),e.preventDefault();break;case"ArrowLeft":{const n=A.addDays(t,O?1:-1),r=A.addMonths(t,O?1:-1),i=JC({utils:A,date:n,minDate:O?n:A.startOfMonth(r),maxDate:O?A.endOfMonth(r):n,isDateDisabled:L,timezone:M});H(i||n),e.preventDefault();break}case"ArrowRight":{const n=A.addDays(t,O?-1:1),r=A.addMonths(t,O?-1:1),i=JC({utils:A,date:n,minDate:O?A.startOfMonth(r):n,maxDate:O?n:A.endOfMonth(r),isDateDisabled:L,timezone:M});H(i||n),e.preventDefault();break}case"Home":H(A.startOfWeek(t)),e.preventDefault();break;case"End":H(A.endOfWeek(t)),e.preventDefault();break;case"PageUp":H(A.addMonths(t,1)),e.preventDefault();break;case"PageDown":H(A.addMonths(t,-1)),e.preventDefault()}}),q=Se((e,t)=>H(t)),X=Se((e,t)=>{V&&A.isSameDay(z,t)&&(null==I||I(!1))}),K=A.getMonth(i),G=on.useMemo(()=>s.filter(e=>!!e).map(e=>A.startOfDay(e)),[A,s]),Y=K,Q=on.useMemo(()=>on.createRef(),[Y]),J=A.startOfWeek(P),Z=on.useMemo(()=>{const e=A.startOfMonth(i),t=A.endOfMonth(i);return L(z)||A.isAfterDay(z,t)||A.isBeforeDay(z,e)?JC({utils:A,date:z,minDate:e,maxDate:t,disablePast:g,disableFuture:v,isDateDisabled:L,timezone:M}):z},[i,v,g,z,L,A,M]),ee=on.useMemo(()=>{const e=A.setTimezone(i,M),t=A.getWeekArray(e);let n=A.addMonths(e,1);for(;j&&t.length<j;){const e=A.getWeekArray(n),r=A.isSameDay(t[t.length-1][0],e[0][0]);e.slice(r?1:0).forEach(e=>{t.length<j&&t.push(e)}),n=A.addMonths(n,1)}return t},[i,j,A,M]);return y.jsxs(SD,{role:"grid","aria-labelledby":D,className:R.root,children:[y.jsxs(kD,{role:"row",className:R.header,children:[T&&y.jsx(ED,{variant:"caption",role:"columnheader","aria-label":F.calendarWeekNumberHeaderLabel,className:R.weekNumberLabel,children:F.calendarWeekNumberHeaderText}),sE(A,P).map((e,t)=>{var n;const r=A.format(e,"weekdayShort");return y.jsx(CD,{variant:"caption",role:"columnheader","aria-label":A.format(A.addDays(J,t),"weekday"),className:R.weekDayLabel,children:null!=(n=null==N?void 0:N(r,e))?n:r},r+t.toString())})]}),a?y.jsx(DD,{className:R.loadingContainer,children:d()}):y.jsx(TD,m({transKey:Y,onExited:c,reduceAnimations:h,slideDirection:f,className:se(r,R.slideTransition)},p,{nodeRef:Q,children:y.jsx(jD,{ref:Q,role:"rowgroup",className:R.monthContainer,children:ee.map((e,n)=>y.jsxs(_D,{role:"row",className:R.weekContainer,"aria-rowindex":n+1,children:[T&&y.jsx(ID,{className:R.weekNumber,role:"rowheader","aria-label":F.calendarWeekNumberAriaLabelText(A.getWeekNumber(e[0])),children:F.calendarWeekNumberText(A.getWeekNumber(e[0]))}),e.map((e,n)=>y.jsx(MD,{parentProps:t,day:e,selectedDays:G,focusableDay:Z,onKeyDown:$,onFocus:q,onBlur:X,onDaySelect:U,isDateDisabled:L,currentMonthNumber:K,isViewFocused:V,"aria-colindex":n+1},e.toString()))]},`week-${e[0]}`))})}))]})}const AD=e=>{const{value:t,referenceDate:n,defaultCalendarMonth:r,disableFuture:i,disablePast:s,disableSwitchToMonthOnDayFocus:o=!1,maxDate:a,minDate:l,onMonthChange:c,reduceAnimations:u,shouldDisableDate:h,timezone:d}=e,f=NE(),p=on.useRef(((e,t,n)=>(r,i)=>{switch(i.type){case"changeMonth":return m({},r,{slideDirection:i.direction,currentMonth:i.newMonth,isMonthSwitchingAnimating:!e});case"finishMonthSwitchingAnimation":return m({},r,{isMonthSwitchingAnimating:!1});case"changeFocusedDay":{if(null!=r.focusedDay&&null!=i.focusedDay&&n.isSameDay(i.focusedDay,r.focusedDay))return r;const s=null!=i.focusedDay&&!t&&!n.isSameMonth(r.currentMonth,i.focusedDay);return m({},r,{focusedDay:i.focusedDay,isMonthSwitchingAnimating:s&&!e&&!i.withoutMonthSwitchingAnimation,currentMonth:s?n.startOfMonth(i.focusedDay):r.currentMonth,slideDirection:null!=i.focusedDay&&n.isAfterDay(i.focusedDay,r.currentMonth)?"left":"right"})}default:throw new Error("missing support")}})(Boolean(u),o,f)).current,g=on.useMemo(()=>{let i=null;return n?i=n:r&&(i=f.startOfMonth(r)),TE.getInitialReferenceValue({value:t,utils:f,timezone:d,props:e,referenceDate:i,granularity:lE.day})},[]),[v,y]=on.useReducer(p,{isMonthSwitchingAnimating:!1,focusedDay:g,currentMonth:f.startOfMonth(g),slideDirection:"left"}),x=on.useCallback(e=>{y(m({type:"changeMonth"},e)),c&&c(e.newMonth)},[c]),b=on.useCallback(e=>{const t=e;f.isSameMonth(t,v.currentMonth)||x({newMonth:f.startOfMonth(t),direction:f.isAfterDay(t,v.currentMonth)?"left":"right"})},[v.currentMonth,x,f]),w=yD({shouldDisableDate:h,minDate:l,maxDate:a,disableFuture:i,disablePast:s,timezone:d}),S=on.useCallback(()=>{y({type:"finishMonthSwitchingAnimation"})},[]),k=Se((e,t)=>{w(e)||y({type:"changeFocusedDay",focusedDay:e,withoutMonthSwitchingAnimation:t})});return{referenceDate:g,calendarState:v,changeMonth:b,changeFocusedDay:k,isDateDisabled:w,onMonthSwitchingAnimationEnd:S,handleChangeMonth:x}},RD=["props","getOpenDialogAriaText"],OD=["ownerState"],ND=["ownerState"],LD=({props:e,inputRef:t})=>{const n=(e=>{var t,n,r;const i=NE(),s=LE();return m({},e,{disablePast:null!=(t=e.disablePast)&&t,disableFuture:null!=(n=e.disableFuture)&&n,format:null!=(r=e.format)?r:i.formats.keyboardDate,minDate:ZC(i,e.minDate,s.minDate),maxDate:ZC(i,e.maxDate,s.maxDate)})})(e),{forwardedProps:r,internalProps:i}=(e=>{const t=m({},e),n={},r=e=>{t.hasOwnProperty(e)&&(n[e]=t[e],delete t[e])};return nD.forEach(r),ZI.forEach(r),{forwardedProps:t,internalProps:n}})(n);return RI({inputRef:t,forwardedProps:r,internalProps:i,valueManager:TE,fieldValueManager:jE,validator:rD})},FD=["ownerState"],VD=["components","componentsProps","slots","slotProps","InputProps","inputProps"],BD=["inputRef"],zD=["ref","onPaste","onKeyDown","inputMode","readOnly","clearable","onClear"],WD=on.forwardRef(function(e,t){var n,r,i;const s=ae({props:e,name:"MuiDateField"}),{components:o,componentsProps:a,slots:l,slotProps:c,InputProps:u,inputProps:h}=s,d=oe(s,VD),f=s,p=null!=(n=null!=(r=null==l?void 0:l.textField)?r:null==o?void 0:o.TextField)?n:Fe,g=GC({elementType:p,externalSlotProps:null!=(i=null==c?void 0:c.textField)?i:null==a?void 0:a.textField,externalForwardedProps:d,ownerState:f}),{inputRef:v}=g,x=oe(g,BD);x.inputProps=m({},h,x.inputProps),x.InputProps=m({},u,x.InputProps);const b=LD({props:x,inputRef:v}),{ref:w,onPaste:S,onKeyDown:C,inputMode:E,readOnly:I,clearable:D,onClear:T}=b,j=oe(b,zD),{InputProps:_,fieldProps:M}=(({clearable:e,fieldProps:t,InputProps:n,onClear:r,slots:i,slotProps:s,components:o,componentsProps:a})=>{var l,c,u,h,d,f;const p=FE(),g=null!=(l=null!=(c=null==i?void 0:i.clearButton)?c:null==o?void 0:o.ClearButton)?l:k,v=GC({elementType:g,externalSlotProps:null!=(u=null==s?void 0:s.clearButton)?u:null==a?void 0:a.clearButton,ownerState:{},className:"clearButton",additionalProps:{title:p.fieldClearLabel}}),x=oe(v,FD),b=null!=(h=null!=(d=null==i?void 0:i.clearIcon)?d:null==o?void 0:o.ClearIcon)?h:tI,w=GC({elementType:b,externalSlotProps:null!=(f=null==s?void 0:s.clearIcon)?f:null==a?void 0:a.clearIcon,ownerState:{}});return{InputProps:m({},n,{endAdornment:y.jsxs(on.Fragment,{children:[e&&y.jsx(Le,{position:"end",sx:{marginRight:null!=n&&n.endAdornment?-1:-1.5},children:y.jsx(g,m({},x,{onClick:r,children:y.jsx(b,m({fontSize:"small"},w))}))}),null==n?void 0:n.endAdornment]})}),fieldProps:m({},t,{sx:[{"& .clearButton":{opacity:1},"@media (pointer: fine)":{"& .clearButton":{opacity:0},"&:hover, &:focus-within":{".clearButton":{opacity:1}}}},...Array.isArray(t.sx)?t.sx:[t.sx]]})}})({onClear:T,clearable:D,fieldProps:j,InputProps:j.InputProps,slots:l,slotProps:c,components:o,componentsProps:a});return y.jsx(p,m({ref:t},M,{InputProps:m({},_,{readOnly:I}),inputProps:m({},j.inputProps,{inputMode:E,onPaste:S,onKeyDown:C,ref:w})}))}),UD=e=>le("MuiPickersFadeTransitionGroup",e);ce("MuiPickersFadeTransitionGroup",["root"]);const HD=ue(Oe,{name:"MuiPickersFadeTransitionGroup",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"block",position:"relative"});function $D(e){const t=ae({props:e,name:"MuiPickersFadeTransitionGroup"}),{children:n,className:r,reduceAnimations:i,transKey:s}=t,o=(e=>{const{classes:t}=e;return he({root:["root"]},UD,t)})(t),a=fe();return i?n:y.jsx(HD,{className:se(o.root,r),children:y.jsx(pe,{appear:!1,mountOnEnter:!0,unmountOnExit:!0,timeout:{appear:a.transitions.duration.enteringScreen,enter:a.transitions.duration.enteringScreen,exit:0},children:n},s)})}function qD(e){return le("MuiPickersMonth",e)}const XD=ce("MuiPickersMonth",["root","monthButton","disabled","selected"]),KD=["autoFocus","children","disabled","selected","value","tabIndex","onClick","onKeyDown","onFocus","onBlur","aria-current","aria-label","monthsPerRow"],GD=ue("div",{name:"MuiPickersMonth",slot:"Root",overridesResolver:(e,t)=>[t.root]})(({ownerState:e})=>({flexBasis:3===e.monthsPerRow?"33.3%":"25%",display:"flex",alignItems:"center",justifyContent:"center"})),YD=ue("button",{name:"MuiPickersMonth",slot:"MonthButton",overridesResolver:(e,t)=>[t.monthButton,{[`&.${XD.disabled}`]:t.disabled},{[`&.${XD.selected}`]:t.selected}]})(({theme:e})=>m({color:"unset",backgroundColor:"transparent",border:0,outline:0},e.typography.subtitle1,{margin:"8px 0",height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Ae(e.palette.action.active,e.palette.action.hoverOpacity)},"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Ae(e.palette.action.active,e.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${XD.disabled}`]:{color:(e.vars||e).palette.text.secondary},[`&.${XD.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,"&:focus, &:hover":{backgroundColor:(e.vars||e).palette.primary.dark}}})),QD=on.memo(function(e){const t=ae({props:e,name:"MuiPickersMonth"}),{autoFocus:n,children:r,disabled:i,selected:s,value:o,tabIndex:a,onClick:l,onKeyDown:c,onFocus:u,onBlur:h,"aria-current":d,"aria-label":f}=t,p=oe(t,KD),g=on.useRef(null),v=(e=>{const{disabled:t,selected:n,classes:r}=e;return he({root:["root"],monthButton:["monthButton",t&&"disabled",n&&"selected"]},qD,r)})(t);return De(()=>{var e;n&&(null==(e=g.current)||e.focus())},[n]),y.jsx(GD,m({className:v.root,ownerState:t},p,{children:y.jsx(YD,{ref:g,disabled:i,type:"button",role:"radio",tabIndex:i?-1:a,"aria-current":d,"aria-checked":s,"aria-label":f,onClick:e=>l(e,o),onKeyDown:e=>c(e,o),onFocus:e=>u(e,o),onBlur:e=>h(e,o),className:v.monthButton,ownerState:t,children:r})}))});function JD(e){return le("MuiMonthCalendar",e)}ce("MuiMonthCalendar",["root"]);const ZD=["className","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","shouldDisableMonth","readOnly","disableHighlightToday","autoFocus","onMonthFocus","hasFocus","onFocusedViewChange","monthsPerRow","timezone","gridLabelId"],eT=ue("div",{name:"MuiMonthCalendar",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",flexWrap:"wrap",alignContent:"stretch",padding:"0 4px",width:uI,boxSizing:"border-box"}),tT=on.forwardRef(function(e,t){const n=function(e,t){const n=NE(),r=LE(),i=ae({props:e,name:t});return m({disableFuture:!1,disablePast:!1},i,{minDate:ZC(n,i.minDate,r.minDate),maxDate:ZC(n,i.maxDate,r.maxDate)})}(e,"MuiMonthCalendar"),{className:r,value:i,defaultValue:s,referenceDate:o,disabled:a,disableFuture:l,disablePast:c,maxDate:u,minDate:h,onChange:d,shouldDisableMonth:f,readOnly:p,disableHighlightToday:g,autoFocus:v=!1,onMonthFocus:x,hasFocus:b,onFocusedViewChange:w,monthsPerRow:S=3,timezone:k,gridLabelId:C}=n,E=oe(n,ZD),{value:I,handleValueChange:D,timezone:T}=TI({name:"MonthCalendar",timezone:k,value:i,defaultValue:s,onChange:d,valueManager:TE}),j=VE(T),_=Ve(),M=NE(),P=on.useMemo(()=>TE.getInitialReferenceValue({value:I,utils:M,props:n,timezone:T,referenceDate:o,granularity:lE.month}),[]),A=n,R=(e=>{const{classes:t}=e;return he({root:["root"]},JD,t)})(A),O=on.useMemo(()=>M.getMonth(j),[M,j]),N=on.useMemo(()=>null!=I?M.getMonth(I):g?null:M.getMonth(P),[I,M,g,P]),[L,F]=on.useState(()=>N||O),[V,B]=Ie({name:"MonthCalendar",state:"hasFocus",controlled:b,default:null!=v&&v}),z=Se(e=>{B(e),w&&w(e)}),W=on.useCallback(e=>{const t=M.startOfMonth(c&&M.isAfter(j,h)?j:h),n=M.startOfMonth(l&&M.isBefore(j,u)?j:u),r=M.startOfMonth(e);return!!M.isBefore(r,t)||!!M.isAfter(r,n)||!!f&&f(r)},[l,c,u,h,j,f,M]),U=Se((e,t)=>{if(p)return;const n=M.setMonth(null!=I?I:P,t);D(n)}),H=Se(e=>{W(M.setMonth(null!=I?I:P,e))||(F(e),z(!0),x&&x(e))});on.useEffect(()=>{F(e=>null!==N&&e!==N?N:e)},[N]);const $=Se((e,t)=>{const n=12;switch(e.key){case"ArrowUp":H((n+t-3)%n),e.preventDefault();break;case"ArrowDown":H((n+t+3)%n),e.preventDefault();break;case"ArrowLeft":H((n+t+("ltr"===_.direction?-1:1))%n),e.preventDefault();break;case"ArrowRight":H((n+t+("ltr"===_.direction?1:-1))%n),e.preventDefault()}}),q=Se((e,t)=>{H(t)}),X=Se((e,t)=>{L===t&&z(!1)});return y.jsx(eT,m({ref:t,className:se(R.root,r),ownerState:A,role:"radiogroup","aria-labelledby":C},E,{children:eE(M,null!=I?I:P).map(e=>{const t=M.getMonth(e),n=M.format(e,"monthShort"),r=M.format(e,"month"),i=t===N,s=a||W(e);return y.jsx(QD,{selected:i,value:t,onClick:U,onKeyDown:$,autoFocus:V&&t===L,disabled:s,tabIndex:t===L?0:-1,onFocus:q,onBlur:X,"aria-current":O===t?"date":void 0,"aria-label":r,monthsPerRow:S,children:n},n)})}))});function nT(e){return le("MuiPickersYear",e)}const rT=ce("MuiPickersYear",["root","yearButton","selected","disabled"]),iT=["autoFocus","className","children","disabled","selected","value","tabIndex","onClick","onKeyDown","onFocus","onBlur","aria-current","yearsPerRow"],sT=ue("div",{name:"MuiPickersYear",slot:"Root",overridesResolver:(e,t)=>[t.root]})(({ownerState:e})=>({flexBasis:3===e.yearsPerRow?"33.3%":"25%",display:"flex",alignItems:"center",justifyContent:"center"})),oT=ue("button",{name:"MuiPickersYear",slot:"YearButton",overridesResolver:(e,t)=>[t.yearButton,{[`&.${rT.disabled}`]:t.disabled},{[`&.${rT.selected}`]:t.selected}]})(({theme:e})=>m({color:"unset",backgroundColor:"transparent",border:0,outline:0},e.typography.subtitle1,{margin:"6px 0",height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.focusOpacity})`:Ae(e.palette.action.active,e.palette.action.focusOpacity)},"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Ae(e.palette.action.active,e.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${rT.disabled}`]:{color:(e.vars||e).palette.text.secondary},[`&.${rT.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,"&:focus, &:hover":{backgroundColor:(e.vars||e).palette.primary.dark}}})),aT=on.memo(function(e){const t=ae({props:e,name:"MuiPickersYear"}),{autoFocus:n,className:r,children:i,disabled:s,selected:o,value:a,tabIndex:l,onClick:c,onKeyDown:u,onFocus:h,onBlur:d,"aria-current":f}=t,p=oe(t,iT),g=on.useRef(null),v=(e=>{const{disabled:t,selected:n,classes:r}=e;return he({root:["root"],yearButton:["yearButton",t&&"disabled",n&&"selected"]},nT,r)})(t);return on.useEffect(()=>{n&&g.current.focus()},[n]),y.jsx(sT,m({className:se(v.root,r),ownerState:t},p,{children:y.jsx(oT,{ref:g,disabled:s,type:"button",role:"radio",tabIndex:s?-1:l,"aria-current":f,"aria-checked":o,onClick:e=>c(e,a),onKeyDown:e=>u(e,a),onFocus:e=>h(e,a),onBlur:e=>d(e,a),className:v.yearButton,ownerState:t,children:i})}))});function lT(e){return le("MuiYearCalendar",e)}ce("MuiYearCalendar",["root"]);const cT=["autoFocus","className","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","readOnly","shouldDisableYear","disableHighlightToday","onYearFocus","hasFocus","onFocusedViewChange","yearsPerRow","timezone","gridLabelId"],uT=ue("div",{name:"MuiYearCalendar",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",flexDirection:"row",flexWrap:"wrap",overflowY:"auto",height:"100%",padding:"0 4px",width:uI,maxHeight:280,boxSizing:"border-box",position:"relative"}),hT=on.forwardRef(function(e,t){const n=function(e,t){var n;const r=NE(),i=LE(),s=ae({props:e,name:t});return m({disablePast:!1,disableFuture:!1},s,{yearsPerRow:null!=(n=s.yearsPerRow)?n:3,minDate:ZC(r,s.minDate,i.minDate),maxDate:ZC(r,s.maxDate,i.maxDate)})}(e,"MuiYearCalendar"),{autoFocus:r,className:i,value:s,defaultValue:o,referenceDate:a,disabled:l,disableFuture:c,disablePast:u,maxDate:h,minDate:d,onChange:f,readOnly:p,shouldDisableYear:g,disableHighlightToday:v,onYearFocus:x,hasFocus:b,onFocusedViewChange:w,yearsPerRow:S,timezone:k,gridLabelId:C}=n,E=oe(n,cT),{value:I,handleValueChange:D,timezone:T}=TI({name:"YearCalendar",timezone:k,value:s,defaultValue:o,onChange:f,valueManager:TE}),j=VE(T),_=Ve(),M=NE(),P=on.useMemo(()=>TE.getInitialReferenceValue({value:I,utils:M,props:n,timezone:T,referenceDate:a,granularity:lE.year}),[]),A=n,R=(e=>{const{classes:t}=e;return he({root:["root"]},lT,t)})(A),O=on.useMemo(()=>M.getYear(j),[M,j]),N=on.useMemo(()=>null!=I?M.getYear(I):v?null:M.getYear(P),[I,M,v,P]),[L,F]=on.useState(()=>N||O),[V,B]=Ie({name:"YearCalendar",state:"hasFocus",controlled:b,default:null!=r&&r}),z=Se(e=>{B(e),w&&w(e)}),W=on.useCallback(e=>{if(u&&M.isBeforeYear(e,j))return!0;if(c&&M.isAfterYear(e,j))return!0;if(d&&M.isBeforeYear(e,d))return!0;if(h&&M.isAfterYear(e,h))return!0;if(!g)return!1;const t=M.startOfYear(e);return g(t)},[c,u,h,d,j,g,M]),U=Se((e,t)=>{if(p)return;const n=M.setYear(null!=I?I:P,t);D(n)}),H=Se(e=>{W(M.setYear(null!=I?I:P,e))||(F(e),z(!0),null==x||x(e))});on.useEffect(()=>{F(e=>null!==N&&e!==N?N:e)},[N]);const $=Se((e,t)=>{switch(e.key){case"ArrowUp":H(t-S),e.preventDefault();break;case"ArrowDown":H(t+S),e.preventDefault();break;case"ArrowLeft":H(t+("ltr"===_.direction?-1:1)),e.preventDefault();break;case"ArrowRight":H(t+("ltr"===_.direction?1:-1)),e.preventDefault()}}),q=Se((e,t)=>{H(t)}),X=Se((e,t)=>{L===t&&z(!1)}),K=on.useRef(null),G=xe(t,K);return on.useEffect(()=>{if(r||null===K.current)return;const e=K.current.querySelector('[tabindex="0"]');if(!e)return;const t=e.offsetHeight,n=e.offsetTop,i=K.current.clientHeight,s=K.current.scrollTop,o=n+t;t>i||n<s||(K.current.scrollTop=o-i/2-t/2)},[r]),y.jsx(uT,m({ref:G,className:se(R.root,i),ownerState:A,role:"radiogroup","aria-labelledby":C},E,{children:M.getYearRange(d,h).map(e=>{const t=M.getYear(e),n=t===N,r=l||W(e);return y.jsx(aT,{selected:n,value:t,onClick:U,onKeyDown:$,autoFocus:V&&t===L,disabled:r,tabIndex:t===L?0:-1,onFocus:q,onBlur:X,"aria-current":O===t?"date":void 0,yearsPerRow:S,children:M.format(e,"year")},M.format(e,"year"))})}))}),dT=e=>le("MuiPickersCalendarHeader",e),fT=ce("MuiPickersCalendarHeader",["root","labelContainer","label","switchViewButton","switchViewIcon"]),pT=["slots","slotProps","components","componentsProps","currentMonth","disabled","disableFuture","disablePast","maxDate","minDate","onMonthChange","onViewChange","view","reduceAnimations","views","labelId","className","timezone"],gT=["ownerState"],mT=ue("div",{name:"MuiPickersCalendarHeader",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",alignItems:"center",marginTop:16,marginBottom:8,paddingLeft:24,paddingRight:12,maxHeight:30,minHeight:30}),vT=ue("div",{name:"MuiPickersCalendarHeader",slot:"LabelContainer",overridesResolver:(e,t)=>t.labelContainer})(({theme:e})=>m({display:"flex",overflow:"hidden",alignItems:"center",cursor:"pointer",marginRight:"auto"},e.typography.body1,{fontWeight:e.typography.fontWeightMedium})),yT=ue("div",{name:"MuiPickersCalendarHeader",slot:"Label",overridesResolver:(e,t)=>t.label})({marginRight:6}),xT=ue(k,{name:"MuiPickersCalendarHeader",slot:"SwitchViewButton",overridesResolver:(e,t)=>t.switchViewButton})(({ownerState:e})=>m({marginRight:"auto"},"year"===e.view&&{[`.${fT.switchViewIcon}`]:{transform:"rotate(180deg)"}})),bT=ue(QE,{name:"MuiPickersCalendarHeader",slot:"SwitchViewIcon",overridesResolver:(e,t)=>t.switchViewIcon})(({theme:e})=>({willChange:"transform",transition:e.transitions.create("transform"),transform:"rotate(0deg)"})),wT=on.forwardRef(function(e,t){var n,r,i,s;const o=FE(),a=NE(),l=ae({props:e,name:"MuiPickersCalendarHeader"}),{slots:c,slotProps:u,components:h,currentMonth:d,disabled:f,disableFuture:p,disablePast:g,maxDate:v,minDate:x,onMonthChange:b,onViewChange:w,view:S,reduceAnimations:k,views:C,labelId:E,className:I,timezone:D}=l,T=oe(l,pT),j=l,_=(e=>{const{classes:t}=e;return he({root:["root"],labelContainer:["labelContainer"],label:["label"],switchViewButton:["switchViewButton"],switchViewIcon:["switchViewIcon"]},dT,t)})(l),M=null!=(n=null!=(r=null==c?void 0:c.switchViewButton)?r:null==h?void 0:h.SwitchViewButton)?n:xT,P=GC({elementType:M,externalSlotProps:null==u?void 0:u.switchViewButton,additionalProps:{size:"small","aria-label":o.calendarViewSwitchingButtonAriaLabel(S)},ownerState:j,className:_.switchViewButton}),A=null!=(i=null!=(s=null==c?void 0:c.switchViewIcon)?s:null==h?void 0:h.SwitchViewIcon)?i:bT,R=GC({elementType:A,externalSlotProps:null==u?void 0:u.switchViewIcon,ownerState:void 0,className:_.switchViewIcon}),O=oe(R,gT),N=function(e,{disableFuture:t,maxDate:n,timezone:r}){const i=NE();return on.useMemo(()=>{const s=i.dateWithTimezone(void 0,r),o=i.startOfMonth(t&&i.isBefore(s,n)?s:n);return!i.isAfter(o,e)},[t,n,e,i,r])}(d,{disableFuture:p,maxDate:v,timezone:D}),L=function(e,{disablePast:t,minDate:n,timezone:r}){const i=NE();return on.useMemo(()=>{const s=i.dateWithTimezone(void 0,r),o=i.startOfMonth(t&&i.isAfter(s,n)?s:n);return!i.isBefore(o,e)},[t,n,e,i,r])}(d,{disablePast:g,minDate:x,timezone:D});return 1===C.length&&"year"===C[0]?null:y.jsxs(mT,m({},T,{ownerState:j,className:se(I,_.root),ref:t,children:[y.jsxs(vT,{role:"presentation",onClick:()=>{if(1!==C.length&&w&&!f)if(2===C.length)w(C.find(e=>e!==S)||C[0]);else{const e=0!==C.indexOf(S)?0:1;w(C[e])}},ownerState:j,"aria-live":"polite",className:_.labelContainer,children:[y.jsx($D,{reduceAnimations:k,transKey:a.format(d,"monthAndYear"),children:y.jsx(yT,{id:E,ownerState:j,className:_.label,children:a.format(d,"monthAndYear")})}),C.length>1&&!f&&y.jsx(M,m({},P,{children:y.jsx(A,m({},O))}))]}),y.jsx(pe,{in:"day"===S,children:y.jsx(cI,{slots:c,slotProps:u,onGoToPrevious:()=>b(a.addMonths(d,-1),"right"),isPreviousDisabled:L,previousLabel:o.previousMonth,onGoToNext:()=>b(a.addMonths(d,1),"left"),isNextDisabled:N,nextLabel:o.nextMonth})})]}))}),ST=ue("div")({overflow:"hidden",width:uI,maxHeight:334,display:"flex",flexDirection:"column",margin:"0 auto"}),kT=e=>le("MuiDateCalendar",e);ce("MuiDateCalendar",["root","viewTransitionContainer"]);const CT=["autoFocus","onViewChange","value","defaultValue","referenceDate","disableFuture","disablePast","defaultCalendarMonth","onChange","onYearChange","onMonthChange","reduceAnimations","shouldDisableDate","shouldDisableMonth","shouldDisableYear","view","views","openTo","className","disabled","readOnly","minDate","maxDate","disableHighlightToday","focusedView","onFocusedViewChange","showDaysOutsideCurrentMonth","fixedWeekNumber","dayOfWeekFormatter","components","componentsProps","slots","slotProps","loading","renderLoading","displayWeekNumber","yearsPerRow","monthsPerRow","timezone"],ET=ue(ST,{name:"MuiDateCalendar",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",flexDirection:"column",height:334}),IT=ue($D,{name:"MuiDateCalendar",slot:"ViewTransitionContainer",overridesResolver:(e,t)=>t.viewTransitionContainer})({}),DT=on.forwardRef(function(e,t){var n,r,i;const s=NE(),o=Ne(),a=function(e,t){var n,r,i,s,o,a,l;const c=NE(),u=LE(),h=wI(),d=ae({props:e,name:t});return m({},d,{loading:null!=(n=d.loading)&&n,disablePast:null!=(r=d.disablePast)&&r,disableFuture:null!=(i=d.disableFuture)&&i,openTo:null!=(s=d.openTo)?s:"day",views:null!=(o=d.views)?o:["year","day"],reduceAnimations:null!=(a=d.reduceAnimations)?a:h,renderLoading:null!=(l=d.renderLoading)?l:()=>y.jsx("span",{children:"..."}),minDate:ZC(c,d.minDate,u.minDate),maxDate:ZC(c,d.maxDate,u.maxDate)})}(e,"MuiDateCalendar"),{autoFocus:l,onViewChange:c,value:u,defaultValue:h,referenceDate:d,disableFuture:f,disablePast:p,defaultCalendarMonth:g,onChange:v,onYearChange:x,onMonthChange:b,reduceAnimations:w,shouldDisableDate:S,shouldDisableMonth:k,shouldDisableYear:C,view:E,views:I,openTo:D,className:T,disabled:j,readOnly:_,minDate:M,maxDate:P,disableHighlightToday:A,focusedView:R,onFocusedViewChange:O,showDaysOutsideCurrentMonth:N,fixedWeekNumber:L,dayOfWeekFormatter:F,components:V,componentsProps:B,slots:z,slotProps:W,loading:U,renderLoading:H,displayWeekNumber:$,yearsPerRow:q,monthsPerRow:X,timezone:K}=a,G=oe(a,CT),{value:Y,handleValueChange:Q,timezone:J}=TI({name:"DateCalendar",timezone:K,value:u,defaultValue:h,onChange:v,valueManager:TE}),{view:Z,setView:ee,focusedView:te,setFocusedView:ne,goToNextView:re,setValueAndGoToNextView:ie}=NI({view:E,views:I,openTo:D,onChange:Q,onViewChange:c,autoFocus:l,focusedView:R,onFocusedViewChange:O}),{referenceDate:le,calendarState:ce,changeFocusedDay:ue,changeMonth:de,handleChangeMonth:fe,isDateDisabled:pe,onMonthSwitchingAnimationEnd:ge}=AD({value:Y,defaultCalendarMonth:g,referenceDate:d,reduceAnimations:w,onMonthChange:b,minDate:M,maxDate:P,shouldDisableDate:S,disablePast:p,disableFuture:f,timezone:J}),me=j&&Y||M,ve=j&&Y||P,ye=`${o}-grid-label`,xe=null!==te,be=null!=(n=null!=(r=null==z?void 0:z.calendarHeader)?r:null==V?void 0:V.CalendarHeader)?n:wT,we=GC({elementType:be,externalSlotProps:null!=(i=null==W?void 0:W.calendarHeader)?i:null==B?void 0:B.calendarHeader,additionalProps:{views:I,view:Z,currentMonth:ce.currentMonth,onViewChange:ee,onMonthChange:(e,t)=>fe({newMonth:e,direction:t}),minDate:me,maxDate:ve,disabled:j,disablePast:p,disableFuture:f,reduceAnimations:w,timezone:J,labelId:ye,slots:z,slotProps:W},ownerState:a}),ke=Se(e=>{const t=s.startOfMonth(e),n=s.endOfMonth(e),r=pe(e)?JC({utils:s,date:e,minDate:s.isBefore(M,t)?t:M,maxDate:s.isAfter(P,n)?n:P,disablePast:p,disableFuture:f,isDateDisabled:pe,timezone:J}):e;r?(ie(r,"finish"),null==b||b(t)):(re(),de(t)),ue(r,!0)}),Ce=Se(e=>{const t=s.startOfYear(e),n=s.endOfYear(e),r=pe(e)?JC({utils:s,date:e,minDate:s.isBefore(M,t)?t:M,maxDate:s.isAfter(P,n)?n:P,disablePast:p,disableFuture:f,isDateDisabled:pe,timezone:J}):e;r?(ie(r,"finish"),null==x||x(r)):(re(),de(t)),ue(r,!0)}),Ee=Se(e=>Q(e?QC(s,e,null!=Y?Y:le):e,"finish",Z));on.useEffect(()=>{null!=Y&&s.isValid(Y)&&de(Y)},[Y]);const Ie=a,De=(e=>{const{classes:t}=e;return he({root:["root"],viewTransitionContainer:["viewTransitionContainer"]},kT,t)})(Ie),Te={disablePast:p,disableFuture:f,maxDate:P,minDate:M},je={disableHighlightToday:A,readOnly:_,disabled:j,timezone:J,gridLabelId:ye},_e=on.useRef(Z);on.useEffect(()=>{_e.current!==Z&&(te===_e.current&&ne(Z,!0),_e.current=Z)},[te,ne,Z]);const Me=on.useMemo(()=>[Y],[Y]);return y.jsxs(ET,m({ref:t,className:se(De.root,T),ownerState:Ie},G,{children:[y.jsx(be,m({},we)),y.jsx(IT,{reduceAnimations:w,className:De.viewTransitionContainer,transKey:Z,ownerState:Ie,children:y.jsxs("div",{children:["year"===Z&&y.jsx(hT,m({},Te,je,{value:Y,onChange:Ce,shouldDisableYear:C,hasFocus:xe,onFocusedViewChange:e=>ne("year",e),yearsPerRow:q,referenceDate:le})),"month"===Z&&y.jsx(tT,m({},Te,je,{hasFocus:xe,className:T,value:Y,onChange:ke,shouldDisableMonth:k,onFocusedViewChange:e=>ne("month",e),monthsPerRow:X,referenceDate:le})),"day"===Z&&y.jsx(PD,m({},ce,Te,je,{onMonthSwitchingAnimationEnd:ge,onFocusedDayChange:ue,reduceAnimations:w,selectedDays:Me,onSelectedDaysChange:Ee,shouldDisableDate:S,shouldDisableMonth:k,shouldDisableYear:C,hasFocus:xe,onFocusedViewChange:e=>ne("day",e),showDaysOutsideCurrentMonth:N,fixedWeekNumber:L,dayOfWeekFormatter:F,displayWeekNumber:$,components:V,componentsProps:B,slots:z,slotProps:W,loading:U,renderLoading:H}))]})})]}))}),TT=({view:e,onViewChange:t,views:n,focusedView:r,onFocusedViewChange:i,value:s,defaultValue:o,referenceDate:a,onChange:l,className:c,classes:u,disableFuture:h,disablePast:d,minDate:f,maxDate:p,shouldDisableDate:g,shouldDisableMonth:m,shouldDisableYear:v,reduceAnimations:x,onMonthChange:b,monthsPerRow:w,onYearChange:S,yearsPerRow:k,defaultCalendarMonth:C,components:E,componentsProps:I,slots:D,slotProps:T,loading:j,renderLoading:_,disableHighlightToday:M,readOnly:P,disabled:A,showDaysOutsideCurrentMonth:R,dayOfWeekFormatter:O,sx:N,autoFocus:L,fixedWeekNumber:F,displayWeekNumber:V,timezone:B})=>y.jsx(DT,{view:e,onViewChange:t,views:n.filter(rE),focusedView:r&&rE(r)?r:null,onFocusedViewChange:i,value:s,defaultValue:o,referenceDate:a,onChange:l,className:c,classes:u,disableFuture:h,disablePast:d,minDate:f,maxDate:p,shouldDisableDate:g,shouldDisableMonth:m,shouldDisableYear:v,reduceAnimations:x,onMonthChange:b,monthsPerRow:w,onYearChange:S,yearsPerRow:k,defaultCalendarMonth:C,components:E,componentsProps:I,slots:D,slotProps:T,loading:j,renderLoading:_,disableHighlightToday:M,readOnly:P,disabled:A,showDaysOutsideCurrentMonth:R,dayOfWeekFormatter:O,sx:N,autoFocus:L,fixedWeekNumber:F,displayWeekNumber:V,timezone:B}),jT=on.forwardRef(function(e,t){var n,r,i,s;const o=FE(),a=NE(),l=YE(e,"MuiDesktopDatePicker"),c=m({day:TT,month:TT,year:TT},l.viewRenderers),u=m({},l,{viewRenderers:c,format:iE(a,l,!1),yearsPerRow:null!=(n=l.yearsPerRow)?n:4,slots:m({openPickerIcon:eI,field:WD},l.slots),slotProps:m({},l.slotProps,{field:e=>{var n;return m({},qC(null==(n=l.slotProps)?void 0:n.field,e),tD(l),{ref:t})},toolbar:m({hidden:!0},null==(r=l.slotProps)?void 0:r.toolbar)})}),{renderPicker:h}=(e=>{var t,n,r,i,s;let{props:o,getOpenDialogAriaText:a}=e,l=oe(e,RD);const{slots:c,slotProps:u,className:h,sx:d,format:f,formatDensity:p,timezone:g,name:v,label:x,inputRef:b,readOnly:w,disabled:S,autoFocus:C,localeText:E,reduceAnimations:I}=o,D=NE(),T=on.useRef(null),j=on.useRef(null),_=Ne(),M=null!=(t=null==u||null==(n=u.toolbar)?void 0:n.hidden)&&t,{open:P,actions:A,hasUIView:R,layoutProps:O,renderCurrentView:N,shouldRestoreFocus:L,fieldProps:F}=zI(m({},l,{props:o,inputRef:T,autoFocusView:!0,additionalViewProps:{},wrapperVariant:"desktop"})),V=null!=(r=c.inputAdornment)?r:Le,B=GC({elementType:V,externalSlotProps:null==u?void 0:u.inputAdornment,additionalProps:{position:"end"},ownerState:o}),z=oe(B,OD),W=null!=(i=c.openPickerButton)?i:k,U=GC({elementType:W,externalSlotProps:null==u?void 0:u.openPickerButton,additionalProps:{disabled:S||w,onClick:P?A.onClose:A.onOpen,"aria-label":a(F.value,D),edge:z.position},ownerState:o}),H=oe(U,ND),$=c.openPickerIcon,q=c.field,X=GC({elementType:q,externalSlotProps:null==u?void 0:u.field,additionalProps:m({},F,M&&{id:_},{readOnly:w,disabled:S,className:h,sx:d,format:f,formatDensity:p,timezone:g,label:x,name:v,autoFocus:C&&!o.open,focused:!!P||void 0}),ownerState:o});R&&(X.InputProps=m({},X.InputProps,{ref:j},!o.disableOpenPicker&&{[`${z.position}Adornment`]:y.jsx(V,m({},z,{children:y.jsx(W,m({},H,{children:y.jsx($,m({},null==u?void 0:u.openPickerIcon))}))}))}));const K=m({textField:c.textField,clearIcon:c.clearIcon,clearButton:c.clearButton},X.slots),G=null!=(s=c.layout)?s:JI,Y=xe(T,X.inputRef,b);let Q=_;M&&(Q=x?`${_}-label`:void 0);const J=m({},u,{toolbar:m({},null==u?void 0:u.toolbar,{titleId:_}),popper:m({"aria-labelledby":Q},null==u?void 0:u.popper)});return{renderPicker:()=>y.jsxs(PE,{localeText:E,children:[y.jsx(q,m({},X,{slots:K,slotProps:J,inputRef:Y})),y.jsx(II,m({role:"dialog",placement:"bottom-start",anchorEl:j.current},A,{open:P,slots:c,slotProps:J,shouldRestoreFocus:L,reduceAnimations:I,children:y.jsx(G,m({},O,null==J?void 0:J.layout,{slots:c,slotProps:J,children:N()}))}))]})}})({props:u,valueManager:TE,valueType:"date",getOpenDialogAriaText:null!=(i=null==(s=u.localeText)?void 0:s.openDatePickerDialogue)?i:o.openDatePickerDialogue,validator:rD});return h()});jT.propTypes={autoFocus:Me.bool,className:Me.string,closeOnSelect:Me.bool,components:Me.object,componentsProps:Me.object,dayOfWeekFormatter:Me.func,defaultCalendarMonth:Me.any,defaultValue:Me.any,disabled:Me.bool,disableFuture:Me.bool,disableHighlightToday:Me.bool,disableOpenPicker:Me.bool,disablePast:Me.bool,displayWeekNumber:Me.bool,fixedWeekNumber:Me.number,format:Me.string,formatDensity:Me.oneOf(["dense","spacious"]),inputRef:Be,label:Me.node,loading:Me.bool,localeText:Me.object,maxDate:Me.any,minDate:Me.any,monthsPerRow:Me.oneOf([3,4]),name:Me.string,onAccept:Me.func,onChange:Me.func,onClose:Me.func,onError:Me.func,onMonthChange:Me.func,onOpen:Me.func,onSelectedSectionsChange:Me.func,onViewChange:Me.func,onYearChange:Me.func,open:Me.bool,openTo:Me.oneOf(["day","month","year"]),orientation:Me.oneOf(["landscape","portrait"]),readOnly:Me.bool,reduceAnimations:Me.bool,referenceDate:Me.any,renderLoading:Me.func,selectedSections:Me.oneOfType([Me.oneOf(["all","day","hours","meridiem","minutes","month","seconds","weekDay","year"]),Me.number,Me.shape({endIndex:Me.number.isRequired,startIndex:Me.number.isRequired})]),shouldDisableDate:Me.func,shouldDisableMonth:Me.func,shouldDisableYear:Me.func,showDaysOutsideCurrentMonth:Me.bool,slotProps:Me.object,slots:Me.object,sx:Me.oneOfType([Me.arrayOf(Me.oneOfType([Me.func,Me.object,Me.bool])),Me.func,Me.object]),timezone:Me.string,value:Me.any,view:Me.oneOf(["day","month","year"]),viewRenderers:Me.shape({day:Me.func,month:Me.func,year:Me.func}),views:Me.arrayOf(Me.oneOf(["day","month","year"]).isRequired),yearsPerRow:Me.oneOf([3,4])};const _T=["props","getOpenDialogAriaText"],MT=on.forwardRef(function(e,t){var n,r,i;const s=FE(),o=NE(),a=YE(e,"MuiMobileDatePicker"),l=m({day:TT,month:TT,year:TT},a.viewRenderers),c=m({},a,{viewRenderers:l,format:iE(o,a,!1),slots:m({field:WD},a.slots),slotProps:m({},a.slotProps,{field:e=>{var n;return m({},qC(null==(n=a.slotProps)?void 0:n.field,e),tD(a),{ref:t})},toolbar:m({hidden:!1},null==(n=a.slotProps)?void 0:n.toolbar)})}),{renderPicker:u}=(e=>{var t,n,r;let{props:i,getOpenDialogAriaText:s}=e,o=oe(e,_T);const{slots:a,slotProps:l,className:c,sx:u,format:h,formatDensity:d,timezone:f,name:p,label:g,inputRef:v,readOnly:x,disabled:b,localeText:w}=i,S=NE(),k=on.useRef(null),C=Ne(),E=null!=(t=null==l||null==(n=l.toolbar)?void 0:n.hidden)&&t,{open:I,actions:D,layoutProps:T,renderCurrentView:j,fieldProps:_}=zI(m({},o,{props:i,inputRef:k,autoFocusView:!0,additionalViewProps:{},wrapperVariant:"mobile"})),M=a.field,P=GC({elementType:M,externalSlotProps:null==l?void 0:l.field,additionalProps:m({},_,E&&{id:C},!(b||x)&&{onClick:D.onOpen,onKeyDown:(A=D.onOpen,e=>{"Enter"!==e.key&&" "!==e.key||(A(e),e.preventDefault(),e.stopPropagation())})},{readOnly:null==x||x,disabled:b,className:c,sx:u,format:h,formatDensity:d,timezone:f,label:g,name:p}),ownerState:i});var A;P.inputProps=m({},P.inputProps,{"aria-label":s(_.value,S)});const R=m({textField:a.textField},P.slots),O=null!=(r=a.layout)?r:JI,N=xe(k,P.inputRef,v);let L=C;E&&(L=g?`${C}-label`:void 0);const F=m({},l,{toolbar:m({},null==l?void 0:l.toolbar,{titleId:C}),mobilePaper:m({"aria-labelledby":L},null==l?void 0:l.mobilePaper)});return{renderPicker:()=>y.jsxs(PE,{localeText:w,children:[y.jsx(M,m({},P,{slots:R,slotProps:F,inputRef:N})),y.jsx(fI,m({},D,{open:I,slots:a,slotProps:F,children:y.jsx(O,m({},T,null==F?void 0:F.layout,{slots:a,slotProps:F,children:j()}))}))]})}})({props:c,valueManager:TE,valueType:"date",getOpenDialogAriaText:null!=(r=null==(i=c.localeText)?void 0:i.openDatePickerDialogue)?r:s.openDatePickerDialogue,validator:rD});return u()});MT.propTypes={autoFocus:Me.bool,className:Me.string,closeOnSelect:Me.bool,components:Me.object,componentsProps:Me.object,dayOfWeekFormatter:Me.func,defaultCalendarMonth:Me.any,defaultValue:Me.any,disabled:Me.bool,disableFuture:Me.bool,disableHighlightToday:Me.bool,disableOpenPicker:Me.bool,disablePast:Me.bool,displayWeekNumber:Me.bool,fixedWeekNumber:Me.number,format:Me.string,formatDensity:Me.oneOf(["dense","spacious"]),inputRef:Be,label:Me.node,loading:Me.bool,localeText:Me.object,maxDate:Me.any,minDate:Me.any,monthsPerRow:Me.oneOf([3,4]),name:Me.string,onAccept:Me.func,onChange:Me.func,onClose:Me.func,onError:Me.func,onMonthChange:Me.func,onOpen:Me.func,onSelectedSectionsChange:Me.func,onViewChange:Me.func,onYearChange:Me.func,open:Me.bool,openTo:Me.oneOf(["day","month","year"]),orientation:Me.oneOf(["landscape","portrait"]),readOnly:Me.bool,reduceAnimations:Me.bool,referenceDate:Me.any,renderLoading:Me.func,selectedSections:Me.oneOfType([Me.oneOf(["all","day","hours","meridiem","minutes","month","seconds","weekDay","year"]),Me.number,Me.shape({endIndex:Me.number.isRequired,startIndex:Me.number.isRequired})]),shouldDisableDate:Me.func,shouldDisableMonth:Me.func,shouldDisableYear:Me.func,showDaysOutsideCurrentMonth:Me.bool,slotProps:Me.object,slots:Me.object,sx:Me.oneOfType([Me.arrayOf(Me.oneOfType([Me.func,Me.object,Me.bool])),Me.func,Me.object]),timezone:Me.string,value:Me.any,view:Me.oneOf(["day","month","year"]),viewRenderers:Me.shape({day:Me.func,month:Me.func,year:Me.func}),views:Me.arrayOf(Me.oneOf(["day","month","year"]).isRequired),yearsPerRow:Me.oneOf([3,4])};const PT=["desktopModeMediaQuery"],AT=on.forwardRef(function(e,t){const n=ae({props:e,name:"MuiDatePicker"}),{desktopModeMediaQuery:r=mI}=n,i=oe(n,PT);return ye(r,{defaultMatches:!0})?y.jsx(jT,m({ref:t},i)):y.jsx(MT,m({ref:t},i))});var RT={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},r=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},i={p:r,P:function(e,t){var i,s=e.match(/(P+)(p+)?/)||[],o=s[1],a=s[2];if(!a)return n(e,t);switch(o){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;default:i=t.dateTime({width:"full"})}return i.replace("{{date}}",n(o,t)).replace("{{time}}",r(a,t))}};t.default=i,e.exports=t.default}(RT,RT.exports);const OT=cn(RT.exports),NT={y:{sectionType:"year",contentType:"digit",maxLength:4},yy:"year",yyy:{sectionType:"year",contentType:"digit",maxLength:4},yyyy:"year",M:{sectionType:"month",contentType:"digit",maxLength:2},MM:"month",MMMM:{sectionType:"month",contentType:"letter"},MMM:{sectionType:"month",contentType:"letter"},L:{sectionType:"month",contentType:"digit",maxLength:2},LL:"month",LLL:{sectionType:"month",contentType:"letter"},LLLL:{sectionType:"month",contentType:"letter"},d:{sectionType:"day",contentType:"digit",maxLength:2},dd:"day",do:{sectionType:"day",contentType:"digit-with-letter"},E:{sectionType:"weekDay",contentType:"letter"},EE:{sectionType:"weekDay",contentType:"letter"},EEE:{sectionType:"weekDay",contentType:"letter"},EEEE:{sectionType:"weekDay",contentType:"letter"},EEEEE:{sectionType:"weekDay",contentType:"letter"},i:{sectionType:"weekDay",contentType:"digit",maxLength:1},ii:"weekDay",iii:{sectionType:"weekDay",contentType:"letter"},iiii:{sectionType:"weekDay",contentType:"letter"},e:{sectionType:"weekDay",contentType:"digit",maxLength:1},ee:"weekDay",eee:{sectionType:"weekDay",contentType:"letter"},eeee:{sectionType:"weekDay",contentType:"letter"},eeeee:{sectionType:"weekDay",contentType:"letter"},eeeeee:{sectionType:"weekDay",contentType:"letter"},c:{sectionType:"weekDay",contentType:"digit",maxLength:1},cc:"weekDay",ccc:{sectionType:"weekDay",contentType:"letter"},cccc:{sectionType:"weekDay",contentType:"letter"},ccccc:{sectionType:"weekDay",contentType:"letter"},cccccc:{sectionType:"weekDay",contentType:"letter"},a:"meridiem",aa:"meridiem",aaa:"meridiem",H:{sectionType:"hours",contentType:"digit",maxLength:2},HH:"hours",h:{sectionType:"hours",contentType:"digit",maxLength:2},hh:"hours",m:{sectionType:"minutes",contentType:"digit",maxLength:2},mm:"minutes",s:{sectionType:"seconds",contentType:"digit",maxLength:2},ss:"seconds"},LT={year:"yyyy",month:"LLLL",monthShort:"MMM",dayOfMonth:"d",weekday:"EEEE",weekdayShort:"EEEEEE",hours24h:"HH",hours12h:"hh",meridiem:"aa",minutes:"mm",seconds:"ss",fullDate:"PP",fullDateWithWeekday:"PPPP",keyboardDate:"P",shortDate:"MMM d",normalDate:"d MMMM",normalDateWithWeekday:"EEE, MMM d",monthAndYear:"LLLL yyyy",monthAndDate:"MMMM d",fullTime:"p",fullTime12h:"hh:mm aa",fullTime24h:"HH:mm",fullDateTime:"PP p",fullDateTime12h:"PP hh:mm aa",fullDateTime24h:"PP HH:mm",keyboardDateTime:"P p",keyboardDateTime12h:"P hh:mm aa",keyboardDateTime24h:"P HH:mm"};class FT{constructor(e){this.isMUIAdapter=!0,this.isTimezoneCompatible=!1,this.lib="date-fns",this.locale=void 0,this.formats=void 0,this.formatTokenMap=NT,this.escapedCharacters={start:"'",end:"'"},this.longFormatters=void 0,this.date=e=>void 0===e?new Date:null===e?null:new Date(e),this.dateWithTimezone=e=>this.date(e),this.getTimezone=()=>"default",this.setTimezone=e=>e,this.toJsDate=e=>e,this.getCurrentLocaleCode=()=>{var e;return(null==(e=this.locale)?void 0:e.code)||"en-US"},this.is12HourCycleInCurrentLocale=()=>!this.locale||/a/.test(this.locale.formatLong.time({width:"short"})),this.expandFormat=e=>e.match(/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g).map(e=>{const t=e[0];return"p"===t||"P"===t?(0,this.longFormatters[t])(e,this.locale.formatLong):e}).join(""),this.getFormatHelperText=e=>this.expandFormat(e).replace(/(aaa|aa|a)/g,"(a|p)m").toLocaleLowerCase(),this.isNull=e=>null===e,this.formatNumber=e=>e,this.getMeridiemText=e=>"am"===e?"AM":"PM";const{locale:t,formats:n,longFormatters:r}=e;this.locale=t,this.formats=m({},LT,n),this.longFormatters=r}}class VT extends FT{constructor({locale:e,formats:t}={}){if("function"!=typeof wn)throw new Error(["MUI: The `date-fns` package v3.x is not compatible with this adapter.","Please, install v2.x of the package or use the `AdapterDateFnsV3` instead."].join("\n"));super({locale:null!=e?e:Sn,formats:t,longFormatters:OT}),this.parseISO=e=>kn(e),this.toISO=e=>Cn(e,{format:"extended"}),this.parse=(e,t)=>""===e?null:En(e,t,new Date,{locale:this.locale}),this.isValid=e=>In(this.date(e)),this.format=(e,t)=>this.formatByString(e,this.formats[t]),this.formatByString=(e,t)=>Dn(e,t,{locale:this.locale}),this.getDiff=(e,t,n)=>{switch(n){case"years":return Nn(e,this.date(t));case"quarters":return On(e,this.date(t));case"months":return Rn(e,this.date(t));case"weeks":return An(e,this.date(t));case"days":return Pn(e,this.date(t));case"hours":return Mn(e,this.date(t));case"minutes":return _n(e,this.date(t));case"seconds":return jn(e,this.date(t));default:return Tn(e,this.date(t))}},this.isEqual=(e,t)=>null===e&&null===t||Ln(e,t),this.isSameYear=(e,t)=>Fn(e,t),this.isSameMonth=(e,t)=>Vn(e,t),this.isSameDay=(e,t)=>Bn(e,t),this.isSameHour=(e,t)=>zn(e,t),this.isAfter=(e,t)=>Wn(e,t),this.isAfterYear=(e,t)=>Wn(e,Un(t)),this.isAfterDay=(e,t)=>Wn(e,Hn(t)),this.isBefore=(e,t)=>$n(e,t),this.isBeforeYear=(e,t)=>$n(e,qn(t)),this.isBeforeDay=(e,t)=>$n(e,Xn(t)),this.isWithinRange=(e,[t,n])=>Kn(e,{start:t,end:n}),this.startOfYear=e=>qn(e),this.startOfMonth=e=>Gn(e),this.startOfWeek=e=>Yn(e,{locale:this.locale}),this.startOfDay=e=>Xn(e),this.endOfYear=e=>Un(e),this.endOfMonth=e=>Qn(e),this.endOfWeek=e=>Jn(e,{locale:this.locale}),this.endOfDay=e=>Hn(e),this.addYears=(e,t)=>Zn(e,t),this.addMonths=(e,t)=>er(e,t),this.addWeeks=(e,t)=>tr(e,t),this.addDays=(e,t)=>wn(e,t),this.addHours=(e,t)=>nr(e,t),this.addMinutes=(e,t)=>rr(e,t),this.addSeconds=(e,t)=>ir(e,t),this.getYear=e=>sr(e),this.getMonth=e=>or(e),this.getDate=e=>ar(e),this.getHours=e=>lr(e),this.getMinutes=e=>cr(e),this.getSeconds=e=>ur(e),this.getMilliseconds=e=>hr(e),this.setYear=(e,t)=>dr(e,t),this.setMonth=(e,t)=>fr(e,t),this.setDate=(e,t)=>pr(e,t),this.setHours=(e,t)=>gr(e,t),this.setMinutes=(e,t)=>mr(e,t),this.setSeconds=(e,t)=>vr(e,t),this.setMilliseconds=(e,t)=>yr(e,t),this.getDaysInMonth=e=>xr(e),this.getNextMonth=e=>er(e,1),this.getPreviousMonth=e=>er(e,-1),this.getMonthArray=e=>{const t=[qn(e)];for(;t.length<12;){const e=t[t.length-1];t.push(this.getNextMonth(e))}return t},this.mergeDateAndTime=(e,t)=>this.setSeconds(this.setMinutes(this.setHours(e,this.getHours(t)),this.getMinutes(t)),this.getSeconds(t)),this.getWeekdays=()=>{const e=new Date;return br({start:Yn(e,{locale:this.locale}),end:Jn(e,{locale:this.locale})}).map(e=>this.formatByString(e,"EEEEEE"))},this.getWeekArray=e=>{const t=Yn(Gn(e),{locale:this.locale}),n=Jn(Qn(e),{locale:this.locale});let r=0,i=t;const s=[];for(;$n(i,n);){const e=Math.floor(r/7);s[e]=s[e]||[],s[e].push(i),i=wn(i,1),r+=1}return s},this.getWeekNumber=e=>wr(e,{locale:this.locale}),this.getYearRange=(e,t)=>{const n=qn(e),r=Un(t),i=[];let s=n;for(;$n(s,r);)i.push(s),s=Zn(s,1);return i}}}const BT=({open:t,onClose:n,editingTask:r})=>{const{user:i}=to(),[s,o]=on.useState(!1),[a,l]=on.useState(""),[c,d]=on.useState(new Date),[f,p]=on.useState({title:"",description:"",status:"todo",priority:"medium"}),m=Boolean(r);on.useEffect(()=>{r?(p({title:r.title,description:r.description,status:r.status,priority:r.priority}),d(new Date(r.dueDate))):(p({title:"",description:"",status:"todo",priority:"medium"}),d(new Date))},[r]);const v=t=>g(e,null,function*(){if(t.preventDefault(),o(!0),l(""),!i)return l("ユーザー情報が見つかりません"),void o(!1);if(!c)return l("期限日を設定してください"),void o(!1);try{const e=localStorage.getItem("currentWorkspace"),t=localStorage.getItem("currentProject"),s={id:m?r.id:Date.now().toString(),title:f.title,description:f.description,status:f.status,priority:f.priority,dueDate:c.toISOString().split("T")[0],assignee:i.name||"未設定",createdAt:m?r.createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),workspace:e||"個人プロジェクト",project:t||"個人プロジェクト"};m?yield FC(i.id,s.id,s):yield LC(i.id,s),mn.success(m?"タスクを更新しました":"タスクを作成しました"),n()}catch(e){console.error("タスク保存エラー:",e),l("タスクの保存に失敗しました"),mn.error("タスクの保存に失敗しました")}finally{o(!1)}});return y.jsxs(ge,{open:t,onClose:n,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:3,background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)"}},children:[y.jsxs(ze,{sx:{pb:1,background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",color:"white",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:2},children:[y.jsx(O,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)",width:40,height:40},children:y.jsx(We,{})}),y.jsx(E,{variant:"h6",sx:{fontWeight:600},children:m?"タスクを編集":"新しいタスクを作成"})]}),y.jsx(k,{onClick:n,sx:{color:"white"},children:y.jsx(Ue,{})})]}),y.jsxs(ve,{sx:{pt:3},children:[a&&y.jsx(He,{severity:"error",sx:{mb:2},children:a}),y.jsxs(I,{component:"form",onSubmit:v,children:[y.jsx(Fe,{fullWidth:!0,label:"タスク名",value:f.title,onChange:e=>p(h(u({},f),{title:e.target.value})),margin:"normal",required:!0,disabled:s,placeholder:"タスクのタイトルを入力...",sx:{mb:2}}),y.jsx(Fe,{fullWidth:!0,label:"説明",value:f.description,onChange:e=>p(h(u({},f),{description:e.target.value})),margin:"normal",multiline:!0,rows:3,disabled:s,placeholder:"タスクの詳細を入力...",sx:{mb:2}}),y.jsxs(I,{sx:{display:"flex",gap:2,mb:2},children:[y.jsxs($e,{fullWidth:!0,children:[y.jsx(qe,{children:"ステータス"}),y.jsxs(Xe,{value:f.status,label:"ステータス",onChange:e=>p(h(u({},f),{status:e.target.value})),disabled:s,startAdornment:y.jsx(I,{sx:{display:"flex",alignItems:"center",mr:1},children:y.jsx(Ke,{sx:{fontSize:18,color:(e=>{switch(e){case"todo":default:return"#64748b";case"inProgress":return"#6366f1";case"done":return"#10b981"}})(f.status)}})}),children:[y.jsx(L,{value:"todo",children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(I,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#64748b"}}),"未着手"]})}),y.jsx(L,{value:"inProgress",children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(I,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#6366f1"}}),"進行中"]})}),y.jsx(L,{value:"done",children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(I,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#10b981"}}),"完了"]})})]})]}),y.jsxs($e,{fullWidth:!0,children:[y.jsx(qe,{children:"優先度"}),y.jsxs(Xe,{value:f.priority,label:"優先度",onChange:e=>p(h(u({},f),{priority:e.target.value})),disabled:s,startAdornment:y.jsx(I,{sx:{display:"flex",alignItems:"center",mr:1},children:y.jsx(Ge,{sx:{fontSize:18,color:(e=>{switch(e){case"high":return"#ef4444";case"medium":return"#f59e0b";case"low":return"#10b981";default:return"#64748b"}})(f.priority)}})}),children:[y.jsx(L,{value:"low",children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(I,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#10b981"}}),"低"]})}),y.jsx(L,{value:"medium",children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(I,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#f59e0b"}}),"中"]})}),y.jsx(L,{value:"high",children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(I,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#ef4444"}}),"高"]})})]})]})]}),y.jsx(PE,{dateAdapter:VT,adapterLocale:$C,children:y.jsx(AT,{label:"期限日",value:c,onChange:e=>d(e),sx:{width:"100%"},disabled:s,slots:{openPickerIcon:ee}})}),y.jsxs(I,{sx:{mt:2,display:"flex",alignItems:"center",gap:1},children:[y.jsx(V,{sx:{fontSize:18,color:"text.secondary"}}),y.jsxs(E,{variant:"body2",color:"text.secondary",children:["担当者: ",(null==i?void 0:i.name)||"未設定"]})]})]})]}),y.jsxs(je,{sx:{p:3,pt:1},children:[y.jsx(Te,{onClick:n,variant:"outlined",disabled:s,sx:{minWidth:100},children:"キャンセル"}),y.jsx(Te,{type:"submit",variant:"contained",disabled:s||!f.title,onClick:v,sx:{minWidth:100,background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)","&:hover":{background:"linear-gradient(135deg, #4f46e5 0%, #3730a3 100%)"}},children:s?y.jsx(Ye,{size:20}):m?"更新":"作成"})]})]})},zT=()=>{const t=un(),n=fe(),{user:r}=to(),[i,s]=on.useState([]),[o,a]=on.useState(!0),[l,c]=on.useState(""),[f,p]=on.useState(null),[m,v]=on.useState(!1),[x,b]=on.useState("個人プロジェクト"),[w,S]=on.useState("個人プロジェクト"),[C,D]=on.useState(!1),[T,M]=on.useState(null);on.useEffect(()=>{if(!(null==r?void 0:r.id))return;const e=localStorage.getItem("currentProject"),t=localStorage.getItem("currentWorkspace");e&&(b(e),console.log("Dashboard: 保存されたプロジェクトを復元:",e)),t&&(S(t),console.log("Dashboard: 保存されたワークスペースを復元:",t));const n=NC(r.id,e=>{const t=localStorage.getItem("currentWorkspace"),n=localStorage.getItem("currentProject");let r=e;t?r=r.filter(e=>e.workspace===t||!e.workspace&&"個人プロジェクト"===t):n&&(r=r.filter(e=>e.project===n||!e.project&&"個人プロジェクト"===n)),s(r),a(!1)});return()=>n()},[null==r?void 0:r.id]),on.useEffect(()=>{const e=e=>{const{type:t,value:n}=e.detail;console.log("Dashboard: フィルタ変更を検知:",t,n),"project"===t?(b(n),S(null)):"workspace"===t&&(S(n),b(null));const i=localStorage.getItem(`tasks_${null==r?void 0:r.id}`);if(i){const e=JSON.parse(i),r="workspace"===t?e.filter(e=>e.workspace===n||!e.workspace&&"個人プロジェクト"===n):e.filter(e=>e.project===n||!e.project&&"個人プロジェクト"===n);s(r)}};return window.addEventListener("filterChanged",e),()=>{window.removeEventListener("filterChanged",e)}},[null==r?void 0:r.id]);const P=i,A=P.filter(e=>"todo"===e.status),R=P.filter(e=>"inProgress"===e.status),N=P.filter(e=>"done"===e.status),F=P.filter(e=>new Date(e.dueDate)<new Date&&"done"!==e.status),V=P.length>0?N.length/P.length*100:0,z=[{title:"総タスク数",value:P.length,change:0,icon:y.jsx(We,{}),color:"#6366f1",gradient:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)"},{title:"進行中",value:R.length,change:0,icon:y.jsx(Ke,{}),color:"#f59e0b",gradient:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)"},{title:"完了済み",value:N.length,change:0,icon:y.jsx(Qe,{}),color:"#10b981",gradient:"linear-gradient(135deg, #10b981 0%, #059669 100%)"},{title:"期限超過",value:F.length,change:0,icon:y.jsx(Je,{}),color:"#ef4444",gradient:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)"}],U=P.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()).slice(0,5),H=e=>{switch(e){case"high":return"#ef4444";case"medium":return"#f59e0b";case"low":return"#10b981";default:return"#64748b"}},$=e=>{switch(e){case"todo":default:return"#64748b";case"inProgress":return"#6366f1";case"done":return"#10b981"}};return o?y.jsx(I,{sx:{p:3,display:"flex",justifyContent:"center",alignItems:"center",minHeight:"calc(100vh - 120px)"},children:y.jsxs(I,{sx:{width:"100%",maxWidth:400},children:[y.jsx(Ze,{sx:{height:4,borderRadius:2}}),y.jsx(E,{variant:"body2",sx:{mt:2,textAlign:"center",color:"text.secondary"},children:"データを読み込み中..."})]})}):y.jsx(I,{sx:{p:{xs:2,md:4},backgroundColor:"background.default",minHeight:"calc(100vh - 120px)",maxWidth:"100%",background:`linear-gradient(135deg, ${Ae(n.palette.primary.main,.02)} 0%, ${Ae(n.palette.background.default,1)} 100%)`},children:y.jsxs(Cr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[y.jsx(I,{sx:{mb:4},children:y.jsx(Cr.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.1},children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",mb:2},children:[y.jsx(O,{sx:{bgcolor:"primary.main",mr:2,width:56,height:56,background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)"},children:y.jsx(J,{})}),y.jsxs(I,{children:[y.jsxs(E,{variant:"h3",sx:{fontWeight:800,mb:.5,color:"text.primary",background:"linear-gradient(135deg, #1a1a1a 0%, #4a5568 100%)",backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:["おかえりなさい、",(null==r?void 0:r.name)||"ユーザー","さん"]}),y.jsx(E,{variant:"body1",color:"text.secondary",sx:{fontWeight:500},children:Dn(new Date,"yyyy年M月d日 EEEE",{locale:$C})})]})]})})}),(x||w)&&y.jsx(Cr.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},children:y.jsx(Ce,{sx:{mb:4,p:3,background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",borderRadius:3,boxShadow:"0 8px 32px rgba(99, 102, 241, 0.2)"},children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center"},children:[y.jsx(O,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)",mr:2,width:40,height:40},children:"📁"}),y.jsxs(E,{variant:"h6",sx:{color:"white",fontWeight:600},children:[x||w," のタスクを表示中 (",P.length,"件)"]})]}),y.jsx(Te,{variant:"outlined",size:"small",onClick:()=>{c(""),localStorage.removeItem("currentProject"),localStorage.removeItem("currentWorkspace"),b("個人プロジェクト"),S("個人プロジェクト")},sx:{color:"white",borderColor:"rgba(255, 255, 255, 0.3)","&:hover":{borderColor:"white",backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:"フィルターをクリア"})]})})}),y.jsx(et,{container:!0,spacing:3,sx:{mb:4},children:z.map((e,n)=>y.jsx(et,{item:!0,xs:12,sm:6,md:3,children:y.jsx(Cr.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1*n},children:y.jsxs(Ce,{sx:{height:"100%",borderRadius:3,background:e.gradient,boxShadow:`0 8px 32px ${Ae(e.color,.3)}`,border:"1px solid rgba(255, 255, 255, 0.1)",cursor:"pointer","&:hover":{transform:"translateY(-4px)",boxShadow:`0 12px 40px ${Ae(e.color,.4)}`},transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",overflow:"hidden",position:"relative"},onClick:()=>{console.log("統計カードをクリックしました:",e.title),("総タスク数"===e.title||"進行中"===e.title||"完了済み"===e.title||"期限超過"===e.title)&&t("/kanban")},children:[y.jsx(I,{sx:{position:"absolute",top:0,right:0,width:100,height:100,background:"rgba(255, 255, 255, 0.1)",borderRadius:"50%",transform:"translate(30px, -30px)"}}),y.jsxs(tt,{sx:{p:3,position:"relative",zIndex:1},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center",mb:2},children:[y.jsx(O,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)",mr:2,width:56,height:56,backdropFilter:"blur(10px)"},children:e.icon}),y.jsxs(I,{sx:{flexGrow:1},children:[y.jsx(E,{variant:"h2",sx:{fontWeight:800,color:"white",textShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:e.value}),y.jsx(E,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.9)",fontWeight:600,fontSize:"0.875rem"},children:e.title})]})]}),0!==e.change&&y.jsxs(I,{sx:{display:"flex",alignItems:"center"},children:[e.change>0?y.jsx(nt,{sx:{color:"rgba(255, 255, 255, 0.9)",fontSize:18,mr:1}}):y.jsx(rt,{sx:{color:"rgba(255, 255, 255, 0.9)",fontSize:18,mr:1}}),y.jsxs(E,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.9)",fontWeight:600,fontSize:"0.875rem"},children:[Math.abs(e.change),"%"]})]})]})]})})},e.title))}),y.jsxs(et,{container:!0,spacing:4,children:[y.jsx(et,{item:!0,xs:12,md:8,children:y.jsx(Cr.div,{initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{duration:.5,delay:.4},children:y.jsx(Ce,{sx:{borderRadius:3,background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.08)",border:"1px solid rgba(226, 232, 240, 0.8)",overflow:"hidden"},children:y.jsxs(I,{sx:{p:4,background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",color:"white"},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center"},children:[y.jsx(O,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)",mr:2,width:48,height:48},children:y.jsx(it,{})}),y.jsx(E,{variant:"h5",sx:{fontWeight:700},children:"進捗状況"})]}),y.jsx(Te,{variant:"contained",startIcon:y.jsx(_,{}),onClick:()=>t("/task/new"),sx:{backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white",backdropFilter:"blur(10px)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.3)"}},children:"新しいタスク"})]}),y.jsxs(I,{sx:{mb:4},children:[y.jsxs(I,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[y.jsx(E,{variant:"body1",sx:{fontWeight:600,color:"rgba(255, 255, 255, 0.9)"},children:"完了率"}),y.jsxs(E,{variant:"h6",sx:{fontWeight:700,color:"white"},children:[V.toFixed(1),"%"]})]}),y.jsx(Ze,{variant:"determinate",value:V,sx:{height:12,borderRadius:6,backgroundColor:"rgba(255, 255, 255, 0.2)","& .MuiLinearProgress-bar":{borderRadius:6,background:"linear-gradient(90deg, #ffffff 0%, #f0f0f0 100%)"}}})]}),y.jsxs(et,{container:!0,spacing:3,children:[y.jsx(et,{item:!0,xs:4,children:y.jsxs(I,{sx:{textAlign:"center"},children:[y.jsx(E,{variant:"h2",sx:{fontWeight:800,color:"rgba(255, 255, 255, 0.9)",mb:1,textShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:A.length}),y.jsx(E,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.8)",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:"To Do"})]})}),y.jsx(et,{item:!0,xs:4,children:y.jsxs(I,{sx:{textAlign:"center"},children:[y.jsx(E,{variant:"h2",sx:{fontWeight:800,color:"white",mb:1,textShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:R.length}),y.jsx(E,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.8)",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:"In Progress"})]})}),y.jsx(et,{item:!0,xs:4,children:y.jsxs(I,{sx:{textAlign:"center"},children:[y.jsx(E,{variant:"h2",sx:{fontWeight:800,color:"rgba(255, 255, 255, 0.9)",mb:1,textShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:N.length}),y.jsx(E,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.8)",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Done"})]})})]})]})})})}),y.jsx(et,{item:!0,xs:12,md:4,children:y.jsx(Cr.div,{initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{duration:.5,delay:.5},children:y.jsxs(Ce,{sx:{borderRadius:3,background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.08)",border:"1px solid rgba(226, 232, 240, 0.8)",height:"100%",overflow:"hidden"},children:[y.jsx(I,{sx:{p:3,background:"linear-gradient(135deg, #1a1a1a 0%, #2d3748 100%)",color:"white"},children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",mb:3},children:[y.jsx(O,{sx:{bgcolor:"rgba(255, 255, 255, 0.1)",mr:2,width:40,height:40},children:y.jsx(te,{})}),y.jsx(E,{variant:"h6",sx:{fontWeight:700},children:"最近のタスク"})]})}),y.jsx(I,{sx:{p:3},children:y.jsx(K,{sx:{p:0},children:y.jsx(Er,{children:U.map((e,t)=>y.jsxs(Cr.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3,delay:.1*t},children:[y.jsxs(G,{sx:{px:0,py:1.5,borderRadius:2,mb:1,cursor:"pointer","&:hover":{backgroundColor:"rgba(99, 102, 241, 0.05)",transform:"translateX(4px)"},transition:"all 0.2s ease"},onClick:()=>{console.log("タスクをクリックしました:",e),M(e),D(!0)},children:[y.jsx(st,{children:y.jsx(O,{sx:{background:`linear-gradient(135deg, ${$(e.status)} 0%, ${Ae($(e.status),.8)} 100%)`,width:36,height:36,fontSize:"0.875rem",boxShadow:`0 4px 12px ${Ae($(e.status),.3)}`},children:y.jsx(We,{sx:{fontSize:16}})})}),y.jsx(B,{primary:y.jsx(E,{variant:"body2",sx:{fontWeight:600,lineHeight:1.4,color:"text.primary"},children:e.title}),secondary:y.jsxs(I,{sx:{display:"flex",alignItems:"center",mt:1},children:[y.jsx(_e,{label:"high"===e.priority?"高":"medium"===e.priority?"中":"低",size:"small",sx:{background:`linear-gradient(135deg, ${H(e.priority)} 0%, ${Ae(H(e.priority),.8)} 100%)`,color:"white",fontSize:"0.625rem",height:20,mr:1,fontWeight:600,"& .MuiChip-label":{px:1}}}),y.jsx(E,{variant:"caption",color:"text.secondary",sx:{fontWeight:500},children:Dn(new Date(e.createdAt),"M/d")})]})}),y.jsx(k,{size:"small",sx:{color:"text.secondary","&:hover":{color:"primary.main",backgroundColor:"rgba(99, 102, 241, 0.1)"}},children:y.jsx(ot,{sx:{fontSize:18}})})]}),t<U.length-1&&y.jsx(W,{sx:{my:1,opacity:.3}})]},e.id))})})})]})})})]}),y.jsx(j,{color:"primary","aria-label":"新しいタスク",onClick:()=>D(!0),sx:{position:"fixed",bottom:32,right:32,background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",boxShadow:"0 8px 32px rgba(99, 102, 241, 0.4)",width:64,height:64,"&:hover":{background:"linear-gradient(135deg, #4f46e5 0%, #3730a3 100%)",boxShadow:"0 12px 40px rgba(99, 102, 241, 0.6)",transform:"scale(1.05)"},transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:y.jsx(_,{sx:{fontSize:28}})}),y.jsxs(ge,{open:m,onClose:()=>v(!1),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:3,background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)"}},children:[y.jsx(ze,{sx:{background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",color:"white",borderRadius:"12px 12px 0 0",pb:2},children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:2},children:[y.jsx(O,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)",width:40,height:40},children:y.jsx(We,{})}),y.jsx(E,{variant:"h6",sx:{fontWeight:700},children:"タスクを編集"})]}),y.jsx(Te,{color:"error",onClick:()=>g(e,null,function*(){if(f&&(null==r?void 0:r.id))try{yield VC(r.id,f.id),mn.success("タスクを削除しました"),v(!1),p(null)}catch(e){console.error("タスクの削除に失敗しました:",e),mn.error("タスクの削除に失敗しました")}}),variant:"outlined",size:"small",sx:{color:"white",borderColor:"rgba(255, 255, 255, 0.3)","&:hover":{borderColor:"white",backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:"削除"})]})}),y.jsx(ve,{sx:{p:3},children:y.jsxs(et,{container:!0,spacing:3,children:[y.jsx(et,{item:!0,xs:12,children:y.jsx(Fe,{fullWidth:!0,label:"タイトル",value:(null==f?void 0:f.title)||"",onChange:e=>p(t=>t?h(u({},t),{title:e.target.value}):null),variant:"outlined",placeholder:"タスクのタイトルを入力...",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),y.jsx(et,{item:!0,xs:12,children:y.jsx(Fe,{fullWidth:!0,label:"説明",multiline:!0,rows:4,value:(null==f?void 0:f.description)||"",onChange:e=>p(t=>t?h(u({},t),{description:e.target.value}):null),variant:"outlined",placeholder:"タスクの詳細を入力...",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),y.jsx(et,{item:!0,xs:12,md:6,children:y.jsxs($e,{fullWidth:!0,children:[y.jsx(qe,{children:"ステータス"}),y.jsxs(Xe,{value:(null==f?void 0:f.status)||"todo",onChange:e=>p(t=>t?h(u({},t),{status:e.target.value}):null),label:"ステータス",sx:{borderRadius:2},children:[y.jsx(L,{value:"todo",children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(I,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#64748b"}}),"未着手"]})}),y.jsx(L,{value:"inProgress",children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(I,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#6366f1"}}),"進行中"]})}),y.jsx(L,{value:"done",children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(I,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#10b981"}}),"完了"]})})]})]})}),y.jsx(et,{item:!0,xs:12,md:6,children:y.jsxs($e,{fullWidth:!0,children:[y.jsx(qe,{children:"優先度"}),y.jsxs(Xe,{value:(null==f?void 0:f.priority)||"medium",onChange:e=>p(t=>t?h(u({},t),{priority:e.target.value}):null),label:"優先度",sx:{borderRadius:2},children:[y.jsx(L,{value:"low",children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(I,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#10b981"}}),"低優先度"]})}),y.jsx(L,{value:"medium",children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(I,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#f59e0b"}}),"中優先度"]})}),y.jsx(L,{value:"high",children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(I,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#ef4444"}}),"高優先度"]})})]})]})}),y.jsx(et,{item:!0,xs:12,md:6,children:y.jsx(Fe,{fullWidth:!0,label:"期限",type:"date",value:(null==f?void 0:f.dueDate)||"",onChange:e=>p(t=>t?h(u({},t),{dueDate:e.target.value}):null),InputLabelProps:{shrink:!0},variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),y.jsx(et,{item:!0,xs:12,md:6,children:y.jsx(Fe,{fullWidth:!0,label:"担当者",value:(null==f?void 0:f.assignee)||"",onChange:e=>p(t=>t?h(u({},t),{assignee:e.target.value}):null),placeholder:"担当者の名前を入力...",variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})})]})}),y.jsxs(je,{sx:{p:3,pt:0},children:[y.jsx(Te,{onClick:()=>v(!1),variant:"outlined",sx:{borderRadius:2,textTransform:"none",fontWeight:600},children:"キャンセル"}),y.jsx(Te,{variant:"contained",onClick:()=>g(e,null,function*(){if(f&&(null==r?void 0:r.id))try{const e=f,{id:t}=e,n=d(e,["id"]);yield FC(r.id,t,n),mn.success("タスクを更新しました"),v(!1),p(null)}catch(e){console.error("タスクの更新に失敗しました:",e),mn.error("タスクの更新に失敗しました")}}),disabled:!(null==f?void 0:f.title),sx:{borderRadius:2,textTransform:"none",fontWeight:600,background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)","&:hover":{background:"linear-gradient(135deg, #4f46e5 0%, #3730a3 100%)"}},children:"保存"})]})]}),y.jsx(BT,{open:C,onClose:()=>{D(!1),M(null)},editingTask:T})]})})},WT=()=>{const{user:t}=to(),[n,r]=on.useState([]),[i,s]=on.useState([]),[o,a]=on.useState(!1),[l,c]=on.useState(null),[d,f]=on.useState(!1),[p,m]=on.useState(!0),[v,x]=on.useState(!0),[b,w]=on.useState(!1),[S,C]=on.useState(1),[D,T]=on.useState(!0),[j,P]=on.useState(!0),[A,R]=on.useState(null),[N,L]=on.useState({x:0,y:0}),[F,V]=on.useState(!1),[B,z]=on.useState(""),W=on.useRef(null);on.useEffect(()=>{if(!(null==t?void 0:t.id))return;f(!0);const e=NC(t.id,e=>{const t=localStorage.getItem("currentWorkspace"),n=localStorage.getItem("currentProject");let i=e;t?i=i.filter(e=>e.workspace===t||!e.workspace&&"個人プロジェクト"===t):n&&(i=i.filter(e=>e.project===n||!e.project&&"個人プロジェクト"===n)),r(i),f(!1)});return()=>e()},[null==t?void 0:t.id]),on.useEffect(()=>{const e=e=>{const{type:n,value:i}=e.detail;console.log("KanbanBoard: フィルタ変更を検知:",n,i),"workspace"===n?(localStorage.setItem("currentWorkspace",i),localStorage.removeItem("currentProject")):"project"===n&&(localStorage.setItem("currentProject",i),localStorage.removeItem("currentWorkspace"));const s=localStorage.getItem(`tasks_${null==t?void 0:t.id}`);if(s){const e=JSON.parse(s),t="workspace"===n?e.filter(e=>e.workspace===i||!e.workspace&&"個人プロジェクト"===i):e.filter(e=>e.project===i||!e.project&&"個人プロジェクト"===i);r(t)}};window.addEventListener("filterChanged",e);const n=localStorage.getItem("currentWorkspace"),i=localStorage.getItem("currentProject"),s=localStorage.getItem(`tasks_${null==t?void 0:t.id}`);if(s){const e=JSON.parse(s);n?r(e.filter(e=>e.workspace===n||!e.workspace&&"個人プロジェクト"===n)):i&&r(e.filter(e=>e.project===i||!e.project&&"個人プロジェクト"===i))}return()=>{window.removeEventListener("filterChanged",e)}},[]),on.useEffect(()=>{U()},[n,null==t?void 0:t.id]);const U=()=>{const e=n.filter(e=>"todo"===e.status),t=n.filter(e=>"inProgress"===e.status),r=n.filter(e=>"done"===e.status);console.log("KanbanBoard: タスク更新",{todoTasks:e,inProgressTasks:t,doneTasks:r}),s([{id:"todo",title:"未着手",color:"#6366f1",tasks:e,maxTasks:10},{id:"inProgress",title:"進行中",color:"#f59e0b",tasks:t,maxTasks:8},{id:"done",title:"完了",color:"#10b981",tasks:r,maxTasks:15}])},H=e=>{switch(e){case"high":return"#ef4444";case"medium":return"#f59e0b";case"low":return"#10b981";default:return"#64748b"}},$=e=>{switch(e){case"high":return y.jsx(Ge,{sx:{fontSize:16,color:"#ef4444"}});case"medium":return y.jsx(Ge,{sx:{fontSize:16,color:"#f59e0b"}});case"low":return y.jsx(Ge,{sx:{fontSize:16,color:"#10b981"}});default:return y.jsx(Ge,{sx:{fontSize:16,color:"#64748b"}})}},q=e=>new Date(e)<new Date&&new Date(e).getTime()!==(new Date).setHours(0,0,0,0),X=e=>e.maxTasks?Math.min(e.tasks.length/e.maxTasks*100,100):0;return y.jsxs(I,{sx:{p:3,height:"calc(100vh - 120px)",overflow:"hidden"},children:[y.jsxs(I,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:2},children:[y.jsx(E,{variant:"h4",sx:{fontWeight:700,color:"text.primary"},children:"カンバンボード"}),d&&y.jsx(Ze,{sx:{width:100}})]}),y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:2},children:[y.jsx(at,{control:y.jsx(lt,{checked:p,onChange:e=>m(e.target.checked),size:"small"}),label:"ドラッグ"}),y.jsx(at,{control:y.jsx(lt,{checked:v,onChange:e=>x(e.target.checked),size:"small"}),label:"アニメーション"}),y.jsx(at,{control:y.jsx(lt,{checked:b,onChange:e=>w(e.target.checked),size:"small"}),label:"コンパクト"}),y.jsx(at,{control:y.jsx(lt,{checked:D,onChange:e=>T(e.target.checked),size:"small"}),label:"進捗"}),y.jsx(Te,{variant:"contained",startIcon:y.jsx(_,{}),onClick:()=>a(!0),sx:{background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)","&:hover":{background:"linear-gradient(135deg, #4f46e5 0%, #3730a3 100%)"}},children:"新しいタスク"})]})]}),A&&y.jsx(Cr.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},style:{position:"fixed",top:N.y,left:N.x,zIndex:9999,pointerEvents:"none"},children:y.jsx(ct,{sx:{minWidth:200,background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",color:"white",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)",borderRadius:2},children:y.jsx(tt,{sx:{p:2},children:y.jsx(E,{variant:"body2",sx:{fontWeight:600},children:A.title})})})}),y.jsx(Ir,{onDragStart:e=>{const t=n.find(t=>t.id===e.draggableId);t&&(R(t),mn.success(`${t.title}を移動中...`))},onDragUpdate:e=>{if(e.destination){const{destination:t}=e,n=i.find(e=>e.id===t.droppableId);n&&n.maxTasks&&n.tasks.length>=n.maxTasks&&mn.error(`${n.title}は最大${n.maxTasks}個までです`)}},onDragEnd:i=>g(e,null,function*(){if(R(null),!i.destination)return void mn.error("ドロップ先が見つかりません");const{source:e,destination:s,draggableId:o}=i,a=o;if(e.droppableId===s.droppableId&&e.index===s.index)return;const l=n.find(e=>e.id===a);if(!l)return;const c=s.droppableId;try{f(!0);const e=h(u({},l),{status:c}),i=n.map(t=>t.id===a?e:t);r(i),(null==t?void 0:t.id)&&(yield FC(t.id,a,{status:c}));const s={todo:"未着手",inProgress:"進行中",done:"完了"};z(`${l.title}を${s[c]}に移動しました`),V(!0)}catch(d){console.error("タスクの更新に失敗しました:",d),mn.error("タスクの移動に失敗しました"),U()}finally{f(!1)}}),children:y.jsx(I,{ref:W,sx:{display:"flex",gap:2,height:"calc(100% - 80px)",overflow:"auto"},children:i.map(e=>y.jsx(Cr.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3},style:{flex:1,minWidth:b?250:300,maxWidth:b?300:350},children:y.jsxs(Ce,{sx:{height:"100%",borderRadius:3,background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",border:"1px solid rgba(226, 232, 240, 0.8)",overflow:"hidden"},children:[y.jsxs(I,{sx:{p:2,background:`linear-gradient(135deg, ${e.color} 0%, ${e.color}dd 100%)`,color:"white",display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},onClick:()=>{return t=e.id,void s(e=>e.map(e=>e.id===t?h(u({},e),{isCollapsed:!e.isCollapsed}):e));var t},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(E,{variant:"h6",sx:{fontWeight:600},children:e.title}),y.jsx(M,{badgeContent:e.tasks.length,color:"primary",sx:{"& .MuiBadge-badge":{backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white",fontWeight:600}}})]}),y.jsx(k,{size:"small",sx:{color:"white"},children:e.isCollapsed?y.jsx(ut,{}):y.jsx(ht,{})})]}),D&&e.maxTasks&&y.jsxs(I,{sx:{p:1},children:[y.jsxs(I,{sx:{display:"flex",justifyContent:"space-between",mb:.5},children:[y.jsx(E,{variant:"caption",color:"text.secondary",children:"進捗"}),y.jsxs(E,{variant:"caption",color:"text.secondary",children:[e.tasks.length,"/",e.maxTasks]})]}),y.jsx(Ze,{variant:"determinate",value:X(e),sx:{height:4,borderRadius:2,backgroundColor:"rgba(0, 0, 0, 0.1)","& .MuiLinearProgress-bar":{backgroundColor:e.color}}})]}),!e.isCollapsed&&y.jsx(Dr,{droppableId:e.id,children:(t,n)=>y.jsxs(I,h(u({ref:t.innerRef},t.droppableProps),{sx:{p:2,height:`calc(100% - ${D?120:80}px)`,overflow:"auto",backgroundColor:n.isDraggingOver?"rgba(99, 102, 241, 0.05)":"transparent",transition:"background-color 0.2s ease"},children:[y.jsx(Er,{children:e.tasks.map((e,t)=>y.jsx(Tr,{draggableId:e.id,index:t,children:(t,n)=>{var r,i;return y.jsx("div",h(u({ref:t.innerRef},t.draggableProps),{style:h(u({},t.draggableProps.style),{transform:n.isDragging?`${null==(r=t.draggableProps.style)?void 0:r.transform} rotate(3deg)`:null==(i=t.draggableProps.style)?void 0:i.transform}),children:y.jsx(ct,h(u({},t.dragHandleProps),{sx:{mb:b?1:2,borderRadius:2,boxShadow:n.isDragging?"0 12px 40px rgba(0, 0, 0, 0.3)":"0 2px 8px rgba(0, 0, 0, 0.1)",cursor:"grab","&:active":{cursor:"grabbing"},"&:hover":{boxShadow:"0 4px 16px rgba(0, 0, 0, 0.15)"},transition:"all 0.2s ease",border:q(e.dueDate)?"2px solid #ef4444":"none"},children:y.jsxs(tt,{sx:{p:b?1.5:2},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",mb:1},children:[y.jsx(E,{variant:"body2",sx:{fontWeight:600,lineHeight:1.4,flex:1,mr:1,fontSize:b?"0.75rem":"0.875rem"},children:e.title}),y.jsx(k,{size:"small",onClick:()=>{c(e),a(!0)},sx:{color:"text.secondary"},children:y.jsx(dt,{sx:{fontSize:b?14:16}})})]}),!b&&e.description&&y.jsx(E,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:1,lineHeight:1.4},children:e.description}),y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[$(e.priority),y.jsx(_e,{label:"high"===e.priority?"高":"medium"===e.priority?"中":"低",size:"small",sx:{backgroundColor:H(e.priority),color:"white",fontSize:"0.625rem",height:20,fontWeight:600}})]}),y.jsxs(I,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(ee,{sx:{fontSize:14,color:"text.secondary"}}),y.jsx(E,{variant:"caption",color:q(e.dueDate)?"error.main":"text.secondary",sx:{fontWeight:q(e.dueDate)?600:400},children:Dn(new Date(e.dueDate),"M/d")})]}),y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:.5},children:[y.jsx(O,{sx:{width:20,height:20,fontSize:"0.625rem"},children:e.assignee.charAt(0)}),!b&&y.jsx(E,{variant:"caption",color:"text.secondary",children:e.assignee})]})]})]})}))}))}},e.id))}),t.placeholder]}))})]})},e.id))})}),y.jsx(ft,{open:F,autoHideDuration:3e3,onClose:()=>V(!1),message:B}),y.jsx(BT,{open:o,onClose:()=>{a(!1),c(null)},editingTask:l})]})};class UT extends Xr{getKeyInfo(){return{allDay:{},timed:{}}}getKeysForDateSpan(e){return e.allDay?["allDay"]:["timed"]}getKeysForEventDef(e){return e.allDay?Kr(e)?["timed","allDay"]:["allDay"]:["timed"]}}const HT=Lr({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"short"});function $T(e){let t=["fc-timegrid-slot","fc-timegrid-slot-label",e.isLabeled?"fc-scrollgrid-shrink":"fc-timegrid-slot-minor"];return _r(ri.Consumer,null,n=>{if(!e.isLabeled)return _r("td",{className:t.join(" "),"data-time":e.isoTimeStr});let{dateEnv:r,options:i,viewApi:s}=n,o=null==i.slotLabelFormat?HT:Array.isArray(i.slotLabelFormat)?Lr(i.slotLabelFormat[0]):Lr(i.slotLabelFormat),a={level:0,time:e.time,date:r.toDate(e.date),view:s,text:r.format(e.date,o)};return _r(Vr,{elTag:"td",elClasses:t,elAttrs:{"data-time":e.isoTimeStr},renderProps:a,generatorName:"slotLabelContent",customGenerator:i.slotLabelContent,defaultGenerator:qT,classNameGenerator:i.slotLabelClassNames,didMount:i.slotLabelDidMount,willUnmount:i.slotLabelWillUnmount},e=>_r("div",{className:"fc-timegrid-slot-label-frame fc-scrollgrid-shrink-frame"},_r(e,{elTag:"div",elClasses:["fc-timegrid-slot-label-cushion","fc-scrollgrid-shrink-cushion"]})))})}function qT(e){return e.text}class XT extends Gr{render(){return this.props.slatMetas.map(e=>_r("tr",{key:e.key},_r($T,Object.assign({},e))))}}const KT=Lr({week:"short"});class GT extends Ar{constructor(){super(...arguments),this.allDaySplitter=new UT,this.headerElRef=Rr(),this.rootElRef=Rr(),this.scrollerElRef=Rr(),this.state={slatCoords:null},this.handleScrollTopRequest=e=>{let t=this.scrollerElRef.current;t&&(t.scrollTop=e)},this.renderHeadAxis=(e,t="")=>{let{options:n}=this.context,{dateProfile:r}=this.props,i=r.renderRange,s=1===Or(i.start,i.end)?Nr(this.context,i.start,"week"):{};return n.weekNumbers&&"day"===e?_r(Fr,{elTag:"th",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},date:i.start,defaultFormat:KT},e=>_r("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame","fc-timegrid-axis-frame-liquid"].join(" "),style:{height:t}},_r(e,{elTag:"a",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"],elAttrs:s}))):_r("th",{"aria-hidden":!0,className:"fc-timegrid-axis"},_r("div",{className:"fc-timegrid-axis-frame",style:{height:t}}))},this.renderTableRowAxis=e=>{let{options:t,viewApi:n}=this.context,r={text:t.allDayText,view:n};return _r(Vr,{elTag:"td",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},renderProps:r,generatorName:"allDayContent",customGenerator:t.allDayContent,defaultGenerator:YT,classNameGenerator:t.allDayClassNames,didMount:t.allDayDidMount,willUnmount:t.allDayWillUnmount},t=>_r("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame",null==e?" fc-timegrid-axis-frame-liquid":""].join(" "),style:{height:e}},_r(t,{elTag:"span",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"]})))},this.handleSlatCoords=e=>{this.setState({slatCoords:e})}}renderSimpleLayout(e,t,n){let{context:r,props:i}=this,s=[],o=Br(r.options);return e&&s.push({type:"header",key:"header",isSticky:o,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),t&&(s.push({type:"body",key:"all-day",chunk:{content:t}}),s.push({type:"body",key:"all-day-divider",outerContent:_r("tr",{role:"presentation",className:"fc-scrollgrid-section"},_r("td",{className:"fc-timegrid-divider "+r.theme.getClass("tableCellShaded")}))})),s.push({type:"body",key:"body",liquid:!0,expandRows:Boolean(r.options.expandRows),chunk:{scrollerElRef:this.scrollerElRef,content:n}}),_r(Wr,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:r.viewSpec},_r(zr,{liquid:!i.isHeightAuto&&!i.forPrint,collapsibleWidth:i.forPrint,cols:[{width:"shrink"}],sections:s}))}renderHScrollLayout(e,t,n,r,i,s,o){let a=this.context.pluginHooks.scrollGridImpl;if(!a)throw new Error("No ScrollGrid implementation");let{context:l,props:c}=this,u=!c.forPrint&&Br(l.options),h=!c.forPrint&&Ur(l.options),d=[];e&&d.push({type:"header",key:"header",isSticky:u,syncRowHeights:!0,chunks:[{key:"axis",rowContent:e=>_r("tr",{role:"presentation"},this.renderHeadAxis("day",e.rowSyncHeights[0]))},{key:"cols",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),t&&(d.push({type:"body",key:"all-day",syncRowHeights:!0,chunks:[{key:"axis",rowContent:e=>_r("tr",{role:"presentation"},this.renderTableRowAxis(e.rowSyncHeights[0]))},{key:"cols",content:t}]}),d.push({key:"all-day-divider",type:"body",outerContent:_r("tr",{role:"presentation",className:"fc-scrollgrid-section"},_r("td",{colSpan:2,className:"fc-timegrid-divider "+l.theme.getClass("tableCellShaded")}))}));let f=l.options.nowIndicator;return d.push({type:"body",key:"body",liquid:!0,expandRows:Boolean(l.options.expandRows),chunks:[{key:"axis",content:e=>_r("div",{className:"fc-timegrid-axis-chunk"},_r("table",{"aria-hidden":!0,style:{height:e.expandRows?e.clientHeight:""}},e.tableColGroupNode,_r("tbody",null,_r(XT,{slatMetas:s}))),_r("div",{className:"fc-timegrid-now-indicator-container"},_r(Hr,{unit:f?"minute":"day"},e=>{let t=f&&o&&o.safeComputeTop(e);return"number"==typeof t?_r($r,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:t},isAxis:!0,date:e}):null})))},{key:"cols",scrollerElRef:this.scrollerElRef,content:n}]}),h&&d.push({key:"footer",type:"footer",isSticky:!0,chunks:[{key:"axis",content:qr},{key:"cols",content:qr}]}),_r(Wr,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:l.viewSpec},_r(a,{liquid:!c.isHeightAuto&&!c.forPrint,forPrint:c.forPrint,collapsibleWidth:!1,colGroups:[{width:"shrink",cols:[{width:"shrink"}]},{cols:[{span:r,minWidth:i}]}],sections:d}))}getAllDayMaxEventProps(){let{dayMaxEvents:e,dayMaxEventRows:t}=this.context.options;return!0!==e&&!0!==t||(e=void 0,t=5),{dayMaxEvents:e,dayMaxEventRows:t}}}function YT(e){return e.text}class QT{constructor(e,t,n){this.positions=e,this.dateProfile=t,this.slotDuration=n}safeComputeTop(e){let{dateProfile:t}=this;if(xi(t.currentRange,e)){let n=bi(e),r=e.valueOf()-n.valueOf();if(r>=Zr(t.slotMinTime)&&r<Zr(t.slotMaxTime))return this.computeTimeTop(Jr(r))}return null}computeDateTop(e,t){return t||(t=bi(e)),this.computeTimeTop(Jr(e.valueOf()-t.valueOf()))}computeTimeTop(e){let t,n,{positions:r,dateProfile:i}=this,s=r.els.length,o=(e.milliseconds-Zr(i.slotMinTime))/Zr(this.slotDuration);return o=Math.max(0,o),o=Math.min(s,o),t=Math.floor(o),t=Math.min(t,s-1),n=o-t,r.tops[t]+r.getHeight(t)*n}}class JT extends Gr{render(){let{props:e,context:t}=this,{options:n}=t,{slatElRefs:r}=e;return _r("tbody",null,e.slatMetas.map((i,s)=>{let o={time:i.time,date:t.dateEnv.toDate(i.date),view:t.viewApi};return _r("tr",{key:i.key,ref:r.createRef(i.key)},e.axis&&_r($T,Object.assign({},i)),_r(Vr,{elTag:"td",elClasses:["fc-timegrid-slot","fc-timegrid-slot-lane",!i.isLabeled&&"fc-timegrid-slot-minor"],elAttrs:{"data-time":i.isoTimeStr},renderProps:o,generatorName:"slotLaneContent",customGenerator:n.slotLaneContent,classNameGenerator:n.slotLaneClassNames,didMount:n.slotLaneDidMount,willUnmount:n.slotLaneWillUnmount}))}))}}class ZT extends Gr{constructor(){super(...arguments),this.rootElRef=Rr(),this.slatElRefs=new ai}render(){let{props:e,context:t}=this;return _r("div",{ref:this.rootElRef,className:"fc-timegrid-slots"},_r("table",{"aria-hidden":!0,className:t.theme.getClass("table"),style:{minWidth:e.tableMinWidth,width:e.clientWidth,height:e.minHeight}},e.tableColGroupNode,_r(JT,{slatElRefs:this.slatElRefs,axis:e.axis,slatMetas:e.slatMetas})))}componentDidMount(){this.updateSizing()}componentDidUpdate(){this.updateSizing()}componentWillUnmount(){this.props.onCoords&&this.props.onCoords(null)}updateSizing(){let{context:e,props:t}=this;var n;t.onCoords&&null!==t.clientWidth&&this.rootElRef.current.offsetHeight&&t.onCoords(new QT(new li(this.rootElRef.current,(n=this.slatElRefs.currentMap,t.slatMetas.map(e=>n[e.key])),!1,!0),this.props.dateProfile,e.options.slotDuration))}}function ej(e,t){let n,r=[];for(n=0;n<t;n+=1)r.push([]);if(e)for(n=0;n<e.length;n+=1)r[e[n].col].push(e[n]);return r}function tj(e,t){let n=[];if(e){for(let r=0;r<t;r+=1)n[r]={affectedInstances:e.affectedInstances,isEvent:e.isEvent,segs:[]};for(let t of e.segs)n[t.col].segs.push(t)}else for(let r=0;r<t;r+=1)n[r]=null;return n}class nj extends Gr{render(){let{props:e}=this;return _r(Si,{elClasses:["fc-timegrid-more-link"],elStyle:{top:e.top,bottom:e.bottom},allDayDate:null,moreCnt:e.hiddenSegs.length,allSegs:e.hiddenSegs,hiddenSegs:e.hiddenSegs,extraDateSpan:e.extraDateSpan,dateProfile:e.dateProfile,todayRange:e.todayRange,popoverContent:()=>fj(e.hiddenSegs,e),defaultGenerator:rj,forceTimed:!0},e=>_r(e,{elTag:"div",elClasses:["fc-timegrid-more-link-inner","fc-sticky"]}))}}function rj(e){return e.shortText}function ij(e,t,n){let r=new ki;null!=t&&(r.strictOrder=t),null!=n&&(r.maxStackCnt=n);let i=r.addSegs(e),s=Ci(i),o=function(e){const{entriesByLevel:t}=e,n=lj((e,t)=>e+":"+t,(r,i)=>{let s=function(e,t,n){let{levelCoords:r,entriesByLevel:i}=e,s=i[t][n],o=r[t]+s.thickness,a=r.length,l=t;for(;l<a&&r[l]<o;l+=1);for(;l<a;l+=1){let e,t=i[l],n=Di(t,s.span.start,Ti),r=n[0]+n[1],o=r;for(;(e=t[o])&&e.span.start<s.span.end;)o+=1;if(r<o)return{level:l,lateralStart:r,lateralEnd:o}}return null}(e,r,i),o=sj(s,n),a=t[r][i];return[Object.assign(Object.assign({},a),{nextLevelNodes:o[0]}),a.thickness+o[1]]});return sj(t.length?{level:0,lateralStart:0,lateralEnd:t[0].length}:null,n)[0]}(r);return o=function(e,t){const n=lj((e,t,n)=>Ei(e),(e,r,i)=>{let s,{nextLevelNodes:o,thickness:a}=e,l=a+i,c=a/l,u=[];if(o.length)for(let t of o)if(void 0===s){let e=n(t,r,l);s=e[0],u.push(e[1])}else{let e=n(t,s,0);u.push(e[1])}else s=t;let h=(s-r)*c;return[s-h,Object.assign(Object.assign({},e),{thickness:h,nextLevelNodes:u})]});return e.map(e=>n(e,0,0)[1])}(o,1),{segRects:function(e){let t=[];const n=lj((e,t,n)=>Ei(e),(e,n,i)=>{let s=Object.assign(Object.assign({},e),{levelCoord:n,stackDepth:i,stackForward:0});return t.push(s),s.stackForward=r(e.nextLevelNodes,n+e.thickness,i+1)+1});function r(e,t,r){let i=0;for(let s of e)i=Math.max(n(s,t,r),i);return i}return r(e,0,0),t}(o),hiddenGroups:s}}function sj(e,t){if(!e)return[[],0];let{level:n,lateralStart:r,lateralEnd:i}=e,s=r,o=[];for(;s<i;)o.push(t(n,s)),s+=1;return o.sort(oj),[o.map(aj),o[0][1]]}function oj(e,t){return t[1]-e[1]}function aj(e){return e[0]}function lj(e,t){const n={};return(...r)=>{let i=e(...r);return i in n?n[i]:n[i]=t(...r)}}function cj(e,t,n=null,r=0){let i=[];if(n)for(let s=0;s<e.length;s+=1){let o=e[s],a=n.computeDateTop(o.start,t),l=Math.max(a+(r||0),n.computeDateTop(o.end,t));i.push({start:Math.round(a),end:Math.round(l)})}return i}const uj=Lr({hour:"numeric",minute:"2-digit",meridiem:!1});class hj extends Gr{render(){return _r(wi,Object.assign({},this.props,{elClasses:["fc-timegrid-event","fc-v-event",this.props.isShort&&"fc-timegrid-event-short"],defaultTimeFormat:uj}))}}class dj extends Gr{constructor(){super(...arguments),this.sortEventSegs=jr(ci)}render(){let{props:e,context:t}=this,{options:n}=t,r=n.selectMirror,i=e.eventDrag&&e.eventDrag.segs||e.eventResize&&e.eventResize.segs||r&&e.dateSelectionSegs||[],s=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{},o=this.sortEventSegs(e.fgEventSegs,n.eventOrder);return _r(hi,{elTag:"td",elRef:e.elRef,elClasses:["fc-timegrid-col",...e.extraClassNames||[]],elAttrs:Object.assign({role:"gridcell"},e.extraDataAttrs),date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,extraRenderProps:e.extraRenderProps},t=>_r("div",{className:"fc-timegrid-col-frame"},_r("div",{className:"fc-timegrid-col-bg"},this.renderFillSegs(e.businessHourSegs,"non-business"),this.renderFillSegs(e.bgEventSegs,"bg-event"),this.renderFillSegs(e.dateSelectionSegs,"highlight")),_r("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(o,s,!1,!1,!1)),_r("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(i,{},Boolean(e.eventDrag),Boolean(e.eventResize),Boolean(r),"mirror")),_r("div",{className:"fc-timegrid-now-indicator-container"},this.renderNowIndicator(e.nowIndicatorSegs)),ui(n)&&_r(t,{elTag:"div",elClasses:["fc-timegrid-col-misc"]})))}renderFgSegs(e,t,n,r,i,s){let{props:o}=this;return o.forPrint?fj(e,o):this.renderPositionedFgSegs(e,t,n,r,i,s)}renderPositionedFgSegs(e,t,n,r,i,s){let{eventMaxStack:o,eventShortHeight:a,eventOrderStrict:l,eventMinHeight:c}=this.context.options,{date:u,slatCoords:h,eventSelection:d,todayRange:f,nowDate:p}=this.props,g=n||r||i,m=cj(e,u,h,c),{segPlacements:v,hiddenGroups:y}=function(e,t,n,r){let i=[],s=[];for(let c=0;c<e.length;c+=1){let n=t[c];n?i.push({index:c,thickness:1,span:n}):s.push(e[c])}let{segRects:o,hiddenGroups:a}=ij(i,n,r),l=[];for(let c of o)l.push({seg:e[c.index],rect:c});for(let c of s)l.push({seg:c,rect:null});return{segPlacements:l,hiddenGroups:a}}(e,m,l,o);return _r(fi,null,this.renderHiddenGroups(y,e),v.map(e=>{let{seg:o,rect:l}=e,c=o.eventRange.instance.instanceId,u=g||Boolean(!t[c]&&l),h=pj(l&&l.span),m=!g&&l?this.computeSegHStyle(l):{left:0,right:0},v=Boolean(l)&&l.stackForward>0,y=Boolean(l)&&l.span.end-l.span.start<a;return _r("div",{className:"fc-timegrid-event-harness"+(v?" fc-timegrid-event-harness-inset":""),key:s||c,style:Object.assign(Object.assign({visibility:u?"":"hidden"},h),m)},_r(hj,Object.assign({seg:o,isDragging:n,isResizing:r,isDateSelecting:i,isSelected:c===d,isShort:y},di(o,f,p))))}))}renderHiddenGroups(e,t){let{extraDateSpan:n,dateProfile:r,todayRange:i,nowDate:s,eventSelection:o,eventDrag:a,eventResize:l}=this.props;return _r(fi,null,e.map(e=>{let c=pj(e.span),u=(h=e.entries,d=t,h.map(e=>d[e.index]));var h,d;return _r(nj,{key:pi(gi(u)),hiddenSegs:u,top:c.top,bottom:c.bottom,extraDateSpan:n,dateProfile:r,todayRange:i,nowDate:s,eventSelection:o,eventDrag:a,eventResize:l})}))}renderFillSegs(e,t){let{props:n,context:r}=this,i=cj(e,n.date,n.slatCoords,r.options.eventMinHeight).map((r,i)=>{let s=e[i];return _r("div",{key:yi(s.eventRange),className:"fc-timegrid-bg-harness",style:pj(r)},"bg-event"===t?_r(vi,Object.assign({seg:s},di(s,n.todayRange,n.nowDate))):mi(t))});return _r(fi,null,i)}renderNowIndicator(e){let{slatCoords:t,date:n}=this.props;return t?e.map((e,r)=>_r($r,{key:r,elClasses:["fc-timegrid-now-indicator-line"],elStyle:{top:t.computeDateTop(e.start,n)},isAxis:!1,date:n})):null}computeSegHStyle(e){let t,n,{isRtl:r,options:i}=this.context,s=i.slotEventOverlap,o=e.levelCoord,a=e.levelCoord+e.thickness;s&&(a=Math.min(1,o+2*(a-o))),r?(t=1-a,n=o):(t=o,n=1-a);let l={zIndex:e.stackDepth+1,left:100*t+"%",right:100*n+"%"};return s&&!e.stackForward&&(l[r?"marginLeft":"marginRight"]=20),l}}function fj(e,{todayRange:t,nowDate:n,eventSelection:r,eventDrag:i,eventResize:s}){let o=(i?i.affectedInstances:null)||(s?s.affectedInstances:null)||{};return _r(fi,null,e.map(e=>{let i=e.eventRange.instance.instanceId;return _r("div",{key:i,style:{visibility:o[i]?"hidden":""}},_r(hj,Object.assign({seg:e,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:i===r,isShort:!1},di(e,t,n))))}))}function pj(e){return e?{top:e.start,bottom:-e.end}:{top:"",bottom:""}}class gj extends Gr{constructor(){super(...arguments),this.splitFgEventSegs=jr(ej),this.splitBgEventSegs=jr(ej),this.splitBusinessHourSegs=jr(ej),this.splitNowIndicatorSegs=jr(ej),this.splitDateSelectionSegs=jr(ej),this.splitEventDrag=jr(tj),this.splitEventResize=jr(tj),this.rootElRef=Rr(),this.cellElRefs=new ai}render(){let{props:e,context:t}=this,n=t.options.nowIndicator&&e.slatCoords&&e.slatCoords.safeComputeTop(e.nowDate),r=e.cells.length,i=this.splitFgEventSegs(e.fgEventSegs,r),s=this.splitBgEventSegs(e.bgEventSegs,r),o=this.splitBusinessHourSegs(e.businessHourSegs,r),a=this.splitNowIndicatorSegs(e.nowIndicatorSegs,r),l=this.splitDateSelectionSegs(e.dateSelectionSegs,r),c=this.splitEventDrag(e.eventDrag,r),u=this.splitEventResize(e.eventResize,r);return _r("div",{className:"fc-timegrid-cols",ref:this.rootElRef},_r("table",{role:"presentation",style:{minWidth:e.tableMinWidth,width:e.clientWidth}},e.tableColGroupNode,_r("tbody",{role:"presentation"},_r("tr",{role:"row"},e.axis&&_r("td",{"aria-hidden":!0,className:"fc-timegrid-col fc-timegrid-axis"},_r("div",{className:"fc-timegrid-col-frame"},_r("div",{className:"fc-timegrid-now-indicator-container"},"number"==typeof n&&_r($r,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:n},isAxis:!0,date:e.nowDate})))),e.cells.map((t,n)=>_r(dj,{key:t.key,elRef:this.cellElRefs.createRef(t.key),dateProfile:e.dateProfile,date:t.date,nowDate:e.nowDate,todayRange:e.todayRange,extraRenderProps:t.extraRenderProps,extraDataAttrs:t.extraDataAttrs,extraClassNames:t.extraClassNames,extraDateSpan:t.extraDateSpan,fgEventSegs:i[n],bgEventSegs:s[n],businessHourSegs:o[n],nowIndicatorSegs:a[n],dateSelectionSegs:l[n],eventDrag:c[n],eventResize:u[n],slatCoords:e.slatCoords,eventSelection:e.eventSelection,forPrint:e.forPrint}))))))}componentDidMount(){this.updateCoords()}componentDidUpdate(){this.updateCoords()}updateCoords(){let{props:e}=this;var t;e.onColCoords&&null!==e.clientWidth&&e.onColCoords(new li(this.rootElRef.current,(t=this.cellElRefs.currentMap,e.cells.map(e=>t[e.key])),!0,!1))}}class mj extends Ar{constructor(){super(...arguments),this.processSlotOptions=jr(vj),this.state={slatCoords:null},this.handleRootEl=e=>{e?this.context.registerInteractiveComponent(this,{el:e,isHitComboAllowed:this.props.isHitComboAllowed}):this.context.unregisterInteractiveComponent(this)},this.handleScrollRequest=e=>{let{onScrollTopRequest:t}=this.props,{slatCoords:n}=this.state;if(t&&n){if(e.time){let r=n.computeTimeTop(e.time);r=Math.ceil(r),r&&(r+=1),t(r)}return!0}return!1},this.handleColCoords=e=>{this.colCoords=e},this.handleSlatCoords=e=>{this.setState({slatCoords:e}),this.props.onSlatCoords&&this.props.onSlatCoords(e)}}render(){let{props:e,state:t}=this;return _r("div",{className:"fc-timegrid-body",ref:this.handleRootEl,style:{width:e.clientWidth,minWidth:e.tableMinWidth}},_r(ZT,{axis:e.axis,dateProfile:e.dateProfile,slatMetas:e.slatMetas,clientWidth:e.clientWidth,minHeight:e.expandRows?e.clientHeight:"",tableMinWidth:e.tableMinWidth,tableColGroupNode:e.axis?e.tableColGroupNode:null,onCoords:this.handleSlatCoords}),_r(gj,{cells:e.cells,axis:e.axis,dateProfile:e.dateProfile,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,todayRange:e.todayRange,nowDate:e.nowDate,nowIndicatorSegs:e.nowIndicatorSegs,clientWidth:e.clientWidth,tableMinWidth:e.tableMinWidth,tableColGroupNode:e.tableColGroupNode,slatCoords:t.slatCoords,onColCoords:this.handleColCoords,forPrint:e.forPrint}))}componentDidMount(){this.scrollResponder=this.context.createScrollResponder(this.handleScrollRequest)}componentDidUpdate(e){this.scrollResponder.update(e.dateProfile!==this.props.dateProfile)}componentWillUnmount(){this.scrollResponder.detach()}queryHit(e,t){let{dateEnv:n,options:r}=this.context,{colCoords:i}=this,{dateProfile:s}=this.props,{slatCoords:o}=this.state,{snapDuration:a,snapsPerSlot:l}=this.processSlotOptions(this.props.slotDuration,r.snapDuration),c=i.leftToIndex(e),u=o.positions.topToIndex(t);if(null!=c&&null!=u){let e=this.props.cells[c],r=o.positions.tops[u],h=o.positions.getHeight(u),d=(t-r)/h,f=u*l+Math.floor(d*l),p=this.props.cells[c].date,g=ni(s.slotMinTime,oi(a,f)),m=n.add(p,g),v=n.add(m,a);return{dateProfile:s,dateSpan:Object.assign({range:{start:m,end:v},allDay:!1},e.extraDateSpan),dayEl:i.els[c],rect:{left:i.lefts[c],right:i.rights[c],top:r,bottom:r+h},layer:0}}return null}}function vj(e,t){let n=t||e,r=ei(e,n);return null===r&&(n=e,r=1),{snapDuration:n,snapsPerSlot:r}}class yj extends ii{sliceRange(e,t){let n=[];for(let r=0;r<t.length;r+=1){let i=si(e,t[r]);i&&n.push({start:i.start,end:i.end,isStart:i.start.valueOf()===e.start.valueOf(),isEnd:i.end.valueOf()===e.end.valueOf(),col:r})}return n}}class xj extends Ar{constructor(){super(...arguments),this.buildDayRanges=jr(bj),this.slicer=new yj,this.timeColsRef=Rr()}render(){let{props:e,context:t}=this,{dateProfile:n,dayTableModel:r}=e,{nowIndicator:i,nextDayThreshold:s}=t.options,o=this.buildDayRanges(r,n,t.dateEnv);return _r(Hr,{unit:i?"minute":"day"},(a,l)=>_r(mj,Object.assign({ref:this.timeColsRef},this.slicer.sliceProps(e,n,null,t,o),{forPrint:e.forPrint,axis:e.axis,dateProfile:n,slatMetas:e.slatMetas,slotDuration:e.slotDuration,cells:r.cells[0],tableColGroupNode:e.tableColGroupNode,tableMinWidth:e.tableMinWidth,clientWidth:e.clientWidth,clientHeight:e.clientHeight,expandRows:e.expandRows,nowDate:a,nowIndicatorSegs:i&&this.slicer.sliceNowDate(a,n,s,t,o),todayRange:l,onScrollTopRequest:e.onScrollTopRequest,onSlatCoords:e.onSlatCoords})))}}function bj(e,t,n){let r=[];for(let i of e.headerDates)r.push({start:n.add(i,t.slotMinTime),end:n.add(i,t.slotMaxTime)});return r}const wj=[{hours:1},{minutes:30},{minutes:15},{seconds:30},{seconds:15}];function Sj(e,t,n,r,i){let s=new Date(0),o=e,a=Jr(0),l=n||function(e){let t,n,r;for(t=wj.length-1;t>=0;t-=1)if(n=Jr(wj[t]),r=ei(n,e),null!==r&&r>1)return n;return e}(r),c=[];for(;Zr(o)<Zr(t);){let e=i.add(s,o),t=null!==ei(a,l);c.push({date:e,time:o,key:e.toISOString(),isoTimeStr:ti(e),isLabeled:t}),o=ni(o,r),a=ni(a,r)}return c}function kj(e,t){let n=new Yr(e.renderRange,t);return new Qr(n,!1)}Ii('.fc-v-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-v-event .fc-event-main{color:var(--fc-event-text-color);height:100%}.fc-v-event .fc-event-main-frame{display:flex;flex-direction:column;height:100%}.fc-v-event .fc-event-time{flex-grow:0;flex-shrink:0;max-height:100%;overflow:hidden}.fc-v-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-height:0}.fc-v-event .fc-event-title{bottom:0;max-height:100%;overflow:hidden;top:0}.fc-v-event:not(.fc-event-start){border-top-left-radius:0;border-top-right-radius:0;border-top-width:0}.fc-v-event:not(.fc-event-end){border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom-width:0}.fc-v-event.fc-event-selected:before{left:-10px;right:-10px}.fc-v-event .fc-event-resizer-start{cursor:n-resize}.fc-v-event .fc-event-resizer-end{cursor:s-resize}.fc-v-event:not(.fc-event-selected) .fc-event-resizer{height:var(--fc-event-resizer-thickness);left:0;right:0}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-start{top:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer{left:50%;margin-left:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-start{top:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc .fc-timegrid .fc-daygrid-body{z-index:2}.fc .fc-timegrid-divider{padding:0 0 2px}.fc .fc-timegrid-body{min-height:100%;position:relative;z-index:1}.fc .fc-timegrid-axis-chunk{position:relative}.fc .fc-timegrid-axis-chunk>table,.fc .fc-timegrid-slots{position:relative;z-index:1}.fc .fc-timegrid-slot{border-bottom:0;height:1.5em}.fc .fc-timegrid-slot:empty:before{content:"\\00a0"}.fc .fc-timegrid-slot-minor{border-top-style:dotted}.fc .fc-timegrid-slot-label-cushion{display:inline-block;white-space:nowrap}.fc .fc-timegrid-slot-label{vertical-align:middle}.fc .fc-timegrid-axis-cushion,.fc .fc-timegrid-slot-label-cushion{padding:0 4px}.fc .fc-timegrid-axis-frame-liquid{height:100%}.fc .fc-timegrid-axis-frame{align-items:center;display:flex;justify-content:flex-end;overflow:hidden}.fc .fc-timegrid-axis-cushion{flex-shrink:0;max-width:60px}.fc-direction-ltr .fc-timegrid-slot-label-frame{text-align:right}.fc-direction-rtl .fc-timegrid-slot-label-frame{text-align:left}.fc-liquid-hack .fc-timegrid-axis-frame-liquid{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-timegrid-col-frame{min-height:100%;position:relative}.fc-media-screen.fc-liquid-hack .fc-timegrid-col-frame{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols{bottom:0;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols>table{height:100%}.fc-media-screen .fc-timegrid-col-bg,.fc-media-screen .fc-timegrid-col-events,.fc-media-screen .fc-timegrid-now-indicator-container{left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col-bg{z-index:2}.fc .fc-timegrid-col-bg .fc-non-business{z-index:1}.fc .fc-timegrid-col-bg .fc-bg-event{z-index:2}.fc .fc-timegrid-col-bg .fc-highlight{z-index:3}.fc .fc-timegrid-bg-harness{left:0;position:absolute;right:0}.fc .fc-timegrid-col-events{z-index:3}.fc .fc-timegrid-now-indicator-container{bottom:0;overflow:hidden}.fc-direction-ltr .fc-timegrid-col-events{margin:0 2.5% 0 2px}.fc-direction-rtl .fc-timegrid-col-events{margin:0 2px 0 2.5%}.fc-timegrid-event-harness{position:absolute}.fc-timegrid-event-harness>.fc-timegrid-event{bottom:0;left:0;position:absolute;right:0;top:0}.fc-timegrid-event-harness-inset .fc-timegrid-event,.fc-timegrid-event.fc-event-mirror,.fc-timegrid-more-link{box-shadow:0 0 0 1px var(--fc-page-bg-color)}.fc-timegrid-event,.fc-timegrid-more-link{border-radius:3px;font-size:var(--fc-small-font-size)}.fc-timegrid-event{margin-bottom:1px}.fc-timegrid-event .fc-event-main{padding:1px 1px 0}.fc-timegrid-event .fc-event-time{font-size:var(--fc-small-font-size);margin-bottom:1px;white-space:nowrap}.fc-timegrid-event-short .fc-event-main-frame{flex-direction:row;overflow:hidden}.fc-timegrid-event-short .fc-event-time:after{content:"\\00a0-\\00a0"}.fc-timegrid-event-short .fc-event-title{font-size:var(--fc-small-font-size)}.fc-timegrid-more-link{background:var(--fc-more-link-bg-color);color:var(--fc-more-link-text-color);cursor:pointer;margin-bottom:1px;position:absolute;z-index:9999}.fc-timegrid-more-link-inner{padding:3px 2px;top:0}.fc-direction-ltr .fc-timegrid-more-link{right:0}.fc-direction-rtl .fc-timegrid-more-link{left:0}.fc .fc-timegrid-now-indicator-arrow,.fc .fc-timegrid-now-indicator-line{pointer-events:none}.fc .fc-timegrid-now-indicator-line{border-color:var(--fc-now-indicator-color);border-style:solid;border-width:1px 0 0;left:0;position:absolute;right:0;z-index:4}.fc .fc-timegrid-now-indicator-arrow{border-color:var(--fc-now-indicator-color);border-style:solid;margin-top:-5px;position:absolute;z-index:4}.fc-direction-ltr .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 0 5px 6px;left:0}.fc-direction-rtl .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 6px 5px 0;right:0}');const Cj={allDaySlot:Boolean};var Ej=ji({name:"@fullcalendar/timegrid",initialView:"timeGridWeek",optionRefiners:Cj,views:{timeGrid:{component:class extends GT{constructor(){super(...arguments),this.buildTimeColsModel=jr(kj),this.buildSlatMetas=jr(Sj)}render(){let{options:e,dateEnv:t,dateProfileGenerator:n}=this.context,{props:r}=this,{dateProfile:i}=r,s=this.buildTimeColsModel(i,n),o=this.allDaySplitter.splitProps(r),a=this.buildSlatMetas(i.slotMinTime,i.slotMaxTime,e.slotLabelInterval,e.slotDuration,t),{dayMinWidth:l}=e,c=!l,u=l,h=e.dayHeaders&&_r(Mr,{dates:s.headerDates,dateProfile:i,datesRepDistinctDays:!0,renderIntro:c?this.renderHeadAxis:null}),d=!1!==e.allDaySlot&&(t=>_r(Pr,Object.assign({},o.allDay,{dateProfile:i,dayTableModel:s,nextDayThreshold:e.nextDayThreshold,tableMinWidth:t.tableMinWidth,colGroupNode:t.tableColGroupNode,renderRowIntro:c?this.renderTableRowAxis:null,showWeekNumbers:!1,expandRows:!1,headerAlignElRef:this.headerElRef,clientWidth:t.clientWidth,clientHeight:t.clientHeight,forPrint:r.forPrint},this.getAllDayMaxEventProps()))),f=t=>_r(xj,Object.assign({},o.timed,{dayTableModel:s,dateProfile:i,axis:c,slotDuration:e.slotDuration,slatMetas:a,forPrint:r.forPrint,tableColGroupNode:t.tableColGroupNode,tableMinWidth:t.tableMinWidth,clientWidth:t.clientWidth,clientHeight:t.clientHeight,onSlatCoords:this.handleSlatCoords,expandRows:t.expandRows,onScrollTopRequest:this.handleScrollTopRequest}));return u?this.renderHScrollLayout(h,d,f,s.colCnt,l,a,this.state.slatCoords):this.renderSimpleLayout(h,d,f)}},usesMinMaxTime:!0,allDaySlot:!0,slotDuration:"00:30:00",slotEventOverlap:!0},timeGridDay:{type:"timeGrid",duration:{days:1}},timeGridWeek:{type:"timeGrid",duration:{weeks:1}}}});hs.touchMouseIgnoreWait=500;let Ij=0,Dj=0,Tj=!1;class jj{constructor(e){this.subjectEl=null,this.selector="",this.handleSelector="",this.shouldIgnoreMove=!1,this.shouldWatchScroll=!0,this.isDragging=!1,this.isTouchDragging=!1,this.wasTouchScroll=!1,this.handleMouseDown=e=>{if(!this.shouldIgnoreMouse()&&function(e){return 0===e.button&&!e.ctrlKey}(e)&&this.tryStart(e)){let t=this.createEventFromMouse(e,!0);this.emitter.trigger("pointerdown",t),this.initScrollWatch(t),this.shouldIgnoreMove||document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}},this.handleMouseMove=e=>{let t=this.createEventFromMouse(e);this.recordCoords(t),this.emitter.trigger("pointermove",t)},this.handleMouseUp=e=>{document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.emitter.trigger("pointerup",this.createEventFromMouse(e)),this.cleanup()},this.handleTouchStart=e=>{if(this.tryStart(e)){this.isTouchDragging=!0;let t=this.createEventFromTouch(e,!0);this.emitter.trigger("pointerdown",t),this.initScrollWatch(t);let n=e.target;this.shouldIgnoreMove||n.addEventListener("touchmove",this.handleTouchMove),n.addEventListener("touchend",this.handleTouchEnd),n.addEventListener("touchcancel",this.handleTouchEnd),window.addEventListener("scroll",this.handleTouchScroll,!0)}},this.handleTouchMove=e=>{let t=this.createEventFromTouch(e);this.recordCoords(t),this.emitter.trigger("pointermove",t)},this.handleTouchEnd=e=>{if(this.isDragging){let t=e.target;t.removeEventListener("touchmove",this.handleTouchMove),t.removeEventListener("touchend",this.handleTouchEnd),t.removeEventListener("touchcancel",this.handleTouchEnd),window.removeEventListener("scroll",this.handleTouchScroll,!0),this.emitter.trigger("pointerup",this.createEventFromTouch(e)),this.cleanup(),this.isTouchDragging=!1,Ij+=1,setTimeout(()=>{Ij-=1},hs.touchMouseIgnoreWait)}},this.handleTouchScroll=()=>{this.wasTouchScroll=!0},this.handleScroll=e=>{if(!this.shouldIgnoreMove){let t=window.scrollX-this.prevScrollX+this.prevPageX,n=window.scrollY-this.prevScrollY+this.prevPageY;this.emitter.trigger("pointermove",{origEvent:e,isTouch:this.isTouchDragging,subjectEl:this.subjectEl,pageX:t,pageY:n,deltaX:t-this.origPageX,deltaY:n-this.origPageY})}},this.containerEl=e,this.emitter=new Ji,e.addEventListener("mousedown",this.handleMouseDown),e.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),Dj+=1,1===Dj&&window.addEventListener("touchmove",_j,{passive:!1})}destroy(){this.containerEl.removeEventListener("mousedown",this.handleMouseDown),this.containerEl.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),Dj-=1,Dj||window.removeEventListener("touchmove",_j,{passive:!1})}tryStart(e){let t=this.querySubjectEl(e),n=e.target;return!(!t||this.handleSelector&&!Li(n,this.handleSelector)||(this.subjectEl=t,this.isDragging=!0,this.wasTouchScroll=!1,0))}cleanup(){Tj=!1,this.isDragging=!1,this.subjectEl=null,this.destroyScrollWatch()}querySubjectEl(e){return this.selector?Li(e.target,this.selector):this.containerEl}shouldIgnoreMouse(){return Ij||this.isTouchDragging}cancelTouchScroll(){this.isDragging&&(Tj=!0)}initScrollWatch(e){this.shouldWatchScroll&&(this.recordCoords(e),window.addEventListener("scroll",this.handleScroll,!0))}recordCoords(e){this.shouldWatchScroll&&(this.prevPageX=e.pageX,this.prevPageY=e.pageY,this.prevScrollX=window.scrollX,this.prevScrollY=window.scrollY)}destroyScrollWatch(){this.shouldWatchScroll&&window.removeEventListener("scroll",this.handleScroll,!0)}createEventFromMouse(e,t){let n=0,r=0;return t?(this.origPageX=e.pageX,this.origPageY=e.pageY):(n=e.pageX-this.origPageX,r=e.pageY-this.origPageY),{origEvent:e,isTouch:!1,subjectEl:this.subjectEl,pageX:e.pageX,pageY:e.pageY,deltaX:n,deltaY:r}}createEventFromTouch(e,t){let n,r,i=e.touches,s=0,o=0;return i&&i.length?(n=i[0].pageX,r=i[0].pageY):(n=e.pageX,r=e.pageY),t?(this.origPageX=n,this.origPageY=r):(s=n-this.origPageX,o=r-this.origPageY),{origEvent:e,isTouch:!0,subjectEl:this.subjectEl,pageX:n,pageY:r,deltaX:s,deltaY:o}}}function _j(e){Tj&&e.preventDefault()}class Mj{constructor(){this.isVisible=!1,this.sourceEl=null,this.mirrorEl=null,this.sourceElRect=null,this.parentNode=document.body,this.zIndex=9999,this.revertDuration=0}start(e,t,n){this.sourceEl=e,this.sourceElRect=this.sourceEl.getBoundingClientRect(),this.origScreenX=t-window.scrollX,this.origScreenY=n-window.scrollY,this.deltaX=0,this.deltaY=0,this.updateElPosition()}handleMove(e,t){this.deltaX=e-window.scrollX-this.origScreenX,this.deltaY=t-window.scrollY-this.origScreenY,this.updateElPosition()}setIsVisible(e){e?this.isVisible||(this.mirrorEl&&(this.mirrorEl.style.display=""),this.isVisible=e,this.updateElPosition()):this.isVisible&&(this.mirrorEl&&(this.mirrorEl.style.display="none"),this.isVisible=e)}stop(e,t){let n=()=>{this.cleanup(),t()};e&&this.mirrorEl&&this.isVisible&&this.revertDuration&&(this.deltaX||this.deltaY)?this.doRevertAnimation(n,this.revertDuration):setTimeout(n,0)}doRevertAnimation(e,t){let n=this.mirrorEl,r=this.sourceEl.getBoundingClientRect();n.style.transition="top "+t+"ms,left "+t+"ms",Zi(n,{left:r.left,top:r.top}),es(n,()=>{n.style.transition="",e()})}cleanup(){this.mirrorEl&&(ts(this.mirrorEl),this.mirrorEl=null),this.sourceEl=null}updateElPosition(){this.sourceEl&&this.isVisible&&Zi(this.getMirrorEl(),{left:this.sourceElRect.left+this.deltaX,top:this.sourceElRect.top+this.deltaY})}getMirrorEl(){let e=this.sourceElRect,t=this.mirrorEl;return t||(t=this.mirrorEl=this.sourceEl.cloneNode(!0),t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.pointerEvents="none",t.classList.add("fc-event-dragging"),Zi(t,{position:"fixed",zIndex:this.zIndex,visibility:"",boxSizing:"border-box",width:e.right-e.left,height:e.bottom-e.top,right:"auto",bottom:"auto",margin:0}),this.parentNode.appendChild(t)),t}}class Pj extends gs{constructor(e,t){super(),this.handleScroll=()=>{this.scrollTop=this.scrollController.getScrollTop(),this.scrollLeft=this.scrollController.getScrollLeft(),this.handleScrollChange()},this.scrollController=e,this.doesListening=t,this.scrollTop=this.origScrollTop=e.getScrollTop(),this.scrollLeft=this.origScrollLeft=e.getScrollLeft(),this.scrollWidth=e.getScrollWidth(),this.scrollHeight=e.getScrollHeight(),this.clientWidth=e.getClientWidth(),this.clientHeight=e.getClientHeight(),this.clientRect=this.computeClientRect(),this.doesListening&&this.getEventTarget().addEventListener("scroll",this.handleScroll)}destroy(){this.doesListening&&this.getEventTarget().removeEventListener("scroll",this.handleScroll)}getScrollTop(){return this.scrollTop}getScrollLeft(){return this.scrollLeft}setScrollTop(e){this.scrollController.setScrollTop(e),this.doesListening||(this.scrollTop=Math.max(Math.min(e,this.getMaxScrollTop()),0),this.handleScrollChange())}setScrollLeft(e){this.scrollController.setScrollLeft(e),this.doesListening||(this.scrollLeft=Math.max(Math.min(e,this.getMaxScrollLeft()),0),this.handleScrollChange())}getClientWidth(){return this.clientWidth}getClientHeight(){return this.clientHeight}getScrollWidth(){return this.scrollWidth}getScrollHeight(){return this.scrollHeight}handleScrollChange(){}}class Aj extends Pj{constructor(e,t){super(new fs(e),t)}getEventTarget(){return this.scrollController.el}computeClientRect(){return ps(this.scrollController.el)}}class Rj extends Pj{constructor(e){super(new ds,e)}getEventTarget(){return window}computeClientRect(){return{left:this.scrollLeft,right:this.scrollLeft+this.clientWidth,top:this.scrollTop,bottom:this.scrollTop+this.clientHeight}}handleScrollChange(){this.clientRect=this.computeClientRect()}}const Oj="function"==typeof performance?performance.now:Date.now;class Nj{constructor(){this.isEnabled=!0,this.scrollQuery=[window,".fc-scroller"],this.edgeThreshold=50,this.maxVelocity=300,this.pointerScreenX=null,this.pointerScreenY=null,this.isAnimating=!1,this.scrollCaches=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.animate=()=>{if(this.isAnimating){let e=this.computeBestEdge(this.pointerScreenX+window.scrollX,this.pointerScreenY+window.scrollY);if(e){let t=Oj();this.handleSide(e,(t-this.msSinceRequest)/1e3),this.requestAnimation(t)}else this.isAnimating=!1}}}start(e,t,n){this.isEnabled&&(this.scrollCaches=this.buildCaches(n),this.pointerScreenX=null,this.pointerScreenY=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.handleMove(e,t))}handleMove(e,t){if(this.isEnabled){let n=e-window.scrollX,r=t-window.scrollY,i=null===this.pointerScreenY?0:r-this.pointerScreenY,s=null===this.pointerScreenX?0:n-this.pointerScreenX;i<0?this.everMovedUp=!0:i>0&&(this.everMovedDown=!0),s<0?this.everMovedLeft=!0:s>0&&(this.everMovedRight=!0),this.pointerScreenX=n,this.pointerScreenY=r,this.isAnimating||(this.isAnimating=!0,this.requestAnimation(Oj()))}}stop(){if(this.isEnabled){this.isAnimating=!1;for(let e of this.scrollCaches)e.destroy();this.scrollCaches=null}}requestAnimation(e){this.msSinceRequest=e,requestAnimationFrame(this.animate)}handleSide(e,t){let{scrollCache:n}=e,{edgeThreshold:r}=this,i=r-e.distance,s=i*i/(r*r)*this.maxVelocity*t,o=1;switch(e.name){case"left":o=-1;case"right":n.setScrollLeft(n.getScrollLeft()+s*o);break;case"top":o=-1;case"bottom":n.setScrollTop(n.getScrollTop()+s*o)}}computeBestEdge(e,t){let{edgeThreshold:n}=this,r=null,i=this.scrollCaches||[];for(let s of i){let i=s.clientRect,o=e-i.left,a=i.right-e,l=t-i.top,c=i.bottom-t;o>=0&&a>=0&&l>=0&&c>=0&&(l<=n&&this.everMovedUp&&s.canScrollUp()&&(!r||r.distance>l)&&(r={scrollCache:s,name:"top",distance:l}),c<=n&&this.everMovedDown&&s.canScrollDown()&&(!r||r.distance>c)&&(r={scrollCache:s,name:"bottom",distance:c}),o<=n&&this.everMovedLeft&&s.canScrollLeft()&&(!r||r.distance>o)&&(r={scrollCache:s,name:"left",distance:o}),a<=n&&this.everMovedRight&&s.canScrollRight()&&(!r||r.distance>a)&&(r={scrollCache:s,name:"right",distance:a}))}return r}buildCaches(e){return this.queryScrollEls(e).map(e=>e===window?new Rj(!1):new Aj(e,!1))}queryScrollEls(e){let t=[];for(let n of this.scrollQuery)"object"==typeof n?t.push(n):t.push(...Array.prototype.slice.call(e.getRootNode().querySelectorAll(n)));return t}}class Lj extends Mi{constructor(e,t){super(e),this.containerEl=e,this.delay=null,this.minDistance=0,this.touchScrollAllowed=!0,this.mirrorNeedsRevert=!1,this.isInteracting=!1,this.isDragging=!1,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,this.delayTimeoutId=null,this.onPointerDown=e=>{this.isDragging||(this.isInteracting=!0,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,Pi(document.body),Ai(document.body),e.isTouch||e.origEvent.preventDefault(),this.emitter.trigger("pointerdown",e),this.isInteracting&&!this.pointer.shouldIgnoreMove&&(this.mirror.setIsVisible(!1),this.mirror.start(e.subjectEl,e.pageX,e.pageY),this.startDelay(e),this.minDistance||this.handleDistanceSurpassed(e)))},this.onPointerMove=e=>{if(this.isInteracting){if(this.emitter.trigger("pointermove",e),!this.isDistanceSurpassed){let t,n=this.minDistance,{deltaX:r,deltaY:i}=e;t=r*r+i*i,t>=n*n&&this.handleDistanceSurpassed(e)}this.isDragging&&("scroll"!==e.origEvent.type&&(this.mirror.handleMove(e.pageX,e.pageY),this.autoScroller.handleMove(e.pageX,e.pageY)),this.emitter.trigger("dragmove",e))}},this.onPointerUp=e=>{this.isInteracting&&(this.isInteracting=!1,Ri(document.body),Oi(document.body),this.emitter.trigger("pointerup",e),this.isDragging&&(this.autoScroller.stop(),this.tryStopDrag(e)),this.delayTimeoutId&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=null))};let n=this.pointer=new jj(e);n.emitter.on("pointerdown",this.onPointerDown),n.emitter.on("pointermove",this.onPointerMove),n.emitter.on("pointerup",this.onPointerUp),t&&(n.selector=t),this.mirror=new Mj,this.autoScroller=new Nj}destroy(){this.pointer.destroy(),this.onPointerUp({})}startDelay(e){"number"==typeof this.delay?this.delayTimeoutId=setTimeout(()=>{this.delayTimeoutId=null,this.handleDelayEnd(e)},this.delay):this.handleDelayEnd(e)}handleDelayEnd(e){this.isDelayEnded=!0,this.tryStartDrag(e)}handleDistanceSurpassed(e){this.isDistanceSurpassed=!0,this.tryStartDrag(e)}tryStartDrag(e){this.isDelayEnded&&this.isDistanceSurpassed&&(this.pointer.wasTouchScroll&&!this.touchScrollAllowed||(this.isDragging=!0,this.mirrorNeedsRevert=!1,this.autoScroller.start(e.pageX,e.pageY,this.containerEl),this.emitter.trigger("dragstart",e),!1===this.touchScrollAllowed&&this.pointer.cancelTouchScroll()))}tryStopDrag(e){this.mirror.stop(this.mirrorNeedsRevert,this.stopDrag.bind(this,e))}stopDrag(e){this.isDragging=!1,this.emitter.trigger("dragend",e)}setIgnoreMove(e){this.pointer.shouldIgnoreMove=e}setMirrorIsVisible(e){this.mirror.setIsVisible(e)}setMirrorNeedsRevert(e){this.mirrorNeedsRevert=e}setAutoScrollEnabled(e){this.autoScroller.isEnabled=e}}class Fj{constructor(e){this.el=e,this.origRect=rs(e),this.scrollCaches=ms(e).map(e=>new Aj(e,!0))}destroy(){for(let e of this.scrollCaches)e.destroy()}computeLeft(){let e=this.origRect.left;for(let t of this.scrollCaches)e+=t.origScrollLeft-t.getScrollLeft();return e}computeTop(){let e=this.origRect.top;for(let t of this.scrollCaches)e+=t.origScrollTop-t.getScrollTop();return e}isWithinClipping(e,t){let n={left:e,top:t};for(let r of this.scrollCaches)if(!Vj(r.getEventTarget())&&!vs(n,r.clientRect))return!1;return!0}}function Vj(e){let t=e.tagName;return"HTML"===t||"BODY"===t}class Bj{constructor(e,t){this.useSubjectCenter=!1,this.requireInitial=!0,this.disablePointCheck=!1,this.initialHit=null,this.movingHit=null,this.finalHit=null,this.handlePointerDown=e=>{let{dragging:t}=this;this.initialHit=null,this.movingHit=null,this.finalHit=null,this.prepareHits(),this.processFirstCoord(e),this.initialHit||!this.requireInitial?(t.setIgnoreMove(!1),this.emitter.trigger("pointerdown",e)):t.setIgnoreMove(!0)},this.handleDragStart=e=>{this.emitter.trigger("dragstart",e),this.handleMove(e,!0)},this.handleDragMove=e=>{this.emitter.trigger("dragmove",e),this.handleMove(e)},this.handlePointerUp=e=>{this.releaseHits(),this.emitter.trigger("pointerup",e)},this.handleDragEnd=e=>{this.movingHit&&this.emitter.trigger("hitupdate",null,!0,e),this.finalHit=this.movingHit,this.movingHit=null,this.emitter.trigger("dragend",e)},this.droppableStore=t,e.emitter.on("pointerdown",this.handlePointerDown),e.emitter.on("dragstart",this.handleDragStart),e.emitter.on("dragmove",this.handleDragMove),e.emitter.on("pointerup",this.handlePointerUp),e.emitter.on("dragend",this.handleDragEnd),this.dragging=e,this.emitter=new Ji}processFirstCoord(e){let t,n={left:e.pageX,top:e.pageY},r=n,i=e.subjectEl;i instanceof HTMLElement&&(t=rs(i),r=is(r,t));let s=this.initialHit=this.queryHitForOffset(r.left,r.top);if(s){if(this.useSubjectCenter&&t){let e=ss(t,s.rect);e&&(r=os(e))}this.coordAdjust=as(r,n)}else this.coordAdjust={left:0,top:0}}handleMove(e,t){let n=this.queryHitForOffset(e.pageX+this.coordAdjust.left,e.pageY+this.coordAdjust.top);!t&&zj(this.movingHit,n)||(this.movingHit=n,this.emitter.trigger("hitupdate",n,!1,e))}prepareHits(){this.offsetTrackers=ls(this.droppableStore,e=>(e.component.prepareHits(),new Fj(e.el)))}releaseHits(){let{offsetTrackers:e}=this;for(let t in e)e[t].destroy();this.offsetTrackers={}}queryHitForOffset(e,t){let{droppableStore:n,offsetTrackers:r}=this,i=null;for(let s in n){let o=n[s].component,a=r[s];if(a&&a.isWithinClipping(e,t)){let n=a.computeLeft(),r=a.computeTop(),l=e-n,c=t-r,{origRect:u}=a,h=u.right-u.left,d=u.bottom-u.top;if(l>=0&&l<h&&c>=0&&c<d){let e=o.queryHit(l,c,h,d);e&&cs(e.dateProfile.activeRange,e.dateSpan.range)&&(this.disablePointCheck||a.el.contains(a.el.getRootNode().elementFromPoint(l+n-window.scrollX,c+r-window.scrollY)))&&(!i||e.layer>i.layer)&&(e.componentId=s,e.context=o.context,e.rect.left+=n,e.rect.right+=n,e.rect.top+=r,e.rect.bottom+=r,i=e)}}}return i}}function zj(e,t){return!e&&!t||Boolean(e)===Boolean(t)&&ns(e.dateSpan,t.dateSpan)}function Wj(e,t){let n={};for(let s of t.pluginHooks.datePointTransforms)Object.assign(n,s(e,t));var r,i;return Object.assign(n,(r=e,{date:(i=t.dateEnv).toDate(r.range.start),dateStr:i.formatIso(r.range.start,{omitTime:r.allDay}),allDay:r.allDay})),n}class Uj extends Fi{constructor(e){super(e),this.subjectEl=null,this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=e=>{let t=e.origEvent.target,{component:n,dragging:r}=this,{mirror:i}=r,{options:s}=n.context,o=n.context;this.subjectEl=e.subjectEl;let a=this.subjectSeg=Hi(e.subjectEl),l=(this.eventRange=a.eventRange).instance.instanceId;this.relevantEvents=$i(o.getCurrentData().eventStore,l),r.minDistance=e.isTouch?0:s.eventDragMinDistance,r.delay=e.isTouch&&l!==n.props.eventSelection?function(e){let{options:t}=e.context,n=t.eventLongPressDelay;return null==n&&(n=t.longPressDelay),n}(n):null,s.fixedMirrorParent?i.parentNode=s.fixedMirrorParent:i.parentNode=Li(t,".fc"),i.revertDuration=s.dragRevertDuration;let c=n.isValidSegDownEl(t)&&!Li(t,".fc-event-resizer");r.setIgnoreMove(!c),this.isDragging=c&&e.subjectEl.classList.contains("fc-event-draggable")},this.handleDragStart=e=>{let t=this.component.context,n=this.eventRange,r=n.instance.instanceId;e.isTouch?r!==this.component.props.eventSelection&&t.dispatch({type:"SELECT_EVENT",eventInstanceId:r}):t.dispatch({type:"UNSELECT_EVENT"}),this.isDragging&&(t.calendarApi.unselect(e),t.emitter.trigger("eventDragStart",{el:this.subjectEl,event:new qi(t,n.def,n.instance),jsEvent:e.origEvent,view:t.viewApi}))},this.handleHitUpdate=(e,t)=>{if(!this.isDragging)return;let n=this.relevantEvents,r=this.hitDragging.initialHit,i=this.component.context,s=null,o=null,a=null,l=!1,c={affectedEvents:n,mutatedEvents:Gi(),isEvent:!0};if(e){s=e.context;let t=s.options;i===s||t.editable&&t.droppable?(o=function(e,t,n,r){let i=e.dateSpan,s=t.dateSpan,o=i.range.start,a=s.range.start,l={};i.allDay!==s.allDay&&(l.allDay=s.allDay,l.hasEnd=t.context.options.allDayMaintainDuration,o=s.allDay?bi(n):n);let c=us(o,a,e.context.dateEnv,e.componentId===t.componentId?e.largeUnit:null);c.milliseconds&&(l.allDay=!1);let u={datesDelta:c,standardProps:l};for(let h of r)h(u,e,t);return u}(r,e,this.eventRange.instance.range.start,s.getCurrentData().pluginHooks.eventDragMutationMassagers),o&&(a=Xi(n,s.getCurrentData().eventUiBases,o,s),c.mutatedEvents=a,Ki(c,e.dateProfile,s)||(l=!0,o=null,a=null,c.mutatedEvents=Gi()))):s=null}this.displayDrag(s,c),l?Wi():zi(),t||(i===s&&zj(r,e)&&(o=null),this.dragging.setMirrorNeedsRevert(!o),this.dragging.setMirrorIsVisible(!e||!this.subjectEl.getRootNode().querySelector(".fc-event-mirror")),this.receivingContext=s,this.validMutation=o,this.mutatedRelevantEvents=a)},this.handlePointerUp=()=>{this.isDragging||this.cleanup()},this.handleDragEnd=e=>{if(this.isDragging){let t=this.component.context,n=t.viewApi,{receivingContext:r,validMutation:i}=this,s=this.eventRange.def,o=this.eventRange.instance,a=new qi(t,s,o),l=this.relevantEvents,c=this.mutatedRelevantEvents,{finalHit:u}=this.hitDragging;if(this.clearDrag(),t.emitter.trigger("eventDragStop",{el:this.subjectEl,event:a,jsEvent:e.origEvent,view:n}),i){if(r===t){let r=new qi(t,c.defs[s.defId],o?c.instances[o.instanceId]:null);t.dispatch({type:"MERGE_EVENTS",eventStore:c});let u={oldEvent:a,event:r,relatedEvents:Yi(c,t,o),revert(){t.dispatch({type:"MERGE_EVENTS",eventStore:l})}},h={};for(let e of t.getCurrentData().pluginHooks.eventDropTransformers)Object.assign(h,e(i,t));t.emitter.trigger("eventDrop",Object.assign(Object.assign(Object.assign({},u),h),{el:e.subjectEl,delta:i.datesDelta,jsEvent:e.origEvent,view:n})),t.emitter.trigger("eventChange",u)}else if(r){let i={event:a,relatedEvents:Yi(l,t,o),revert(){t.dispatch({type:"MERGE_EVENTS",eventStore:l})}};t.emitter.trigger("eventLeave",Object.assign(Object.assign({},i),{draggedEl:e.subjectEl,view:n})),t.dispatch({type:"REMOVE_EVENTS",eventStore:l}),t.emitter.trigger("eventRemove",i);let h=c.defs[s.defId],d=c.instances[o.instanceId],f=new qi(r,h,d);r.dispatch({type:"MERGE_EVENTS",eventStore:c});let p={event:f,relatedEvents:Yi(c,r,d),revert(){r.dispatch({type:"REMOVE_EVENTS",eventStore:c})}};r.emitter.trigger("eventAdd",p),e.isTouch&&r.dispatch({type:"SELECT_EVENT",eventInstanceId:o.instanceId}),r.emitter.trigger("drop",Object.assign(Object.assign({},Wj(u.dateSpan,r)),{draggedEl:e.subjectEl,jsEvent:e.origEvent,view:u.context.viewApi})),r.emitter.trigger("eventReceive",Object.assign(Object.assign({},p),{draggedEl:e.subjectEl,view:u.context.viewApi}))}}else t.emitter.trigger("_noEventDrop")}this.cleanup()};let{component:t}=this,{options:n}=t.context,r=this.dragging=new Lj(e.el);r.pointer.selector=Uj.SELECTOR,r.touchScrollAllowed=!1,r.autoScroller.isEnabled=n.dragScroll;let i=this.hitDragging=new Bj(this.dragging,Qi);i.useSubjectCenter=e.useEventCenter,i.emitter.on("pointerdown",this.handlePointerDown),i.emitter.on("dragstart",this.handleDragStart),i.emitter.on("hitupdate",this.handleHitUpdate),i.emitter.on("pointerup",this.handlePointerUp),i.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}displayDrag(e,t){let n=this.component.context,r=this.receivingContext;r&&r!==e&&(r===n?r.dispatch({type:"SET_EVENT_DRAG",state:{affectedEvents:t.affectedEvents,mutatedEvents:Gi(),isEvent:!0}}):r.dispatch({type:"UNSET_EVENT_DRAG"})),e&&e.dispatch({type:"SET_EVENT_DRAG",state:t})}clearDrag(){let e=this.component.context,{receivingContext:t}=this;t&&t.dispatch({type:"UNSET_EVENT_DRAG"}),e!==t&&e.dispatch({type:"UNSET_EVENT_DRAG"})}cleanup(){this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null}}Uj.SELECTOR=".fc-event-draggable, .fc-event-resizable";const Hj={fixedMirrorParent:_i},$j={dateClick:_i,eventDragStart:_i,eventDragStop:_i,eventDrop:_i,eventResizeStart:_i,eventResizeStop:_i,eventResize:_i,drop:_i,eventReceive:_i,eventLeave:_i};hs.dataAttrPrefix="";var qj=ji({name:"@fullcalendar/interaction",componentInteractions:[class extends Fi{constructor(e){super(e),this.handlePointerDown=e=>{let{dragging:t}=this,n=e.origEvent.target;t.setIgnoreMove(!this.component.isValidDateDownEl(n))},this.handleDragEnd=e=>{let{component:t}=this,{pointer:n}=this.dragging;if(!n.wasTouchScroll){let{initialHit:n,finalHit:r}=this.hitDragging;if(n&&r&&zj(n,r)){let{context:r}=t,i=Object.assign(Object.assign({},Wj(n.dateSpan,r)),{dayEl:n.dayEl,jsEvent:e.origEvent,view:r.viewApi||r.calendarApi.view});r.emitter.trigger("dateClick",i)}}},this.dragging=new Lj(e.el),this.dragging.autoScroller.isEnabled=!1;let t=this.hitDragging=new Bj(this.dragging,Vi(e));t.emitter.on("pointerdown",this.handlePointerDown),t.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}},class extends Fi{constructor(e){super(e),this.dragSelection=null,this.handlePointerDown=e=>{let{component:t,dragging:n}=this,{options:r}=t.context,i=r.selectable&&t.isValidDateDownEl(e.origEvent.target);n.setIgnoreMove(!i),n.delay=e.isTouch?function(e){let{options:t}=e.context,n=t.selectLongPressDelay;return null==n&&(n=t.longPressDelay),n}(t):null},this.handleDragStart=e=>{this.component.context.calendarApi.unselect(e)},this.handleHitUpdate=(e,t)=>{let{context:n}=this.component,r=null,i=!1;if(e){let t=this.hitDragging.initialHit;e.componentId===t.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(t,e)||(r=function(e,t,n){let r=e.dateSpan,i=t.dateSpan,s=[r.range.start,r.range.end,i.range.start,i.range.end];s.sort(ys);let o={};for(let a of n){let n=a(e,t);if(!1===n)return null;n&&Object.assign(o,n)}return o.range={start:s[0],end:s[3]},o.allDay=r.allDay,o}(t,e,n.pluginHooks.dateSelectionTransformers)),r&&Bi(r,e.dateProfile,n)||(i=!0,r=null)}r?n.dispatch({type:"SELECT_DATES",selection:r}):t||n.dispatch({type:"UNSELECT_DATES"}),i?Wi():zi(),t||(this.dragSelection=r)},this.handlePointerUp=e=>{this.dragSelection&&(Ui(this.dragSelection,e,this.component.context),this.dragSelection=null)};let{component:t}=e,{options:n}=t.context,r=this.dragging=new Lj(e.el);r.touchScrollAllowed=!1,r.minDistance=n.selectMinDistance||0,r.autoScroller.isEnabled=n.dragScroll;let i=this.hitDragging=new Bj(this.dragging,Vi(e));i.emitter.on("pointerdown",this.handlePointerDown),i.emitter.on("dragstart",this.handleDragStart),i.emitter.on("hitupdate",this.handleHitUpdate),i.emitter.on("pointerup",this.handlePointerUp)}destroy(){this.dragging.destroy()}},Uj,class extends Fi{constructor(e){super(e),this.draggingSegEl=null,this.draggingSeg=null,this.eventRange=null,this.relevantEvents=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=e=>{let{component:t}=this,n=this.querySegEl(e),r=Hi(n),i=this.eventRange=r.eventRange;this.dragging.minDistance=t.context.options.eventDragMinDistance,this.dragging.setIgnoreMove(!this.component.isValidSegDownEl(e.origEvent.target)||e.isTouch&&this.component.props.eventSelection!==i.instance.instanceId)},this.handleDragStart=e=>{let{context:t}=this.component,n=this.eventRange;this.relevantEvents=$i(t.getCurrentData().eventStore,this.eventRange.instance.instanceId);let r=this.querySegEl(e);this.draggingSegEl=r,this.draggingSeg=Hi(r),t.calendarApi.unselect(),t.emitter.trigger("eventResizeStart",{el:r,event:new qi(t,n.def,n.instance),jsEvent:e.origEvent,view:t.viewApi})},this.handleHitUpdate=(e,t,n)=>{let{context:r}=this.component,i=this.relevantEvents,s=this.hitDragging.initialHit,o=this.eventRange.instance,a=null,l=null,c=!1,u={affectedEvents:i,mutatedEvents:Gi(),isEvent:!0};e&&(e.componentId===s.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(s,e)||(a=function(e,t,n,r){let i=e.context.dateEnv,s=e.dateSpan.range.start,o=t.dateSpan.range.start,a=us(s,o,i,e.largeUnit);if(n){if(i.add(r.start,a)<r.end)return{startDelta:a}}else if(i.add(r.end,a)>r.start)return{endDelta:a};return null}(s,e,n.subjectEl.classList.contains("fc-event-resizer-start"),o.range))),a&&(l=Xi(i,r.getCurrentData().eventUiBases,a,r),u.mutatedEvents=l,Ki(u,e.dateProfile,r)||(c=!0,a=null,l=null,u.mutatedEvents=null)),l?r.dispatch({type:"SET_EVENT_RESIZE",state:u}):r.dispatch({type:"UNSET_EVENT_RESIZE"}),c?Wi():zi(),t||(a&&zj(s,e)&&(a=null),this.validMutation=a,this.mutatedRelevantEvents=l)},this.handleDragEnd=e=>{let{context:t}=this.component,n=this.eventRange.def,r=this.eventRange.instance,i=new qi(t,n,r),s=this.relevantEvents,o=this.mutatedRelevantEvents;if(t.emitter.trigger("eventResizeStop",{el:this.draggingSegEl,event:i,jsEvent:e.origEvent,view:t.viewApi}),this.validMutation){let a=new qi(t,o.defs[n.defId],r?o.instances[r.instanceId]:null);t.dispatch({type:"MERGE_EVENTS",eventStore:o});let l={oldEvent:i,event:a,relatedEvents:Yi(o,t,r),revert(){t.dispatch({type:"MERGE_EVENTS",eventStore:s})}};t.emitter.trigger("eventResize",Object.assign(Object.assign({},l),{el:this.draggingSegEl,startDelta:this.validMutation.startDelta||Jr(0),endDelta:this.validMutation.endDelta||Jr(0),jsEvent:e.origEvent,view:t.viewApi})),t.emitter.trigger("eventChange",l)}else t.emitter.trigger("_noEventResize");this.draggingSeg=null,this.relevantEvents=null,this.validMutation=null};let{component:t}=e,n=this.dragging=new Lj(e.el);n.pointer.selector=".fc-event-resizer",n.touchScrollAllowed=!1,n.autoScroller.isEnabled=t.context.options.dragScroll;let r=this.hitDragging=new Bj(this.dragging,Vi(e));r.emitter.on("pointerdown",this.handlePointerDown),r.emitter.on("dragstart",this.handleDragStart),r.emitter.on("hitupdate",this.handleHitUpdate),r.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}querySegEl(e){return Li(e.subjectEl,".fc-event")}}],calendarInteractions:[class{constructor(e){this.context=e,this.isRecentPointerDateSelect=!1,this.matchesCancel=!1,this.matchesEvent=!1,this.onSelect=e=>{e.jsEvent&&(this.isRecentPointerDateSelect=!0)},this.onDocumentPointerDown=e=>{let t=this.context.options.unselectCancel,n=Ni(e.origEvent);this.matchesCancel=!!Li(n,t),this.matchesEvent=!!Li(n,Uj.SELECTOR)},this.onDocumentPointerUp=e=>{let{context:t}=this,{documentPointer:n}=this,r=t.getCurrentData();if(!n.wasTouchScroll){if(r.dateSelection&&!this.isRecentPointerDateSelect){let n=t.options.unselectAuto;!n||n&&this.matchesCancel||t.calendarApi.unselect(e)}r.eventSelection&&!this.matchesEvent&&t.dispatch({type:"UNSELECT_EVENT"})}this.isRecentPointerDateSelect=!1};let t=this.documentPointer=new jj(document);t.shouldIgnoreMove=!0,t.shouldWatchScroll=!1,t.emitter.on("pointerdown",this.onDocumentPointerDown),t.emitter.on("pointerup",this.onDocumentPointerUp),e.emitter.on("select",this.onSelect)}destroy(){this.context.emitter.off("select",this.onSelect),this.documentPointer.destroy()}}],elementDraggingImpl:Lj,optionRefiners:Hj,listenerRefiners:$j});const Xj=()=>{const{user:t}=to(),[n,r]=on.useState([]),[i,s]=on.useState([]),[o,a]=on.useState(null),[l,c]=on.useState(!1),[d,f]=on.useState(null);on.useEffect(()=>{if(!(null==t?void 0:t.id))return;const e=NC(t.id,e=>{const t=localStorage.getItem("currentWorkspace"),n=localStorage.getItem("currentProject");let i=e;t?i=i.filter(e=>e.workspace===t||!e.workspace&&"個人プロジェクト"===t):n&&(i=i.filter(e=>e.project===n||!e.project&&"個人プロジェクト"===n)),r(i)});return()=>e()},[null==t?void 0:t.id]),on.useEffect(()=>{const e=e=>{const{type:n,value:i}=e.detail;console.log("CalendarView: フィルタ変更を検知:",n,i),"workspace"===n?(localStorage.setItem("currentWorkspace",i),localStorage.removeItem("currentProject")):"project"===n&&(localStorage.setItem("currentProject",i),localStorage.removeItem("currentWorkspace"));const s=localStorage.getItem(`tasks_${null==t?void 0:t.id}`);if(s){const e=JSON.parse(s),t="workspace"===n?e.filter(e=>e.workspace===i||!e.workspace&&"個人プロジェクト"===i):e.filter(e=>e.project===i||!e.project&&"個人プロジェクト"===i);r(t)}};window.addEventListener("filterChanged",e);const n=localStorage.getItem("currentWorkspace"),i=localStorage.getItem("currentProject"),s=localStorage.getItem(`tasks_${null==t?void 0:t.id}`);if(s){const e=JSON.parse(s);n?r(e.filter(e=>e.workspace===n||!e.workspace&&"個人プロジェクト"===n)):i&&r(e.filter(e=>e.project===i||!e.project&&"個人プロジェクト"===i))}return()=>{window.removeEventListener("filterChanged",e)}},[]),on.useEffect(()=>{p()},[n]);const p=()=>{const e=n.map(e=>{const t={todo:{bg:"#6b7280",border:"#4b5563",text:"#ffffff"},inProgress:{bg:"#3b82f6",border:"#2563eb",text:"#ffffff"},done:{bg:"#10b981",border:"#059669",text:"#ffffff"}}[e.status];return{id:e.id,title:e.title,start:e.dueDate,backgroundColor:t.bg,borderColor:t.border,textColor:t.text,extendedProps:{task:e},classNames:["draggable-event"],display:"block",allDay:!0}});s(e)};return y.jsx(I,{sx:{p:3},children:y.jsxs(Cr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[y.jsxs(I,{sx:{mb:3,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[y.jsx(E,{variant:"h4",sx:{fontWeight:700},children:"カレンダー"}),y.jsx(Te,{variant:"contained",startIcon:y.jsx(_,{}),onClick:()=>{const e={id:Date.now().toString(),title:"",description:"",status:"todo",priority:"medium",dueDate:Dn(new Date,"yyyy-MM-dd"),assignee:"",createdAt:(new Date).toISOString()};f(e),c(!0)},children:"新しいタスク"})]}),y.jsx(ct,{children:y.jsxs(tt,{sx:{p:0},children:[y.jsxs(I,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:[y.jsx(E,{variant:"h6",sx:{fontWeight:600,mb:1},children:"タスクカレンダー"}),y.jsxs(I,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[y.jsx(_e,{icon:y.jsx(pt,{}),label:"未着手",size:"small",sx:{bgcolor:"#6b7280",color:"white"}}),y.jsx(_e,{icon:y.jsx(Ke,{}),label:"進行中",size:"small",sx:{bgcolor:"#3b82f6",color:"white"}}),y.jsx(_e,{icon:y.jsx(pt,{}),label:"完了",size:"small",sx:{bgcolor:"#10b981",color:"white"}})]})]}),y.jsx(I,{sx:{height:600,"& .draggable-event":{cursor:"grab",transition:"all 0.2s ease","&:hover":{transform:"scale(1.02)",boxShadow:"0 4px 8px rgba(0,0,0,0.2)"},"&:active":{cursor:"grabbing",transform:"scale(1.05)",boxShadow:"0 6px 12px rgba(0,0,0,0.3)"}},"& .fc-event-dragging":{opacity:.8,transform:"rotate(5deg)",boxShadow:"0 8px 16px rgba(0,0,0,0.4)"}},children:y.jsx(xs,{plugins:[bs,Ej,qj],initialView:"dayGridMonth",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},locale:"ja",editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,weekends:!0,events:i,dateClick:e=>{const t={id:Date.now().toString(),title:"",description:"",status:"todo",priority:"medium",dueDate:e.dateStr,assignee:"",createdAt:(new Date).toISOString()};f(t),c(!0)},eventClick:e=>{a(e.event),f(e.event.extendedProps.task),c(!0)},eventDrop:n=>g(e,null,function*(){const{event:e}=n,r=e.extendedProps.task;if(r&&(null==t?void 0:t.id))try{const n=Dn(e.start,"yyyy-MM-dd"),i=h(u({},r),{dueDate:n,updatedAt:(new Date).toISOString()});console.log("カレンダーでタスクをドラッグ:",r.title,"新しい日付:",n),yield FC(t.id,r.id,i),console.log("タスクの日付を更新しました:",r.title)}catch(i){console.error("タスクの日付更新に失敗しました:",i),e.setProp("start",r.dueDate)}}),height:"100%",eventDisplay:"block",eventTimeFormat:{hour:"2-digit",minute:"2-digit",meridiem:!1}})})]})}),y.jsxs(ge,{open:l,onClose:()=>c(!1),maxWidth:"sm",fullWidth:!0,children:[y.jsx(ze,{children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[y.jsx(E,{variant:"h6",sx:{fontWeight:600},children:(null==d?void 0:d.id)?"タスクを編集":"新しいタスク"}),(null==d?void 0:d.id)&&y.jsx(D,{title:"削除",children:y.jsx(k,{color:"error",onClick:()=>g(e,null,function*(){if(d&&(null==t?void 0:t.id))try{yield VC(t.id,d.id),c(!1),f(null)}catch(e){console.error("タスクの削除に失敗しました:",e)}}),sx:{color:"error.main"},children:y.jsx(Q,{})})})]})}),y.jsx(ve,{children:y.jsxs(I,{sx:{mt:2},children:[y.jsx(Fe,{fullWidth:!0,label:"タイトル",value:(null==d?void 0:d.title)||"",onChange:e=>f(t=>t?h(u({},t),{title:e.target.value}):null),sx:{mb:2}}),y.jsx(Fe,{fullWidth:!0,label:"説明",multiline:!0,rows:3,value:(null==d?void 0:d.description)||"",onChange:e=>f(t=>t?h(u({},t),{description:e.target.value}):null),sx:{mb:2}}),y.jsxs(I,{sx:{display:"flex",gap:2,mb:2},children:[y.jsxs($e,{fullWidth:!0,children:[y.jsx(qe,{children:"ステータス"}),y.jsxs(Xe,{value:(null==d?void 0:d.status)||"todo",onChange:e=>f(t=>t?h(u({},t),{status:e.target.value}):null),label:"ステータス",children:[y.jsx(L,{value:"todo",children:"未着手"}),y.jsx(L,{value:"inProgress",children:"進行中"}),y.jsx(L,{value:"done",children:"完了"})]})]}),y.jsxs($e,{fullWidth:!0,children:[y.jsx(qe,{children:"優先度"}),y.jsxs(Xe,{value:(null==d?void 0:d.priority)||"medium",onChange:e=>f(t=>t?h(u({},t),{priority:e.target.value}):null),label:"優先度",children:[y.jsx(L,{value:"low",children:"低"}),y.jsx(L,{value:"medium",children:"中"}),y.jsx(L,{value:"high",children:"高"})]})]})]}),y.jsx(Fe,{fullWidth:!0,label:"期限",type:"date",value:(null==d?void 0:d.dueDate)||"",onChange:e=>f(t=>t?h(u({},t),{dueDate:e.target.value}):null),InputLabelProps:{shrink:!0},sx:{mb:2}}),y.jsx(Fe,{fullWidth:!0,label:"担当者",value:(null==d?void 0:d.assignee)||"",onChange:e=>f(t=>t?h(u({},t),{assignee:e.target.value}):null)})]})}),y.jsxs(je,{children:[y.jsx(Te,{onClick:()=>c(!1),children:"キャンセル"}),y.jsx(Te,{variant:"contained",onClick:()=>g(e,null,function*(){if(d&&(null==t?void 0:t.id))try{if(d.id&&d.title)if(d.id.includes("temp")){const e=h(u({},d),{id:Date.now().toString(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()});yield LC(t.id,e)}else yield FC(t.id,d.id,d);c(!1),f(null)}catch(e){console.error("タスクの保存に失敗しました:",e)}}),disabled:!(null==d?void 0:d.title),children:"保存"})]})]})]})})},Kj=()=>{const{user:t}=to(),[n,r]=on.useState([]),[i,s]=on.useState(null),[o,a]=on.useState(!1),[l,c]=on.useState(null),[d,f]=on.useState("week");on.useEffect(()=>{if(!(null==t?void 0:t.id))return;const e=NC(t.id,e=>{const t=localStorage.getItem("currentWorkspace"),n=localStorage.getItem("currentProject");let i=e;t?i=i.filter(e=>e.workspace===t||!e.workspace&&"個人プロジェクト"===t):n&&(i=i.filter(e=>e.project===n||!e.project&&"個人プロジェクト"===n));const s=i.map((e,t)=>h(u({},e),{startDate:e.startDate||Dn(wn(new Date,2*t),"yyyy-MM-dd"),endDate:e.endDate||Dn(wn(new Date,2*t+1),"yyyy-MM-dd")}));r(s)});return()=>e()},[null==t?void 0:t.id]),on.useEffect(()=>{const e=e=>{const{type:n,value:i}=e.detail;console.log("TimelineView: フィルタ変更を検知:",n,i),"workspace"===n?(localStorage.setItem("currentWorkspace",i),localStorage.removeItem("currentProject")):"project"===n&&(localStorage.setItem("currentProject",i),localStorage.removeItem("currentWorkspace"));const s=localStorage.getItem(`tasks_${null==t?void 0:t.id}`);if(s){const e=JSON.parse(s),t=("workspace"===n?e.filter(e=>e.workspace===i||!e.workspace&&"個人プロジェクト"===i):e.filter(e=>e.project===i||!e.project&&"個人プロジェクト"===i)).map((e,t)=>h(u({},e),{startDate:e.startDate||Dn(wn(new Date,2*t),"yyyy-MM-dd"),endDate:e.endDate||Dn(wn(new Date,2*t+1),"yyyy-MM-dd")}));r(t)}};window.addEventListener("filterChanged",e);const n=localStorage.getItem("currentWorkspace"),i=localStorage.getItem("currentProject"),s=localStorage.getItem(`tasks_${null==t?void 0:t.id}`);if(s){const e=JSON.parse(s);let t=e;n?t=e.filter(e=>e.workspace===n||!e.workspace&&"個人プロジェクト"===n):i&&(t=e.filter(e=>e.project===i||!e.project&&"個人プロジェクト"===i));const o=t.map((e,t)=>h(u({},e),{startDate:e.startDate||Dn(wn(new Date,2*t),"yyyy-MM-dd"),endDate:e.endDate||Dn(wn(new Date,2*t+1),"yyyy-MM-dd")}));r(o)}return()=>{window.removeEventListener("filterChanged",e)}},[]);const p=()=>{const e=new Date;return{startDate:Xn("week"===d?e:new Date(e.getFullYear(),e.getMonth(),1)),endDate:"week"===d?wn(e,7):new Date(e.getFullYear(),e.getMonth()+1,0)}},m=()=>{const{startDate:e,endDate:t}=p(),n=[];let r=e;for(;$n(r,t)||r.getTime()===t.getTime();)n.push(r),r=wn(r,1);return n},v=e=>{switch(e){case"high":return"#ef4444";case"medium":return"#f59e0b";case"low":return"#10b981";default:return"#6b7280"}},x=e=>{switch(e){case"todo":default:return"#6b7280";case"inProgress":return"#3b82f6";case"done":return"#10b981"}},b=e=>{switch(e){case"high":return"高";case"medium":return"中";case"low":return"低";default:return e}},w=m();return y.jsx(I,{sx:{p:3},children:y.jsxs(Cr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[y.jsxs(I,{sx:{mb:3,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[y.jsx(E,{variant:"h4",sx:{fontWeight:700},children:"タイムライン"}),y.jsxs(I,{sx:{display:"flex",gap:2},children:[y.jsx(Te,{variant:"week"===d?"contained":"outlined",onClick:()=>f("week"),children:"週表示"}),y.jsx(Te,{variant:"month"===d?"contained":"outlined",onClick:()=>f("month"),children:"月表示"}),y.jsx(Te,{variant:"contained",startIcon:y.jsx(_,{}),onClick:()=>{const e={id:Date.now().toString(),title:"",description:"",status:"todo",priority:"medium",dueDate:Dn(new Date,"yyyy-MM-dd"),assignee:"",createdAt:(new Date).toISOString(),startDate:Dn(new Date,"yyyy-MM-dd"),endDate:Dn(wn(new Date,1),"yyyy-MM-dd")};c(e),a(!0)},children:"新しいタスク"})]})]}),y.jsx(ct,{children:y.jsxs(tt,{sx:{p:0},children:[y.jsxs(I,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:[y.jsx(E,{variant:"h6",sx:{fontWeight:600,mb:1},children:"プロジェクトタイムライン"}),y.jsxs(I,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[y.jsx(_e,{icon:y.jsx(te,{}),label:"未着手",size:"small",sx:{bgcolor:"#6b7280",color:"white"}}),y.jsx(_e,{icon:y.jsx(Ke,{}),label:"進行中",size:"small",sx:{bgcolor:"#3b82f6",color:"white"}}),y.jsx(_e,{icon:y.jsx(Qe,{}),label:"完了",size:"small",sx:{bgcolor:"#10b981",color:"white"}})]})]}),y.jsxs(I,{sx:{p:2},children:[y.jsxs(I,{sx:{display:"flex",mb:2},children:[y.jsx(I,{sx:{width:200,flexShrink:0}}),w.map((e,t)=>y.jsxs(I,{sx:{flex:1,textAlign:"center",borderRight:t<w.length-1?1:0,borderColor:"divider",py:1},children:[y.jsx(E,{variant:"caption",color:"text.secondary",children:Dn(e,"M/d",{locale:$C})}),y.jsx(E,{variant:"caption",display:"block",children:Dn(e,"EEE",{locale:$C})})]},t))]}),y.jsx(I,{sx:{position:"relative"},children:n.map((e,t)=>{const n=(e=>{const{startDate:t}=p(),n=new Date(e.startDate||e.dueDate),r=Pn(n,t),i=Pn(new Date(e.endDate||e.dueDate),new Date(e.startDate||e.dueDate))+1;return{left:r/m().length*100+"%",width:i/m().length*100+"%"}})(e);return y.jsx(Cr.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1*t},style:{position:"absolute",left:n.left,width:n.width,top:60*t+"px",height:"40px"},children:y.jsx(ct,{sx:{height:"100%",backgroundColor:x(e.status),color:"white",cursor:"pointer","&:hover":{transform:"scale(1.02)",boxShadow:2}},onClick:()=>{s(e),c(e),a(!0)},children:y.jsx(tt,{sx:{p:1,height:"100%"},children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",height:"100%"},children:[y.jsx(O,{sx:{width:24,height:24,bgcolor:v(e.priority),mr:1},children:y.jsx(Ge,{sx:{fontSize:12}})}),y.jsx(E,{variant:"body2",sx:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.title})]})})})},e.id)})}),y.jsx(I,{sx:{height:60*n.length+"px",mt:2}})]})]})}),y.jsx(ct,{sx:{mt:3},children:y.jsxs(tt,{children:[y.jsx(E,{variant:"h6",sx:{fontWeight:600,mb:2},children:"タスク一覧"}),y.jsx(K,{children:n.map((r,i)=>y.jsxs(sn.Fragment,{children:[y.jsxs(G,{sx:{px:0},secondaryAction:y.jsxs(I,{sx:{display:"flex",gap:1},children:[y.jsx(D,{title:"編集",children:y.jsx(k,{size:"small",onClick:()=>{c(r),a(!0)},children:y.jsx(dt,{})})}),y.jsx(D,{title:"削除",children:y.jsx(k,{size:"small",color:"error",onClick:()=>g(e,null,function*(){(null==t?void 0:t.id)&&(yield VC(t.id,r.id))}),children:y.jsx(Q,{})})})]}),children:[y.jsx(st,{children:y.jsx(O,{sx:{bgcolor:x(r.status)},children:y.jsx(We,{})})}),y.jsx(B,{primary:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(E,{variant:"body1",sx:{fontWeight:500},children:r.title}),y.jsx(_e,{label:b(r.priority),size:"small",sx:{backgroundColor:v(r.priority),color:"white",fontSize:"0.75rem"}})]}),secondary:y.jsxs(I,{sx:{mt:.5},children:[y.jsx(E,{variant:"body2",color:"text.secondary",children:r.description}),y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:2,mt:.5},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:.5},children:[y.jsx(ee,{sx:{fontSize:16}}),y.jsxs(E,{variant:"caption",color:"text.secondary",children:[Dn(new Date(r.startDate||r.dueDate),"M/d")," - ",Dn(new Date(r.endDate||r.dueDate),"M/d")]})]}),r.assignee&&y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:.5},children:[y.jsx(V,{sx:{fontSize:16}}),y.jsx(E,{variant:"caption",color:"text.secondary",children:r.assignee})]})]})]})})]}),i<n.length-1&&y.jsx(W,{})]},r.id))})]})}),y.jsxs(ge,{open:o,onClose:()=>a(!1),maxWidth:"sm",fullWidth:!0,children:[y.jsx(ze,{children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[y.jsx(E,{variant:"h6",sx:{fontWeight:600},children:(null==l?void 0:l.id)?"タスクを編集":"新しいタスク"}),(null==l?void 0:l.id)&&y.jsx(D,{title:"削除",children:y.jsx(k,{color:"error",onClick:()=>g(e,null,function*(){if(l&&(null==t?void 0:t.id))try{yield VC(t.id,l.id),a(!1),c(null)}catch(e){console.error("タスクの削除に失敗しました:",e)}}),sx:{color:"error.main"},children:y.jsx(Q,{})})})]})}),y.jsx(ve,{children:y.jsxs(I,{sx:{mt:2},children:[y.jsx(Fe,{fullWidth:!0,label:"タイトル",value:(null==l?void 0:l.title)||"",onChange:e=>c(t=>t?h(u({},t),{title:e.target.value}):null),sx:{mb:2}}),y.jsx(Fe,{fullWidth:!0,label:"説明",multiline:!0,rows:3,value:(null==l?void 0:l.description)||"",onChange:e=>c(t=>t?h(u({},t),{description:e.target.value}):null),sx:{mb:2}}),y.jsxs(I,{sx:{display:"flex",gap:2,mb:2},children:[y.jsxs($e,{fullWidth:!0,children:[y.jsx(qe,{children:"ステータス"}),y.jsxs(Xe,{value:(null==l?void 0:l.status)||"todo",onChange:e=>c(t=>t?h(u({},t),{status:e.target.value}):null),label:"ステータス",children:[y.jsx(L,{value:"todo",children:"未着手"}),y.jsx(L,{value:"inProgress",children:"進行中"}),y.jsx(L,{value:"done",children:"完了"})]})]}),y.jsxs($e,{fullWidth:!0,children:[y.jsx(qe,{children:"優先度"}),y.jsxs(Xe,{value:(null==l?void 0:l.priority)||"medium",onChange:e=>c(t=>t?h(u({},t),{priority:e.target.value}):null),label:"優先度",children:[y.jsx(L,{value:"low",children:"低"}),y.jsx(L,{value:"medium",children:"中"}),y.jsx(L,{value:"high",children:"高"})]})]})]}),y.jsxs(I,{sx:{display:"flex",gap:2,mb:2},children:[y.jsx(Fe,{fullWidth:!0,label:"開始日",type:"date",value:(null==l?void 0:l.startDate)||"",onChange:e=>c(t=>t?h(u({},t),{startDate:e.target.value}):null),InputLabelProps:{shrink:!0}}),y.jsx(Fe,{fullWidth:!0,label:"終了日",type:"date",value:(null==l?void 0:l.endDate)||"",onChange:e=>c(t=>t?h(u({},t),{endDate:e.target.value}):null),InputLabelProps:{shrink:!0}})]}),y.jsx(Fe,{fullWidth:!0,label:"担当者",value:(null==l?void 0:l.assignee)||"",onChange:e=>c(t=>t?h(u({},t),{assignee:e.target.value}):null)})]})}),y.jsxs(je,{children:[y.jsx(Te,{onClick:()=>a(!1),children:"キャンセル"}),y.jsx(Te,{variant:"contained",onClick:()=>g(e,null,function*(){if(l&&(null==t?void 0:t.id))try{if(l.id&&l.title)if(l.id.includes("temp")){const e=h(u({},l),{id:Date.now().toString(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()});yield LC(t.id,e)}else yield FC(t.id,l.id,l);a(!1),c(null)}catch(e){console.error("タスクの保存に失敗しました:",e)}}),disabled:!(null==l?void 0:l.title),children:"保存"})]})]})]})})},Gj=()=>{const{user:t}=to(),[n,r]=on.useState([]),[i,s]=on.useState([]),[o,a]=on.useState([]),[l,c]=on.useState(!1),[d,f]=on.useState(null),[p,m]=on.useState(""),[v,x]=on.useState("all"),[b,w]=on.useState("all"),[S,C]=on.useState("asc"),[j,M]=on.useState("createdAt"),[P,A]=on.useState(0),[R,N]=on.useState(10);on.useEffect(()=>{if(!(null==t?void 0:t.id))return;const e=NC(t.id,e=>{const t=localStorage.getItem("currentWorkspace"),n=localStorage.getItem("currentProject");let i=e;t?i=i.filter(e=>e.workspace===t||!e.workspace&&"個人プロジェクト"===t):n&&(i=i.filter(e=>e.project===n||!e.project&&"個人プロジェクト"===n)),r(i)});return()=>e()},[null==t?void 0:t.id]),on.useEffect(()=>{const e=e=>{const{type:n,value:i}=e.detail;console.log("ListView: フィルタ変更を検知:",n,i),"workspace"===n?(localStorage.setItem("currentWorkspace",i),localStorage.removeItem("currentProject")):"project"===n&&(localStorage.setItem("currentProject",i),localStorage.removeItem("currentWorkspace"));const s=localStorage.getItem(`tasks_${null==t?void 0:t.id}`);if(s){const e=JSON.parse(s),t="workspace"===n?e.filter(e=>e.workspace===i||!e.workspace&&"個人プロジェクト"===i):e.filter(e=>e.project===i||!e.project&&"個人プロジェクト"===i);r(t)}};window.addEventListener("filterChanged",e);const n=localStorage.getItem("currentWorkspace"),i=localStorage.getItem("currentProject"),s=localStorage.getItem(`tasks_${null==t?void 0:t.id}`);if(s){const e=JSON.parse(s);n?r(e.filter(e=>e.workspace===n||!e.workspace&&"個人プロジェクト"===n)):i&&r(e.filter(e=>e.project===i||!e.project&&"個人プロジェクト"===i))}return()=>{window.removeEventListener("filterChanged",e)}},[]),on.useEffect(()=>{F()},[n,p,v,b,S,j]);const F=()=>{let e=n.filter(e=>{const t=e.title.toLowerCase().includes(p.toLowerCase())||e.description.toLowerCase().includes(p.toLowerCase())||e.assignee.toLowerCase().includes(p.toLowerCase()),n="all"===v||e.status===v,r="all"===b||e.priority===b;return t&&n&&r});e.sort((e,t)=>{let n=e[j],r=t[j];return"dueDate"!==j&&"createdAt"!==j||(n=new Date(n).getTime(),r=new Date(r).getTime()),"desc"===S?r>n?1:-1:n>r?1:-1}),s(e)},B=e=>{C(j===e&&"asc"===S?"desc":"asc"),M(e)},z=e=>{switch(e){case"high":return"#ef4444";case"medium":return"#f59e0b";case"low":return"#10b981";default:return"#6b7280"}},W=e=>{switch(e){case"todo":default:return"#6b7280";case"inProgress":return"#3b82f6";case"done":return"#10b981"}},U=e=>{switch(e){case"todo":default:return y.jsx(We,{});case"inProgress":return y.jsx(Ke,{});case"done":return y.jsx(Qe,{})}},H=e=>{switch(e){case"high":return y.jsx(Je,{});case"medium":default:return y.jsx(Ge,{});case"low":return y.jsx(Qe,{})}};return y.jsx(I,{sx:{p:3},children:y.jsxs(Cr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[y.jsxs(I,{sx:{mb:3,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[y.jsx(E,{variant:"h4",sx:{fontWeight:700},children:"リストビュー"}),y.jsxs(I,{sx:{display:"flex",gap:2},children:[o.length>0&&y.jsxs(Te,{variant:"outlined",color:"error",startIcon:y.jsx(Q,{}),onClick:()=>g(e,null,function*(){if(null==t?void 0:t.id)try{for(const e of o)yield VC(t.id,e);a([])}catch(e){console.error("選択されたタスクの削除に失敗しました:",e)}}),children:["選択削除 (",o.length,")"]}),y.jsx(Te,{variant:"contained",startIcon:y.jsx(_,{}),onClick:()=>{const e={id:Date.now().toString(),title:"",description:"",status:"todo",priority:"medium",dueDate:Dn(new Date,"yyyy-MM-dd"),assignee:"",createdAt:(new Date).toISOString()};f(e),c(!0)},children:"新しいタスク"})]})]}),y.jsx(ct,{sx:{mb:3},children:y.jsx(tt,{children:y.jsxs(I,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap"},children:[y.jsx(Fe,{placeholder:"タスクを検索...",value:p,onChange:e=>m(e.target.value),InputProps:{startAdornment:y.jsx(Le,{position:"start",children:y.jsx(T,{})})},sx:{minWidth:250}}),y.jsxs($e,{sx:{minWidth:120},children:[y.jsx(qe,{children:"ステータス"}),y.jsxs(Xe,{value:v,onChange:e=>x(e.target.value),label:"ステータス",children:[y.jsx(L,{value:"all",children:"すべて"}),y.jsx(L,{value:"todo",children:"未着手"}),y.jsx(L,{value:"inProgress",children:"進行中"}),y.jsx(L,{value:"done",children:"完了"})]})]}),y.jsxs($e,{sx:{minWidth:120},children:[y.jsx(qe,{children:"優先度"}),y.jsxs(Xe,{value:b,onChange:e=>w(e.target.value),label:"優先度",children:[y.jsx(L,{value:"all",children:"すべて"}),y.jsx(L,{value:"low",children:"低"}),y.jsx(L,{value:"medium",children:"中"}),y.jsx(L,{value:"high",children:"高"})]})]})]})})}),y.jsx(ct,{children:y.jsxs(tt,{sx:{p:0},children:[y.jsx(gt,{component:Ce,sx:{boxShadow:"none"},children:y.jsxs(mt,{children:[y.jsx(vt,{children:y.jsxs(yt,{children:[y.jsx(xt,{padding:"checkbox",children:y.jsx(bt,{indeterminate:o.length>0&&o.length<i.length,checked:i.length>0&&o.length===i.length,onChange:e=>{if(e.target.checked){const e=i.map(e=>e.id);return void a(e)}a([])}})}),y.jsx(xt,{children:y.jsx(wt,{active:"title"===j,direction:"title"===j?S:"asc",onClick:()=>B("title"),children:"タイトル"})}),y.jsx(xt,{children:y.jsx(wt,{active:"status"===j,direction:"status"===j?S:"asc",onClick:()=>B("status"),children:"ステータス"})}),y.jsx(xt,{children:y.jsx(wt,{active:"priority"===j,direction:"priority"===j?S:"asc",onClick:()=>B("priority"),children:"優先度"})}),y.jsx(xt,{children:y.jsx(wt,{active:"dueDate"===j,direction:"dueDate"===j?S:"asc",onClick:()=>B("dueDate"),children:"期限"})}),y.jsx(xt,{children:y.jsx(wt,{active:"assignee"===j,direction:"assignee"===j?S:"asc",onClick:()=>B("assignee"),children:"担当者"})}),y.jsx(xt,{children:y.jsx(wt,{active:"createdAt"===j,direction:"createdAt"===j?S:"asc",onClick:()=>B("createdAt"),children:"作成日"})}),y.jsx(xt,{align:"right",children:"アクション"})]})}),y.jsx(St,{children:i.slice(P*R,P*R+R).map(n=>{const r=(i=n.id,-1!==o.indexOf(i));var i;return y.jsxs(yt,{hover:!0,selected:r,onClick:()=>(e=>{const t=o.indexOf(e);let n=[];-1===t?n=n.concat(o,e):0===t?n=n.concat(o.slice(1)):t===o.length-1?n=n.concat(o.slice(0,-1)):t>0&&(n=n.concat(o.slice(0,t),o.slice(t+1))),a(n)})(n.id),sx:{cursor:"pointer"},children:[y.jsx(xt,{padding:"checkbox",children:y.jsx(bt,{checked:r})}),y.jsx(xt,{children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(O,{sx:{bgcolor:W(n.status),width:32,height:32},children:U(n.status)}),y.jsxs(I,{children:[y.jsx(E,{variant:"body2",sx:{fontWeight:500},children:n.title}),y.jsx(E,{variant:"caption",color:"text.secondary",children:n.description})]})]})}),y.jsx(xt,{children:y.jsx(_e,{label:"todo"===n.status?"未着手":"inProgress"===n.status?"進行中":"完了",size:"small",sx:{backgroundColor:W(n.status),color:"white"}})}),y.jsx(xt,{children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(O,{sx:{width:24,height:24,bgcolor:z(n.priority)},children:H(n.priority)}),y.jsx(E,{variant:"body2",children:"high"===n.priority?"高":"medium"===n.priority?"中":"低"})]})}),y.jsx(xt,{children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:.5},children:[y.jsx(ee,{sx:{fontSize:16,color:"text.secondary"}}),y.jsx(E,{variant:"body2",children:Dn(new Date(n.dueDate),"M/d",{locale:$C})})]})}),y.jsx(xt,{children:n.assignee?y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:.5},children:[y.jsx(V,{sx:{fontSize:16,color:"text.secondary"}}),y.jsx(E,{variant:"body2",children:n.assignee})]}):y.jsx(E,{variant:"body2",color:"text.secondary",children:"未割り当て"})}),y.jsx(xt,{children:y.jsx(E,{variant:"body2",children:Dn(new Date(n.createdAt),"M/d",{locale:$C})})}),y.jsx(xt,{align:"right",children:y.jsxs(I,{sx:{display:"flex",gap:1},children:[y.jsx(D,{title:"編集",children:y.jsx(k,{size:"small",onClick:e=>{e.stopPropagation(),f(n),c(!0)},children:y.jsx(dt,{})})}),y.jsx(D,{title:"削除",children:y.jsx(k,{size:"small",color:"error",onClick:r=>g(e,null,function*(){r.stopPropagation(),(null==t?void 0:t.id)&&(yield VC(t.id,n.id))}),children:y.jsx(Q,{})})})]})})]},n.id)})})]})}),y.jsx(kt,{rowsPerPageOptions:[5,10,25],component:"div",count:i.length,rowsPerPage:R,page:P,onPageChange:(e,t)=>A(t),onRowsPerPageChange:e=>{N(parseInt(e.target.value,10)),A(0)},labelRowsPerPage:"行数:",labelDisplayedRows:({from:e,to:t,count:n})=>`${e}-${t} / ${n}`})]})}),y.jsxs(ge,{open:l,onClose:()=>c(!1),maxWidth:"sm",fullWidth:!0,children:[y.jsx(ze,{children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[y.jsx(E,{variant:"h6",sx:{fontWeight:600},children:(null==d?void 0:d.id)?"タスクを編集":"新しいタスク"}),(null==d?void 0:d.id)&&y.jsx(D,{title:"削除",children:y.jsx(k,{color:"error",onClick:()=>g(e,null,function*(){if(d&&(null==t?void 0:t.id))try{yield VC(t.id,d.id),c(!1),f(null)}catch(e){console.error("タスクの削除に失敗しました:",e)}}),sx:{color:"error.main"},children:y.jsx(Q,{})})})]})}),y.jsx(ve,{children:y.jsxs(I,{sx:{mt:2},children:[y.jsx(Fe,{fullWidth:!0,label:"タイトル",value:(null==d?void 0:d.title)||"",onChange:e=>f(t=>t?h(u({},t),{title:e.target.value}):null),sx:{mb:2}}),y.jsx(Fe,{fullWidth:!0,label:"説明",multiline:!0,rows:3,value:(null==d?void 0:d.description)||"",onChange:e=>f(t=>t?h(u({},t),{description:e.target.value}):null),sx:{mb:2}}),y.jsxs(I,{sx:{display:"flex",gap:2,mb:2},children:[y.jsxs($e,{fullWidth:!0,children:[y.jsx(qe,{children:"ステータス"}),y.jsxs(Xe,{value:(null==d?void 0:d.status)||"todo",onChange:e=>f(t=>t?h(u({},t),{status:e.target.value}):null),label:"ステータス",children:[y.jsx(L,{value:"todo",children:"未着手"}),y.jsx(L,{value:"inProgress",children:"進行中"}),y.jsx(L,{value:"done",children:"完了"})]})]}),y.jsxs($e,{fullWidth:!0,children:[y.jsx(qe,{children:"優先度"}),y.jsxs(Xe,{value:(null==d?void 0:d.priority)||"medium",onChange:e=>f(t=>t?h(u({},t),{priority:e.target.value}):null),label:"優先度",children:[y.jsx(L,{value:"low",children:"低"}),y.jsx(L,{value:"medium",children:"中"}),y.jsx(L,{value:"high",children:"高"})]})]})]}),y.jsx(Fe,{fullWidth:!0,label:"期限",type:"date",value:(null==d?void 0:d.dueDate)||"",onChange:e=>f(t=>t?h(u({},t),{dueDate:e.target.value}):null),InputLabelProps:{shrink:!0},sx:{mb:2}}),y.jsx(Fe,{fullWidth:!0,label:"担当者",value:(null==d?void 0:d.assignee)||"",onChange:e=>f(t=>t?h(u({},t),{assignee:e.target.value}):null)})]})}),y.jsxs(je,{children:[y.jsx(Te,{onClick:()=>c(!1),children:"キャンセル"}),y.jsx(Te,{variant:"contained",onClick:()=>g(e,null,function*(){if(d&&(null==t?void 0:t.id))try{if(d.id&&d.title)if(d.id.includes("temp")){const e=h(u({},d),{id:Date.now().toString(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()});yield LC(t.id,e)}else yield FC(t.id,d.id,d);c(!1),f(null)}catch(e){console.error("タスクの保存に失敗しました:",e)}}),disabled:!(null==d?void 0:d.title),children:"保存"})]})]})]})})},Yj=()=>{const{isDarkMode:e,toggleTheme:t}=oo(),{user:n}=to(),[r,i]=on.useState(!1),[s,o]=on.useState(!1),[a,l]=on.useState({notifications:{email:!0,push:!0,sms:!1,taskReminders:!0,deadlineAlerts:!0,teamUpdates:!0},appearance:{theme:"auto",language:"ja",timezone:"Asia/Tokyo",dateFormat:"YYYY/MM/DD",timeFormat:"24h"},privacy:{profileVisible:!0,showEmail:!1,showPhone:!1,allowAnalytics:!0},data:{autoBackup:!0,backupFrequency:"daily",retentionPeriod:"30days"}}),c=(()=>{const e=JSON.parse(localStorage.getItem("tasks")||"[]"),t=localStorage.getItem("userProfile"),n=localStorage.getItem("userSettings"),r=new Blob([JSON.stringify(e)]).size,i=t?new Blob([t]).size:0,s=n?new Blob([n]).size:0;return{tasks:r,profile:i,settings:s,total:r+i+s}})();return y.jsxs(I,{sx:{p:3,maxWidth:1200,mx:"auto"},children:[y.jsx(E,{variant:"h4",gutterBottom:!0,sx:{fontWeight:700,mb:4},children:"設定"}),y.jsxs(et,{container:!0,spacing:3,children:[y.jsx(et,{item:!0,xs:12,md:6,children:y.jsxs(Ce,{sx:{p:3,mb:3},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[y.jsx(E,{variant:"h6",sx:{fontWeight:600},children:"通知設定"}),y.jsx(P,{color:"primary"})]}),y.jsxs(K,{children:[y.jsxs(G,{children:[y.jsx(F,{children:y.jsx(Ct,{color:"primary"})}),y.jsx(B,{primary:"メール通知",secondary:"重要な更新をメールで受け取る"}),y.jsx(Et,{children:y.jsx(lt,{checked:a.notifications.email,onChange:e=>l(h(u({},a),{notifications:h(u({},a.notifications),{email:e.target.checked})})),disabled:!r})})]}),y.jsxs(G,{children:[y.jsx(F,{children:y.jsx(Qe,{color:"primary"})}),y.jsx(B,{primary:"プッシュ通知",secondary:"ブラウザでプッシュ通知を受け取る"}),y.jsx(Et,{children:y.jsx(lt,{checked:a.notifications.push,onChange:e=>l(h(u({},a),{notifications:h(u({},a.notifications),{push:e.target.checked})})),disabled:!r})})]}),y.jsxs(G,{children:[y.jsx(F,{children:y.jsx(Je,{color:"primary"})}),y.jsx(B,{primary:"タスクリマインダー",secondary:"期限が近づいたタスクの通知"}),y.jsx(Et,{children:y.jsx(lt,{checked:a.notifications.taskReminders,onChange:e=>l(h(u({},a),{notifications:h(u({},a.notifications),{taskReminders:e.target.checked})})),disabled:!r})})]}),y.jsxs(G,{children:[y.jsx(F,{children:y.jsx(It,{color:"primary"})}),y.jsx(B,{primary:"期限アラート",secondary:"期限切れタスクの警告"}),y.jsx(Et,{children:y.jsx(lt,{checked:a.notifications.deadlineAlerts,onChange:e=>l(h(u({},a),{notifications:h(u({},a.notifications),{deadlineAlerts:e.target.checked})})),disabled:!r})})]})]})]})}),y.jsx(et,{item:!0,xs:12,md:6,children:y.jsxs(Ce,{sx:{p:3,mb:3},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[y.jsx(E,{variant:"h6",sx:{fontWeight:600},children:"表示設定"}),y.jsx(Dt,{color:"primary"})]}),y.jsxs(K,{children:[y.jsxs(G,{children:[y.jsx(F,{children:y.jsx(Dt,{color:"primary"})}),y.jsx(B,{primary:"ダークモード",secondary:"ダークテーマを使用"}),y.jsx(Et,{children:y.jsx(lt,{checked:e,onChange:t})})]}),y.jsxs(G,{children:[y.jsx(F,{children:y.jsx(Tt,{color:"primary"})}),y.jsx(B,{primary:"言語",secondary:"日本語"}),y.jsx(Et,{children:y.jsx(_e,{label:"日本語",size:"small"})})]}),y.jsxs(G,{children:[y.jsx(F,{children:y.jsx(Ct,{color:"primary"})}),y.jsx(B,{primary:"タイムゾーン",secondary:"Asia/Tokyo"}),y.jsx(Et,{children:y.jsx(_e,{label:"JST",size:"small"})})]})]})]})}),y.jsx(et,{item:!0,xs:12,md:6,children:y.jsxs(Ce,{sx:{p:3,mb:3},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[y.jsx(E,{variant:"h6",sx:{fontWeight:600},children:"プライバシー設定"}),y.jsx(jt,{color:"primary"})]}),y.jsxs(K,{children:[y.jsxs(G,{children:[y.jsx(F,{children:y.jsx(Ct,{color:"primary"})}),y.jsx(B,{primary:"プロフィール公開",secondary:"他のユーザーにプロフィールを表示"}),y.jsx(Et,{children:y.jsx(lt,{checked:a.privacy.profileVisible,onChange:e=>l(h(u({},a),{privacy:h(u({},a.privacy),{profileVisible:e.target.checked})})),disabled:!r})})]}),y.jsxs(G,{children:[y.jsx(F,{children:y.jsx(Ct,{color:"primary"})}),y.jsx(B,{primary:"メールアドレス表示",secondary:"プロフィールでメールアドレスを表示"}),y.jsx(Et,{children:y.jsx(lt,{checked:a.privacy.showEmail,onChange:e=>l(h(u({},a),{privacy:h(u({},a.privacy),{showEmail:e.target.checked})})),disabled:!r})})]}),y.jsxs(G,{children:[y.jsx(F,{children:y.jsx(Ct,{color:"primary"})}),y.jsx(B,{primary:"分析データ送信",secondary:"使用状況の分析データを送信"}),y.jsx(Et,{children:y.jsx(lt,{checked:a.privacy.allowAnalytics,onChange:e=>l(h(u({},a),{privacy:h(u({},a.privacy),{allowAnalytics:e.target.checked})})),disabled:!r})})]})]})]})}),y.jsx(et,{item:!0,xs:12,md:6,children:y.jsxs(Ce,{sx:{p:3,mb:3},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[y.jsx(E,{variant:"h6",sx:{fontWeight:600},children:"データ管理"}),y.jsx(_t,{color:"primary"})]}),y.jsxs(I,{sx:{mb:3},children:[y.jsx(E,{variant:"subtitle2",sx:{mb:2},children:"ストレージ使用量"}),y.jsxs(I,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[y.jsx(E,{variant:"body2",children:"タスクデータ"}),y.jsxs(E,{variant:"body2",children:[(c.tasks/1024).toFixed(2)," KB"]})]}),y.jsxs(I,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[y.jsx(E,{variant:"body2",children:"プロフィール"}),y.jsxs(E,{variant:"body2",children:[(c.profile/1024).toFixed(2)," KB"]})]}),y.jsxs(I,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[y.jsx(E,{variant:"body2",children:"設定"}),y.jsxs(E,{variant:"body2",children:[(c.settings/1024).toFixed(2)," KB"]})]}),y.jsx(W,{}),y.jsxs(I,{sx:{display:"flex",justifyContent:"space-between",mt:2},children:[y.jsx(E,{variant:"subtitle2",children:"合計"}),y.jsxs(E,{variant:"subtitle2",children:[(c.total/1024).toFixed(2)," KB"]})]})]}),y.jsx(I,{sx:{display:"flex",gap:2},children:y.jsx(Te,{variant:"outlined",color:"error",startIcon:y.jsx(Q,{}),onClick:()=>o(!0),fullWidth:!0,children:"データを削除"})})]})})]}),y.jsx(I,{sx:{display:"flex",justifyContent:"flex-end",mt:3},children:r?y.jsxs(I,{sx:{display:"flex",gap:2},children:[y.jsx(Te,{variant:"outlined",onClick:()=>{const e=localStorage.getItem("userSettings");e&&l(JSON.parse(e)),i(!1)},startIcon:y.jsx(Mt,{}),children:"キャンセル"}),y.jsx(Te,{variant:"contained",onClick:()=>{localStorage.setItem("userSettings",JSON.stringify(a)),i(!1),mn.success("設定を保存しました")},startIcon:y.jsx(Pt,{}),children:"保存"})]}):y.jsx(Te,{variant:"contained",onClick:()=>i(!0),startIcon:y.jsx(dt,{}),children:"編集"})}),y.jsxs(ge,{open:s,onClose:()=>o(!1),maxWidth:"sm",fullWidth:!0,children:[y.jsx(ze,{children:"データ削除の確認"}),y.jsxs(ve,{children:[y.jsx(He,{severity:"warning",sx:{mb:2},children:"この操作は元に戻すことができません。すべてのデータが削除されます。"}),y.jsx(E,{variant:"body2",color:"text.secondary",children:"削除されるデータ："}),y.jsxs("ul",{children:[y.jsx("li",{children:"すべてのタスク"}),y.jsx("li",{children:"プロフィール情報"}),y.jsx("li",{children:"設定"}),y.jsx("li",{children:"その他のアプリデータ"})]})]}),y.jsxs(je,{children:[y.jsx(Te,{onClick:()=>o(!1),children:"キャンセル"}),y.jsx(Te,{variant:"contained",color:"error",onClick:()=>{localStorage.clear(),mn.success("すべてのデータを削除しました"),o(!1),window.location.reload()},children:"削除"})]})]})]})};function Qj(e){const t=e,{children:n,value:r,index:i}=t,s=d(t,["children","value","index"]);return y.jsx("div",h(u({role:"tabpanel",hidden:r!==i,id:`auth-tabpanel-${i}`,"aria-labelledby":`auth-tab-${i}`},s),{children:r===i&&y.jsx(I,{sx:{p:3},children:n})}))}const Jj=()=>{const[t,n]=on.useState(0),[r,i]=on.useState(!1),[s,o]=on.useState(""),a=un(),{login:l,register:c}=to(),[d,f]=on.useState({email:"demo@example.com",password:"password"}),[p,m]=on.useState({name:"",email:"",password:"",confirmPassword:""});return y.jsx(At,{maxWidth:"sm",sx:{mt:4},children:y.jsxs(Ce,{elevation:3,sx:{borderRadius:2},children:[y.jsx(I,{sx:{borderBottom:1,borderColor:"divider"},children:y.jsxs(Rt,{value:t,onChange:(e,t)=>{n(t),o("")},"aria-label":"認証タブ",children:[y.jsx(Ot,{label:"ログイン"}),y.jsx(Ot,{label:"新規登録"})]})}),y.jsxs(Qj,{value:t,index:0,children:[y.jsx(E,{variant:"h5",component:"h1",gutterBottom:!0,align:"center",children:"ログイン"}),s&&y.jsx(He,{severity:"error",sx:{mb:2},children:s}),y.jsxs(I,{component:"form",onSubmit:t=>g(e,null,function*(){t.preventDefault(),i(!0),o("");try{yield l(d.email,d.password),mn.success("ログインしました"),a("/")}catch(e){o(e instanceof Error?e.message:"ログインに失敗しました"),mn.error("ログインに失敗しました")}finally{i(!1)}}),sx:{mt:2},children:[y.jsx(Fe,{fullWidth:!0,label:"メールアドレス",type:"email",value:d.email,onChange:e=>f(h(u({},d),{email:e.target.value})),margin:"normal",required:!0,disabled:r}),y.jsx(Fe,{fullWidth:!0,label:"パスワード",type:"password",value:d.password,onChange:e=>f(h(u({},d),{password:e.target.value})),margin:"normal",required:!0,disabled:r}),y.jsx(Te,{type:"submit",fullWidth:!0,variant:"contained",size:"large",sx:{mt:3,mb:2},disabled:r,children:r?y.jsx(Ye,{size:24}):"ログイン"})]}),y.jsx(I,{sx:{mt:2,textAlign:"center"},children:y.jsx(E,{variant:"body2",color:"text.secondary",children:"デモアカウント: demo@example.com / password"})})]}),y.jsxs(Qj,{value:t,index:1,children:[y.jsx(E,{variant:"h5",component:"h1",gutterBottom:!0,align:"center",children:"新規登録"}),s&&y.jsx(He,{severity:"error",sx:{mb:2},children:s}),y.jsxs(I,{component:"form",onSubmit:t=>g(e,null,function*(){if(t.preventDefault(),i(!0),o(""),p.password!==p.confirmPassword)return o("パスワードが一致しません"),void i(!1);try{yield c(p.name,p.email,p.password),mn.success("アカウントを作成しました"),a("/")}catch(e){o(e instanceof Error?e.message:"登録に失敗しました"),mn.error("登録に失敗しました")}finally{i(!1)}}),sx:{mt:2},children:[y.jsx(Fe,{fullWidth:!0,label:"お名前",value:p.name,onChange:e=>m(h(u({},p),{name:e.target.value})),margin:"normal",required:!0,disabled:r}),y.jsx(Fe,{fullWidth:!0,label:"メールアドレス",type:"email",value:p.email,onChange:e=>m(h(u({},p),{email:e.target.value})),margin:"normal",required:!0,disabled:r}),y.jsx(Fe,{fullWidth:!0,label:"パスワード",type:"password",value:p.password,onChange:e=>m(h(u({},p),{password:e.target.value})),margin:"normal",required:!0,disabled:r}),y.jsx(Fe,{fullWidth:!0,label:"パスワード（確認）",type:"password",value:p.confirmPassword,onChange:e=>m(h(u({},p),{confirmPassword:e.target.value})),margin:"normal",required:!0,disabled:r}),y.jsx(Te,{type:"submit",fullWidth:!0,variant:"contained",size:"large",sx:{mt:3,mb:2},disabled:r,children:r?y.jsx(Ye,{size:24}):"登録"})]})]})]})})},Zj=()=>{const{user:e}=to(),{isDarkMode:t,toggleTheme:n}=oo(),[r,i]=on.useState(!1),[s,o]=on.useState(!1),[a,l]=on.useState({name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.email)||"",phone:"",location:"",bio:"",website:"",github:"",linkedin:"",twitter:"",notifications:{email:!0,push:!0,sms:!1},preferences:{language:"ja",timezone:"Asia/Tokyo",dateFormat:"YYYY/MM/DD"}}),[c,d]=on.useState({currentPassword:"",newPassword:"",confirmPassword:""});return y.jsxs(I,{sx:{p:3,maxWidth:1200,mx:"auto"},children:[y.jsx(E,{variant:"h4",gutterBottom:!0,sx:{fontWeight:700,mb:4},children:"プロフィール設定"}),y.jsxs(et,{container:!0,spacing:3,children:[y.jsxs(et,{item:!0,xs:12,md:8,children:[y.jsxs(Ce,{sx:{p:3,mb:3},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[y.jsx(E,{variant:"h6",sx:{fontWeight:600},children:"基本情報"}),y.jsx(Te,{variant:r?"outlined":"contained",startIcon:r?y.jsx(Mt,{}):y.jsx(dt,{}),onClick:()=>i(!r),children:r?"キャンセル":"編集"})]}),y.jsxs(et,{container:!0,spacing:2,children:[y.jsx(et,{item:!0,xs:12,sm:6,children:y.jsx(Fe,{fullWidth:!0,label:"名前",value:a.name,onChange:e=>l(h(u({},a),{name:e.target.value})),disabled:!r,sx:{mb:2}})}),y.jsx(et,{item:!0,xs:12,sm:6,children:y.jsx(Fe,{fullWidth:!0,label:"メールアドレス",value:a.email,onChange:e=>l(h(u({},a),{email:e.target.value})),disabled:!r,sx:{mb:2}})}),y.jsx(et,{item:!0,xs:12,sm:6,children:y.jsx(Fe,{fullWidth:!0,label:"電話番号",value:a.phone,onChange:e=>l(h(u({},a),{phone:e.target.value})),disabled:!r,sx:{mb:2}})}),y.jsx(et,{item:!0,xs:12,sm:6,children:y.jsx(Fe,{fullWidth:!0,label:"所在地",value:a.location,onChange:e=>l(h(u({},a),{location:e.target.value})),disabled:!r,sx:{mb:2}})}),y.jsx(et,{item:!0,xs:12,children:y.jsx(Fe,{fullWidth:!0,label:"自己紹介",multiline:!0,rows:4,value:a.bio,onChange:e=>l(h(u({},a),{bio:e.target.value})),disabled:!r,sx:{mb:2}})})]}),r&&y.jsxs(I,{sx:{display:"flex",gap:2,mt:2},children:[y.jsx(Te,{variant:"contained",onClick:()=>{localStorage.setItem("userProfile",JSON.stringify(a)),i(!1),mn.success("プロフィールを更新しました")},startIcon:y.jsx(Pt,{}),children:"保存"}),y.jsx(Te,{variant:"outlined",onClick:()=>{const e=localStorage.getItem("userProfile");e&&l(JSON.parse(e)),i(!1)},children:"キャンセル"})]})]}),y.jsxs(Ce,{sx:{p:3,mb:3},children:[y.jsx(E,{variant:"h6",sx:{fontWeight:600,mb:3},children:"ソーシャルリンク"}),y.jsxs(et,{container:!0,spacing:2,children:[y.jsx(et,{item:!0,xs:12,sm:6,children:y.jsx(Fe,{fullWidth:!0,label:"ウェブサイト",value:a.website,onChange:e=>l(h(u({},a),{website:e.target.value})),disabled:!r,sx:{mb:2}})}),y.jsx(et,{item:!0,xs:12,sm:6,children:y.jsx(Fe,{fullWidth:!0,label:"GitHub",value:a.github,onChange:e=>l(h(u({},a),{github:e.target.value})),disabled:!r,sx:{mb:2}})}),y.jsx(et,{item:!0,xs:12,sm:6,children:y.jsx(Fe,{fullWidth:!0,label:"LinkedIn",value:a.linkedin,onChange:e=>l(h(u({},a),{linkedin:e.target.value})),disabled:!r,sx:{mb:2}})}),y.jsx(et,{item:!0,xs:12,sm:6,children:y.jsx(Fe,{fullWidth:!0,label:"Twitter",value:a.twitter,onChange:e=>l(h(u({},a),{twitter:e.target.value})),disabled:!r,sx:{mb:2}})})]})]})]}),y.jsxs(et,{item:!0,xs:12,md:4,children:[y.jsxs(Ce,{sx:{p:3,mb:3,textAlign:"center"},children:[y.jsx(O,{sx:{width:100,height:100,mx:"auto",mb:2,bgcolor:"primary.main",fontSize:"2rem"},children:a.name.charAt(0)}),y.jsx(E,{variant:"h6",sx:{fontWeight:600,mb:1},children:a.name}),y.jsx(E,{variant:"body2",color:"text.secondary",sx:{mb:2},children:a.email}),a.location&&y.jsx(_e,{icon:y.jsx(Nt,{}),label:a.location,size:"small",sx:{mb:1}})]}),y.jsxs(Ce,{sx:{p:3,mb:3},children:[y.jsx(E,{variant:"h6",sx:{fontWeight:600,mb:3},children:"設定"}),y.jsxs(I,{sx:{mb:3},children:[y.jsx(E,{variant:"subtitle2",sx:{mb:2},children:"通知設定"}),y.jsx(at,{control:y.jsx(lt,{checked:a.notifications.email,onChange:e=>l(h(u({},a),{notifications:h(u({},a.notifications),{email:e.target.checked})}))}),label:"メール通知"}),y.jsx(at,{control:y.jsx(lt,{checked:a.notifications.push,onChange:e=>l(h(u({},a),{notifications:h(u({},a.notifications),{push:e.target.checked})}))}),label:"プッシュ通知"}),y.jsx(at,{control:y.jsx(lt,{checked:a.notifications.sms,onChange:e=>l(h(u({},a),{notifications:h(u({},a.notifications),{sms:e.target.checked})}))}),label:"SMS通知"})]}),y.jsx(W,{sx:{my:2}}),y.jsxs(I,{sx:{mb:3},children:[y.jsx(E,{variant:"subtitle2",sx:{mb:2},children:"表示設定"}),y.jsx(at,{control:y.jsx(lt,{checked:t,onChange:n}),label:"ダークモード"})]}),y.jsx(W,{sx:{my:2}}),y.jsx(Te,{fullWidth:!0,variant:"outlined",startIcon:y.jsx(jt,{}),onClick:()=>o(!0),sx:{mb:2},children:"パスワード変更"}),y.jsx(Te,{fullWidth:!0,variant:"outlined",startIcon:y.jsx(Tt,{}),sx:{mb:2},children:"言語設定"})]})]})]}),y.jsxs(ge,{open:s,onClose:()=>o(!1),maxWidth:"sm",fullWidth:!0,children:[y.jsx(ze,{children:"パスワード変更"}),y.jsxs(ve,{children:[y.jsx(Fe,{fullWidth:!0,type:"password",label:"現在のパスワード",value:c.currentPassword,onChange:e=>d(h(u({},c),{currentPassword:e.target.value})),sx:{mb:2,mt:1}}),y.jsx(Fe,{fullWidth:!0,type:"password",label:"新しいパスワード",value:c.newPassword,onChange:e=>d(h(u({},c),{newPassword:e.target.value})),sx:{mb:2}}),y.jsx(Fe,{fullWidth:!0,type:"password",label:"新しいパスワード（確認）",value:c.confirmPassword,onChange:e=>d(h(u({},c),{confirmPassword:e.target.value})),sx:{mb:2}}),c.newPassword!==c.confirmPassword&&c.confirmPassword&&y.jsx(He,{severity:"error",sx:{mb:2},children:"パスワードが一致しません"})]}),y.jsxs(je,{children:[y.jsx(Te,{onClick:()=>o(!1),children:"キャンセル"}),y.jsx(Te,{variant:"contained",onClick:()=>{c.newPassword===c.confirmPassword?(mn.success("パスワードを変更しました"),o(!1),d({currentPassword:"",newPassword:"",confirmPassword:""})):mn.error("新しいパスワードが一致しません")},disabled:!c.currentPassword||!c.newPassword||c.newPassword!==c.confirmPassword,children:"変更"})]})]})]})},e_=()=>{const{user:e}=to(),[t,n]=on.useState(!1),[r,i]=on.useState(1500),[s,o]=on.useState("work"),[a,l]=on.useState(0),[c,d]=on.useState(null),[f,p]=on.useState(!1),[g,m]=on.useState(!0),[v,x]=on.useState({workDuration:25,shortBreakDuration:5,longBreakDuration:15,longBreakInterval:4,autoStartBreaks:!1,autoStartPomodoros:!1,soundEnabled:!0});on.useEffect(()=>{let e;return t&&r>0&&(e=setInterval(()=>{i(e=>e<=1?(b(),0):e-1)},1e3)),()=>clearInterval(e)},[t,r]);const b=on.useCallback(()=>{if(n(!1),g&&w(),"work"===s){l(e=>e+1),mn.success("ポモドーロ完了！休憩時間です。");const e=(a+1)%v.longBreakInterval===0,t=e?"longBreak":"shortBreak",r=e?v.longBreakDuration:v.shortBreakDuration;o(t),i(60*r),v.autoStartBreaks&&n(!0)}else mn.success("休憩終了！作業を再開しましょう。"),o("work"),i(60*v.workDuration),v.autoStartPomodoros&&n(!0)},[s,a,v,g]),w=()=>{try{new Audio("/notification.mp3").play().catch(()=>{console.log("通知音を再生できませんでした")})}catch(e){console.log("通知音の再生に失敗しました:",e)}},S=()=>{switch(s){case"work":default:return"#ef4444";case"shortBreak":return"#10b981";case"longBreak":return"#6366f1"}};return y.jsxs(I,{sx:{p:3},children:[y.jsx(Cr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:y.jsx(ct,{sx:{maxWidth:600,mx:"auto",background:`linear-gradient(135deg, ${S()} 0%, ${S()}dd 100%)`,color:"white",borderRadius:3,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)"},children:y.jsxs(tt,{sx:{p:4,textAlign:"center"},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[y.jsx(E,{variant:"h4",sx:{fontWeight:700},children:"ポモドーロタイマー"}),y.jsxs(I,{sx:{display:"flex",gap:1},children:[y.jsx(D,{title:"音声設定",children:y.jsx(k,{onClick:()=>m(!g),sx:{color:"white"},children:g?y.jsx(Lt,{}):y.jsx(Ft,{})})}),y.jsx(D,{title:"設定",children:y.jsx(k,{onClick:()=>p(!0),sx:{color:"white"},children:y.jsx(z,{})})})]})]}),y.jsx(_e,{label:(()=>{switch(s){case"work":default:return"作業時間";case"shortBreak":return"短い休憩";case"longBreak":return"長い休憩"}})(),sx:{backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white",fontWeight:600,mb:2}}),y.jsx(E,{variant:"h1",sx:{fontWeight:700,fontSize:"4rem",mb:2,fontFamily:"monospace"},children:(e=>{const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`})(r)}),y.jsx(Ze,{variant:"determinate",value:(()=>{const e="work"===s?60*v.workDuration:"shortBreak"===s?60*v.shortBreakDuration:60*v.longBreakDuration;return(e-r)/e*100})(),sx:{height:8,borderRadius:4,backgroundColor:"rgba(255, 255, 255, 0.2)","& .MuiLinearProgress-bar":{backgroundColor:"white"},mb:3}}),y.jsxs(I,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:3},children:[y.jsx(Qe,{sx:{mr:1}}),y.jsxs(E,{variant:"h6",children:["完了: ",a," ポモドーロ"]})]}),y.jsxs(I,{sx:{display:"flex",gap:2,justifyContent:"center",mb:3},children:[t?y.jsx(Te,{variant:"contained",size:"large",onClick:()=>{n(!1),mn.info("タイマーを一時停止しました")},startIcon:y.jsx(Bt,{}),sx:{backgroundColor:"white",color:S(),"&:hover":{backgroundColor:"rgba(255, 255, 255, 0.9)"}},children:"一時停止"}):y.jsx(Te,{variant:"contained",size:"large",onClick:()=>{n(!0),mn.success("ポモドーロタイマーを開始しました")},startIcon:y.jsx(Vt,{}),sx:{backgroundColor:"white",color:S(),"&:hover":{backgroundColor:"rgba(255, 255, 255, 0.9)"}},children:"開始"}),y.jsx(Te,{variant:"outlined",size:"large",onClick:()=>{n(!1),i(60*v.workDuration),o("work"),mn.info("タイマーを停止しました")},startIcon:y.jsx(zt,{}),sx:{borderColor:"white",color:"white","&:hover":{borderColor:"white",backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:"停止"}),y.jsx(Te,{variant:"outlined",size:"large",onClick:()=>{n(!1),i(60*v.workDuration),o("work"),l(0),mn.info("タイマーをリセットしました")},startIcon:y.jsx(Wt,{}),sx:{borderColor:"white",color:"white","&:hover":{borderColor:"white",backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:"リセット"})]}),c&&y.jsxs(I,{sx:{mt:3,p:2,backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:2},children:[y.jsx(E,{variant:"h6",sx:{mb:1},children:"現在のタスク"}),y.jsx(E,{variant:"body1",children:c.title})]})]})})}),y.jsxs(ge,{open:f,onClose:()=>p(!1),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:3,background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)"}},children:[y.jsx(ze,{sx:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"white",borderRadius:"12px 12px 0 0",pb:2},children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:2},children:[y.jsx(O,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)",width:40,height:40},children:y.jsx(z,{})}),y.jsx(E,{variant:"h6",sx:{fontWeight:700},children:"ポモドーロ設定"})]})}),y.jsx(ve,{sx:{p:3},children:y.jsxs(et,{container:!0,spacing:3,children:[y.jsx(et,{item:!0,xs:12,md:6,children:y.jsx(Fe,{fullWidth:!0,label:"作業時間（分）",type:"number",value:v.workDuration,onChange:e=>x(h(u({},v),{workDuration:parseInt(e.target.value)})),variant:"outlined",InputProps:{startAdornment:y.jsx(re,{sx:{mr:1,color:"text.secondary"}})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),y.jsx(et,{item:!0,xs:12,md:6,children:y.jsx(Fe,{fullWidth:!0,label:"短い休憩時間（分）",type:"number",value:v.shortBreakDuration,onChange:e=>x(h(u({},v),{shortBreakDuration:parseInt(e.target.value)})),variant:"outlined",InputProps:{startAdornment:y.jsx(Ke,{sx:{mr:1,color:"text.secondary"}})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),y.jsx(et,{item:!0,xs:12,md:6,children:y.jsx(Fe,{fullWidth:!0,label:"長い休憩時間（分）",type:"number",value:v.longBreakDuration,onChange:e=>x(h(u({},v),{longBreakDuration:parseInt(e.target.value)})),variant:"outlined",InputProps:{startAdornment:y.jsx(Ke,{sx:{mr:1,color:"text.secondary"}})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),y.jsx(et,{item:!0,xs:12,md:6,children:y.jsx(Fe,{fullWidth:!0,label:"長い休憩の間隔（ポモドーロ数）",type:"number",value:v.longBreakInterval,onChange:e=>x(h(u({},v),{longBreakInterval:parseInt(e.target.value)})),variant:"outlined",InputProps:{startAdornment:y.jsx(Qe,{sx:{mr:1,color:"text.secondary"}})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),y.jsx(et,{item:!0,xs:12,children:y.jsxs($e,{fullWidth:!0,children:[y.jsx(qe,{children:"自動開始設定"}),y.jsxs(Xe,{value:v.autoStartBreaks?"breaks":v.autoStartPomodoros?"pomodoros":"none",onChange:e=>{const t=e.target.value;x(h(u({},v),{autoStartBreaks:"breaks"===t,autoStartPomodoros:"pomodoros"===t}))},label:"自動開始設定",sx:{borderRadius:2},children:[y.jsx(L,{value:"none",children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(I,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#64748b"}}),"自動開始なし"]})}),y.jsx(L,{value:"breaks",children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(I,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#10b981"}}),"休憩を自動開始"]})}),y.jsx(L,{value:"pomodoros",children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1},children:[y.jsx(I,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#f59e0b"}}),"ポモドーロを自動開始"]})})]})]})}),y.jsx(et,{item:!0,xs:12,children:y.jsx(He,{severity:"info",sx:{borderRadius:2},children:y.jsx(E,{variant:"body2",children:"推奨設定: 作業時間25分、短い休憩5分、長い休憩15分、間隔4ポモドーロ"})})})]})}),y.jsxs(je,{sx:{p:3,pt:0},children:[y.jsx(Te,{onClick:()=>p(!1),variant:"outlined",sx:{borderRadius:2,textTransform:"none",fontWeight:600},children:"キャンセル"}),y.jsx(Te,{onClick:()=>{x(v),i(60*v.workDuration),m(v.soundEnabled),p(!1),mn.success("設定を保存しました")},variant:"contained",sx:{borderRadius:2,textTransform:"none",fontWeight:600,background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)","&:hover":{background:"linear-gradient(135deg, #d97706 0%, #b45309 100%)"}},children:"保存"})]})]})]})},t_=()=>{var e,t,n;const{user:r}=to(),[i,s]=on.useState([]),[o,a]=on.useState([]),[l,c]=on.useState(null),[d,f]=on.useState(!1),[p,g]=on.useState(null),[m,v]=on.useState(1),[x,b]=on.useState({x:0,y:0}),[C,T]=on.useState(!1),[j,P]=on.useState(!1),[A,R]=on.useState(!1),[N,F]=on.useState(!1),[V,B]=on.useState(!1),[z,U]=on.useState(!0),[H,$]=on.useState(!1),[q]=on.useState(on.useRef(null)),[X,K]=on.useState(null),[G,Y]=on.useState(null),[J,Z]=on.useState(null),[ee,ne]=on.useState(!1),[re,se]=on.useState(null),[oe,ae]=on.useState(null),[le,ce]=on.useState({x:0,y:0}),[ue,he]=on.useState(!1);on.useEffect(()=>{if(!(null==r?void 0:r.id))return;P(!0);const e=NC(r.id,e=>{a(e);const t=localStorage.getItem(`mindmap_${r.id}`);if(t)try{const e=JSON.parse(t);s(e),console.log("保存されたマインドマップノードを読み込みました:",e.length,"個のノード")}catch(i){console.error("マインドマップノードの読み込みに失敗:",i),de()}else de();const n=localStorage.getItem(`mindmap_pan_${r.id}`);if(n)try{const e=JSON.parse(n);b(e),console.log("保存されたパン位置を読み込みました:",e)}catch(i){console.error("パン位置の読み込みに失敗:",i)}P(!1)});return()=>e()},[null==r?void 0:r.id]),on.useEffect(()=>{const e=e=>{const{type:t,value:n}=e.detail;console.log("MindMapView: フィルタ変更を検知:",t,n),"workspace"===t?(localStorage.setItem("currentWorkspace",n),localStorage.removeItem("currentProject")):"project"===t&&(localStorage.setItem("currentProject",n),localStorage.removeItem("currentWorkspace"));const i=localStorage.getItem(`tasks_${null==r?void 0:r.id}`);if(i){const e=JSON.parse(i),r="workspace"===t?e.filter(e=>e.workspace===n||!e.workspace&&"個人プロジェクト"===n):e.filter(e=>e.project===n||!e.project&&"個人プロジェクト"===n);a(r)}};window.addEventListener("filterChanged",e);const t=localStorage.getItem("currentWorkspace"),n=localStorage.getItem("currentProject"),i=localStorage.getItem(`tasks_${null==r?void 0:r.id}`);if(i){const e=JSON.parse(i);t?a(e.filter(e=>e.workspace===t||!e.workspace&&"個人プロジェクト"===t)):n&&a(e.filter(e=>e.project===n||!e.project&&"個人プロジェクト"===n))}return()=>{window.removeEventListener("filterChanged",e)}},[null==r?void 0:r.id]),on.useEffect(()=>{i.length>0&&(null==r?void 0:r.id)&&localStorage.setItem(`mindmap_${r.id}`,JSON.stringify(i))},[i,null==r?void 0:r.id]),on.useEffect(()=>{if(!ee)return;const e=e=>{ce({x:e.clientX,y:e.clientY})};return document.addEventListener("mousemove",e),()=>document.removeEventListener("mousemove",e)},[ee]);const de=()=>{const e=[{id:"node-1",title:"プロジェクト成功の鍵",description:"プロジェクトを成功させるための重要な要素を整理",type:"strategy",priority:"high",status:"todo",position:{x:400,y:300},children:["node-2","node-3","node-4"],color:"#6366f1",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),size:"large",complexity:"complex",impact:"high",timeEstimate:480,isPublic:!0},{id:"node-2",title:"チーム構築",description:"効果的なチームメンバーの選定と役割分担",type:"concept",priority:"high",status:"inProgress",position:{x:200,y:150},parentId:"node-1",children:[],color:"#8b5cf6",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),size:"medium",complexity:"moderate",impact:"high",timeEstimate:120,tags:["重要","チーム"]},{id:"node-3",title:"技術選定",description:"最新技術の調査と最適な技術スタックの決定",type:"idea",priority:"medium",status:"todo",position:{x:600,y:150},parentId:"node-1",children:[],color:"#06b6d4",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),size:"medium",complexity:"moderate",impact:"medium",timeEstimate:180,tags:["技術","調査"]},{id:"node-4",title:"マーケティング戦略",description:"ターゲット市場の分析と効果的なマーケティング手法",type:"strategy",priority:"high",status:"todo",position:{x:400,y:450},parentId:"node-1",children:[],color:"#10b981",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),size:"medium",complexity:"complex",impact:"high",timeEstimate:240,tags:["マーケティング","戦略"]}];s(e)},fe=e=>{const t={id:`node-${Date.now()}`,title:"",description:"",type:"idea",priority:"medium",status:"todo",position:{x:e?400:800*Math.random()+100,y:e?300:600*Math.random()+100},parentId:e,children:[],color:"#6366f1",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),size:"medium",complexity:"simple",impact:"medium",timeEstimate:60,tags:[]};s(e=>[...e,t]),g(t),f(!0)},pe=e=>({idea:"#06b6d4",task:"#6366f1",project:"#8b5cf6",goal:"#10b981",concept:"#f59e0b",strategy:"#ef4444",milestone:"#ec4899"}[e]||"#6366f1"),me=e=>({idea:y.jsx(Zt,{sx:{fontSize:20}}),task:y.jsx(We,{sx:{fontSize:20}}),project:y.jsx(ie,{sx:{fontSize:20}}),goal:y.jsx(Qe,{sx:{fontSize:20}}),concept:y.jsx(en,{sx:{fontSize:20}}),strategy:y.jsx(nt,{sx:{fontSize:20}}),milestone:y.jsx(te,{sx:{fontSize:20}})}[e]||y.jsx(Zt,{sx:{fontSize:20}})),ye=e=>{const t="in"===e?1.2*m:m/1.2;v(Math.min(Math.max(t,.3),3))},xe=on.useCallback(e=>{if(!C||!J||N||ee)return;const t=e.clientX-X.x,n=e.clientY-X.y;s(e=>{const i=e.map(e=>e.id===J?h(u({},e),{position:{x:e.position.x+t,y:e.position.y+n}}):e);return i.length>0&&(null==r?void 0:r.id)&&localStorage.setItem(`mindmap_${r.id}`,JSON.stringify(i)),i}),K({x:e.clientX,y:e.clientY})},[C,J,X,N,ee,null==r?void 0:r.id]),be=()=>{T(!1),Z(null),document.body.style.cursor="default",i.length>0&&(null==r?void 0:r.id)&&(localStorage.setItem(`mindmap_${r.id}`,JSON.stringify(i)),console.log("マインドマップノードの位置を保存しました"))},we=e=>{if(!G||!N&&2!==e.buttons)return;const t=e.clientX-G.x,n=e.clientY-G.y;b(e=>{const i={x:e.x+t,y:e.y+n};return(null==r?void 0:r.id)&&localStorage.setItem(`mindmap_pan_${r.id}`,JSON.stringify(i)),i}),Y({x:e.clientX,y:e.clientY})},Se=()=>{Y(null),document.body.style.cursor="default"};on.useEffect(()=>{z&&z&&s(e=>{const t=e.filter(e=>!e.parentId),n=[...e];return t.forEach((e,r)=>{const i=2*r*Math.PI/t.length,s=400+300*Math.cos(i),o=300+300*Math.sin(i),a=n.findIndex(t=>t.id===e.id);-1!==a&&(n[a]=h(u({},e),{position:{x:s,y:o}}))}),n})},[z]),on.useEffect(()=>{if(C)return document.addEventListener("mousemove",xe),document.addEventListener("mouseup",be),()=>{document.removeEventListener("mousemove",xe),document.removeEventListener("mouseup",be)}},[C,xe]),on.useEffect(()=>{if(N||G)return document.addEventListener("mousemove",we),document.addEventListener("mouseup",Se),document.addEventListener("contextmenu",e=>e.preventDefault()),()=>{document.removeEventListener("mousemove",we),document.removeEventListener("mouseup",Se),document.removeEventListener("contextmenu",e=>e.preventDefault())}},[N,G,we,Se]);const ke=A?i.filter(e=>e.isFavorite):i;return y.jsxs(I,{sx:{height:"100vh",display:"flex",flexDirection:"column"},children:[y.jsx(w,{position:"static",elevation:0,sx:{backgroundColor:"white",color:"text.primary"},children:y.jsxs(S,{children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:2,flex:1},children:[y.jsx(ie,{sx:{fontSize:32,color:"primary.main"}}),y.jsx(E,{variant:"h5",sx:{fontWeight:700,color:"text.primary"},children:"画期的マインドマップ"})]}),y.jsxs(I,{sx:{display:"flex",gap:1,alignItems:"center"},children:[y.jsx(D,{title:"パンモード: キャンバスをドラッグして移動できます",children:y.jsx(at,{control:y.jsx(lt,{checked:N,onChange:e=>{F(e.target.checked),e.target.checked&&(he(!0),setTimeout(()=>he(!1),2e3))},size:"small"}),label:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:.5},children:[y.jsx(Ut,{sx:{fontSize:16}}),y.jsx(E,{variant:"body2",children:"パンモード"})]})})}),y.jsx(D,{title:"自動レイアウト: ノードを自動的に配置します",children:y.jsx(at,{control:y.jsx(lt,{checked:z,onChange:e=>U(e.target.checked),size:"small"}),label:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:.5},children:[y.jsx(Ht,{sx:{fontSize:16}}),y.jsx(E,{variant:"body2",children:"自動レイアウト"})]})})}),y.jsx(D,{title:"接続モード: ノードをクリックして接続を作成できます",children:y.jsx(at,{control:y.jsx(lt,{checked:ee,onChange:e=>{ne(e.target.checked),e.target.checked||(se(null),ne(!1),ce({x:0,y:0}),mn.error("接続をキャンセルしました"))},size:"small"}),label:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:.5},children:[y.jsx($t,{sx:{fontSize:16}}),y.jsx(E,{variant:"body2",children:"接続モード"})]})})}),y.jsx(D,{title:"コラボレーションモード: 他のユーザーとリアルタイムでマインドマップを共同編集できます",children:y.jsx(at,{control:y.jsx(lt,{checked:V,onChange:e=>B(e.target.checked),size:"small"}),label:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:.5},children:[y.jsx(qt,{sx:{fontSize:16}}),y.jsx(E,{variant:"body2",children:"コラボレーション"})]})})}),y.jsx(D,{title:"お気に入りのみ表示",children:y.jsx(k,{onClick:()=>R(!A),color:A?"primary":"default",children:y.jsx(M,{badgeContent:i.filter(e=>e.isFavorite).length,color:"primary",children:y.jsx(Xt,{})})})}),y.jsx(D,{title:"ズームイン",children:y.jsx(k,{onClick:()=>ye("in"),children:y.jsx(Kt,{})})}),y.jsx(D,{title:"ズームアウト",children:y.jsx(k,{onClick:()=>ye("out"),children:y.jsx(Gt,{})})}),y.jsx(D,{title:"ビューをリセット",children:y.jsx(k,{onClick:()=>{v(1),b({x:0,y:0})},children:y.jsx(Yt,{})})}),y.jsx(D,{title:"新しいノードを追加",children:y.jsx(Te,{variant:"contained",startIcon:y.jsx(_,{}),onClick:()=>fe(),sx:{borderRadius:2,textTransform:"none",fontWeight:600},children:"ノードを追加"})})]})]})}),j&&y.jsx(Ze,{}),ue&&y.jsx(He,{severity:"info",sx:{position:"absolute",top:80,left:"50%",transform:"translateX(-50%)",zIndex:1e3,borderRadius:2},children:"パンモード: キャンバスをドラッグして移動できます"}),ee&&y.jsx(He,{severity:"warning",sx:{position:"absolute",top:ue?140:80,left:"50%",transform:"translateX(-50%)",zIndex:1e3,borderRadius:2},children:"接続モード: ノードをクリックして接続を作成できます"}),y.jsx(Ce,{ref:q,sx:{flex:1,position:"relative",overflow:"hidden",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:0,cursor:N?"grab":"default","&:active":{cursor:N?"grabbing":"default"}},onMouseDown:e=>{(N||2===e.button)&&(e.preventDefault(),Y({x:e.clientX,y:e.clientY}),document.body.style.cursor="grabbing")},onContextMenu:e=>e.preventDefault(),children:y.jsxs(I,{sx:{transform:`scale(${m}) translate(${x.x}px, ${x.y}px)`,transformOrigin:"center",transition:C?"none":"transform 0.3s ease",position:"relative",width:"100%",height:"100%"},children:[y.jsxs("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"},children:[ke.map(e=>{if(!e.parentId)return null;const t=ke.find(t=>t.id===e.parentId);if(!t)return null;const n=t.position.x+150,r=t.position.y+75,i=e.position.x+150,s=e.position.y+75;return y.jsx("line",{x1:n,y1:r,x2:i,y2:s,stroke:pe(e.type),strokeWidth:3,opacity:.8,strokeDasharray:"5,5"},`${t.id}-${e.id}`)}),re&&y.jsx("line",{x1:(null==(e=ke.find(e=>e.id===re))?void 0:e.position.x)+150||0,y1:(null==(t=ke.find(e=>e.id===re))?void 0:t.position.y)+75||0,x2:(le.x-x.x)/m,y2:(le.y-x.y)/m,stroke:"#fbbf24",strokeWidth:4,opacity:.8,strokeDasharray:"10,5"})]}),y.jsx(Er,{children:ke.map(e=>y.jsx(Cr.div,{initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:-20},transition:{duration:.4,ease:"easeOut"},style:{position:"absolute",left:e.position.x,top:e.position.y,zIndex:e.parentId?1:2},onMouseDown:t=>{return n=e.id,r=t,void(N||ee||(r.preventDefault(),T(!0),Z(n),K({x:r.clientX,y:r.clientY}),document.body.style.cursor="grabbing"));var n,r},children:y.jsx(ct,{sx:h(u({minWidth:"large"===e.size?400:"small"===e.size?250:300,maxWidth:"large"===e.size?450:"small"===e.size?300:350,background:re===e.id?"linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)":`linear-gradient(135deg, ${pe(e.type)} 0%, ${pe(e.type)}dd 100%)`,color:"white",cursor:ee?re===e.id?"not-allowed":"crosshair":N?"grab":"pointer",borderRadius:3,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)",border:e.isFavorite?"2px solid #fbbf24":"none","&:hover":{transform:"scale(1.05) translateY(-5px)",boxShadow:"0 16px 48px rgba(0, 0, 0, 0.4)"}},ee&&re!==e.id&&{border:"2px dashed rgba(255, 255, 255, 0.5)","&:hover":{border:"2px solid rgba(255, 255, 255, 0.8)",transform:"scale(1.1) translateY(-5px)",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)"}}),{transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"}),onClick:()=>{var t;ee?re?(e=>{if(!re||re===e)return void se(null);const t=i.find(e=>e.id===re),n=i.find(t=>t.id===e);if(t&&n){const e=i.map(e=>e.id===n.id?h(u({},e),{parentId:t.id}):e.id===t.id?h(u({},e),{children:[...e.children,n.id]}):e);s(e),mn.success(`${t.title} と ${n.title} を接続しました`)}se(null),ne(!1),ce({x:0,y:0})})(e.id):(t=e.id,ee&&(se(t),mn.success("接続先のノードをクリックしてください"))):c(e)},children:y.jsxs(tt,{sx:{p:3},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",mb:2},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:1.5,flex:1},children:[y.jsx(O,{sx:{backgroundColor:"rgba(255, 255, 255, 0.2)",width:40,height:40},children:me(e.type)}),y.jsxs(I,{children:[y.jsx(E,{variant:"h6",sx:{fontWeight:700,mb:.5},children:e.title}),e.tags&&e.tags.length>0&&y.jsx(I,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:e.tags.slice(0,2).map((e,t)=>y.jsx(_e,{label:e,size:"small",sx:{backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white",fontSize:"0.7rem",height:20}},t))})]})]}),y.jsxs(I,{sx:{display:"flex",gap:.5},children:[y.jsx(D,{title:"お気に入り",children:y.jsx(k,{size:"small",onClick:t=>{var n;t.stopPropagation(),n=e.id,s(e=>e.map(e=>e.id===n?h(u({},e),{isFavorite:!e.isFavorite}):e))},sx:{color:e.isFavorite?"#fbbf24":"rgba(255, 255, 255, 0.7)"},children:e.isFavorite?y.jsx(Qt,{}):y.jsx(Jt,{})})}),y.jsx(D,{title:"編集",children:y.jsx(k,{size:"small",onClick:t=>{t.stopPropagation(),(e=>{g(u({},e)),f(!0)})(e)},sx:{color:"rgba(255, 255, 255, 0.7)"},children:y.jsx(dt,{})})}),y.jsx(D,{title:"削除",children:y.jsx(k,{size:"small",onClick:t=>{t.stopPropagation(),(e=>{const t=e=>{const n=i.find(t=>t.id===e);n&&(n.children.forEach(e=>t(e)),s(t=>t.filter(t=>t.id!==e)))};t(e),mn.success("ノードを削除しました")})(e.id)},sx:{color:"rgba(255, 255, 255, 0.7)"},children:y.jsx(Q,{})})})]})]}),e.description&&y.jsx(E,{variant:"body2",sx:{mb:2,opacity:.9,lineHeight:1.5,fontStyle:"italic"},children:e.description}),y.jsxs(I,{sx:{display:"flex",gap:1,mb:2},children:[y.jsx(_e,{label:"todo"===e.status?"未着手":"inProgress"===e.status?"進行中":"完了",size:"small",sx:{backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white",fontWeight:600}}),y.jsx(_e,{label:"high"===e.priority?"高優先":"medium"===e.priority?"中優先":"低優先",size:"small",sx:{backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white",fontWeight:600}}),e.timeEstimate&&y.jsx(_e,{label:`${Math.round(e.timeEstimate/60)}時間`,size:"small",sx:{backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white",fontWeight:600}})]}),y.jsx(W,{sx:{my:1,borderColor:"rgba(255, 255, 255, 0.2)"}}),y.jsxs(I,{sx:{display:"flex",gap:1},children:[y.jsx(D,{title:"子ノードを追加",children:y.jsx(Te,{size:"small",variant:"outlined",onClick:t=>{t.stopPropagation(),fe(e.id)},sx:{borderColor:"white",color:"white",borderRadius:2,textTransform:"none",fontWeight:600,"&:hover":{borderColor:"white",backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:"子ノード追加"})}),"idea"===e.type&&y.jsx(D,{title:"アイデアをタスクに変換",children:y.jsx(Te,{size:"small",variant:"outlined",onClick:t=>{t.stopPropagation(),(e=>{var t,n;const i=localStorage.getItem("currentWorkspace"),s=localStorage.getItem("currentProject"),o={id:`task-${Date.now()}`,title:e.title,description:e.description,status:e.status,priority:e.priority,dueDate:new Date(Date.now()+6048e5).toISOString().split("T")[0],assignee:(null==r?void 0:r.name)||"未設定",createdAt:(new Date).toISOString(),project:s||(null==(t=e.tags)?void 0:t[0])||"個人プロジェクト",workspace:i||(null==(n=e.tags)?void 0:n[1])||"チームA"};(null==r?void 0:r.id)&&(LC(r.id,o),mn.success("タスクに変換しました"),a(e=>[...e,o]))})(e)},sx:{borderColor:"white",color:"white",borderRadius:2,textTransform:"none",fontWeight:600,"&:hover":{borderColor:"white",backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:"タスク化"})})]})]})})},e.id))})]})}),y.jsxs(ge,{open:d,onClose:()=>f(!1),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:3,background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)"}},children:[y.jsx(ze,{sx:{background:"linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)",color:"white",borderRadius:"12px 12px 0 0",pb:2},children:y.jsxs(I,{sx:{display:"flex",alignItems:"center",gap:2},children:[p&&me(p.type),y.jsx(E,{variant:"h6",sx:{fontWeight:700},children:(null==p?void 0:p.id)?"ノードを編集":"新しいノード"})]})}),y.jsx(ve,{sx:{p:3},children:y.jsxs(et,{container:!0,spacing:3,children:[y.jsx(et,{item:!0,xs:12,children:y.jsx(Fe,{fullWidth:!0,label:"タイトル",value:(null==p?void 0:p.title)||"",onChange:e=>g(t=>t?h(u({},t),{title:e.target.value}):null),variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),y.jsx(et,{item:!0,xs:12,children:y.jsx(Fe,{fullWidth:!0,label:"説明",value:(null==p?void 0:p.description)||"",onChange:e=>g(t=>t?h(u({},t),{description:e.target.value}):null),variant:"outlined",multiline:!0,rows:3,sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),y.jsx(et,{item:!0,xs:12,md:6,children:y.jsxs($e,{fullWidth:!0,variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}},children:[y.jsx(qe,{children:"タイプ"}),y.jsxs(Xe,{value:(null==p?void 0:p.type)||"idea",onChange:e=>g(t=>t?h(u({},t),{type:e.target.value}):null),label:"タイプ",children:[y.jsx(L,{value:"idea",children:"アイデア 💡"}),y.jsx(L,{value:"task",children:"タスク 📋"}),y.jsx(L,{value:"project",children:"プロジェクト 🚀"}),y.jsx(L,{value:"goal",children:"目標 🎯"}),y.jsx(L,{value:"concept",children:"コンセプト 🧠"}),y.jsx(L,{value:"strategy",children:"戦略 📊"}),y.jsx(L,{value:"milestone",children:"マイルストーン 🏁"})]})]})}),y.jsx(et,{item:!0,xs:12,md:6,children:y.jsxs($e,{fullWidth:!0,variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}},children:[y.jsx(qe,{children:"優先度"}),y.jsxs(Xe,{value:(null==p?void 0:p.priority)||"medium",onChange:e=>g(t=>t?h(u({},t),{priority:e.target.value}):null),label:"優先度",children:[y.jsx(L,{value:"low",children:"低優先度"}),y.jsx(L,{value:"medium",children:"中優先度"}),y.jsx(L,{value:"high",children:"高優先度"})]})]})}),y.jsx(et,{item:!0,xs:12,md:6,children:y.jsxs($e,{fullWidth:!0,variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}},children:[y.jsx(qe,{children:"サイズ"}),y.jsxs(Xe,{value:(null==p?void 0:p.size)||"medium",onChange:e=>g(t=>t?h(u({},t),{size:e.target.value}):null),label:"サイズ",children:[y.jsx(L,{value:"small",children:"小"}),y.jsx(L,{value:"medium",children:"中"}),y.jsx(L,{value:"large",children:"大"})]})]})}),y.jsx(et,{item:!0,xs:12,md:6,children:y.jsx(Fe,{fullWidth:!0,label:"時間見積もり（分）",type:"number",value:(null==p?void 0:p.timeEstimate)||60,onChange:e=>g(t=>t?h(u({},t),{timeEstimate:parseInt(e.target.value)}):null),variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),y.jsx(et,{item:!0,xs:12,children:y.jsx(Fe,{fullWidth:!0,label:"タグ（カンマ区切り）",value:(null==(n=null==p?void 0:p.tags)?void 0:n.join(", "))||"",onChange:e=>{const t=e.target.value.split(",").map(e=>e.trim()).filter(e=>e);g(e=>e?h(u({},e),{tags:t}):null)},variant:"outlined",placeholder:"重要, 計画, 分析",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})})]})}),y.jsxs(je,{sx:{p:3,pt:0},children:[y.jsx(Te,{onClick:()=>f(!1),variant:"outlined",sx:{borderRadius:2,textTransform:"none",fontWeight:600},children:"キャンセル"}),y.jsx(Te,{onClick:()=>{p&&(p.id.startsWith("node-")?s(e=>[...e,p]):s(e=>e.map(e=>e.id===p.id?h(u({},p),{updatedAt:(new Date).toISOString()}):e)),f(!1),g(null),mn.success("ノードを保存しました"))},variant:"contained",sx:{borderRadius:2,textTransform:"none",fontWeight:600,background:"linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)","&:hover":{background:"linear-gradient(135deg, #5b5feb 0%, #7c3aed 100%)"}},children:"保存"})]})]})]})},n_=()=>{const{id:e}=dn(),t=un(),{user:n}=to(),[r,i]=on.useState(null),[s,o]=on.useState(!0),[a,l]=on.useState(!0);return on.useEffect(()=>{if(null==n?void 0:n.id){if(e&&"new"!==e){const t=NC(n.id,t=>{const n=t.find(t=>t.id===e);i(n||null),o(!1)});return()=>t()}o(!1)}},[e,null==n?void 0:n.id]),s?y.jsx(I,{sx:{p:3,textAlign:"center"},children:y.jsx(E,{variant:"h6",children:"読み込み中..."})}):y.jsx(I,{sx:{p:3},children:y.jsxs(Cr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[y.jsxs(I,{sx:{display:"flex",alignItems:"center",mb:3},children:[y.jsx(Te,{startIcon:y.jsx(tn,{}),onClick:()=>t(-1),sx:{mr:2},children:"戻る"}),y.jsx(E,{variant:"h4",sx:{fontWeight:700},children:r?"タスクを編集":"新しいタスク"})]}),y.jsx(BT,{open:a,onClose:()=>{l(!1),t(-1)},editingTask:r})]})})},r_=new Ks({defaultOptions:{queries:{refetchOnWindowFocus:!1,staleTime:1/0}}});function i_(){const[e,t]=on.useState(!0),{isDarkMode:n}=oo(),{user:r,isLoading:i}=to();return console.log("AppContent rendered",{sidebarOpen:e,isDarkMode:n,user:r,isLoading:i}),on.useEffect(()=>{kr.dismiss()},[]),i?y.jsx(I,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:y.jsx(E,{variant:"h6",children:"読み込み中..."})}):r?y.jsxs(y.Fragment,{children:[y.jsx(fn,{children:y.jsxs(I,{sx:{display:"flex",minHeight:"100vh"},children:[y.jsx(zC,{open:e,onToggle:()=>t(!e)}),y.jsxs(I,{sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[y.jsx(BC,{onMenuClick:()=>t(!e)}),y.jsx(I,{component:Cr.main,sx:{flexGrow:1,pt:"80px",backgroundColor:"background.default",transition:"margin-left 0.3s ease-in-out",marginLeft:e?"240px":"64px",minHeight:"calc(100vh - 80px)",overflow:"auto",paddingLeft:"24px",paddingRight:"24px"},children:y.jsx(Er,{mode:"wait",children:y.jsxs(pn,{children:[y.jsx(gn,{path:"/",element:y.jsx(zT,{})}),y.jsx(gn,{path:"/kanban",element:y.jsx(WT,{})}),y.jsx(gn,{path:"/calendar",element:y.jsx(Xj,{})}),y.jsx(gn,{path:"/timeline",element:y.jsx(Kj,{})}),y.jsx(gn,{path:"/list",element:y.jsx(Gj,{})}),y.jsx(gn,{path:"/pomodoro",element:y.jsx(e_,{})}),y.jsx(gn,{path:"/mindmap",element:y.jsx(t_,{})}),y.jsx(gn,{path:"/task/new",element:y.jsx(n_,{})}),y.jsx(gn,{path:"/task/edit/:id",element:y.jsx(n_,{})}),y.jsx(gn,{path:"/settings",element:y.jsx(Yj,{})}),y.jsx(gn,{path:"/profile",element:y.jsx(Zj,{})}),y.jsx(gn,{path:"/login",element:y.jsx(Jj,{})})]})})})]})]})}),y.jsx(Sr,{position:"top-right",toastOptions:{duration:2e3,style:{background:"#363636",color:"#fff",borderRadius:"8px",maxWidth:"400px",zIndex:9999}},containerStyle:{top:20,right:20,zIndex:9999},gutter:8,reverseOrder:!1})]}):y.jsxs(y.Fragment,{children:[y.jsx(fn,{children:y.jsx(pn,{children:y.jsx(gn,{path:"*",element:y.jsx(Jj,{})})})}),y.jsx(Sr,{position:"top-right",toastOptions:{duration:2e3,style:{background:"#363636",color:"#fff",borderRadius:"8px",maxWidth:"400px",zIndex:9999}},containerStyle:{top:20,right:20,zIndex:9999},gutter:8,reverseOrder:!1})]})}function s_(){return console.log("App component rendered"),y.jsx(Zs,{client:r_,children:y.jsx(ao,{children:y.jsx(no,{children:y.jsx(i_,{})})})})}t.createRoot(document.getElementById("root")).render(y.jsx(sn.StrictMode,{children:y.jsx(s_,{})}))}},function(){return Ss||(0,ws[r(ws)[0]])((Ss={exports:{}}).exports,Ss),Ss.exports});export default ks();
